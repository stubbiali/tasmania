

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>API Documentation &mdash; gt4ess 0.1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="gt4ess 0.1.0 documentation" href="index.html"/>
        <link rel="prev" title="Welcome to gt4ess’s documentation!" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> gt4ess
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#axis">Axis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dynamics">Dynamics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#diagnostics">Diagnostics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynamical-cores">Dynamical cores</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lateral-boundary-conditions">Lateral boundary conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#numerical-diffusion">Numerical diffusion</a></li>
<li class="toctree-l3"><a class="reference internal" href="#numerical-fluxes">Numerical fluxes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#prognostics">Prognostics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#wave-absorber">Wave absorber</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#grids">Grids</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#two-dimensional-grids">Two-dimensional grids</a></li>
<li class="toctree-l3"><a class="reference internal" href="#three-dimensional-grids">Three-dimensional grids</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#model">Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-namelist">Namelist</a></li>
<li class="toctree-l2"><a class="reference internal" href="#storages">Storages</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-grids.topography">Topography</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#parsers">Parsers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-utils">Utilities</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">gt4ess</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>API Documentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="api-documentation">
<h1>API Documentation<a class="headerlink" href="#api-documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="axis">
<h2>Axis<a class="headerlink" href="#axis" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="grids.axis.Axis">
<em class="property">class </em><code class="descclassname">grids.axis.</code><code class="descname">Axis</code><span class="sig-paren">(</span><em>coords</em>, <em>dims</em>, <em>attrs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.axis.Axis" title="Permalink to this definition">¶</a></dt>
<dd><p>Class representing a one-dimensional axis. The class API has been designed to be similar to
that provided by <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>coords</strong> (<em>list</em>) – One-dimensional <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> storing axis coordinates, wrapped
within a list.</li>
<li><strong>values</strong> (<em>array_like</em>) – One-dimensional <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> storing axis coordinates.
This attrribute is semantically identical to <code class="xref py py-attr docutils literal"><span class="pre">coords</span></code> and it is
introduced just for the sake of compliancy with <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a>’s API.</li>
<li><strong>dims</strong> (<em>list</em>) – Axis dimension, i.e., label.</li>
<li><strong>attrs</strong> (<em>dict</em>) – Axis attributes, e.g., the units.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="grids.axis.Axis.__getitem__">
<code class="descname">__getitem__</code><span class="sig-paren">(</span><em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.axis.Axis.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Get directly access to the coordinate vector.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>i</strong> (<em>int</em><em> or </em><em>array_like</em>) – The index, or a sequence of indices.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The coordinate(s).</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.axis.Axis.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>coords</em>, <em>dims</em>, <em>attrs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.axis.Axis.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>coords</strong> (<em>array_like</em>) – Axis coordinates. Must be a one-dimensional <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a>.</li>
<li><strong>dims</strong> (<em>str</em>) – Axis label.</li>
<li><strong>attrs</strong> (<cite>dict</cite>, optional) – <p>Axis attributes. This may be used to specify, e.g., the units,
which, following the <a class="reference external" href="http://cfconventions.org">CF Conventions</a>, may be either:</p>
<blockquote>
<div><ul>
<li>’m’ (meters) or multiples, for height-based coordinates;</li>
<li>’Pa’ (Pascal) or multiples, for pressure-based coordinates;</li>
<li>’K’ (Kelvin), for temperature-based coordinates;</li>
<li>’degrees_east’, for longitude; or</li>
<li>’degrees_north’, for latitude.</li>
</ul>
</div></blockquote>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="dynamics">
<h2>Dynamics<a class="headerlink" href="#dynamics" title="Permalink to this headline">¶</a></h2>
<div class="section" id="diagnostics">
<h3>Diagnostics<a class="headerlink" href="#diagnostics" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="dynamical-cores">
<h3>Dynamical cores<a class="headerlink" href="#dynamical-cores" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="dycore.dycore.DynamicalCore">
<em class="property">class </em><code class="descclassname">dycore.dycore.</code><code class="descname">DynamicalCore</code><span class="sig-paren">(</span><em>grid</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.dycore.DynamicalCore" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract base class whose derived classes implement different dynamical cores.
The class inherits <code class="xref py py-class docutils literal"><span class="pre">sympl.Prognostic</span></code>.</p>
<dl class="method">
<dt id="dycore.dycore.DynamicalCore.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>dt</em>, <em>state</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.dycore.DynamicalCore.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call operator advancing the input state one step forward.
As this method is marked as abstract, its implementation is delegated to the derived classes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> object representing the time step.</li>
<li><strong>state</strong> (<em>obj</em>) – The current state, as an instance of <a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> or one of its derived classes.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The state at the next time level. This is of the same class of <code class="xref py py-data docutils literal"><span class="pre">state</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.dycore.DynamicalCore.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.dycore.DynamicalCore.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.xyz_grid.XYZGrid" title="grids.xyz_grid.XYZGrid"><code class="xref py py-class docutils literal"><span class="pre">XYZGrid</span></code></a> or one of its derived classes.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.dycore.DynamicalCore.get_initial_state">
<code class="descname">get_initial_state</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.dycore.DynamicalCore.get_initial_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the initial state.
As this method is marked as abstract, its implementation is delegated to the derived classes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>*args</strong> – The arguments depend on the specific dynamical core which the derived class implements.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The initial state, as an instance of <a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> or one of its derived classes.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">obj</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.dycore.DynamicalCore.update_topography">
<code class="descname">update_topography</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.dycore.DynamicalCore.update_topography" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the underlying (time-dependent) topography.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the elapsed simulation time.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="lateral-boundary-conditions">
<h3>Lateral boundary conditions<a class="headerlink" href="#lateral-boundary-conditions" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="dycore.horizontal_boundary.HorizontalBoundary">
<em class="property">class </em><code class="descclassname">dycore.horizontal_boundary.</code><code class="descname">HorizontalBoundary</code><span class="sig-paren">(</span><em>grid</em>, <em>nb</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.HorizontalBoundary" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract base class whose derived classes implement different types of horizontal boundary conditions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><strong>nb</strong> (<em>int</em>) – Number of boundary layers.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="dycore.horizontal_boundary.HorizontalBoundary.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em>, <em>nb</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.HorizontalBoundary.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.xyz_grid.XYZGrid" title="grids.xyz_grid.XYZGrid"><code class="xref py py-class docutils literal"><span class="pre">XYZGrid</span></code></a> or one of its derived classes.</li>
<li><strong>nb</strong> (<em>int</em>) – Number of boundary layers.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.HorizontalBoundary.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>phi_new</em>, <em>phi_now</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.HorizontalBoundary.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the boundary conditions on the field <code class="xref py py-attr docutils literal"><span class="pre">phi_new</span></code>, possibly relying upon the solution
<code class="xref py py-attr docutils literal"><span class="pre">phi_now</span></code> at the current time.
As this method is marked as abstract, its implementation is delegated to the derived classes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>phi_new</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field on which applying the boundary conditions.</li>
<li><strong>phi_now</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field at the current time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="dycore.horizontal_boundary.HorizontalBoundary.factory">
<em class="property">static </em><code class="descname">factory</code><span class="sig-paren">(</span><em>horizontal_boundary_type</em>, <em>grid</em>, <em>nb</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.HorizontalBoundary.factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Static method which returns an instance of the derived class which implements the boundary
conditions specified by <code class="xref py py-data docutils literal"><span class="pre">horizontal_boundary_type</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>horizontal_boundary_type</strong> (<em>str</em>) – <dl class="docutils">
<dt>String specifying the type of boundary conditions to apply. Either:</dt>
<dd><ul class="first last">
<li>’periodic’, for periodic boundary conditions;</li>
<li>’relaxed’, for relaxed boundary conditions;</li>
<li>’relaxed-symmetric-xz’, for relaxed boundary conditions for a <span class="math">\(xz\)</span>-symmetric field.</li>
<li>’relaxed-symmetric-yz’, for relaxed boundary conditions for a <span class="math">\(yz\)</span>-symmetric field.</li>
</ul>
</dd>
</dl>
</li>
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.xyz_grid.XYZGrid" title="grids.xyz_grid.XYZGrid"><code class="xref py py-class docutils literal"><span class="pre">XYZGrid</span></code></a> or one of its derived classes.</li>
<li><strong>nb</strong> (<em>int</em>) – Number of boundary layers.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>An instance of the derived class implementing the boundary conditions specified by</dt>
<dd><p class="first last"><code class="xref py py-data docutils literal"><span class="pre">horizontal_boundary_type</span></code>.</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.HorizontalBoundary.from_computational_to_physical_domain">
<code class="descname">from_computational_to_physical_domain</code><span class="sig-paren">(</span><em>phi_</em>, <em>out_dims</em>, <em>change_sign</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.HorizontalBoundary.from_computational_to_physical_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the computational domain of a stencil, return the
associated physicalm field which may (or may not) satisfy the horizontal boundary conditions.
As this method is marked as abstract, its implementation is delegated to the derived classes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>phi</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the computational domain of a stencil.</li>
<li><strong>out_dims</strong> (<em>tuple</em>) – Tuple of the output array dimensions.</li>
<li><strong>change_sign</strong> (<em>bool</em>) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if the field should change sign through the symmetry plane (if any), <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field defined over the physical domain.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array_like</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.HorizontalBoundary.from_physical_to_computational_domain">
<code class="descname">from_physical_to_computational_domain</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.HorizontalBoundary.from_physical_to_computational_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing a physical field, return the associated stencils’ computational
domain, i.e., the <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> (accomodating the boundary conditions) which will be input
to the stencils. If the physical and computational fields coincide, a deep copy of the physical
domain is returned.
As this method is marked as abstract, its implementation is delegated to the derived classes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the physical field.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The implementation should be designed to work with both staggered and unstaggared fields.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.HorizontalBoundary.set_outermost_layers_x">
<code class="descname">set_outermost_layers_x</code><span class="sig-paren">(</span><em>phi_new</em>, <em>phi_now</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.HorizontalBoundary.set_outermost_layers_x" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the outermost layers of <code class="xref py py-obj docutils literal"><span class="pre">phi_new</span></code> in the <span class="math">\(x\)</span>- (i.e., <code class="xref py py-obj docutils literal"><span class="pre">i</span></code>-) direction so to satisfy
the lateral boundary conditions. For this, possibly rely upon the field <code class="xref py py-obj docutils literal"><span class="pre">phi_now</span></code> at the current time.
As this method is marked as abstract, its implementation is delegated to the derived classes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>phi_new</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field on which applying the boundary conditions.</li>
<li><strong>phi_now</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field at the current time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.HorizontalBoundary.set_outermost_layers_y">
<code class="descname">set_outermost_layers_y</code><span class="sig-paren">(</span><em>phi_new</em>, <em>phi_now</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.HorizontalBoundary.set_outermost_layers_y" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the outermost layers of <code class="xref py py-obj docutils literal"><span class="pre">phi_new</span></code> in the <span class="math">\(y\)</span>- (i.e., <code class="xref py py-obj docutils literal"><span class="pre">j</span></code>-) direction so to satisfy
the lateral boundary conditions. For this, possibly rely upon the field <code class="xref py py-obj docutils literal"><span class="pre">phi_now</span></code> at the current time.
As this method is marked as abstract, its implementation is delegated to the derived classes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>phi_new</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field on which applying the boundary conditions.</li>
<li><strong>phi_now</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field at the current time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="dycore.horizontal_boundary.Periodic">
<em class="property">class </em><code class="descclassname">dycore.horizontal_boundary.</code><code class="descname">Periodic</code><span class="sig-paren">(</span><em>grid</em>, <em>nb</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Periodic" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#dycore.horizontal_boundary.HorizontalBoundary" title="dycore.horizontal_boundary.HorizontalBoundary"><code class="xref py py-class docutils literal"><span class="pre">HorizontalBoundary</span></code></a> to implement horizontally periodic boundary conditions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><strong>nb</strong> (<em>int</em>) – Number of boundary layers.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="dycore.horizontal_boundary.Periodic.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em>, <em>nb</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Periodic.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.xyz_grid.XYZGrid" title="grids.xyz_grid.XYZGrid"><code class="xref py py-class docutils literal"><span class="pre">XYZGrid</span></code></a> or one of its derived classes.</li>
<li><strong>nb</strong> (<em>int</em>) – Number of boundary layers.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.Periodic.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>phi_new</em>, <em>phi_now=None</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Periodic.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply horizontally periodic boundary conditions on <code class="xref py py-attr docutils literal"><span class="pre">phi_new</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>phi_new</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field on which applying the boundary conditions.</li>
<li><strong>phi_now</strong> (<cite>array_like</cite>, optional) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field at the current time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The argument <code class="xref py py-data docutils literal"><span class="pre">phi_now</span></code> is not required by the implementation, yet it is retained as optional
argument for compliancy with the class hierarchy interface.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.Periodic.from_computational_to_physical_domain">
<code class="descname">from_computational_to_physical_domain</code><span class="sig-paren">(</span><em>phi_</em>, <em>out_dims=None</em>, <em>change_sign=True</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Periodic.from_computational_to_physical_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Shrink the field <code class="xref py py-obj docutils literal"><span class="pre">phi_</span></code> by removing the <code class="xref py py-attr docutils literal"><span class="pre">nb</span></code> outermost layers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>phi</strong> (<em>array_like</em>) – The <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> to shrink.</li>
<li><strong>out_dims</strong> (<em>tuple</em>) – Tuple of the output array dimensions.</li>
<li><strong>change_sign</strong> (<em>bool</em>) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if the field should change sign through the symmetry plane (if any), <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The shrunk <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array_like</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The arguments <code class="xref py py-data docutils literal"><span class="pre">out_dims</span></code> and <code class="xref py py-data docutils literal"><span class="pre">change_sign</span></code> are not required by the implementation,
yet they are retained as optional arguments for compliancy with the class hierarchy interface.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.Periodic.from_physical_to_computational_domain">
<code class="descname">from_physical_to_computational_domain</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Periodic.from_physical_to_computational_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Periodically extend the field <code class="xref py py-obj docutils literal"><span class="pre">phi</span></code> with <code class="xref py py-attr docutils literal"><span class="pre">nb</span></code> extra layers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>array_like</em>) – The <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> to extend.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The extended <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.Periodic.set_outermost_layers_x">
<code class="descname">set_outermost_layers_x</code><span class="sig-paren">(</span><em>phi_new</em>, <em>phi_now=None</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Periodic.set_outermost_layers_x" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the outermost layers of <code class="xref py py-obj docutils literal"><span class="pre">phi_new</span></code> in the <code class="xref py py-obj docutils literal"><span class="pre">x</span></code>-direction so to satisfy the periodic
boundary conditions. For this, the field <code class="xref py py-obj docutils literal"><span class="pre">phi_now</span></code> at the current time is not required. Yet,
it appears as (default) argument for compliancy with the general API.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>phi_new</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field on which applying the boundary conditions.</li>
<li><strong>phi_now</strong> (<cite>array_like</cite>, optional) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field at the current time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The argument <code class="xref py py-data docutils literal"><span class="pre">phi_now</span></code> is not required by the implementation, yet it is retained as optional
argument for compliancy with the class hierarchy interface.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.Periodic.set_outermost_layers_y">
<code class="descname">set_outermost_layers_y</code><span class="sig-paren">(</span><em>phi_new</em>, <em>phi_now=None</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Periodic.set_outermost_layers_y" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the outermost layers of <code class="xref py py-obj docutils literal"><span class="pre">phi_new</span></code> in the <code class="xref py py-obj docutils literal"><span class="pre">y</span></code>-direction so to satisfy the periodic
boundary conditions. For this, the field <code class="xref py py-obj docutils literal"><span class="pre">phi_now</span></code> at the current time is not required. Yet,
it appears as (default) argument for compliancy with the general API.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>phi_new</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field on which applying the boundary conditions.</li>
<li><strong>phi_now</strong> (<cite>array_like</cite>, optional) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field at the current time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The argument <code class="xref py py-data docutils literal"><span class="pre">phi_now</span></code> is not required by the implementation, yet it is retained as optional
argument for compliancy with the class hierarchy interface.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="dycore.horizontal_boundary.Relaxed">
<em class="property">class </em><code class="descclassname">dycore.horizontal_boundary.</code><code class="descname">Relaxed</code><span class="sig-paren">(</span><em>grid</em>, <em>nb</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Relaxed" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#dycore.horizontal_boundary.HorizontalBoundary" title="dycore.horizontal_boundary.HorizontalBoundary"><code class="xref py py-class docutils literal"><span class="pre">HorizontalBoundary</span></code></a> to implement horizontally relaxed boundary conditions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>nb</strong> (<em>int</em>) – Number of boundary layers.</li>
<li><strong>nr</strong> (<em>int</em>) – Number of layers which will be affected by relaxation.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="dycore.horizontal_boundary.Relaxed.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em>, <em>nb</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Relaxed.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.xyz_grid.XYZGrid" title="grids.xyz_grid.XYZGrid"><code class="xref py py-class docutils literal"><span class="pre">XYZGrid</span></code></a> or one of its derived classes.</li>
<li><strong>nb</strong> (<em>int</em>) – Number of boundary layers.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.Relaxed.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>phi_new</em>, <em>phi_now</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Relaxed.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply relaxed lateral boundary conditions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>phi_new</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field on which applying the boundary conditions.</li>
<li><strong>phi_now</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field at the current time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Dirichlet conditions at the boundaries are assumed to be time-independent, so that they
can be inferred from the solution at current time.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.Relaxed.from_computational_to_physical_domain">
<code class="descname">from_computational_to_physical_domain</code><span class="sig-paren">(</span><em>phi_</em>, <em>out_dims=None</em>, <em>change_sign=True</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Relaxed.from_computational_to_physical_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>As no extension is required to apply relaxed boundary conditions, return a deep copy of the
input field <code class="xref py py-obj docutils literal"><span class="pre">phi_</span></code>.</p>
<p>Parameters
———9</p>
<blockquote>
<div><dl class="docutils">
<dt><a href="#id20"><span class="problematic" id="id21">phi_</span></a> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>A <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a>.</dd>
<dt>out_dims <span class="classifier-delimiter">:</span> <span class="classifier"><cite>tuple</cite>, optional</span></dt>
<dd>Tuple of the output array dimensions.</dd>
<dt>change_sign <span class="classifier-delimiter">:</span> <span class="classifier"><cite>bool</cite>, optional</span></dt>
<dd><code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if the field should change sign through the symmetry plane, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</dd>
</dl>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A deep copy of <code class="xref py py-obj docutils literal"><span class="pre">phi_</span></code>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The arguments <code class="xref py py-data docutils literal"><span class="pre">out_dims</span></code> and <code class="xref py py-data docutils literal"><span class="pre">change_sign</span></code> are not required by the implementation,
yet they are retained as optional arguments for compliancy with the class hierarchy interface.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.Relaxed.from_physical_to_computational_domain">
<code class="descname">from_physical_to_computational_domain</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Relaxed.from_physical_to_computational_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>As no extension is required to apply relaxed boundary conditions, return a deep copy of the
input field <code class="xref py py-obj docutils literal"><span class="pre">phi</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>array_like</em>) – A <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A deep copy of <code class="xref py py-obj docutils literal"><span class="pre">phi</span></code>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.Relaxed.set_outermost_layers_x">
<code class="descname">set_outermost_layers_x</code><span class="sig-paren">(</span><em>phi_new</em>, <em>phi_now</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Relaxed.set_outermost_layers_x" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the outermost layers of <code class="xref py py-obj docutils literal"><span class="pre">phi_new</span></code> in the <code class="xref py py-obj docutils literal"><span class="pre">x</span></code>-direction equal to the corresponding
layers of <code class="xref py py-obj docutils literal"><span class="pre">phi_now</span></code>. In other words, apply Dirichlet conditions in <code class="xref py py-obj docutils literal"><span class="pre">x</span></code>-direction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>phi_new</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field on which applying the boundary conditions.</li>
<li><strong>phi_now</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field at the current time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Dirichlet conditions at the boundaries are assumed to be time-independent, so that they
can be inferred from the solution at current time.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.Relaxed.set_outermost_layers_y">
<code class="descname">set_outermost_layers_y</code><span class="sig-paren">(</span><em>phi_new</em>, <em>phi_now</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Relaxed.set_outermost_layers_y" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the outermost layers of <code class="xref py py-obj docutils literal"><span class="pre">phi_new</span></code> in the <code class="xref py py-obj docutils literal"><span class="pre">y</span></code>-direction equal to the corresponding
layers of <code class="xref py py-obj docutils literal"><span class="pre">phi_now</span></code>. In other words, apply Dirichelt conditions in <code class="xref py py-obj docutils literal"><span class="pre">y</span></code>-direction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>phi_new</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field on which applying the boundary conditions.</li>
<li><strong>phi_now</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field at the current time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Dirichlet conditions at the boundaries are assumed to be time-independent, so that they
can be inferred from the solution at current time.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="dycore.horizontal_boundary.RelaxedSymmetricXZ">
<em class="property">class </em><code class="descclassname">dycore.horizontal_boundary.</code><code class="descname">RelaxedSymmetricXZ</code><span class="sig-paren">(</span><em>grid</em>, <em>nb</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.RelaxedSymmetricXZ" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#dycore.horizontal_boundary.Relaxed" title="dycore.horizontal_boundary.Relaxed"><code class="xref py py-class docutils literal"><span class="pre">Relaxed</span></code></a> to implement horizontally relaxed boundary conditions
for fields symmetric with respect to the <span class="math">\(xz\)</span>-plane <span class="math">\(y = y_c = 0.5 (a_y + b_y)\)</span>,
where <span class="math">\(a_y\)</span> and <span class="math">\(b_y\)</span> denote the extremes of the domain in the <span class="math">\(y\)</span>-direction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>nb</strong> (<em>int</em>) – Number of boundary layers.</li>
<li><strong>nr</strong> (<em>int</em>) – Number of layers which will be affected by relaxation.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="dycore.horizontal_boundary.RelaxedSymmetricXZ.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em>, <em>nb</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.RelaxedSymmetricXZ.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.xyz_grid.XYZGrid" title="grids.xyz_grid.XYZGrid"><code class="xref py py-class docutils literal"><span class="pre">XYZGrid</span></code></a> or one of its derived classes.</li>
<li><strong>nb</strong> (<em>int</em>) – Number of boundary layers.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.RelaxedSymmetricXZ.from_computational_to_physical_domain">
<code class="descname">from_computational_to_physical_domain</code><span class="sig-paren">(</span><em>phi_</em>, <em>out_dims</em>, <em>change_sign=False</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.RelaxedSymmetricXZ.from_computational_to_physical_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Mirror the computational domain with respect to the <span class="math">\(xz\)</span>-plane <span class="math">\(y = y_c\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>phi</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the computational domain of a stencil.</li>
<li><strong>out_dims</strong> (<em>tuple</em>) – Tuple of the output array dimensions.</li>
<li><strong>change_sign</strong> (<cite>bool</cite>, optional) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if the field should change sign through the symmetry plane, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.
Default is false.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field defined over the physical domain.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array_like</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.RelaxedSymmetricXZ.from_physical_to_computational_domain">
<code class="descname">from_physical_to_computational_domain</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.RelaxedSymmetricXZ.from_physical_to_computational_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <span class="math">\(y\)</span>-lowermost half of the domain. To accomodate symmetric conditions,
we retain (at least) <code class="xref py py-attr docutils literal"><span class="pre">nb</span></code> additional layers in the positive direction of the <span class="math">\(y\)</span>-axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the physical field.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="dycore.horizontal_boundary.RelaxedSymmetricYZ">
<em class="property">class </em><code class="descclassname">dycore.horizontal_boundary.</code><code class="descname">RelaxedSymmetricYZ</code><span class="sig-paren">(</span><em>grid</em>, <em>nb</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.RelaxedSymmetricYZ" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#dycore.horizontal_boundary.Relaxed" title="dycore.horizontal_boundary.Relaxed"><code class="xref py py-class docutils literal"><span class="pre">Relaxed</span></code></a> to implement horizontally relaxed boundary conditions
for fields symmetric with respect to the <span class="math">\(yz\)</span>-plane <span class="math">\(x = x_c = 0.5 (a_x + b_x)\)</span>,
where <span class="math">\(a_x\)</span> and <span class="math">\(b_x\)</span> denote the extremes of the domain in the <span class="math">\(x\)</span>-direction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>nb</strong> (<em>int</em>) – Number of boundary layers.</li>
<li><strong>nr</strong> (<em>int</em>) – Number of layers which will be affected by relaxation.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="dycore.horizontal_boundary.RelaxedSymmetricYZ.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em>, <em>nb</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.RelaxedSymmetricYZ.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.xyz_grid.XYZGrid" title="grids.xyz_grid.XYZGrid"><code class="xref py py-class docutils literal"><span class="pre">XYZGrid</span></code></a> or one of its derived classes.</li>
<li><strong>nb</strong> (<em>int</em>) – Number of boundary layers.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.RelaxedSymmetricYZ.from_computational_to_physical_domain">
<code class="descname">from_computational_to_physical_domain</code><span class="sig-paren">(</span><em>phi_</em>, <em>out_dims</em>, <em>change_sign=False</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.RelaxedSymmetricYZ.from_computational_to_physical_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Mirror the computational domain with respect to the <span class="math">\(yz\)</span>-axis <span class="math">\(x = x_c\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>phi</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the computational domain of a stencil.</li>
<li><strong>out_dims</strong> (<em>tuple</em>) – Tuple of the output array dimensions.</li>
<li><strong>change_sign</strong> (<cite>bool</cite>, optional) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if the field should change sign through the symmetry plane, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.
Default is false.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field defined over the physical domain.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array_like</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.RelaxedSymmetricYZ.from_physical_to_computational_domain">
<code class="descname">from_physical_to_computational_domain</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.RelaxedSymmetricYZ.from_physical_to_computational_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <span class="math">\(x\)</span>-lowermost half of the domain. To accomodate symmetric conditions,
we retain (at least) <code class="xref py py-attr docutils literal"><span class="pre">nb</span></code> additional layers in the positive direction of the <span class="math">\(x\)</span>-axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the physical field.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="numerical-diffusion">
<h3>Numerical diffusion<a class="headerlink" href="#numerical-diffusion" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="dycore.diffusion.Diffusion">
<em class="property">class </em><code class="descclassname">dycore.diffusion.</code><code class="descname">Diffusion</code><span class="sig-paren">(</span><em>grid</em>, <em>idamp=True</em>, <em>damp_depth=10</em>, <em>diff_coeff=0.03</em>, <em>diff_max=0.24</em>, <em>backend=&lt;Mode.NUMPY: 4&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diffusion.Diffusion" title="Permalink to this definition">¶</a></dt>
<dd><p>Class applying horizontal numerical diffusion to a generic (prognostic) variable by means of a GT4Py’s stencil.</p>
<dl class="method">
<dt id="dycore.diffusion.Diffusion.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em>, <em>idamp=True</em>, <em>damp_depth=10</em>, <em>diff_coeff=0.03</em>, <em>diff_max=0.24</em>, <em>backend=&lt;Mode.NUMPY: 4&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diffusion.Diffusion.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.xyz_grid.XYZGrid" title="grids.xyz_grid.XYZGrid"><code class="xref py py-class docutils literal"><span class="pre">XYZGrid</span></code></a> or one of its derived classes.</li>
<li><strong>idamp</strong> (<cite>bool</cite>, optional) – <code class="xref py py-data docutils literal"><span class="pre">True</span></code> if vertical damping is enabled, <code class="xref py py-data docutils literal"><span class="pre">False</span></code> otherwise.
In the former case, the diffusion coefficient is monotonically increased towards the
top of the domain, thus to mimic the effect of a wave absorber.</li>
<li><strong>damp_depth</strong> (<cite>int</cite>, optional) – Depth of the damping region, i.e., number of vertical layers in the damping region. Default is 10.</li>
<li><strong>diff_coeff</strong> (<cite>float</cite>, optional) – Value for the diffusion coefficient far from the top boundary. Default is 0.03.</li>
<li><strong>diff_max</strong> (<cite>float</cite>, optional) – Maximum value for the diffusion coefficient. For the sake of numerical stability, it should not
exceed 0.25. Default is 0.24.</li>
<li><strong>backend</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode</span></code> specifying the backend for the GT4Py’s stencil implementing numerical
diffusion. Default is <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode.NUMPY</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.diffusion.Diffusion.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diffusion.Diffusion.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply horizontal diffusion to a prognostic field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field to diffuse.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the diffused field.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="numerical-fluxes">
<h3>Numerical fluxes<a class="headerlink" href="#numerical-fluxes" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="prognostics">
<h3>Prognostics<a class="headerlink" href="#prognostics" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="wave-absorber">
<h3>Wave absorber<a class="headerlink" href="#wave-absorber" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="dycore.vertical_damping.VerticalDamping">
<em class="property">class </em><code class="descclassname">dycore.vertical_damping.</code><code class="descname">VerticalDamping</code><span class="sig-paren">(</span><em>grid</em>, <em>damp_depth</em>, <em>damp_max</em>, <em>backend</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.vertical_damping.VerticalDamping" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract base class whose derived classes implement different vertical damping, i.e., wave absorbing, techniques.</p>
<dl class="method">
<dt id="dycore.vertical_damping.VerticalDamping.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em>, <em>damp_depth</em>, <em>damp_max</em>, <em>backend</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.vertical_damping.VerticalDamping.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code> or one of its derived classes.</li>
<li><strong>damp_depth</strong> (<em>int</em>) – Number of vertical layers in the damping region.</li>
<li><strong>damp_max</strong> (<em>float</em>) – Maximum value for the damping coefficient.</li>
<li><strong>backend</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode</span></code> specifying the backend for the GT4Py’s stencils implementing the dynamical core.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.vertical_damping.VerticalDamping.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>dt</em>, <em>phi_now</em>, <em>phi_new</em>, <em>phi_ref</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.vertical_damping.VerticalDamping.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply vertical damping to a generic field <span class="math">\(\phi\)</span>.
As this method is marked as abstract, its implementation is delegated to the derived classes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the time step.</li>
<li><strong>phi_now</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field <span class="math">\(\phi\)</span> at the current time level.</li>
<li><strong>phi_new</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field <span class="math">\(\phi\)</span> at the next time level, on
which the absorber will be applied.</li>
<li><strong>phi_ref</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing a reference value for <span class="math">\(\phi\)</span>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the damped field <span class="math">\(\phi\)</span>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array_like</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="dycore.vertical_damping.VerticalDamping.factory">
<em class="property">static </em><code class="descname">factory</code><span class="sig-paren">(</span><em>damp_type</em>, <em>grid</em>, <em>damp_depth</em>, <em>damp_max</em>, <em>backend</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.vertical_damping.VerticalDamping.factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Static method which returns an instance of the derived class implementing the damping method
specified by <code class="xref py py-data docutils literal"><span class="pre">damp_type</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>damp_type</strong> (<em>str</em>) – <dl class="docutils">
<dt>String specifying the damper to implement. Either:</dt>
<dd><ul class="first last">
<li>’rayleigh’, for a Rayleigh damper.</li>
</ul>
</dd>
</dl>
</li>
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code> or one of its derived classes.</li>
<li><strong>damp_depth</strong> (<em>int</em>) – Number of vertical layers in the damping region. Default is 15.</li>
<li><strong>damp_max</strong> (<em>float</em>) – Maximum value for the damping coefficient. Default is 0.0002.</li>
<li><strong>backend</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode</span></code> specifying the backend for the GT4Py’s stencils implementing the dynamical core.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An instance of the derived class implementing the damping method specified by <code class="xref py py-data docutils literal"><span class="pre">damp_type</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="dycore.vertical_damping.Rayleigh">
<em class="property">class </em><code class="descclassname">dycore.vertical_damping.</code><code class="descname">Rayleigh</code><span class="sig-paren">(</span><em>grid</em>, <em>damp_depth</em>, <em>damp_max</em>, <em>backend</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.vertical_damping.Rayleigh" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#dycore.vertical_damping.VerticalDamping" title="dycore.vertical_damping.VerticalDamping"><code class="xref py py-class docutils literal"><span class="pre">VerticalDamping</span></code></a> to implement a Rayleigh absorber.</p>
<dl class="method">
<dt id="dycore.vertical_damping.Rayleigh.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em>, <em>damp_depth</em>, <em>damp_max</em>, <em>backend</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.vertical_damping.Rayleigh.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code> or one of its derived classes.</li>
<li><strong>damp_depth</strong> (<em>int</em>) – Number of vertical layers in the damping region.</li>
<li><strong>damp_max</strong> (<em>float</em>) – Maximum value for the damping coefficient.</li>
<li><strong>backend</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode</span></code> specifying the backend for the GT4Py’s stencils implementing the dynamical core.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.vertical_damping.Rayleigh.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>dt</em>, <em>phi_now</em>, <em>phi_new</em>, <em>phi_ref</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.vertical_damping.Rayleigh.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply vertical damping to a generic field <span class="math">\(\phi\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the time step.</li>
<li><strong>phi_now</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field <span class="math">\(\phi\)</span> at the current time level.</li>
<li><strong>phi_new</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field <span class="math">\(\phi\)</span> at the next time level, on
which the absorber will be applied.</li>
<li><strong>phi_ref</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing a reference value for <span class="math">\(\phi\)</span>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the damped field <span class="math">\(\phi\)</span>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array_like</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="grids">
<h2>Grids<a class="headerlink" href="#grids" title="Permalink to this headline">¶</a></h2>
<div class="section" id="two-dimensional-grids">
<h3>Two-dimensional grids<a class="headerlink" href="#two-dimensional-grids" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="grids.xy_grid.XYGrid">
<em class="property">class </em><code class="descclassname">grids.xy_grid.</code><code class="descname">XYGrid</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_y</em>, <em>ny</em>, <em>units_x='degrees_east'</em>, <em>dims_x='longitude'</em>, <em>units_y='degrees_north'</em>, <em>dims_y='latitude'</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.xy_grid.XYGrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Rectangular and regular two-dimensional grid embedded in a reference system whose
coordinates are, in the order, <span class="math">\(x\)</span> and <span class="math">\(y\)</span>. No assumption is made on
the nature of the coordinates. For instance, <span class="math">\(x\)</span> may be the longitude, in
which case <span class="math">\(x \equiv \lambda\)</span>, and <span class="math">\(y\)</span> may be the latitude, in which
case <span class="math">\(y \equiv \phi\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.x" title="grids.xyz_grid.XYZGrid.x"><strong>x</strong></a> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object storing the <span class="math">\(x\)</span> main levels.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.x_half_levels" title="grids.xyz_grid.XYZGrid.x_half_levels"><strong>x_half_levels</strong></a> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object storing the <span class="math">\(x\)</span> half levels.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.nx" title="grids.xyz_grid.XYZGrid.nx"><strong>nx</strong></a> (<em>int</em>) – Number of grid points along <span class="math">\(x\)</span>.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.dx" title="grids.xyz_grid.XYZGrid.dx"><strong>dx</strong></a> (<em>float</em>) – The <span class="math">\(x\)</span>-spacing.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.y" title="grids.xyz_grid.XYZGrid.y"><strong>y</strong></a> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object storing the <span class="math">\(y\)</span> main levels.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.y_half_levels" title="grids.xyz_grid.XYZGrid.y_half_levels"><strong>y_half_levels</strong></a> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object storing the <span class="math">\(y\)</span> half levels.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.ny" title="grids.xyz_grid.XYZGrid.ny"><strong>ny</strong></a> (<em>int</em>) – Number of grid points along <span class="math">\(y\)</span>.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.dy" title="grids.xyz_grid.XYZGrid.dy"><strong>dy</strong></a> (<em>float</em>) – The <span class="math">\(y\)</span>-spacing.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="grids.xy_grid.XYGrid.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_y</em>, <em>ny</em>, <em>units_x='degrees_east'</em>, <em>dims_x='longitude'</em>, <em>units_y='degrees_north'</em>, <em>dims_y='latitude'</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.xy_grid.XYGrid.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>domain_x</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((x_{start}, ~ x_{stop})\)</span>.</li>
<li><strong>nx</strong> (<em>int</em>) – Number of grid points along <span class="math">\(x\)</span>.</li>
<li><strong>domain_y</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((y_{start}, ~ y_{stop})\)</span>.</li>
<li><strong>ny</strong> (<em>int</em>) – Number of grid points along <span class="math">\(y\)</span>.</li>
<li><strong>units_x</strong> (<cite>str</cite>, optional) – Units for the <span class="math">\(x\)</span>-coordinate.</li>
<li><strong>dims_x</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(x\)</span>-coordinate.</li>
<li><strong>units_y</strong> (<cite>str</cite>, optional) – Units for the <span class="math">\(y\)</span>-coordinate.</li>
<li><strong>dims_y</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(y\)</span>-coordinate.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Axes labels should use the <a class="reference external" href="http://cfconventions.org">CF Conventions</a>.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="grids.xz_grid.XZGrid">
<em class="property">class </em><code class="descclassname">grids.xz_grid.</code><code class="descname">XZGrid</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='m'</em>, <em>dims_x='x'</em>, <em>units_z='m'</em>, <em>dims_z='z'</em>, <em>z_interface=None</em>, <em>topo_type='terrain_flat'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.xz_grid.XZGrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Rectangular and regular two-dimensional grid embedded in a reference system whose
coordinates are</p>
<blockquote>
<div><ul class="simple">
<li>the horizontal coordinate <span class="math">\(x\)</span>, and</li>
<li>the vertical (terrain-following) coordinate <span class="math">\(z\)</span>.</li>
</ul>
</div></blockquote>
<p>The vertical coordinate <span class="math">\(z\)</span> may be formulated to define a hybrid terrain-
following coordinate system with terrain-following coordinate lines between the
surface terrain-height and <span class="math">\(z = z_F\)</span>, where <span class="math">\(z\)</span>-coordinate lines change
back to flat horizontal lines. However, no assumption is made on the actual nature
of <span class="math">\(z\)</span> which may be either pressure-based or height-based.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.x" title="grids.xyz_grid.XYZGrid.x"><strong>x</strong></a> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object representing the <span class="math">\(x\)</span>-axis.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.nx" title="grids.xyz_grid.XYZGrid.nx"><strong>nx</strong></a> (<em>int</em>) – Number of grid points along <span class="math">\(x\)</span>.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.dx" title="grids.xyz_grid.XYZGrid.dx"><strong>dx</strong></a> (<em>float</em>) – The <span class="math">\(x\)</span>-spacing.</li>
<li><strong>z</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object storing the <span class="math">\(z\)</span>-main levels.</li>
<li><strong>z_half_levels</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object storing the <span class="math">\(z\)</span>-half levels.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>dz</strong> (<em>float</em>) – The <span class="math">\(z\)</span>-spacing.</li>
<li><strong>z_interface</strong> (<em>float</em>) – The interface coordinate <span class="math">\(z_F\)</span>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For the sake of compliancy with the <a class="reference external" href="http://www.cosmo-model.org">COSMO model</a>,
the vertical grid points are ordered from the top of the domain to the surface.</p>
</div>
<dl class="method">
<dt id="grids.xz_grid.XZGrid.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='m'</em>, <em>dims_x='x'</em>, <em>units_z='m'</em>, <em>dims_z='z'</em>, <em>z_interface=None</em>, <em>topo_type='terrain_flat'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.xz_grid.XZGrid.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>domain_x</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((x_{left}, ~ x_{right})\)</span>.</li>
<li><strong>nx</strong> (<em>int</em>) – Number of grid points in the <span class="math">\(x\)</span>-direction.</li>
<li><strong>domain_z</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((z_{top}, ~ z_{surface})\)</span>.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>units_x</strong> (<cite>str</cite>, optional) – <p>Units for the <span class="math">\(x\)</span>-coordinate. Must be compliant
with the <a class="reference external" href="http://cfconventions.org">CF Conventions</a> (see also
<a class="reference internal" href="#grids.axis.Axis.__init__" title="grids.axis.Axis.__init__"><code class="xref py py-meth docutils literal"><span class="pre">grids.axis.Axis.__init__()</span></code></a>).</p>
</li>
<li><strong>dims_x</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(x\)</span>-coordinate.</li>
<li><strong>units_z</strong> (<cite>str</cite>, optional) – <p>Units for the <span class="math">\(z\)</span>-coordinate. Must be compliant
with the <a class="reference external" href="http://cfconventions.org">CF Conventions</a> (see also
<a class="reference internal" href="#grids.axis.Axis.__init__" title="grids.axis.Axis.__init__"><code class="xref py py-meth docutils literal"><span class="pre">grids.axis.Axis.__init__()</span></code></a>).</p>
</li>
<li><strong>dims_z</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(z\)</span>-coordinate.</li>
<li><strong>z_interface</strong> (<cite>float</cite>, optional) – Interface value <span class="math">\(z_F\)</span>. If not specified,
it is assumed that <span class="math">\(z_F = z_T\)</span>, with <span class="math">\(z_T\)</span> the value of <span class="math">\(z\)</span>
at the top of the domain. In other words, a fully terrain-following coordinate
system is supposed.</li>
<li><strong>topo_type</strong> (<cite>str</cite>, optional) – Topography type. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a>
for further details.</li>
<li><strong>topo_time</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the simulation time after
which the topography should stop increasing. Default is 0, corresponding to a time-invariant
terrain surface-height. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a> for further details.</li>
<li><strong>**kwargs</strong> – keyword arguments to be forwarded to the constructor of
<a class="reference internal" href="#grids.topography.Topography1d" title="grids.topography.Topography1d"><code class="xref py py-class docutils literal"><span class="pre">Topography1d</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="grids.xz_grid.XZGrid.topography_height">
<code class="descname">topography_height</code><a class="headerlink" href="#grids.xz_grid.XZGrid.topography_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the topography (i.e., terrain-surface) height.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">One-dimensional <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> carrying the topography height.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.xz_grid.XZGrid.update_topography">
<code class="descname">update_topography</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.xz_grid.XZGrid.update_topography" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the (time-dependent) topography.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the elapsed simulation time.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="grids.sigma.Sigma2d">
<em class="property">class </em><code class="descclassname">grids.sigma.</code><code class="descname">Sigma2d</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='m'</em>, <em>dims_x='x'</em>, <em>z_interface=None</em>, <em>topo_type='terrain_flat'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sigma.Sigma2d" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#grids.xz_grid.XZGrid" title="grids.xz_grid.XZGrid"><code class="xref py py-class docutils literal"><span class="pre">XZGrid</span></code></a> to represent a rectangular and regular
two-dimensional grid embedded in a reference system whose coordinates are</p>
<blockquote>
<div><ul class="simple">
<li>the horizontal coordinate <span class="math">\(x\)</span>, and</li>
<li>the pressure-based terrain-following coordinate <span class="math">\(\sigma = p / p_{SL}\)</span>,                  where <span class="math">\(p\)</span> is the pressure and <span class="math">\(p_{SL}\)</span> the pressure at the                  sea level.</li>
</ul>
</div></blockquote>
<p>The vertical coordinate <span class="math">\(\sigma\)</span> may be formulated to define a hybrid terrain-
following coordinate system with terrain-following coordinate lines between the
surface terrain-height and <span class="math">\(\sigma = \sigma_F\)</span>, where <span class="math">\(\sigma\)</span>-coordinate
lines change back to flat horizontal lines.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.x" title="grids.xyz_grid.XYZGrid.x"><strong>x</strong></a> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object representing the <span class="math">\(x\)</span>-axis.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.nx" title="grids.xyz_grid.XYZGrid.nx"><strong>nx</strong></a> (<em>int</em>) – Number of grid points along <span class="math">\(x\)</span>.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.dx" title="grids.xyz_grid.XYZGrid.dx"><strong>dx</strong></a> (<em>float</em>) – The <span class="math">\(x\)</span>-spacing.</li>
<li><strong>z</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object storing the <span class="math">\(\sigma\)</span>-main levels.</li>
<li><strong>z_half_levels</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object storing the <span class="math">\(\sigma\)</span>-half levels.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>dz</strong> (<em>float</em>) – The <span class="math">\(\sigma\)</span>-spacing.</li>
<li><strong>z_interface</strong> (<em>float</em>) – The interface coordinate <span class="math">\(\sigma_F\)</span>.</li>
<li><strong>height</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the geometrical height at
the main levels.</li>
<li><strong>height_half_levels</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the geometrical height at
the half levels.</li>
<li><strong>height_interface</strong> (<em>float</em>) – geometrical height corresponding to <span class="math">\(\sigma = \sigma_F\)</span>.</li>
<li><strong>reference_pressure</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the geometrical height at
the main levels.</li>
<li><strong>reference_pressure_half_levels</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the geometrical
height at the half levels.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="grids.sigma.Sigma2d.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='m'</em>, <em>dims_x='x'</em>, <em>z_interface=None</em>, <em>topo_type='terrain_flat'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sigma.Sigma2d.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>domain_x</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((x_{left}, ~ x_{right})\)</span>.</li>
<li><strong>nx</strong> (<em>int</em>) – Number of grid points in the <span class="math">\(x\)</span>-direction.</li>
<li><strong>domain_z</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((\sigma_{top}, ~ \sigma_{surface})\)</span>.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>units_x</strong> (<cite>str</cite>, optional) – <p>Units for the <span class="math">\(x\)</span>-coordinate. Must be compliant
with the <a class="reference external" href="http://cfconventions.org">CF Conventions</a> (see also
<a class="reference internal" href="#grids.axis.Axis.__init__" title="grids.axis.Axis.__init__"><code class="xref py py-meth docutils literal"><span class="pre">grids.axis.Axis.__init__()</span></code></a>).</p>
</li>
<li><strong>dims_x</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(x\)</span>-coordinate.</li>
<li><strong>z_interface</strong> (<cite>float</cite>, optional) – Interface value <span class="math">\(\sigma_F\)</span>. If not specified,
it is assumed that <span class="math">\(\sigma_F = \sigma_T\)</span>, with <span class="math">\(\sigma_T\)</span> the value
of <span class="math">\(\sigma\)</span> at the top of the domain. In other words, a fully terrain-following
coordinate system is supposed.</li>
<li><strong>topo_type</strong> (<cite>str</cite>, optional) – Topography type. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a>
for further details.</li>
<li><strong>topo_time</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the simulation time after
which the topography should stop increasing. Default is 0, corresponding to a time-invariant
terrain surface-height. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a> for further details.</li>
<li><strong>**kwargs</strong> – keyword arguments to be forwarded to the constructor of
<a class="reference internal" href="#grids.topography.Topography1d" title="grids.topography.Topography1d"><code class="xref py py-class docutils literal"><span class="pre">Topography1d</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.sigma.Sigma2d.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sigma.Sigma2d.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the grid half levels using <a class="reference external" href="https://matplotlib.org/2.1.1/api/_as_gen/matplotlib.pyplot.html#module-matplotlib.pyplot" title="(in Matplotlib v2.1.1)"><code class="xref py py-mod docutils literal"><span class="pre">matplotlib.pyplot</span></code></a>’s utilities.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For the sake of compliancy with the notation employed by <a class="reference external" href="http://www.cosmo-model.org">COSMO</a>,
the vertical geometrical height is denoted by <span class="math">\(z\)</span>.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>**kwargs</strong> – Keyword arguments to be forwarded to <a class="reference external" href="https://matplotlib.org/2.1.1/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="(in Matplotlib v2.1.1)"><code class="xref py py-func docutils literal"><span class="pre">matplotlib.pyplot.subplots()</span></code></a>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.sigma.Sigma2d.update_topography">
<code class="descname">update_topography</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sigma.Sigma2d.update_topography" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the (time-dependent) topography. In turn, the metric terms are re-computed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the elapsed simulation time.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="grids.gal_chen.GalChen2d">
<em class="property">class </em><code class="descclassname">grids.gal_chen.</code><code class="descname">GalChen2d</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='m'</em>, <em>dims_x='x'</em>, <em>z_interface=None</em>, <em>topo_type='terrain_flat'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.gal_chen.GalChen2d" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#grids.xz_grid.XZGrid" title="grids.xz_grid.XZGrid"><code class="xref py py-class docutils literal"><span class="pre">XZGrid</span></code></a> to represent a rectangular and regular
two-dimensional grid embedded in a reference system whose coordinates are</p>
<blockquote>
<div><ul class="simple">
<li>the horizontal coordinate <span class="math">\(x\)</span>, and</li>
<li>the height-based Gal-Chen terrain-following coordinate <span class="math">\(\mu\)</span>.</li>
</ul>
</div></blockquote>
<p>The vertical coordinate <span class="math">\(\mu\)</span> may be formulated to define a hybrid terrain-
following coordinate system with terrain-following coordinate lines between the
surface terrain-height and <span class="math">\(\mu = \mu_F\)</span>, where <span class="math">\(\mu\)</span>-coordinate
lines change back to flat horizontal lines.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.x" title="grids.xyz_grid.XYZGrid.x"><strong>x</strong></a> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object representing the <span class="math">\(x\)</span>-axis.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.nx" title="grids.xyz_grid.XYZGrid.nx"><strong>nx</strong></a> (<em>int</em>) – Number of grid points along <span class="math">\(x\)</span>.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.dx" title="grids.xyz_grid.XYZGrid.dx"><strong>dx</strong></a> (<em>float</em>) – The <span class="math">\(x\)</span>-spacing.</li>
<li><strong>z</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object storing the <span class="math">\(\mu\)</span>-main levels.</li>
<li><strong>z_half_levels</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object storing the <span class="math">\(\mu\)</span>-half levels.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>dz</strong> (<em>float</em>) – The <span class="math">\(\mu\)</span>-spacing.</li>
<li><strong>z_interface</strong> (<em>float</em>) – The interface coordinate <span class="math">\(\mu_F\)</span>.</li>
<li><strong>height</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the geometrical height at
the main levels.</li>
<li><strong>height_half_levels</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the geometrical height at
the half levels.</li>
<li><strong>height_interface</strong> (<em>float</em>) – geometrical height corresponding to <span class="math">\(\mu = \mu_F\)</span>.</li>
<li><strong>reference_pressure</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the geometrical height at
the main levels.</li>
<li><strong>reference_pressure_half_levels</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the geometrical
height at the half levels.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="grids.gal_chen.GalChen2d.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='m'</em>, <em>dims_x='x'</em>, <em>z_interface=None</em>, <em>topo_type='terrain_flat'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.gal_chen.GalChen2d.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>domain_x</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((x_{left}, ~ x_{right})\)</span>.</li>
<li><strong>nx</strong> (<em>int</em>) – Number of grid points in the <span class="math">\(x\)</span>-direction.</li>
<li><strong>domain_z</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((\mu_{top}, ~ \mu_{surface})\)</span>.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>units_x</strong> (<cite>str</cite>, optional) – <p>Units for the <span class="math">\(x\)</span>-coordinate. Must be compliant
with the <a class="reference external" href="http://cfconventions.org">CF Conventions</a> (see also
<a class="reference internal" href="#grids.axis.Axis.__init__" title="grids.axis.Axis.__init__"><code class="xref py py-meth docutils literal"><span class="pre">grids.axis.Axis.__init__()</span></code></a>).</p>
</li>
<li><strong>dims_x</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(x\)</span>-coordinate.</li>
<li><strong>z_interface</strong> (<cite>float</cite>, optional) – Interface value <span class="math">\(\mu_F\)</span>. If not specified,
it is assumed that <span class="math">\(\mu_F = \mu_T\)</span>, with <span class="math">\(\mu_T\)</span> the value of
<span class="math">\(\mu\)</span> at the top of the domain. In other words, a fully terrain-following
coordinate system is supposed.</li>
<li><strong>topo_type</strong> (<cite>str</cite>, optional) – Topography type. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a>
for further dmuils.</li>
<li><strong>topo_time</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the simulation time after
which the topography should stop increasing. Default is 0, corresponding to a time-invariant
terrain surface-height. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a> for further details.</li>
<li><strong>**kwargs</strong> – keyword arguments to be forwarded to the constructor of
<a class="reference internal" href="#grids.topography.Topography1d" title="grids.topography.Topography1d"><code class="xref py py-class docutils literal"><span class="pre">Topography1d</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.gal_chen.GalChen2d.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.gal_chen.GalChen2d.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the grid half levels using <a class="reference external" href="https://matplotlib.org/2.1.1/api/_as_gen/matplotlib.pyplot.html#module-matplotlib.pyplot" title="(in Matplotlib v2.1.1)"><code class="xref py py-mod docutils literal"><span class="pre">matplotlib.pyplot</span></code></a>’s utilities.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For the sake of compliancy with the notation employed by <a class="reference external" href="http://www.cosmo-model.org">COSMO</a>,
the vertical geometrical height is denoted by <span class="math">\(z\)</span>.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>**kwargs</strong> – Keyword arguments to be forwarded to <a class="reference external" href="https://matplotlib.org/2.1.1/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="(in Matplotlib v2.1.1)"><code class="xref py py-func docutils literal"><span class="pre">matplotlib.pyplot.subplots()</span></code></a>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.gal_chen.GalChen2d.update_topography">
<code class="descname">update_topography</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.gal_chen.GalChen2d.update_topography" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the (time-dependent) topography. In turn, the metric terms are re-computed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the elapsed simulation time.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="grids.sleve.SLEVE2d">
<em class="property">class </em><code class="descclassname">grids.sleve.</code><code class="descname">SLEVE2d</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='m'</em>, <em>dims_x='x'</em>, <em>z_interface=None</em>, <em>N=100</em>, <em>s1=8000.0</em>, <em>s2=5000.0</em>, <em>topo_type='terrain_flat'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sleve.SLEVE2d" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#grids.xz_grid.XZGrid" title="grids.xz_grid.XZGrid"><code class="xref py py-class docutils literal"><span class="pre">XZGrid</span></code></a> to represent a rectangular and regular
two-dimensional grid embedded in a reference system whose coordinates are</p>
<blockquote>
<div><ul class="simple">
<li>the horizontal coordinate <span class="math">\(x\)</span>, and</li>
<li>the height-based SLEVE terrain-following coordinate <span class="math">\(\mu\)</span>.</li>
</ul>
</div></blockquote>
<p>The vertical coordinate <span class="math">\(\mu\)</span> may be formulated to define a hybrid terrain-
following coordinate system with terrain-following coordinate lines between the
surface terrain-height and <span class="math">\(\mu = \mu_F\)</span>, where <span class="math">\(\mu\)</span>-coordinate
lines change back to flat horizontal lines.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.x" title="grids.xyz_grid.XYZGrid.x"><strong>x</strong></a> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object representing the <span class="math">\(x\)</span>-axis.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.nx" title="grids.xyz_grid.XYZGrid.nx"><strong>nx</strong></a> (<em>int</em>) – Number of grid points along <span class="math">\(x\)</span>.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.dx" title="grids.xyz_grid.XYZGrid.dx"><strong>dx</strong></a> (<em>float</em>) – The <span class="math">\(x\)</span>-spacing.</li>
<li><strong>z</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object storing the <span class="math">\(\mu\)</span>-main levels.</li>
<li><strong>z_half_levels</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object storing the <span class="math">\(\mu\)</span>-half levels.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>dz</strong> (<em>float</em>) – The <span class="math">\(\mu\)</span>-spacing.</li>
<li><strong>z_interface</strong> (<em>float</em>) – The interface coordinate <span class="math">\(\mu_F\)</span>.</li>
<li><strong>height</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the geometrical height at
the main levels.</li>
<li><strong>height_half_levels</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the geometrical height at
the half levels.</li>
<li><strong>height_interface</strong> (<em>float</em>) – geometrical height corresponding to <span class="math">\(\mu = \mu_F\)</span>.</li>
<li><strong>reference_pressure</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the geometrical height at
the main levels.</li>
<li><strong>reference_pressure_half_levels</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the geometrical
height at the half levels.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="grids.sleve.SLEVE2d.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='m'</em>, <em>dims_x='x'</em>, <em>z_interface=None</em>, <em>N=100</em>, <em>s1=8000.0</em>, <em>s2=5000.0</em>, <em>topo_type='terrain_flat'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sleve.SLEVE2d.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>domain_x</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((x_{left}, ~ x_{right})\)</span>.</li>
<li><strong>nx</strong> (<em>int</em>) – Number of grid points in the <span class="math">\(x\)</span>-direction.</li>
<li><strong>domain_z</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((\mu_{top}, ~ \mu_{surface})\)</span>.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>units_x</strong> (<cite>str</cite>, optional) – <p>Units for the <span class="math">\(x\)</span>-coordinate. Must be compliant
with the <a class="reference external" href="http://cfconventions.org">CF Conventions</a> (see also
<a class="reference internal" href="#grids.axis.Axis.__init__" title="grids.axis.Axis.__init__"><code class="xref py py-meth docutils literal"><span class="pre">grids.axis.Axis.__init__()</span></code></a>).</p>
</li>
<li><strong>dims_x</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(x\)</span>-coordinate.</li>
<li><strong>z_interface</strong> (<cite>float</cite>, optional) – Interface value <span class="math">\(\mu_F\)</span>. If not specified,
it is assumed that <span class="math">\(\mu_F = \mu_T\)</span>, with <span class="math">\(\mu_T\)</span> the value of
<span class="math">\(\mu\)</span> at the top of the domain. In other words, a fully terrain-following
coordinate system is supposed.</li>
<li><strong>N</strong> (<cite>int</cite>, optional) – Number of filter iterations performed to determine the
large-scale component of the surface terrain-height. Defaults to 100.</li>
<li><strong>s1</strong> (<cite>float</cite>, optional) – Large-scale decay constant. Defaults to <span class="math">\(8000 ~ m\)</span>.</li>
<li><strong>s2</strong> (<cite>float</cite>, optional) – Small-scale decay constant. Defaults to <span class="math">\(5000 ~ m\)</span>.</li>
<li><strong>topo_type</strong> (<cite>str</cite>, optional) – Topography type. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a>
for further dmuils.</li>
<li><strong>topo_time</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the simulation time after
which the topography should stop increasing. Default is 0, corresponding to a time-invariant
terrain surface-height. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a> for further details.</li>
<li><strong>**kwargs</strong> – keyword arguments to be forwarded to the constructor of
<a class="reference internal" href="#grids.topography.Topography1d" title="grids.topography.Topography1d"><code class="xref py py-class docutils literal"><span class="pre">Topography1d</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.sleve.SLEVE2d.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sleve.SLEVE2d.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the grid half levels using <a class="reference external" href="https://matplotlib.org/2.1.1/api/_as_gen/matplotlib.pyplot.html#module-matplotlib.pyplot" title="(in Matplotlib v2.1.1)"><code class="xref py py-mod docutils literal"><span class="pre">matplotlib.pyplot</span></code></a>’s utilities.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For the sake of compliancy with the notation employed by <a class="reference external" href="http://www.cosmo-model.org">COSMO</a>,
the vertical geometrical height is denoted by <span class="math">\(z\)</span>.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>**kwargs</strong> – Keyword arguments to be forwarded to <a class="reference external" href="https://matplotlib.org/2.1.1/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="(in Matplotlib v2.1.1)"><code class="xref py py-func docutils literal"><span class="pre">matplotlib.pyplot.subplots()</span></code></a>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.sleve.SLEVE2d.update_topography">
<code class="descname">update_topography</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sleve.SLEVE2d.update_topography" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the (time-dependent) topography. In turn, the metric terms are re-computed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the elasped simulation time.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="three-dimensional-grids">
<h3>Three-dimensional grids<a class="headerlink" href="#three-dimensional-grids" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="grids.xyz_grid.XYZGrid">
<em class="property">class </em><code class="descclassname">grids.xyz_grid.</code><code class="descname">XYZGrid</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_y</em>, <em>ny</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='degrees_east'</em>, <em>dims_x='longitude'</em>, <em>units_y='degrees_north'</em>, <em>dims_y='latitude'</em>, <em>units_z='m'</em>, <em>dims_z='z'</em>, <em>z_interface=None</em>, <em>topo_type='flat_terrain'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.xyz_grid.XYZGrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Rectangular and regular three-dimensional grid embedded in a reference system whose
coordinates are</p>
<blockquote>
<div><ul class="simple">
<li>the first horizontal coordinate <span class="math">\(x\)</span>,</li>
<li>the second horizontal coordinate <span class="math">\(y\)</span>, and</li>
<li>the vertical (terrain-following) coordinate <span class="math">\(z\)</span>.</li>
</ul>
</div></blockquote>
<p>The vertical coordinate <span class="math">\(z\)</span> may be formulated to define a hybrid terrain-
following coordinate system with terrain-following coordinate lines between the
surface terrain-height and <span class="math">\(z = z_F\)</span>, where <span class="math">\(z\)</span>-coordinate lines change
back to flat horizontal lines. However, no assumption is made on the actual nature
of <span class="math">\(z\)</span> which may be either pressure-based or height-based.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>xy_grid</strong> (<em>obj</em>) – The <span class="math">\(xy\)</span>-grid. This is a <a class="reference internal" href="#grids.xy_grid.XYGrid" title="grids.xy_grid.XYGrid"><code class="xref py py-class docutils literal"><span class="pre">XYGrid</span></code></a>.</li>
<li><strong>z</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object storing the <span class="math">\(z\)</span>-main levels.</li>
<li><strong>z_half_levels</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object storing the <span class="math">\(z\)</span>-half levels.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>dz</strong> (<em>float</em>) – The <span class="math">\(z\)</span>-spacing.</li>
<li><strong>z_interface</strong> (<em>float</em>) – The interface coordinate <span class="math">\(z_F\)</span>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For the sake of compliancy with the <a class="reference external" href="http://cosmo-model.org">COSMO model</a>,
the vertical grid points are ordered from the top of the domain to the surface.</p>
</div>
<dl class="method">
<dt id="grids.xyz_grid.XYZGrid.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_y</em>, <em>ny</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='degrees_east'</em>, <em>dims_x='longitude'</em>, <em>units_y='degrees_north'</em>, <em>dims_y='latitude'</em>, <em>units_z='m'</em>, <em>dims_z='z'</em>, <em>z_interface=None</em>, <em>topo_type='flat_terrain'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.xyz_grid.XYZGrid.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>domain_x</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((x_{start}, ~ x_{stop})\)</span>.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.nx" title="grids.xyz_grid.XYZGrid.nx"><strong>nx</strong></a> (<em>int</em>) – Number of grid points in the <span class="math">\(x\)</span>-direction.</li>
<li><strong>domain_y</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((y_{start}, ~ y_{stop})\)</span>.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.ny" title="grids.xyz_grid.XYZGrid.ny"><strong>ny</strong></a> (<em>int</em>) – Number of grid points in the <span class="math">\(y\)</span>-direction.</li>
<li><strong>domain_z</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((z_{top}, ~ z_{surface})\)</span>.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>units_x</strong> (<cite>str</cite>, optional) – <p>Units for the <span class="math">\(x\)</span>-coordinate. Must be compliant
with the <a class="reference external" href="cfconventions.org">CF Conventions</a>.</p>
</li>
<li><strong>dims_x</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(x\)</span>-coordinate.</li>
<li><strong>units_y</strong> (<cite>str</cite>, optional) – <p>Units for the <span class="math">\(y\)</span>-coordinate. Must be compliant
with the <a class="reference external" href="cfconventions.org">CF Conventions</a>.</p>
</li>
<li><strong>dims_y</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(y\)</span>-coordinate.</li>
<li><strong>units_z</strong> (<cite>str</cite>, optional) – <p>Units for the <span class="math">\(z\)</span>-coordinate. Must be compliant
with the <a class="reference external" href="cfconventions.org">CF Conventions</a>.</p>
</li>
<li><strong>dims_z</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(z\)</span>-coordinate.</li>
<li><strong>z_interface</strong> (<cite>float</cite>, optional) – Interface value <span class="math">\(z_F\)</span>. If not specified,
it is assumed that <span class="math">\(z_F = z_T\)</span>, with <span class="math">\(z_T\)</span> the value of <span class="math">\(z\)</span>
at the top of the domain. In other words, a fully terrain-following coordinate
system is supposed.</li>
<li><strong>topo_type</strong> (<cite>str</cite>, optional) – Topography type. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a>
for further details.</li>
<li><strong>topo_time</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the simulation time after
which the topography should stop increasing. Default is 0, corresponding to a time-invariant
terrain surface-height. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a> for further details.</li>
<li><strong>**kwargs</strong> – keyword arguments to be forwarded to the constructor of
<a class="reference internal" href="#grids.topography.Topography2d" title="grids.topography.Topography2d"><code class="xref py py-class docutils literal"><span class="pre">Topography2d</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="grids.xyz_grid.XYZGrid.dx">
<code class="descname">dx</code><a class="headerlink" href="#grids.xyz_grid.XYZGrid.dx" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <span class="math">\(x\)</span>-spacing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The <span class="math">\(x\)</span>-spacing.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="grids.xyz_grid.XYZGrid.dy">
<code class="descname">dy</code><a class="headerlink" href="#grids.xyz_grid.XYZGrid.dy" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <span class="math">\(y\)</span>-spacing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The <span class="math">\(y\)</span>-spacing.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="grids.xyz_grid.XYZGrid.nx">
<code class="descname">nx</code><a class="headerlink" href="#grids.xyz_grid.XYZGrid.nx" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of grid points in the <span class="math">\(x\)</span>-direction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Number of grid points in the <span class="math">\(x\)</span>-direction.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="grids.xyz_grid.XYZGrid.ny">
<code class="descname">ny</code><a class="headerlink" href="#grids.xyz_grid.XYZGrid.ny" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of grid points in the <span class="math">\(y\)</span>-direction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Number of grid points in the <span class="math">\(y\)</span>-direction.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="grids.xyz_grid.XYZGrid.topography_height">
<code class="descname">topography_height</code><a class="headerlink" href="#grids.xyz_grid.XYZGrid.topography_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the topography (i.e., terrain-surface) height.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Two-dimensional <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> carrying the topography height.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.xyz_grid.XYZGrid.update_topography">
<code class="descname">update_topography</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.xyz_grid.XYZGrid.update_topography" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the (time-dependent) topography.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the elapsed simulation time.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="grids.xyz_grid.XYZGrid.x">
<code class="descname">x</code><a class="headerlink" href="#grids.xyz_grid.XYZGrid.x" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <span class="math">\(x\)</span>-axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object representing the <span class="math">\(x\)</span>-axis.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="grids.xyz_grid.XYZGrid.x_half_levels">
<code class="descname">x_half_levels</code><a class="headerlink" href="#grids.xyz_grid.XYZGrid.x_half_levels" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <code class="xref py py-class docutils literal"><span class="pre">Axis</span></code> object storing the <span class="math">\(x\)</span> half levels.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object storing the <span class="math">\(x\)</span> half levels.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="grids.xyz_grid.XYZGrid.y">
<code class="descname">y</code><a class="headerlink" href="#grids.xyz_grid.XYZGrid.y" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <span class="math">\(y\)</span>-axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object representing the <span class="math">\(y\)</span>-axis.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="grids.xyz_grid.XYZGrid.y_half_levels">
<code class="descname">y_half_levels</code><a class="headerlink" href="#grids.xyz_grid.XYZGrid.y_half_levels" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <code class="xref py py-class docutils literal"><span class="pre">Axis</span></code> object storing the <span class="math">\(y\)</span> half levels.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object storing the <span class="math">\(y\)</span> half levels.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="grids.sigma.Sigma3d">
<em class="property">class </em><code class="descclassname">grids.sigma.</code><code class="descname">Sigma3d</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_y</em>, <em>ny</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='degrees_east'</em>, <em>dims_x='longitude'</em>, <em>units_y='degrees_north'</em>, <em>dims_y='latitude'</em>, <em>z_interface=None</em>, <em>topo_type='terrain_flat'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sigma.Sigma3d" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#grids.xyz_grid.XYZGrid" title="grids.xyz_grid.XYZGrid"><code class="xref py py-class docutils literal"><span class="pre">XYZGrid</span></code></a> to represent a rectangular and regular
computational grid embedded in a three-dimensional terrain-following reference system, whose
coordinates are:</p>
<blockquote>
<div><ul class="simple">
<li>first horizontal coordinate <span class="math">\(x\)</span>, e.g., the longitude;</li>
<li>second horizontal coordinate <span class="math">\(y\)</span>, e.g., the latitude;</li>
<li>the pressure-based terrain-following coordinate <span class="math">\(\sigma = p / p_{SL}\)</span>,                  where <span class="math">\(p\)</span> is the pressure and <span class="math">\(p_{SL}\)</span> the pressure at the                  sea level.</li>
</ul>
</div></blockquote>
<p>The vertical coordinate <span class="math">\(\sigma\)</span> may be formulated to define a hybrid terrain-
following coordinate system with terrain-following coordinate lines between the
surface terrain-height and <span class="math">\(\sigma = \sigma_F\)</span>, where <span class="math">\(\sigma\)</span>-coordinate
lines change back to flat horizontal lines.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.x" title="grids.xyz_grid.XYZGrid.x"><strong>x</strong></a> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object representing the <span class="math">\(x\)</span>-axis.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.nx" title="grids.xyz_grid.XYZGrid.nx"><strong>nx</strong></a> (<em>int</em>) – Number of grid points along <span class="math">\(x\)</span>.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.dx" title="grids.xyz_grid.XYZGrid.dx"><strong>dx</strong></a> (<em>float</em>) – The <span class="math">\(x\)</span>-spacing.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.y" title="grids.xyz_grid.XYZGrid.y"><strong>y</strong></a> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object representing the <span class="math">\(y\)</span>-axis.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.ny" title="grids.xyz_grid.XYZGrid.ny"><strong>ny</strong></a> (<em>int</em>) – Number of grid points along <span class="math">\(y\)</span>.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.dy" title="grids.xyz_grid.XYZGrid.dy"><strong>dy</strong></a> (<em>float</em>) – The <span class="math">\(y\)</span>-spacing.</li>
<li><strong>z</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object storing the <span class="math">\(\sigma\)</span>-main levels.</li>
<li><strong>z_half_levels</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object storing the <span class="math">\(\sigma\)</span>-half levels.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>dz</strong> (<em>float</em>) – The <span class="math">\(\sigma\)</span>-spacing.</li>
<li><strong>z_interface</strong> (<em>float</em>) – The interface coordinate <span class="math">\(\sigma_F\)</span>.</li>
<li><strong>height</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the geometrical height at
the main levels.</li>
<li><strong>height_half_levels</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the geometrical height at
the half levels.</li>
<li><strong>height_interface</strong> (<em>float</em>) – geometrical height corresponding to <span class="math">\(\sigma = \sigma_F\)</span>.</li>
<li><strong>reference_pressure</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the geometrical height at
the main levels.</li>
<li><strong>reference_pressure_half_levels</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the geometrical
height at the half levels.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="grids.sigma.Sigma3d.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_y</em>, <em>ny</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='degrees_east'</em>, <em>dims_x='longitude'</em>, <em>units_y='degrees_north'</em>, <em>dims_y='latitude'</em>, <em>z_interface=None</em>, <em>topo_type='terrain_flat'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sigma.Sigma3d.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>domain_x</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((x_{left}, ~ x_{right})\)</span>.</li>
<li><strong>nx</strong> (<em>int</em>) – Number of grid points in the <span class="math">\(x\)</span>-direction.</li>
<li><strong>domain_y</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((y_{left}, ~ y_{right})\)</span>.</li>
<li><strong>ny</strong> (<em>int</em>) – Number of grid points in the <span class="math">\(y\)</span>-direction.</li>
<li><strong>domain_z</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((\sigma_{top}, ~ \sigma_{surface})\)</span>.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>units_x</strong> (<cite>str</cite>, optional) – <p>Units for the <span class="math">\(x\)</span>-coordinate. Must be compliant
with the <a class="reference external" href="http://cfconventions.org">CF Conventions</a> (see also
<a class="reference internal" href="#grids.axis.Axis.__init__" title="grids.axis.Axis.__init__"><code class="xref py py-meth docutils literal"><span class="pre">grids.axis.Axis.__init__()</span></code></a>).</p>
</li>
<li><strong>dims_x</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(x\)</span>-coordinate.</li>
<li><strong>units_y</strong> (<cite>str</cite>, optional) – <p>Units for the <span class="math">\(y\)</span>-coordinate. Must be compliant
with the <a class="reference external" href="http://cfconventions.org">CF Conventions</a> (see also
<a class="reference internal" href="#grids.axis.Axis.__init__" title="grids.axis.Axis.__init__"><code class="xref py py-meth docutils literal"><span class="pre">grids.axis.Axis.__init__()</span></code></a>).</p>
</li>
<li><strong>dims_y</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(y\)</span>-coordinate.</li>
<li><strong>z_interface</strong> (<cite>float</cite>, optional) – Interface value <span class="math">\(\sigma_F\)</span>. If not specified,
it is assumed that <span class="math">\(\sigma_F = \sigma_T\)</span>, with <span class="math">\(\sigma_T\)</span> the value of
<span class="math">\(\sigma\)</span> at the top of the domain. In other words, a fully terrain-following
coordinate system is supposed.</li>
<li><strong>topo_type</strong> (<cite>str</cite>, optional) – Topography type. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a>
for further details.</li>
<li><strong>topo_time</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the simulation time after
which the topography should stop increasing. Default is 0, corresponding to a time-invariant
terrain surface-height. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a> for further details.</li>
<li><strong>**kwargs</strong> – keyword arguments to be forwarded to the constructor of
<a class="reference internal" href="#grids.topography.Topography2d" title="grids.topography.Topography2d"><code class="xref py py-class docutils literal"><span class="pre">Topography2d</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.sigma.Sigma3d.update_topography">
<code class="descname">update_topography</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sigma.Sigma3d.update_topography" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the (time-dependent) topography. In turn, the metric terms are re-computed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the elapsed simulation time.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="grids.gal_chen.GalChen3d">
<em class="property">class </em><code class="descclassname">grids.gal_chen.</code><code class="descname">GalChen3d</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_y</em>, <em>ny</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='degrees_east'</em>, <em>dims_x='longitude'</em>, <em>units_y='degrees_north'</em>, <em>dims_y='latitude'</em>, <em>z_interface=None</em>, <em>topo_type='terrain_flat'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.gal_chen.GalChen3d" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#grids.xyz_grid.XYZGrid" title="grids.xyz_grid.XYZGrid"><code class="xref py py-class docutils literal"><span class="pre">XYZGrid</span></code></a> to represent a rectangular and regular
computational grid embedded in a three-dimensional terrain-following reference system, whose
coordinates are:</p>
<blockquote>
<div><ul class="simple">
<li>first horizontal coordinate <span class="math">\(x\)</span>, e.g., the longitude;</li>
<li>second horizontal coordinate <span class="math">\(y\)</span>, e.g., the latitude;</li>
<li>the Gal-Chen terrain-following coordinate <span class="math">\(\mu\)</span>.</li>
</ul>
</div></blockquote>
<p>The vertical coordinate <span class="math">\(\mu\)</span> may be formulated to define a hybrid terrain-
following coordinate system with terrain-following coordinate lines between the
surface terrain-height and <span class="math">\(\mu = \mu_F\)</span>, where <span class="math">\(\mu\)</span>-coordinate
lines change back to flat horizontal lines.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.x" title="grids.xyz_grid.XYZGrid.x"><strong>x</strong></a> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object representing the <span class="math">\(x\)</span>-axis.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.nx" title="grids.xyz_grid.XYZGrid.nx"><strong>nx</strong></a> (<em>int</em>) – Number of grid points along <span class="math">\(x\)</span>.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.dx" title="grids.xyz_grid.XYZGrid.dx"><strong>dx</strong></a> (<em>float</em>) – The <span class="math">\(x\)</span>-spacing.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.y" title="grids.xyz_grid.XYZGrid.y"><strong>y</strong></a> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object representing the <span class="math">\(y\)</span>-axis.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.ny" title="grids.xyz_grid.XYZGrid.ny"><strong>ny</strong></a> (<em>int</em>) – Number of grid points along <span class="math">\(y\)</span>.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.dy" title="grids.xyz_grid.XYZGrid.dy"><strong>dy</strong></a> (<em>float</em>) – The <span class="math">\(y\)</span>-spacing.</li>
<li><strong>z</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object storing the <span class="math">\(z\)</span>-main levels.</li>
<li><strong>z_half_levels</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object storing the <span class="math">\(z\)</span>-half levels.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>dz</strong> (<em>float</em>) – The <span class="math">\(z\)</span>-spacing.</li>
<li><strong>z_interface</strong> (<em>float</em>) – The interface coordinate <span class="math">\(z_F\)</span>.</li>
<li><strong>height</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the geometrical height at
the main levels.</li>
<li><strong>height_half_levels</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the geometrical height at
the half levels.</li>
<li><strong>height_interface</strong> (<em>float</em>) – geometrical height corresponding to <span class="math">\(\mu = \mu_F\)</span>.</li>
<li><strong>reference_pressure</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the geometrical height at
the main levels.</li>
<li><strong>reference_pressure_half_levels</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the geometrical
height at the half levels.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="grids.gal_chen.GalChen3d.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_y</em>, <em>ny</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='degrees_east'</em>, <em>dims_x='longitude'</em>, <em>units_y='degrees_north'</em>, <em>dims_y='latitude'</em>, <em>z_interface=None</em>, <em>topo_type='terrain_flat'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.gal_chen.GalChen3d.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>domain_x</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((x_{left}, ~ x_{right})\)</span>.</li>
<li><strong>nx</strong> (<em>int</em>) – Number of grid points in the <span class="math">\(x\)</span>-direction.</li>
<li><strong>domain_y</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((y_{left}, ~ y_{right})\)</span>.</li>
<li><strong>ny</strong> (<em>int</em>) – Number of grid points in the <span class="math">\(y\)</span>-direction.</li>
<li><strong>domain_z</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((\mu_{top}, ~ \mu_{surface})\)</span>.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>units_x</strong> (<cite>str</cite>, optional) – <p>Units for the <span class="math">\(x\)</span>-coordinate. Must be compliant
with the <a class="reference external" href="http://cfconventions.org">CF Conventions</a> (see also
<a class="reference internal" href="#grids.axis.Axis.__init__" title="grids.axis.Axis.__init__"><code class="xref py py-meth docutils literal"><span class="pre">grids.axis.Axis.__init__()</span></code></a>).</p>
</li>
<li><strong>dims_x</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(x\)</span>-coordinate.</li>
<li><strong>units_y</strong> (<cite>str</cite>, optional) – <p>Units for the <span class="math">\(y\)</span>-coordinate. Must be compliant
with the <a class="reference external" href="http://cfconventions.org">CF Conventions</a> (see also
<a class="reference internal" href="#grids.axis.Axis.__init__" title="grids.axis.Axis.__init__"><code class="xref py py-meth docutils literal"><span class="pre">grids.axis.Axis.__init__()</span></code></a>).</p>
</li>
<li><strong>dims_y</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(y\)</span>-coordinate.</li>
<li><strong>z_interface</strong> (<cite>float</cite>, optional) – Interface value <span class="math">\(zmu_F = \mu_F\)</span>. If not
specified, it is assumed that <span class="math">\(\mu_F = \mu_T\)</span>, with <span class="math">\(\mu_T\)</span> the
value of <span class="math">\(\mu\)</span> at the top of the domain. In other words, a fully terrain-following
coordinate nsystem is supposed.</li>
<li><strong>topo_type</strong> (<cite>str</cite>, optional) – Topography type. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a>
for further dmuils.</li>
<li><strong>topo_time</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the simulation time after
which the topography should stop increasing. Default is 0, corresponding to a time-invariant
terrain surface-height. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a> for further details.</li>
<li><strong>**kwargs</strong> – keyword arguments to be forwarded to the constructor of
<a class="reference internal" href="#grids.topography.Topography2d" title="grids.topography.Topography2d"><code class="xref py py-class docutils literal"><span class="pre">Topography2d</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.gal_chen.GalChen3d.update_topography">
<code class="descname">update_topography</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.gal_chen.GalChen3d.update_topography" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the (time-dependent) topography. In turn, the metric terms are re-computed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the elapsed simulation time.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="grids.sleve.SLEVE3d">
<em class="property">class </em><code class="descclassname">grids.sleve.</code><code class="descname">SLEVE3d</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_y</em>, <em>ny</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='degrees_east'</em>, <em>dims_x='longitude'</em>, <em>units_y='degrees_north'</em>, <em>dims_y='latitude'</em>, <em>z_interface=None</em>, <em>N=100</em>, <em>s1=8000.0</em>, <em>s2=5000.0</em>, <em>topo_type='terrain_flat'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sleve.SLEVE3d" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#grids.xyz_grid.XYZGrid" title="grids.xyz_grid.XYZGrid"><code class="xref py py-class docutils literal"><span class="pre">XYZGrid</span></code></a> to represent a rectangular and regular
computational grid embedded in a three-dimensional terrain-following reference system, whose
coordinates are:</p>
<blockquote>
<div><ul class="simple">
<li>first horizontal coordinate <span class="math">\(x\)</span>, e.g., the longitude;</li>
<li>second horizontal coordinate <span class="math">\(y\)</span>, e.g., the latitude;</li>
<li>the SLEVE terrain-following coordinate <span class="math">\(\mu\)</span>.</li>
</ul>
</div></blockquote>
<p>The vertical coordinate <span class="math">\(\mu\)</span> may be formulated to define a hybrid terrain-
following coordinate system with terrain-following coordinate lines between the
surface terrain-height and <span class="math">\(\mu = \mu_F\)</span>, where <span class="math">\(\mu\)</span>-coordinate
lines change back to flat horizontal lines.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.x" title="grids.xyz_grid.XYZGrid.x"><strong>x</strong></a> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object representing the <span class="math">\(x\)</span>-axis.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.nx" title="grids.xyz_grid.XYZGrid.nx"><strong>nx</strong></a> (<em>int</em>) – Number of grid points along <span class="math">\(x\)</span>.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.dx" title="grids.xyz_grid.XYZGrid.dx"><strong>dx</strong></a> (<em>float</em>) – The <span class="math">\(x\)</span>-spacing.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.y" title="grids.xyz_grid.XYZGrid.y"><strong>y</strong></a> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object representing the <span class="math">\(y\)</span>-axis.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.ny" title="grids.xyz_grid.XYZGrid.ny"><strong>ny</strong></a> (<em>int</em>) – Number of grid points along <span class="math">\(y\)</span>.</li>
<li><a class="reference internal" href="#grids.xyz_grid.XYZGrid.dy" title="grids.xyz_grid.XYZGrid.dy"><strong>dy</strong></a> (<em>float</em>) – The <span class="math">\(y\)</span>-spacing.</li>
<li><strong>z</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object storing the <span class="math">\(z\)</span>-main levels.</li>
<li><strong>z_half_levels</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object storing the <span class="math">\(z\)</span>-half levels.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>dz</strong> (<em>float</em>) – The <span class="math">\(z\)</span>-spacing.</li>
<li><strong>z_interface</strong> (<em>float</em>) – The interface coordinate <span class="math">\(z_F\)</span>.</li>
<li><strong>height</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the geometrical height at
the main levels.</li>
<li><strong>height_half_levels</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the geometrical height at
the half levels.</li>
<li><strong>height_interface</strong> (<em>float</em>) – geometrical height corresponding to <span class="math">\(\mu = \mu_F\)</span>.</li>
<li><strong>reference_pressure</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the geometrical height at
the main levels.</li>
<li><strong>reference_pressure_half_levels</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the geometrical
height at the half levels.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="grids.sleve.SLEVE3d.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_y</em>, <em>ny</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='degrees_east'</em>, <em>dims_x='longitude'</em>, <em>units_y='degrees_north'</em>, <em>dims_y='latitude'</em>, <em>z_interface=None</em>, <em>N=100</em>, <em>s1=8000.0</em>, <em>s2=5000.0</em>, <em>topo_type='terrain_flat'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sleve.SLEVE3d.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>domain_x</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((x_{left}, ~ x_{right})\)</span>.</li>
<li><strong>nx</strong> (<em>int</em>) – Number of grid points in the <span class="math">\(x\)</span>-direction.</li>
<li><strong>domain_y</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((y_{left}, ~ y_{right})\)</span>.</li>
<li><strong>ny</strong> (<em>int</em>) – Number of grid points in the <span class="math">\(y\)</span>-direction.</li>
<li><strong>domain_z</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((\mu_{top}, ~ \mu_{surface})\)</span>.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>units_x</strong> (<cite>str</cite>, optional) – <p>Units for the <span class="math">\(x\)</span>-coordinate. Must be compliant
with the <a class="reference external" href="http://cfconventions.org">CF Conventions</a> (see also
<a class="reference internal" href="#grids.axis.Axis.__init__" title="grids.axis.Axis.__init__"><code class="xref py py-meth docutils literal"><span class="pre">grids.axis.Axis.__init__()</span></code></a>).</p>
</li>
<li><strong>dims_x</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(x\)</span>-coordinate.</li>
<li><strong>units_y</strong> (<cite>str</cite>, optional) – <p>Units for the <span class="math">\(y\)</span>-coordinate. Must be compliant
with the <a class="reference external" href="http://cfconventions.org">CF Conventions</a> (see also
<a class="reference internal" href="#grids.axis.Axis.__init__" title="grids.axis.Axis.__init__"><code class="xref py py-meth docutils literal"><span class="pre">grids.axis.Axis.__init__()</span></code></a>).</p>
</li>
<li><strong>dims_y</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(y\)</span>-coordinate.</li>
<li><strong>z_interface</strong> (<cite>float</cite>, optional) – Interface value <span class="math">\(zmu_F = \mu_F\)</span>. If not
specified, it is assumed that <span class="math">\(\mu_F = \mu_T\)</span>, with <span class="math">\(\mu_T\)</span> the
value of <span class="math">\(\mu\)</span> at the top of the domain. In other words, a fully terrain-following
coordinate nsystem is supposed.</li>
<li><strong>N</strong> (<cite>int</cite>, optional) – Number of filter iterations performed to determine the
large-scale component of the surface terrain-height. Defaults to 100.</li>
<li><strong>s1</strong> (<cite>float</cite>, optional) – Large-scale decay constant. Defaults to <span class="math">\(8000 ~ m\)</span>.</li>
<li><strong>s2</strong> (<cite>float</cite>, optional) – Small-scale decay constant. Defaults to <span class="math">\(5000 ~ m\)</span>.</li>
<li><strong>topo_type</strong> (<cite>str</cite>, optional) – Topography type. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a>
for further dmuils.</li>
<li><strong>topo_time</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the simulation time after
which the topography should stop increasing. Default is 0, corresponding to a time-invariant
terrain surface-height. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a> for further details.</li>
<li><strong>**kwargs</strong> – keyword arguments to be forwarded to the constructor of
<a class="reference internal" href="#grids.topography.Topography2d" title="grids.topography.Topography2d"><code class="xref py py-class docutils literal"><span class="pre">Topography2d</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.sleve.SLEVE3d.update_topography">
<code class="descname">update_topography</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sleve.SLEVE3d.update_topography" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the (time-dependent) topography. In turn, the metric terms are re-computed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the elapsed simulation time.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="model">
<h2>Model<a class="headerlink" href="#model" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="model.Model">
<em class="property">class </em><code class="descclassname">model.</code><code class="descname">Model</code><span class="sig-paren">(</span><em>dynamical_core</em>, <em>diagnostics=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#model.Model" title="Permalink to this definition">¶</a></dt>
<dd><p>This class is intended to represent and run a generic climate or meteorological numerical model.</p>
<dl class="method">
<dt id="model.Model.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>dt</em>, <em>simulation_time</em>, <em>state</em>, <em>save_freq=0</em><span class="sig-paren">)</span><a class="headerlink" href="#model.Model.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call operator integrating the model forward in time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the time step.</li>
<li><strong>simulation_time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the simulation time.</li>
<li><strong>state</strong> (<em>obj</em>) – The initial state, as an instance of <a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> or one of its derived classes.</li>
<li><strong>save_freq</strong> (<cite>int</cite>, optional) – The number of iterations between two consecutive saved states. Default is 0, meaning that only the
initial and final states are saved.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>state_out</strong> (<em>obj</em>) – The final state, of the same class of <code class="xref py py-data docutils literal"><span class="pre">state</span></code>.</li>
<li><strong>state_save</strong> (<em>obj</em>) – The sequence of saved states, of the same class of <code class="xref py py-data docutils literal"><span class="pre">state</span></code>.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.Model.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>dynamical_core</em>, <em>diagnostics=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#model.Model.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dynamical_core</strong> (<em>obj</em>) – An instance of <a class="reference internal" href="#dycore.dycore.DynamicalCore" title="dycore.dycore.DynamicalCore"><code class="xref py py-class docutils literal"><span class="pre">DynamicalCore</span></code></a> or one of its derived classes, implementing a dynamical core.</li>
<li><strong>diagnostics</strong> (<cite>list</cite>, optional) – List of diagnostics. Default is empty.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-namelist">
<span id="namelist"></span><h2>Namelist<a class="headerlink" href="#module-namelist" title="Permalink to this headline">¶</a></h2>
<p>Configuration and global variables used throughout the package.</p>
<dl class="docutils">
<dt>Physical constants:</dt>
<dd><ul class="first last simple">
<li><code class="xref py py-data docutils literal"><span class="pre">namelist.p_ref</span></code>: Reference pressure ([<span class="math">\(Pa\)</span>]).</li>
<li><code class="xref py py-data docutils literal"><span class="pre">namelist.p_sl</span></code>: Reference pressure at sea level ([<span class="math">\(Pa\)</span>]).</li>
<li><code class="xref py py-data docutils literal"><span class="pre">namelist.T_sl</span></code>: Reference temperature at sea level ([<span class="math">\(K\)</span>]).</li>
<li><code class="xref py py-data docutils literal"><span class="pre">namelist.beta</span></code>: Rate of increase in reference temperature with the logarithm           of reference pressure ([<span class="math">\(K ~ Pa^{-1}\)</span>]).</li>
<li><code class="xref py py-data docutils literal"><span class="pre">namelist.Rd</span></code>: Gas constant for dry airi ([<span class="math">\(J ~ K^{-1} ~ Kg^{-1}\)</span>]).</li>
<li><code class="xref py py-data docutils literal"><span class="pre">namelist.cp</span></code>: Specific heat of dry air at constant pressure ([<span class="math">\(J ~ K^{-1} ~ Kg^{-1}\)</span>]).</li>
<li><code class="xref py py-data docutils literal"><span class="pre">namelist.g</span></code>: Mean gravitational acceleration ([<span class="math">\(m ~ s^{-2}\)</span>]).</li>
</ul>
</dd>
<dt>Grid settings:</dt>
<dd><ul class="first last">
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.domain_x</span></code>: Tuple storing the boundaries of the domain in the <span class="math">\(x\)</span>-direction              in the form (<span class="math">\(x_{west}\)</span>, <span class="math">\(x_{east}\)</span>).</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.nx</span></code>: Number of grid points in the <span class="math">\(x\)</span>-direction.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.domain_y</span></code>: Tuple storing the boundaries of the domain in the <span class="math">\(y\)</span>-direction              in the form (<span class="math">\(y_{south}\)</span>, <span class="math">\(y_{north}\)</span>).</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.ny</span></code>: Number of grid points in the <span class="math">\(y\)</span>-direction.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.domain_z</span></code>: Tuple storing the boundaries of the domain in the <span class="math">\(z\)</span>-direction              in the form (<span class="math">\(z_{top}\)</span>, <span class="math">\(z_{bottom}\)</span>).</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.nz</span></code>: Number of grid points in the <span class="math">\(z\)</span>-direction.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.z_interface</span></code>: For a hybrid coordinate system, interface level at which terrain-following              <span class="math">\(z\)</span>-coordinate lines get back to horizontal lines.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.topo_type</span></code>: Topography type. Available options are:</p>
<blockquote>
<div><ul class="simple">
<li>‘flat_terrain’;</li>
<li>‘gaussian’;</li>
<li>‘schaer’;</li>
<li>‘user_defined’.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.topo_time</span></code>: <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> object representing the elapsed simulation time                               after which the topography should stop increasing.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.topo_max_height</span></code>: When <code class="xref py py-data docutils literal"><span class="pre">topo_type</span></code> is ‘gaussian’, maximum mountain height ([<span class="math">\(m\)</span>]).</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.topo_width_x</span></code>: When <code class="xref py py-data docutils literal"><span class="pre">topo_type</span></code> is ‘gaussian’, mountain half-width in <span class="math">\(x\)</span>-direction             ([<span class="math">\(m\)</span>]).</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.topo_width_y</span></code>: When <code class="xref py py-data docutils literal"><span class="pre">topo_type</span></code> is ‘gaussian’, mountain half-width in <span class="math">\(y\)</span>-direction             ([<span class="math">\(m\)</span>]).</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.topo_str</span></code>: When <code class="xref py py-data docutils literal"><span class="pre">topo_type</span></code> is ‘user_defined’, terrain profile expression in the independent          variables <span class="math">\(x\)</span> and <span class="math">\(y\)</span>. Must be fully C++-compliant.</p>
</li>
</ul>
</dd>
<dt>Model settings:</dt>
<dd><ul class="first last">
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.model_name</span></code>: Name of the model to implement. Available options are:</p>
<blockquote>
<div><ul class="simple">
<li>‘isentropic’, for the isentropic model.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.imoist</span></code>: <code class="xref py py-data docutils literal"><span class="pre">True</span></code> if water constituents should be taken into account, <code class="xref py py-data docutils literal"><span class="pre">False</span></code> otherwise.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.horizontal_boundary_type</span></code>: Horizontal boundary conditions. Available options are:</p>
<blockquote>
<div><ul class="simple">
<li>‘periodic’, for periodic boundary conditions;</li>
<li>‘relaxed’, for relaxed boundary conditions.</li>
</ul>
</div></blockquote>
</li>
</ul>
</dd>
<dt>Numerical settings:</dt>
<dd><ul class="first last">
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.scheme</span></code>: Numerical scheme to implement. For the isentropic model, available options are:</p>
<blockquote>
<div><ul class="simple">
<li>‘upwind’, for the first-order upwind scheme;</li>
<li>‘leapfrog’, for the second-order leapfrog scheme;</li>
<li>‘maccormack’, for the second-order maccormack scheme.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.idamp</span></code>: <code class="xref py py-data docutils literal"><span class="pre">True</span></code> if (explicit) vertical damping should be applied, <code class="xref py py-data docutils literal"><span class="pre">False</span></code> otherwise.               Note that when vertical damping is switched off, the numerical diffusion is monotonically increased towards             the top of the model, so to act as a diffusive wave absorber.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.damp_type</span></code>: Type of vertical damping to apply. Available options are:</p>
<blockquote>
<div><ul class="simple">
<li>‘rayleigh’, for Rayleigh vertical damping.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.damp_depth</span></code>: Number of levels (either main levels or half levels) in the absorbing region.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.damp_max</span></code>: Maximum value which should be assumed by the damping coefficient.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.idiff</span></code>: <code class="xref py py-data docutils literal"><span class="pre">True</span></code> to add numerical horizontal diffusion, <code class="xref py py-data docutils literal"><span class="pre">False</span></code> otherwise.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.diff_coeff</span></code>: The diffusion coefficient, i.e., the diffusivity.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.diff_coeff_moist</span></code>: The diffusion coefficient, i.e., the diffusivity, for the moisture components.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.diff_max</span></code>: Maximum value which should be assumed by the diffusivity when diffusive vertical damping is applied.</p>
</li>
</ul>
</dd>
<dt>Simulation settings:</dt>
<dd><ul class="first last">
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.dt</span></code>: <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> object representing the timestep.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.initial_time</span></code>: <code class="xref py py-class docutils literal"><span class="pre">datetime.datetime</span></code> representing the initial simulation time.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.simulation_time</span></code>: <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> object representing the simulation time.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.x_velocity_initial</span></code>: The initial, uniform <span class="math">\(x\)</span>-velocity ([<span class="math">\(m s^{-1}\)</span>]).</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.y_velocity_initial</span></code>: The initial, uniform <span class="math">\(y\)</span>-velocity ([<span class="math">\(m s^{-1}\)</span>]).</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.brunt_vaisala_initial</span></code>: The initial, uniform Brunt-Vaisala frequency.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.backend</span></code>: GT4Py’s backend to use. Available options are:</p>
<blockquote>
<div><ul class="simple">
<li><code class="xref py py-data docutils literal"><span class="pre">gridtools.mode.NUMPY</span></code>: Numpy (i.e., vectorized) backend.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.save_freq</span></code>: Save state every <code class="xref py py-data docutils literal"><span class="pre">freq</span></code> iterations.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.save_dest</span></code>: Path to the location where results should be saved.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.tol</span></code>: Tolerance used to compare floats (see <a class="reference internal" href="#module-utils" title="utils"><code class="xref py py-mod docutils literal"><span class="pre">utils</span></code></a>).</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.datatype</span></code>: Datatype for <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a>. Either <code class="xref py py-data docutils literal"><span class="pre">np.float32</span></code>             or <code class="xref py py-data docutils literal"><span class="pre">np.float64</span></code>.</p>
</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="storages">
<h2>Storages<a class="headerlink" href="#storages" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="storages.grid_data.GridData">
<em class="property">class </em><code class="descclassname">storages.grid_data.</code><code class="descname">GridData</code><span class="sig-paren">(</span><em>time</em>, <em>grid</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#storages.grid_data.GridData" title="Permalink to this definition">¶</a></dt>
<dd><p>Class storing and handling time-dependent variables defined on a grid. Ideally, this class should be used to
represent the state, or a sequence of states, of a <em>generic</em> climate or meteorological model. The model variables,
in the shape of <code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray`s,</span> <span class="pre">are</span> <span class="pre">passed</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">constructor</span> <span class="pre">as</span> <span class="pre">keyword</span> <span class="pre">arguments.</span> <span class="pre">After</span> <span class="pre">conversion</span> <span class="pre">to</span>
<span class="pre">:class:`xarray.DataArray`s,</span> <span class="pre">the</span> <span class="pre">variables</span> <span class="pre">are</span> <span class="pre">packed</span> <span class="pre">in</span> <span class="pre">a</span> <span class="pre">dictionary</span> <span class="pre">whose</span> <span class="pre">keys</span> <span class="pre">are</span> <span class="pre">the</span> <span class="pre">input</span> <span class="pre">keywords.</span> <span class="pre">The</span>
<span class="pre">class</span> <span class="pre">attribute</span> <span class="pre">:data:`units</span></code> lists, for any admissible keyword, the units in which the associated field should
be expressed. Any variable can be accessed in read-only mode via the accessor operator by specifying the
corresponding keyword. Other methods are provided to update the state, or to create a sequence of states
(useful for animation purposes).
This class is designed be as general as possible. Hence, it is not endowed with any method whose
implementation depends on the variables actually stored by the class. This kind of methods will be
provided by the derived classes, each one representing the state of a <em>specific</em> model.</p>
<dl class="method">
<dt id="storages.grid_data.GridData.__getitem__">
<code class="descname">__getitem__</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#storages.grid_data.GridData.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Access a gridded variable in read-only mode.</p>
</dd></dl>

<dl class="method">
<dt id="storages.grid_data.GridData.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>time</em>, <em>grid</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#storages.grid_data.GridData.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
</dd></dl>

<dl class="method">
<dt id="storages.grid_data.GridData.append">
<code class="descname">append</code><span class="sig-paren">(</span><em>state_new</em><span class="sig-paren">)</span><a class="headerlink" href="#storages.grid_data.GridData.append" title="Permalink to this definition">¶</a></dt>
<dd><p>Append a new state to the sequence of states.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>state_new</strong> (<em>obj</em>) – The new <a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> to append.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="storages.grid_data.GridData.get_max">
<code class="descname">get_max</code><span class="sig-paren">(</span><em>field</em><span class="sig-paren">)</span><a class="headerlink" href="#storages.grid_data.GridData.get_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Get maximum value of a field.</p>
</dd></dl>

<dl class="method">
<dt id="storages.grid_data.GridData.get_min">
<code class="descname">get_min</code><span class="sig-paren">(</span><em>field</em><span class="sig-paren">)</span><a class="headerlink" href="#storages.grid_data.GridData.get_min" title="Permalink to this definition">¶</a></dt>
<dd><p>Get minimum value of a field.</p>
</dd></dl>

<dl class="attribute">
<dt id="storages.grid_data.GridData.time">
<code class="descname">time</code><a class="headerlink" href="#storages.grid_data.GridData.time" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the time at which the state corresponds.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A <code class="xref py py-class docutils literal"><span class="pre">datetime.datetime</span></code> object representing the current time.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="storages.grid_data.GridData.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>state_new</em><span class="sig-paren">)</span><a class="headerlink" href="#storages.grid_data.GridData.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update (some of) the gridded variables.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>state_new</strong> (<em>obj</em>) – A <a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> carrying the updated model variables.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="xref py py-data docutils literal"><span class="pre">state_new</span></code> is not required to carry <em>all</em> the model variables.</p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-grids.topography">
<span id="topography"></span><h2>Topography<a class="headerlink" href="#module-grids.topography" title="Permalink to this headline">¶</a></h2>
<p>Classes representing one- and two-dimensional topographies, possibly time-dependent.
Indeed, although clearly not physical, a terrain surface (slowly) growing in the early stages
of a simulation may help to retrieve numerical stability, as it prevents steep gradients
in the first few iterations.</p>
<p>Letting <span class="math">\(h_s = h_s(x)\)</span> be a one-dimensional topography, with <span class="math">\(x \in [a,b]\)</span>,
the user may choose among:</p>
<blockquote>
<div><ul>
<li><p class="first">a flat terrain, i.e., <span class="math">\(h_s(x) \equiv 0\)</span>;</p>
</li>
<li><p class="first">a Gaussian-shaped mountain, i.e.,</p>
<blockquote>
<div><div class="math">
\[h_s(x) = h_{max} \exp{\left[ - \left( \frac{x - c}{\sigma_x} \right)^2 \right]},\]</div>
</div></blockquote>
<p>where <span class="math">\(c = 0.5 (a + b)\)</span>.</p>
</li>
</ul>
</div></blockquote>
<p>For the two-dimensional case, letting <span class="math">\(h_s = h_s(x,y)\)</span> be the topography, with
<span class="math">\(x \in [a_x,b_x]\)</span> and <span class="math">\(y \in [a_y,b_y]\)</span>, the following profiles are provided:</p>
<blockquote>
<div><ul>
<li><p class="first">flat terrain, i.e., <span class="math">\(h_s(x,y) \equiv 0\)</span>;</p>
</li>
<li><p class="first">Gaussian shaped-mountain, i.e.</p>
<blockquote>
<div><div class="math">
\[h_s(x,y) = h_{max} \exp{\left[ - \left( \frac{x - c_x}{\sigma_x} \right)^2 - \left( \frac{y - c_y}{\sigma_y} \right)^2 \right]} ,\]</div>
</div></blockquote>
<p>where <span class="math">\(c_x = 0.5 (a_x + b_x)\)</span> and <span class="math">\(c_y = 0.5 (a_y + b_y)\)</span>;</p>
</li>
<li><p class="first">modified Gaussian-shaped mountain proposed by Schaer and Durran (1997),</p>
<blockquote>
<div><div class="math">
\[h_s(x,y) = \frac{h_{max}}{\left[ 1 + \left( \frac{x}{\sigma_x} \right)^2 + \left( \frac{y}{\sigma_y} \right)^2 \right]^{3/2}}.\]</div>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<p>Yet, user-defined profiles are supported as well, provided that they admit an analytical expression.
This is passed to the class as a string, which is then parsed in C++ via <a class="reference external" href="http://cython.org">Cython</a>
(see <code class="xref py py-class docutils literal"><span class="pre">parser_1d</span></code> and <code class="xref py py-class docutils literal"><span class="pre">parser_2d</span></code>). Hence, the string itself must be
fully C++-compliant.</p>
<p class="rubric">References</p>
<p>Schaer, C., and Durran, D. R. (1997). <em>Vortex formation and vortex shedding in continuosly stratified flows     past isolated topography</em>. Journal of Atmospheric Sciences, 54:534-554.</p>
<dl class="class">
<dt id="grids.topography.Topography1d">
<em class="property">class </em><code class="descclassname">grids.topography.</code><code class="descname">Topography1d</code><span class="sig-paren">(</span><em>x</em>, <em>topo_type='flat_terrain'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.topography.Topography1d" title="Permalink to this definition">¶</a></dt>
<dd><p>One-dimensional topography.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>topo</strong> (<em>array_like</em>) – A <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the topography (in meters).</li>
<li><strong>topo_type</strong> (<em>str</em>) – Topography type. Either ‘flat_terrain’, ‘gaussian’ or ‘user_defined’.</li>
<li><strong>topo_time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> object representing the elapsed simulation time
after which the topography should stop increasing.</li>
<li><strong>topo_fact</strong> (<em>float</em>) – Topography factor. It runs in between 0 (at the beginning of the
simulation) and 1 (once the simulation has been run for <code class="xref py py-attr docutils literal"><span class="pre">topo_time</span></code> seconds).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="grids.topography.Topography1d.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>x</em>, <em>topo_type='flat_terrain'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.topography.Topography1d.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object representing the underlying horizontal axis.</li>
<li><strong>topo_type</strong> (<cite>str</cite>, optional) – Topography type. Either ‘flat_terrain’ (default), ‘gaussian’
or ‘user_defined’.</li>
<li><strong>topo_time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> object representing the elapsed simulation time
after which the topography should stop increasing. Default is 0, corresponding to a
time-invariant terrain surface-height.</li>
<li><strong>**topo_max_height</strong> (<em>float</em>) – When <code class="xref py py-data docutils literal"><span class="pre">topo_type</span></code> is ‘gaussian’, maximum mountain
height (in meters). Default is 500.</li>
<li><strong>**topo_width_x</strong> (<em>float</em>) – When <code class="xref py py-data docutils literal"><span class="pre">topo_type</span></code> is ‘gaussian’, mountain half-width
(in meters). Default is 10000.</li>
<li><strong>**topo_str</strong> (<em>str</em>) – When <code class="xref py py-data docutils literal"><span class="pre">topo_type</span></code> is ‘user_defined’, terrain profile expression
in the independent variable <span class="math">\(x\)</span>. Must be fully C++-compliant.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.topography.Topography1d.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.topography.Topography1d.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update topography at current simulation time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> object, representing the elapsed simulation time.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="grids.topography.Topography2d">
<em class="property">class </em><code class="descclassname">grids.topography.</code><code class="descname">Topography2d</code><span class="sig-paren">(</span><em>grid</em>, <em>topo_type='flat_terrain'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.topography.Topography2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Two-dimensional topography.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>topo</strong> (<em>array_like</em>) – A <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.0)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the topography (in meters).</li>
<li><strong>topo_type</strong> (<em>str</em>) – Topography type. Either ‘flat_terrain’, ‘gaussian’, ‘schaer’ or ‘user_defined’.</li>
<li><strong>topo_time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> object representing the elapsed simulation time
after which the topography should stop increasing.</li>
<li><strong>topo_fact</strong> (<em>float</em>) – Topography factor. It runs in between 0 (at the beginning of the
simulation) and 1 (once the simulation has been run for <code class="xref py py-attr docutils literal"><span class="pre">topo_time</span></code> seconds).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="grids.topography.Topography2d.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em>, <em>topo_type='flat_terrain'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.topography.Topography2d.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grid</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.xy_grid.XYGrid" title="grids.xy_grid.XYGrid"><code class="xref py py-class docutils literal"><span class="pre">XYGrid</span></code></a> object representing the underlying grid.</li>
<li><strong>topo_type</strong> (<cite>str</cite>, optional) – Topography type. Either ‘flat_terrain’ (default), ‘gaussian’,
‘schaer’ or ‘user_defined’.</li>
<li><strong>topo_time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> object representing the elapsed simulation time
after which the topography should stop increasing. Default is 0, corresponding to a
time-invariant terrain surface-height.</li>
<li><strong>**topo_max_height</strong> (<em>float</em>) – When <code class="xref py py-data docutils literal"><span class="pre">topo_type</span></code> is ‘gaussian’, maximum mountain
height (in meters). Default is 500.</li>
<li><strong>**topo_width_x</strong> (<em>float</em>) – When <code class="xref py py-data docutils literal"><span class="pre">topo_type</span></code> is ‘gaussian’, mountain half-width in
<span class="math">\(x\)</span>-direction (in meters). Default is 10000.</li>
<li><strong>**topo_width_y</strong> (<em>float</em>) – When <code class="xref py py-data docutils literal"><span class="pre">topo_type</span></code> is ‘gaussian’, mountain half-width in
<span class="math">\(y\)</span>-direction (in meters). Default is 10000.</li>
<li><strong>**topo_str</strong> (<em>str</em>) – When <code class="xref py py-data docutils literal"><span class="pre">topo_type</span></code> is ‘user_defined’, terrain profile expression
in the independent variables <span class="math">\(x\)</span> and <span class="math">\(y\)</span>. Must be fully C++-compliant.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.topography.Topography2d.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>grid</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.topography.Topography2d.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the topography using the <a class="reference external" href="https://matplotlib.org/tutorials/toolkits/mplot3d.html">mplot3d toolkit</a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grid</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.xy_grid.XYGrid" title="grids.xy_grid.XYGrid"><code class="xref py py-class docutils literal"><span class="pre">XYGrid</span></code></a> object representing the underlying grid.</li>
<li><strong>**kwargs</strong> – Keyword arguments to be forwarded to <a class="reference external" href="https://matplotlib.org/2.1.1/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="(in Matplotlib v2.1.1)"><code class="xref py py-func docutils literal"><span class="pre">matplotlib.pyplot.figure()</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.topography.Topography2d.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.topography.Topography2d.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update topography at current simulation time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> object, representing the elapsed simulation time.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<div class="section" id="parsers">
<h3>Parsers<a class="headerlink" href="#parsers" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="grids.parser.parser_1d.Parser1d">
<em class="property">class </em><code class="descclassname">grids.parser.parser_1d.</code><code class="descname">Parser1d</code><a class="headerlink" href="#grids.parser.parser_1d.Parser1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Cython wrapper for the C++ class <code class="xref py py-obj docutils literal"><span class="pre">parser_1d_cpp</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><strong>parser</strong> (<em>obj</em>) – Pointer to a <code class="xref py py-obj docutils literal"><span class="pre">parser_1d_cpp</span></code> object.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="grids.parser.parser_1d.Parser1d.evaluate">
<code class="descname">evaluate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grids.parser.parser_1d.Parser1d.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the expression.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> of the evaluations.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-utils">
<span id="utilities"></span><h2>Utilities<a class="headerlink" href="#module-utils" title="Permalink to this headline">¶</a></h2>
<p>Some useful utilities.</p>
<dl class="function">
<dt id="utils.convert_datetime64_to_datetime">
<code class="descclassname">utils.</code><code class="descname">convert_datetime64_to_datetime</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.convert_datetime64_to_datetime" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert <code class="xref py py-class docutils literal"><span class="pre">numpy.datetime64</span></code> to <code class="xref py py-class docutils literal"><span class="pre">datetime.datetime</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>obj</em>) – The <code class="xref py py-class docutils literal"><span class="pre">numpy.datetime64</span></code> object to convert.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The converted <code class="xref py py-class docutils literal"><span class="pre">datetime.datetime</span></code> object.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">obj</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="https://stackoverflow.com/questions/13703720/converting-between-datetime-timestamp-and-datetime64">https://stackoverflow.com/questions/13703720/converting-between-datetime-timestamp-and-datetime64</a>.</p>
</dd></dl>

<dl class="function">
<dt id="utils.equal_to">
<code class="descclassname">utils.</code><code class="descname">equal_to</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>tol=None</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.equal_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare floating point numbers (or arrays of floating point numbers), properly accounting for round-off errors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (<cite>float</cite> or <cite>array_like</cite>) – Left-hand side.</li>
<li><strong>b</strong> (<cite>float</cite> or <cite>array_like</cite>) – Right-hand side.</li>
<li><strong>tol</strong> (<cite>float</cite>, optional) – Tolerance.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if <code class="xref py py-data docutils literal"><span class="pre">a</span></code> is equal to <code class="xref py py-data docutils literal"><span class="pre">b</span></code> up to <code class="xref py py-data docutils literal"><span class="pre">tol</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.get_factor">
<code class="descclassname">utils.</code><code class="descname">get_factor</code><span class="sig-paren">(</span><em>units</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.get_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert units prefix to the corresponding factor.
For the conversion, the <a class="reference external" href="http://cfconventions.org/">CF Conventions</a> are used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>units</strong> (<em>str</em>) – The units.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The factor.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.greater_or_equal_than">
<code class="descclassname">utils.</code><code class="descname">greater_or_equal_than</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>tol=None</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.greater_or_equal_than" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare floating point numbers (or arrays of floating point numbers), properly accounting for round-off errors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (<cite>float</cite> or <cite>array_like</cite>) – Left-hand side.</li>
<li><strong>b</strong> (<cite>float</cite> or <cite>array_like</cite>) – Right-hand side.</li>
<li><strong>tol</strong> (<cite>float</cite>, optional) – Tolerance.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if <code class="xref py py-data docutils literal"><span class="pre">a</span></code> is greater than or equal to <code class="xref py py-data docutils literal"><span class="pre">b</span></code> up to <code class="xref py py-data docutils literal"><span class="pre">tol</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.greater_than">
<code class="descclassname">utils.</code><code class="descname">greater_than</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>tol=None</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.greater_than" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare floating point numbers (or arrays of floating point numbers), properly accounting for round-off errors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (<cite>float</cite> or <cite>array_like</cite>) – Left-hand side.</li>
<li><strong>b</strong> (<cite>float</cite> or <cite>array_like</cite>) – Right-hand side.</li>
<li><strong>tol</strong> (<cite>float</cite>, optional) – Tolerance.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if <code class="xref py py-data docutils literal"><span class="pre">a</span></code> is greater than <code class="xref py py-data docutils literal"><span class="pre">b</span></code> up to <code class="xref py py-data docutils literal"><span class="pre">tol</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.reverse_colormap">
<code class="descclassname">utils.</code><code class="descname">reverse_colormap</code><span class="sig-paren">(</span><em>cmap</em>, <em>name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.reverse_colormap" title="Permalink to this definition">¶</a></dt>
<dd><p>Reverse a Matplotlib colormap.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cmap</strong> (<em>obj</em>) – The <a class="reference external" href="https://matplotlib.org/2.1.1/api/_as_gen/matplotlib.colors.LinearSegmentedColormap.html#matplotlib.colors.LinearSegmentedColormap" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.colors.LinearSegmentedColormap</span></code></a> to invert.</li>
<li><strong>name</strong> (<cite>str</cite>, optional) – The name of the reversed colormap. By default, this is obtained by appending ‘_r’ to the name of the input colormap.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The reversed <a class="reference external" href="https://matplotlib.org/2.1.1/api/_as_gen/matplotlib.colors.LinearSegmentedColormap.html#matplotlib.colors.LinearSegmentedColormap" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.colors.LinearSegmentedColormap</span></code></a>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="https://stackoverflow.com/questions/3279560/invert-colormap-in-matplotlib">https://stackoverflow.com/questions/3279560/invert-colormap-in-matplotlib</a>.</p>
</dd></dl>

<dl class="function">
<dt id="utils.set_namelist">
<code class="descclassname">utils.</code><code class="descname">set_namelist</code><span class="sig-paren">(</span><em>user_namelist=None</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.set_namelist" title="Permalink to this definition">¶</a></dt>
<dd><p>Place the user-defined namelist module in the Python search path.
This is achieved by physically copying the content of the user-provided module into GT4ESS_ROOT/namelist.py.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>user_namelist</strong> (<em>str</em>) – Path to the user-defined namelist. If not specified, the default namelist GT4ESS_ROOT/_namelist.py is used.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.smaller_or_equal_than">
<code class="descclassname">utils.</code><code class="descname">smaller_or_equal_than</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>tol=None</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.smaller_or_equal_than" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare floating point numbers (or arrays of floating point numbers), properly accounting for round-off errors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (<cite>float</cite> or <cite>array_like</cite>) – Left-hand side.</li>
<li><strong>b</strong> (<cite>float</cite> or <cite>array_like</cite>) – Right-hand side.</li>
<li><strong>tol</strong> (<cite>float</cite>, optional) – Tolerance.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if <code class="xref py py-data docutils literal"><span class="pre">a</span></code> is smaller than or equal to <code class="xref py py-data docutils literal"><span class="pre">b</span></code> up to <code class="xref py py-data docutils literal"><span class="pre">tol</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.smaller_than">
<code class="descclassname">utils.</code><code class="descname">smaller_than</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>tol=None</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.smaller_than" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare floating point numbers (or arrays of floating point numbers), properly accounting for round-off errors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (<cite>float</cite> or <cite>array_like</cite>) – Left-hand side.</li>
<li><strong>b</strong> (<cite>float</cite> or <cite>array_like</cite>) – Right-hand side.</li>
<li><strong>tol</strong> (<cite>float</cite>, optional) – Tolerance.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if <code class="xref py py-data docutils literal"><span class="pre">a</span></code> is smaller than <code class="xref py py-data docutils literal"><span class="pre">b</span></code> up to <code class="xref py py-data docutils literal"><span class="pre">tol</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="index.html" class="btn btn-neutral" title="Welcome to gt4ess’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Stefano Ubbiali.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>API Documentation &mdash; gt4ess 0.1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="gt4ess 0.1.0 documentation" href="index.html"/>
        <link rel="prev" title="Welcome to gt4ess’s documentation!" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> gt4ess
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#axis">Axis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dynamics">Dynamics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#diagnostics">Diagnostics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynamical-cores">Dynamical cores</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lateral-boundary-conditions">Lateral boundary conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#horizontal-smoothing">Horizontal smoothing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#numerical-fluxes">Numerical fluxes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#prognostics">Prognostics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#wave-absorber">Wave absorber</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#grids">Grids</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#two-dimensional-grids">Two-dimensional grids</a></li>
<li class="toctree-l3"><a class="reference internal" href="#three-dimensional-grids">Three-dimensional grids</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#model">Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-namelist">Namelist</a></li>
<li class="toctree-l2"><a class="reference internal" href="#parameterizations">Parameterizations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#microphysics">Microphysics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#storages">Storages</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-grids.topography">Topography</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#parsers">Parsers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-utils.utils">Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-utils.utils_meteo">Meteo utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-utils.utils_plot">Plotting utilities</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">gt4ess</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>API Documentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="api-documentation">
<h1>API Documentation<a class="headerlink" href="#api-documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="axis">
<h2>Axis<a class="headerlink" href="#axis" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="grids.axis.Axis">
<em class="property">class </em><code class="descclassname">grids.axis.</code><code class="descname">Axis</code><span class="sig-paren">(</span><em>coords</em>, <em>dims</em>, <em>attrs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.axis.Axis" title="Permalink to this definition">¶</a></dt>
<dd><p>Class representing a one-dimensional axis. The class API is designed to be similar to
that provided by <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>coords</strong> (<em>list</em>) – One-dimensional <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> storing axis coordinates, wrapped within a list.</li>
<li><strong>values</strong> (<em>array_like</em>) – One-dimensional <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> storing axis coordinates. This attrribute is semantically identical
to <code class="xref py py-attr docutils literal"><span class="pre">coords</span></code> and it is introduced only for the sake of compliancy with <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a>’s API.</li>
<li><strong>dims</strong> (<em>str</em>) – Axis dimension, i.e., label.</li>
<li><strong>attrs</strong> (<em>dict</em>) – Axis attributes, e.g., the units.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="grids.axis.Axis.__getitem__">
<code class="descname">__getitem__</code><span class="sig-paren">(</span><em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.axis.Axis.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Get direct access to the coordinate vector.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>i</strong> (<cite>int</cite> or <a href="#id1"><span class="problematic" id="id2">`</span></a>array_like) – The index, or a sequence of indices.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The coordinate(s).</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.axis.Axis.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>coords</em>, <em>dims</em>, <em>attrs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.axis.Axis.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>coords</strong> (<em>array_like</em>) – One-dimensional <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the axis values.</li>
<li><strong>dims</strong> (<em>str</em>) – Axis label.</li>
<li><strong>attrs</strong> (<cite>dict</cite>, optional) – <p>Axis attributes. This may be used to specify, e.g., the units, which, following the
<a class="reference external" href="http://cfconventions.org">CF Conventions</a>, may be either:</p>
<blockquote>
<div><ul>
<li>’m’ (meters) or multiples, for height-based coordinates;</li>
<li>’Pa’ (Pascal) or multiples, for pressure-based coordinates;</li>
<li>’K’ (Kelvin), for temperature-based coordinates;</li>
<li>’degrees_east’, for longitude;</li>
<li>’degrees_north’, for latitude.</li>
</ul>
</div></blockquote>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.axis.Axis._check_arguments">
<code class="descname">_check_arguments</code><span class="sig-paren">(</span><em>coords</em>, <em>attr</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.axis.Axis._check_arguments" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert user-specified units to base units, e.g., km –&gt; m, hPa –&gt; Pa.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>coords</strong> (<em>array_like</em>) – One-dimensional <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the axis values.</li>
<li><strong>attrs</strong> (<em>dict</em>) – <p>Axis attributes. This may be used to specify, e.g., the units, which, following the
<a class="reference external" href="http://cfconventions.org">CF Conventions</a>, may be either:</p>
<blockquote>
<div><ul>
<li>’m’ (meters) or multiples, for height-based coordinates;</li>
<li>’Pa’ (Pascal) or multiples, for pressure-based coordinates;</li>
<li>’K’ (Kelvin), for temperature-based coordinates;</li>
<li>’degrees_east’, for longitude;</li>
<li>’degrees_north’, for latitude.</li>
</ul>
</div></blockquote>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The axis coordinates expressed in base units.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array_like</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="dynamics">
<h2>Dynamics<a class="headerlink" href="#dynamics" title="Permalink to this headline">¶</a></h2>
<div class="section" id="diagnostics">
<h3>Diagnostics<a class="headerlink" href="#diagnostics" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic">
<em class="property">class </em><code class="descclassname">dycore.diagnostic_isentropic.</code><code class="descname">DiagnosticIsentropic</code><span class="sig-paren">(</span><em>grid</em>, <em>moist_on</em>, <em>backend</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic" title="Permalink to this definition">¶</a></dt>
<dd><p>Class implementing the diagnostic steps of the three-dimensional moist isentropic dynamical core
using GT4Py’s stencils.</p>
<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em>, <em>moist_on</em>, <em>backend</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grid</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> representing the underlying grid.</li>
<li><strong>moist_on</strong> (<em>bool</em>) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> for a moist dynamical core, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</li>
<li><strong>backend</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode</span></code> specifying the backend for the GT4Py’s stencils.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_air_density_defs">
<code class="descname">_stencil_diagnosing_air_density_defs</code><span class="sig-paren">(</span><em>in_theta</em>, <em>in_s</em>, <em>in_h</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_air_density_defs" title="Permalink to this definition">¶</a></dt>
<dd><p>GT4Py’s stencil diagnosing the density.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>in_theta</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the vertical half levels.</li>
<li><strong>in_s</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density.</li>
<li><strong>in_h</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the geometric height at the half-levels.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the diagnosed density.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_air_density_initialize">
<code class="descname">_stencil_diagnosing_air_density_initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_air_density_initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the GT4Py’s stencil in charge of diagnosing the density.</p>
</dd></dl>

<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_air_density_set_inputs">
<code class="descname">_stencil_diagnosing_air_density_set_inputs</code><span class="sig-paren">(</span><em>s</em>, <em>h</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_air_density_set_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the private instance attributes which serve as inputs to the GT4Py’s stencil which diagnoses the density.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>s</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> with shape (<code class="xref py py-obj docutils literal"><span class="pre">nx</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">ny</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">nz</span></code>) representing the isentropic density.</li>
<li><strong>h</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> with shape (<code class="xref py py-obj docutils literal"><span class="pre">nx</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">ny</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">nz+1</span></code>) representing the height of the half-levels.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_air_pressure_defs">
<code class="descname">_stencil_diagnosing_air_pressure_defs</code><span class="sig-paren">(</span><em>in_s</em>, <em>in_p</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_air_pressure_defs" title="Permalink to this definition">¶</a></dt>
<dd><p>GT4Py’s stencil diagnosing the pressure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>in_s</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density.</li>
<li><strong>in_p</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the pressure.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the diagnosed pressure.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_air_pressure_initialize">
<code class="descname">_stencil_diagnosing_air_pressure_initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_air_pressure_initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the GT4Py’s stencil in charge of diagnosing the pressure.</p>
</dd></dl>

<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_air_pressure_set_inputs">
<code class="descname">_stencil_diagnosing_air_pressure_set_inputs</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_air_pressure_set_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the private instance attributes which serve as inputs to the GT4Py’s stencil which diagnoses the pressure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>s</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> with shape (<code class="xref py py-obj docutils literal"><span class="pre">nx</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">ny</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">nz</span></code>) representing the isentropic density.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_height_defs">
<code class="descname">_stencil_diagnosing_height_defs</code><span class="sig-paren">(</span><em>in_theta</em>, <em>in_exn</em>, <em>in_p</em>, <em>in_h</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_height_defs" title="Permalink to this definition">¶</a></dt>
<dd><p>GT4Py’s stencil diagnosing the geometric height of the isentropes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>in_theta</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the vertical half levels.</li>
<li><strong>in_exn</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the Exner function.</li>
<li><strong>in_p</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the pressure.</li>
<li><strong>in_h</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the geometric height of the isentropes.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the diagnosed geometric height of the isentropes.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_height_initialize">
<code class="descname">_stencil_diagnosing_height_initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_height_initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the GT4Py’s stencil in charge of diagnosing the geometric height of the half-level isentropes.</p>
</dd></dl>

<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_mass_fraction_of_water_constituents_in_air_defs">
<code class="descname">_stencil_diagnosing_mass_fraction_of_water_constituents_in_air_defs</code><span class="sig-paren">(</span><em>in_s</em>, <em>in_Qv</em>, <em>in_Qc</em>, <em>in_Qr</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_mass_fraction_of_water_constituents_in_air_defs" title="Permalink to this definition">¶</a></dt>
<dd><p>GT4Py’s stencil diagnosing the mass fraction of each water constituent.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>in_s</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density.</li>
<li><strong>in_U</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-momentum.</li>
<li><strong>in_V</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-momentum.</li>
<li><strong>in_Qv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density of water vapor.</li>
<li><strong>in_Qc</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density of cloud water.</li>
<li><strong>in_Qr</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density of precipitation water.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>out_qv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the diagnosed mass fraction of water vapor.</li>
<li><strong>out_qc</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the diagnosed mass fraction of cloud water.</li>
<li><strong>out_qr</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the diagnosed mass fraction of precipitation water.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_mass_fraction_of_water_constituents_in_air_initialize">
<code class="descname">_stencil_diagnosing_mass_fraction_of_water_constituents_in_air_initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_mass_fraction_of_water_constituents_in_air_initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the GT4Py’s stencil in charge of diagnosing the mass fraction of each water constituent.</p>
</dd></dl>

<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_mass_fraction_of_water_constituents_in_air_set_inputs">
<code class="descname">_stencil_diagnosing_mass_fraction_of_water_constituents_in_air_set_inputs</code><span class="sig-paren">(</span><em>s</em>, <em>Qv</em>, <em>Qc</em>, <em>Qr</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_mass_fraction_of_water_constituents_in_air_set_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the private instance attributes which serve as inputs to the GT4Py’s stencil which diagnose
the mass fraction of each water constituent.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>s</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> with shape (<code class="xref py py-obj docutils literal"><span class="pre">nx</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">ny</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">nz</span></code>) representing the isentropic density.</li>
<li><strong>Qv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density of water vapor.</li>
<li><strong>Qc</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density of cloud water.</li>
<li><strong>Qr</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density of precipitation water.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_montgomery_defs">
<code class="descname">_stencil_diagnosing_montgomery_defs</code><span class="sig-paren">(</span><em>in_exn</em>, <em>in_mtg</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_montgomery_defs" title="Permalink to this definition">¶</a></dt>
<dd><p>GT4Py’s stencil diagnosing the Exner function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>in_exn</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the Exner function.</li>
<li><strong>in_mtg</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the Montgomery potential.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the diagnosed Montgomery potential.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_montgomery_initialize">
<code class="descname">_stencil_diagnosing_montgomery_initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_montgomery_initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the GT4Py’s stencil in charge of diagnosing the Montgomery potential.</p>
</dd></dl>

<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_velocity_x_defs">
<code class="descname">_stencil_diagnosing_velocity_x_defs</code><span class="sig-paren">(</span><em>in_s</em>, <em>in_U</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_velocity_x_defs" title="Permalink to this definition">¶</a></dt>
<dd><p>GT4Py’s stencil diagnosing the <span class="math">\(x\)</span>-component of the velocity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>in_s</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density.</li>
<li><strong>in_U</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-momentum.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the diagnosed <span class="math">\(x\)</span>-velocity.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_velocity_x_initialize">
<code class="descname">_stencil_diagnosing_velocity_x_initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_velocity_x_initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the GT4Py’s stencil in charge of diagnosing the <span class="math">\(x\)</span>-component of the velocity.</p>
</dd></dl>

<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_velocity_y_defs">
<code class="descname">_stencil_diagnosing_velocity_y_defs</code><span class="sig-paren">(</span><em>in_s</em>, <em>in_V</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_velocity_y_defs" title="Permalink to this definition">¶</a></dt>
<dd><p>GT4Py’s stencil diagnosing the <span class="math">\(y\)</span>-component of the velocity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>in_s</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density.</li>
<li><strong>in_V</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-momentum.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the diagnosed <span class="math">\(y\)</span>-velocity.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_velocity_y_initialize">
<code class="descname">_stencil_diagnosing_velocity_y_initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_velocity_y_initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the GT4Py’s stencil in charge of diagnosing the <span class="math">\(y\)</span>-component of the velocity.</p>
</dd></dl>

<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_water_constituents_isentropic_density_defs">
<code class="descname">_stencil_diagnosing_water_constituents_isentropic_density_defs</code><span class="sig-paren">(</span><em>in_s</em>, <em>in_qv</em>, <em>in_qc</em>, <em>in_qr</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_water_constituents_isentropic_density_defs" title="Permalink to this definition">¶</a></dt>
<dd><p>GT4Py’s stencil diagnosing the isentropic density of each water constituent, i.e.,
<span class="math">\(Q_v\)</span>, <span class="math">\(Q_c\)</span> and <span class="math">\(Q_r\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>in_s</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density.</li>
<li><strong>in_qv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the mass fraction of water vapor.</li>
<li><strong>in_qc</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the mass fraction of cloud water.</li>
<li><strong>in_qr</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the mass fraction of precipitation water.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>out_Qv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the diagnosed <span class="math">\(Qv\)</span>.</li>
<li><strong>out_Qc</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the diagnosed <span class="math">\(Qc\)</span>.</li>
<li><strong>out_Qr</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the diagnosed <span class="math">\(Qr\)</span>.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_water_constituents_isentropic_density_initialize">
<code class="descname">_stencil_diagnosing_water_constituents_isentropic_density_initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_water_constituents_isentropic_density_initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the GT4Py’s stencil in charge of diagnosing the isentropic density of each water constituent.</p>
</dd></dl>

<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_water_constituents_isentropic_density_set_inputs">
<code class="descname">_stencil_diagnosing_water_constituents_isentropic_density_set_inputs</code><span class="sig-paren">(</span><em>s</em>, <em>qv</em>, <em>qc</em>, <em>qr</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_water_constituents_isentropic_density_set_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the private instance attributes which serve as inputs to the GT4Py’s stencil which diagnoses
the isentropic density of each water constituent.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>s</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> with shape (<code class="xref py py-obj docutils literal"><span class="pre">nx</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">ny</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">nz</span></code>) representing the isentropic density.</li>
<li><strong>qv</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> with shape (<code class="xref py py-obj docutils literal"><span class="pre">nx</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">ny</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">nz</span></code>) representing the mass fraction of
water vapor.</li>
<li><strong>qc</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> with shape (<code class="xref py py-obj docutils literal"><span class="pre">nx</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">ny</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">nz</span></code>) representing the mass fraction of
cloud water.</li>
<li><strong>qr</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> with shape (<code class="xref py py-obj docutils literal"><span class="pre">nx</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">ny</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">nz</span></code>) representing the mass fraction of
precipitation water.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic._stencils_diagnosing_velocity_set_inputs">
<code class="descname">_stencils_diagnosing_velocity_set_inputs</code><span class="sig-paren">(</span><em>s</em>, <em>U</em>, <em>V</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic._stencils_diagnosing_velocity_set_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the private instance attributes which serve as inputs to the GT4Py’s stencils which diagnose
the velocity components.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>s</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> with shape (<code class="xref py py-obj docutils literal"><span class="pre">nx</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">ny</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">nz</span></code>) representing the isentropic density.</li>
<li><strong>U</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> with shape (<code class="xref py py-obj docutils literal"><span class="pre">nx</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">ny</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">nz</span></code>) representing the <span class="math">\(x\)</span>-velocity.</li>
<li><strong>V</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> with shape (<code class="xref py py-obj docutils literal"><span class="pre">nx</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">ny</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">nz</span></code>) representing the <span class="math">\(y\)</span>-velocity.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic.diagnostic">
<code class="descname">diagnostic</code><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic.diagnostic" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the attribute implementing the diagnostic step of the three-dimensional moist isentropic dynamical core.
If this is set to <code class="xref py py-obj docutils literal"><span class="pre">None</span></code>, a <code class="xref py py-class docutils literal"><span class="pre">ValueError</span></code> is thrown.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference internal" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic" title="dycore.diagnostic_isentropic.DiagnosticIsentropic"><code class="xref py py-class docutils literal"><span class="pre">DiagnosticIsentropic</span></code></a> carrying out the diagnostic step of the
three-dimensional moist isentropic dynamical core.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">obj</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic.get_air_density">
<code class="descname">get_air_density</code><span class="sig-paren">(</span><em>state</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic.get_air_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Diagnosis of the density.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>state</strong> (<em>obj</em>) – <p><a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> or one of its derived classes containing the following variables:</p>
<ul class="simple">
<li>air_isentropic_density (unstaggered);</li>
<li>height (<span class="math">\(z\)</span>-staggered).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> collecting the diagnosed variables, namely:<ul class="simple">
<li>air_density (unstaggered).</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">obj</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic.get_air_temperature">
<code class="descname">get_air_temperature</code><span class="sig-paren">(</span><em>state</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic.get_air_temperature" title="Permalink to this definition">¶</a></dt>
<dd><p>Diagnosis of the temperature.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>state</strong> (<em>obj</em>) – <p><a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> or one of its derived classes containing the following variables:</p>
<ul class="simple">
<li>exner_function (<span class="math">\(z\)</span>-staggered).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> collecting the diagnosed variables, namely:<ul class="simple">
<li>air_temperature (unstaggered).</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">obj</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic.get_diagnostic_variables">
<code class="descname">get_diagnostic_variables</code><span class="sig-paren">(</span><em>state</em>, <em>pt</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic.get_diagnostic_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Diagnosis of the pressure, the Exner function, the Montgomery potential, and the geometric height of the half-levels.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>state</strong> (<em>obj</em>) – <p><a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> or one of its derived classes containing the following variables:</p>
<ul>
<li>air_isentropic_density (unstaggered).</li>
</ul>
</li>
<li><strong>pt</strong> (<em>float</em>) – Pressure value at the top of the domain.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p><a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> collecting the diagnosed variables, namely:</p>
<ul class="simple">
<li>air_pressure (<span class="math">\(z\)</span>-staggered);</li>
<li>exner_function (<span class="math">\(z\)</span>-staggered);</li>
<li>montgomery_potential (unstaggered);</li>
<li>height (<span class="math">\(z\)</span>-staggered).</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic.get_mass_fraction_of_water_constituents_in_air">
<code class="descname">get_mass_fraction_of_water_constituents_in_air</code><span class="sig-paren">(</span><em>state</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic.get_mass_fraction_of_water_constituents_in_air" title="Permalink to this definition">¶</a></dt>
<dd><p>Diagnosis of the mass fraction of each water constituents, i.e., <span class="math">\(q_v\)</span>, <span class="math">\(q_c\)</span> and <span class="math">\(q_r\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>state</strong> (<em>obj</em>) – <p><a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> or one of its derived classes containing the following variables:</p>
<ul class="simple">
<li>air_isentropic_density (unstaggered);</li>
<li>water_vapor_isentropic_density (unstaggered);</li>
<li>cloud_liquid_water_isentropic_density (unstaggered);</li>
<li>precipitation_water_isentropic_density (unstaggered).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> collecting the diagnosed variables, namely:<ul class="simple">
<li>mass_fraction_of_water_vapor_in_air (unstaggered);</li>
<li>mass_fraction_of_cloud_liquid_water_in_air (unstaggered);</li>
<li>mass_fraction_of_precipitation_water_in_air (unstaggered).</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">obj</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic.get_velocity_components">
<code class="descname">get_velocity_components</code><span class="sig-paren">(</span><em>state</em>, <em>state_old=None</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic.get_velocity_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Diagnosis of the velocity components <span class="math">\(u\)</span> and <span class="math">\(v\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>state</strong> (<em>obj</em>) – <p><a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> or one of its derived classes containing the following variables:</p>
<ul>
<li>air_isentropic_density (unstaggered);</li>
<li>x_momentum_isentropic (unstaggered);</li>
<li>y_momentum_isentropic (unstaggered).</li>
</ul>
</li>
<li><strong>state_old</strong> (<em>obj</em>) – <p><a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> or one of its derived classes containing the following variables,
defined at the previous time level:</p>
<ul>
<li>x_velocity (<span class="math">\(x\)</span>-staggered);</li>
<li>y_velocity (<span class="math">\(y\)</span>-staggered).</li>
</ul>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p><a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> collecting the diagnosed variables, namely:</p>
<ul class="simple">
<li>x_velocity (<span class="math">\(x\)</span>-staggered);</li>
<li>y_velocity (<span class="math">\(y\)</span>-staggered).</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The first and last rows (respectively, columns) of the staggered <span class="math">\(x\)</span>-velocity (resp., <span class="math">\(y\)</span>-velocity)
are set only if the state at the previous time level is provided.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="dycore.diagnostic_isentropic.DiagnosticIsentropic.get_water_constituents_isentropic_density">
<code class="descname">get_water_constituents_isentropic_density</code><span class="sig-paren">(</span><em>state</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic.get_water_constituents_isentropic_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Diagnosis of the isentropic density of each water constituent, i.e., <span class="math">\(Q_v\)</span>, <span class="math">\(Q_c\)</span> and <span class="math">\(Q_v\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>state</strong> (<em>obj</em>) – <p><a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> or one of its derived classes containing the following variables:</p>
<ul class="simple">
<li>air_isentropic_density (unstaggered);</li>
<li>mass_fraction_of_water_vapor_in_air (unstaggered);</li>
<li>mass_fraction_of_cloud_liquid_water_in_air (unstaggered);</li>
<li>mass_fraction_of_precipitation_water_in_air (unstaggered).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> collecting the diagnosed variables, namely:<ul class="simple">
<li>water_vapor_isentropic_density (unstaggered);</li>
<li>cloud_liquid_water_isentropic_density (unstaggered);</li>
<li>precipitation_water_isentropic_density (unstaggered).</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">obj</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="dynamical-cores">
<h3>Dynamical cores<a class="headerlink" href="#dynamical-cores" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="dycore.dycore.DynamicalCore">
<em class="property">class </em><code class="descclassname">dycore.dycore.</code><code class="descname">DynamicalCore</code><span class="sig-paren">(</span><em>grid</em>, <em>moist_on</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.dycore.DynamicalCore" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract base class whose derived classes implement different dynamical cores.
The class inherits <code class="xref py py-class docutils literal"><span class="pre">sympl.TimeStepper</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><strong>microphysics</strong> (<em>obj</em>) – Derived class of <code class="xref py py-class docutils literal"><span class="pre">Microphysics</span></code> taking care of the cloud microphysics.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="dycore.dycore.DynamicalCore.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>dt</em>, <em>state</em>, <em>diagnostics=None</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.dycore.DynamicalCore.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call operator advancing the input state one step forward.
As this method is marked as abstract, its implementation is delegated to the derived classes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> object representing the time step.</li>
<li><strong>state</strong> (<em>obj</em>) – The current state, as an instance of <a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> or one of its derived classes.</li>
<li><strong>diagnostics</strong> (<cite>obj</cite>, optional) – <a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> storing the possibly required diagnostics. Default is <code class="xref py py-obj docutils literal"><span class="pre">None</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The state at the next time level. This is of the same class of <code class="xref py py-data docutils literal"><span class="pre">state</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.dycore.DynamicalCore.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em>, <em>moist_on</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.dycore.DynamicalCore.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</li>
<li><strong>moist_on</strong> (<em>bool</em>) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> for a moist dynamical core, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="dycore.dycore.DynamicalCore.factory">
<em class="property">static </em><code class="descname">factory</code><span class="sig-paren">(</span><em>model</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.dycore.DynamicalCore.factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Static method returning an instance of the derived class implementing the dynamical core specified by <code class="xref py py-obj docutils literal"><span class="pre">model</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>model</strong> (<em>str</em>) – <p>String specifying the dynamical core to implement. Either:</p>
<ul>
<li>’isentropic’, for the hydrostatic, isentropic dynamical core;</li>
<li>’isentropic_isothermal’, for the hydrostatic, isentropic, isothermal dynamical core.</li>
</ul>
</li>
<li><strong>*args</strong> – Positional arguments to forward to the derived class.</li>
<li><strong>**kwargs</strong> – Keyword arguments to forward to the derived class.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Instance of the derived class implementing the specified model.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.dycore.DynamicalCore.get_initial_state">
<code class="descname">get_initial_state</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.dycore.DynamicalCore.get_initial_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the initial state.
As this method is marked as abstract, its implementation is delegated to the derived classes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>*args</strong> – The arguments depend on the specific dynamical core which the derived class implements.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The initial state, as an instance of <a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> or one of its derived classes.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">obj</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.dycore.DynamicalCore.update_topography">
<code class="descname">update_topography</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.dycore.DynamicalCore.update_topography" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the underlying (time-dependent) topography.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the elapsed simulation time.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="dycore.dycore_isentropic.DynamicalCoreIsentropic">
<em class="property">class </em><code class="descclassname">dycore.dycore_isentropic.</code><code class="descname">DynamicalCoreIsentropic</code><span class="sig-paren">(</span><em>time_scheme</em>, <em>flux_scheme</em>, <em>horizontal_boundary_type</em>, <em>grid</em>, <em>moist_on</em>, <em>backend</em>, <em>damp_on=True</em>, <em>damp_type='rayleigh'</em>, <em>damp_depth=15</em>, <em>damp_max=0.0002</em>, <em>smooth_on=True</em>, <em>smooth_type='first_order'</em>, <em>smooth_damp_depth=10</em>, <em>smooth_coeff=0.03</em>, <em>smooth_coeff_max=0.24</em>, <em>smooth_moist_on=False</em>, <em>smooth_moist_type='first_order'</em>, <em>smooth_moist_damp_depth=10</em>, <em>smooth_coeff_moist=0.03</em>, <em>smooth_coeff_moist_max=0.24</em>, <em>physics_dynamics_coupling_on=False</em>, <em>sedimentation_on=False</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.dycore_isentropic.DynamicalCoreIsentropic" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#dycore.dycore.DynamicalCore" title="dycore.dycore.DynamicalCore"><code class="xref py py-class docutils literal"><span class="pre">DynamicalCore</span></code></a> to implement the three-dimensional
(moist) isentropic dynamical core using GT4Py’s stencils. The class offers different numerical
schemes to carry out the prognostic step of the dynamical core, and supports different types of
lateral boundary conditions.</p>
<dl class="method">
<dt id="dycore.dycore_isentropic.DynamicalCoreIsentropic.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>dt</em>, <em>state</em>, <em>diagnostics=None</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.dycore_isentropic.DynamicalCoreIsentropic.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call operator advancing the state variables one step forward.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the time step.</li>
<li><strong>state</strong> (<em>obj</em>) – <p><a class="reference internal" href="#storages.state_isentropic.StateIsentropic" title="storages.state_isentropic.StateIsentropic"><code class="xref py py-class docutils literal"><span class="pre">StateIsentropic</span></code></a> representing the current state.
It should contain the following variables:</p>
<ul>
<li>air_isentropic_density (unstaggered);</li>
<li>x_velocity (<span class="math">\(x\)</span>-staggered);</li>
<li>x_momentum_isentropic (unstaggered);</li>
<li>y_velocity (<span class="math">\(y\)</span>-staggered);</li>
<li>y_momentum_isentropic (unstaggered);</li>
<li>air_pressure (<span class="math">\(z\)</span>-staggered);</li>
<li>montgomery_potential (unstaggered);</li>
<li>mass_fraction_of_water_vapor_in_air (unstaggered, optional);</li>
<li>mass_fraction_of_cloud_liquid_water_in_air (unstaggered, optional);</li>
<li>mass_fraction_of_precipitation_water_in_air (unstaggered, optional).</li>
</ul>
</li>
<li><strong>diagnostics</strong> (<cite>obj</cite>, optional) – <p><a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> storing possibly required diagnostics, namely:</p>
<ul>
<li>change_over_time_in_air_potential_temperature (unstaggered);</li>
<li>raindrop_fall_velocity (unstaggered).</li>
</ul>
<p>Default is <code class="xref py py-obj docutils literal"><span class="pre">None</span></code>.</p>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p><a class="reference internal" href="#storages.state_isentropic.StateIsentropic" title="storages.state_isentropic.StateIsentropic"><code class="xref py py-class docutils literal"><span class="pre">StateIsentropic</span></code></a> representing the state at the next time level.
It contains the following variables:</p>
<ul class="simple">
<li>air_isentropic_density (unstaggered);</li>
<li>x_velocity (<span class="math">\(x\)</span>-staggered);</li>
<li>x_momentum_isentropic (unstaggered);</li>
<li>y_velocity (<span class="math">\(y\)</span>-staggered);</li>
<li>y_momentum_isentropic (unstaggered);</li>
<li>air_pressure (<span class="math">\(z\)</span>-staggered);</li>
<li>exner_function (<span class="math">\(z\)</span>-staggered);</li>
<li>montgomery_potential (unstaggered);</li>
<li>height (<span class="math">\(z\)</span>-staggered);</li>
<li>mass_fraction_of_water_vapor_in_air (unstaggered);</li>
<li>mass_fraction_of_cloud_liquid_water_in_air (unstaggered);</li>
<li>mass_fraction_of_precipitation_water_in_air (unstaggered);</li>
<li>air_density (unstaggered, only if cloud microphysics is switched on);</li>
<li>air_temperature (unstaggered, only if cloud microphysics is switched on).</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.dycore_isentropic.DynamicalCoreIsentropic.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>time_scheme</em>, <em>flux_scheme</em>, <em>horizontal_boundary_type</em>, <em>grid</em>, <em>moist_on</em>, <em>backend</em>, <em>damp_on=True</em>, <em>damp_type='rayleigh'</em>, <em>damp_depth=15</em>, <em>damp_max=0.0002</em>, <em>smooth_on=True</em>, <em>smooth_type='first_order'</em>, <em>smooth_damp_depth=10</em>, <em>smooth_coeff=0.03</em>, <em>smooth_coeff_max=0.24</em>, <em>smooth_moist_on=False</em>, <em>smooth_moist_type='first_order'</em>, <em>smooth_moist_damp_depth=10</em>, <em>smooth_coeff_moist=0.03</em>, <em>smooth_coeff_moist_max=0.24</em>, <em>physics_dynamics_coupling_on=False</em>, <em>sedimentation_on=False</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.dycore_isentropic.DynamicalCoreIsentropic.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>time_scheme</strong> (<em>str</em>) – String specifying the time stepping method to implement.
See <a class="reference internal" href="#dycore.prognostic_isentropic.PrognosticIsentropic" title="dycore.prognostic_isentropic.PrognosticIsentropic"><code class="xref py py-class docutils literal"><span class="pre">PrognosticIsentropic</span></code></a> for the available options.</li>
<li><strong>flux_scheme</strong> (<em>str</em>) – String specifying the numerical fluc to use.
See <code class="xref py py-class docutils literal"><span class="pre">PrognosticFlux</span></code> for the available options.</li>
<li><strong>horizontal_boundary_type</strong> (<em>str</em>) – String specifying the horizontal boundary conditions.
See <a class="reference internal" href="#dycore.horizontal_boundary.HorizontalBoundary" title="dycore.horizontal_boundary.HorizontalBoundary"><code class="xref py py-class docutils literal"><span class="pre">HorizontalBoundary</span></code></a> for the available options.</li>
<li><strong>grid</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> representing the underlying grid.</li>
<li><strong>moist_on</strong> (<em>bool</em>) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> for a moist dynamical core, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</li>
<li><strong>backend</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode</span></code> specifying the backend for the GT4Py’s stencils implementing the dynamical core.</li>
<li><strong>damp_on</strong> (<cite>bool</cite>, optional) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if vertical damping is enabled, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise. Default is <code class="xref py py-obj docutils literal"><span class="pre">True</span></code>.</li>
<li><strong>damp_type</strong> (<cite>str</cite>, optional) – String specifying the type of vertical damping to apply. Default is ‘rayleigh’.
See <a class="reference internal" href="#dycore.vertical_damping.VerticalDamping" title="dycore.vertical_damping.VerticalDamping"><code class="xref py py-class docutils literal"><span class="pre">dycore.vertical_damping.VerticalDamping</span></code></a> for the available options.</li>
<li><strong>damp_depth</strong> (<cite>int</cite>, optional) – Number of vertical layers in the damping region. Default is 15.</li>
<li><strong>damp_max</strong> (<cite>float</cite>, optional) – Maximum value for the damping coefficient. Default is 0.0002.</li>
<li><strong>smooth_on</strong> (<cite>bool</cite>, optional) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if numerical smoothing is enabled, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise. Default is <code class="xref py py-obj docutils literal"><span class="pre">True</span></code>.</li>
<li><strong>smooth_type</strong> (<cite>str</cite>, optional) – String specifying the smoothing technique to implement. Default is ‘first-order’.
See <a class="reference internal" href="#dycore.horizontal_smoothing.HorizontalSmoothing" title="dycore.horizontal_smoothing.HorizontalSmoothing"><code class="xref py py-class docutils literal"><span class="pre">dycore.horizontal_smoothing.HorizontalSmoothing</span></code></a> for the available options.</li>
<li><strong>smooth_damp_depth</strong> (<cite>int</cite>, optional) – Number of vertical layers in the smoothing damping region. Default is 10.</li>
<li><strong>smooth_coeff</strong> (<cite>float</cite>, optional) – Smoothing coefficient. Default is 0.03.</li>
<li><strong>smooth_coeff_max</strong> (<cite>float</cite>, optional) – Maximum value for the smoothing coefficient. Default is 0.24.
See <a class="reference internal" href="#dycore.horizontal_smoothing.HorizontalSmoothing" title="dycore.horizontal_smoothing.HorizontalSmoothing"><code class="xref py py-class docutils literal"><span class="pre">HorizontalSmoothing</span></code></a> for further details.</li>
<li><strong>smooth_moist_on</strong> (<cite>bool</cite>, optional) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if numerical smoothing on water constituents is enabled, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise. Default is <code class="xref py py-obj docutils literal"><span class="pre">True</span></code>.</li>
<li><strong>smooth_moist_type</strong> (<cite>str</cite>, optional) – String specifying the smoothing technique to apply to the water constituents. Default is ‘first-order’.
See <a class="reference internal" href="#dycore.horizontal_smoothing.HorizontalSmoothing" title="dycore.horizontal_smoothing.HorizontalSmoothing"><code class="xref py py-class docutils literal"><span class="pre">dycore.horizontal_smoothing.HorizontalSmoothing</span></code></a> for the available options.</li>
<li><strong>smooth_moist_damp_depth</strong> (<cite>int</cite>, optional) – Number of vertical layers in the smoothing damping region for the water constituents. Default is 10.</li>
<li><strong>smooth_coeff_moist</strong> (<cite>float</cite>, optional) – Smoothing coefficient for the water constituents. Default is 0.03.</li>
<li><strong>smooth_coeff_moist_max</strong> (<cite>float</cite>, optional) – Maximum value for the smoothing coefficient for the water constituents. Default is 0.24.
See <a class="reference internal" href="#dycore.horizontal_smoothing.HorizontalSmoothing" title="dycore.horizontal_smoothing.HorizontalSmoothing"><code class="xref py py-class docutils literal"><span class="pre">HorizontalSmoothing</span></code></a> for further details.</li>
<li><strong>physics_dynamics_coupling_on</strong> (<cite>bool</cite>, optional) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> to couple physics with dynamics, i.e., to account for the change over time in potential temperature,
<code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise. Default is <code class="xref py py-obj docutils literal"><span class="pre">False</span></code>.</li>
<li><strong>sedimentation_on</strong> (<cite>bool</cite>, optional) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> to account for rain sedimentation, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise. Default is <code class="xref py py-obj docutils literal"><span class="pre">False</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.dycore_isentropic.DynamicalCoreIsentropic._carry_out_large_timestep_dry">
<code class="descname">_carry_out_large_timestep_dry</code><span class="sig-paren">(</span><em>dt</em>, <em>state</em>, <em>diagnostics</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.dycore_isentropic.DynamicalCoreIsentropic._carry_out_large_timestep_dry" title="Permalink to this definition">¶</a></dt>
<dd><p>Method advancing the dry isentropic state by a single time step.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the time step.</li>
<li><strong>state</strong> (<em>obj</em>) – <p><a class="reference internal" href="#storages.state_isentropic.StateIsentropic" title="storages.state_isentropic.StateIsentropic"><code class="xref py py-class docutils literal"><span class="pre">StateIsentropic</span></code></a> representing the current state.
It should contain the following variables:</p>
<ul>
<li>air_isentropic_density (unstaggered);</li>
<li>x_velocity (<span class="math">\(x\)</span>-staggered);</li>
<li>x_momentum_isentropic (unstaggered);</li>
<li>y_velocity (<span class="math">\(y\)</span>-staggered);</li>
<li>y_momentum_isentropic (unstaggered);</li>
<li>air_pressure (<span class="math">\(z\)</span>-staggered);</li>
<li>montgomery_potential (unstaggered).</li>
</ul>
</li>
<li><strong>diagnostics</strong> (<cite>obj</cite>, optional) – <a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> storing possibly required diagnostics.
By the time being, it is not actually used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p><a class="reference internal" href="#storages.state_isentropic.StateIsentropic" title="storages.state_isentropic.StateIsentropic"><code class="xref py py-class docutils literal"><span class="pre">StateIsentropic</span></code></a> representing the state at the next time level.
It contains the following variables:</p>
<ul class="simple">
<li>air_isentropic_density (unstaggered);</li>
<li>x_velocity (<span class="math">\(x\)</span>-staggered);</li>
<li>x_momentum_isentropic (unstaggered);</li>
<li>y_velocity (<span class="math">\(y\)</span>-staggered);</li>
<li>y_momentum_isentropic (unstaggered);</li>
<li>air_pressure (<span class="math">\(z\)</span>-staggered);</li>
<li>exner_function (<span class="math">\(z\)</span>-staggered);</li>
<li>montgomery_potential (unstaggered);</li>
<li>height (<span class="math">\(z\)</span>-staggered).</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.dycore_isentropic.DynamicalCoreIsentropic._carry_out_large_timestep_moist">
<code class="descname">_carry_out_large_timestep_moist</code><span class="sig-paren">(</span><em>dt</em>, <em>state</em>, <em>diagnostics</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.dycore_isentropic.DynamicalCoreIsentropic._carry_out_large_timestep_moist" title="Permalink to this definition">¶</a></dt>
<dd><p>Method advancing the moist isentropic state by a single time step.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the time step.</li>
<li><strong>state</strong> (<em>obj</em>) – <p><a class="reference internal" href="#storages.state_isentropic.StateIsentropic" title="storages.state_isentropic.StateIsentropic"><code class="xref py py-class docutils literal"><span class="pre">StateIsentropic</span></code></a> representing the current state.
It should contain the following variables:</p>
<ul>
<li>air_isentropic_density (unstaggered);</li>
<li>x_velocity (<span class="math">\(x\)</span>-staggered);</li>
<li>x_momentum_isentropic (unstaggered);</li>
<li>y_velocity (<span class="math">\(y\)</span>-staggered);</li>
<li>y_momentum_isentropic (unstaggered);</li>
<li>air_pressure (<span class="math">\(z\)</span>-staggered);</li>
<li>montgomery_potential (unstaggered);</li>
<li>mass_fraction_of_water_vapor_in_air (unstaggered);</li>
<li>mass_fraction_of_cloud_liquid_water_in_air (unstaggered);</li>
<li>mass_fraction_of_precipitation_water_in_air (unstaggered).</li>
</ul>
</li>
<li><strong>diagnostics</strong> (<cite>obj</cite>, optional) – <p><a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> storing possibly required diagnostics, namely:</p>
<ul>
<li>change_over_time_in_air_potential_temperature (unstaggered).</li>
</ul>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p><a class="reference internal" href="#storages.state_isentropic.StateIsentropic" title="storages.state_isentropic.StateIsentropic"><code class="xref py py-class docutils literal"><span class="pre">StateIsentropic</span></code></a> representing the state at the next time level.
It contains the following variables:</p>
<ul class="simple">
<li>air_isentropic_density (unstaggered);</li>
<li>x_velocity (<span class="math">\(x\)</span>-staggered);</li>
<li>x_momentum_isentropic (unstaggered);</li>
<li>y_velocity (<span class="math">\(y\)</span>-staggered);</li>
<li>y_momentum_isentropic (unstaggered);</li>
<li>air_pressure (<span class="math">\(z\)</span>-staggered);</li>
<li>exner_function (<span class="math">\(z\)</span>-staggered);</li>
<li>montgomery_potential (unstaggered);</li>
<li>height (<span class="math">\(z\)</span>-staggered);</li>
<li>mass_fraction_of_water_vapor_in_air (unstaggered);</li>
<li>mass_fraction_of_cloud_liquid_water_in_air (unstaggered);</li>
<li>mass_fraction_of_precipitation_water_in_air (unstaggered);</li>
<li>air_density (unstaggered, only if cloud microphysics is switched on);</li>
<li>air_temperature (unstaggered, only if cloud microphysics is switched on).</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.dycore_isentropic.DynamicalCoreIsentropic.get_initial_state">
<code class="descname">get_initial_state</code><span class="sig-paren">(</span><em>initial_time</em>, <em>initial_state_type</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.dycore_isentropic.DynamicalCoreIsentropic.get_initial_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the initial state, based on the identifier <code class="xref py py-data docutils literal"><span class="pre">initial_state_type</span></code>. Particularly:</p>
<ul>
<li><p class="first">if <code class="xref py py-data docutils literal"><span class="pre">initial_state_type</span> <span class="pre">==</span> <span class="pre">0</span></code>:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(u(x, \, y, \, \theta, \, 0) = u_0\)</span> and <span class="math">\(v(x, \, y, \, \theta, \, 0) = v_0\)</span>;</li>
<li>the Exner function, the pressure, the Montgomery potential, the height of the isentropes,                             and the isentropic density are derived from the Brunt-Vaisala frequency <span class="math">\(N\)</span>;</li>
<li>the mass fraction of water vapor is derived from the relative humidity, which is horizontally uniform                                 and different from zero only in a band close to the surface;</li>
<li>the mass fraction of cloud water and precipitation water is zero;</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">if <code class="xref py py-data docutils literal"><span class="pre">initial_state_type</span> <span class="pre">==</span> <span class="pre">1</span></code>:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(u(x, \, y, \, \theta, \, 0) = u_0\)</span> and <span class="math">\(v(x, \, y, \, \theta, \, 0) = v_0\)</span>;</li>
<li>the Exner function, the pressure, the Montgomery potential, the height of the isentropes,                             and the isentropic density are derived from the Brunt-Vaisala frequency <span class="math">\(N\)</span>;</li>
<li>the mass fraction of water vapor is derived from the relative humidity, which is sinusoidal in the                            <span class="math">\(x\)</span>-direction and uniform in the <span class="math">\(y\)</span>-direction, and different from zero only in a band                              close to the surface;</li>
<li>the mass fraction of cloud water and precipitation water is zero.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">if <code class="xref py py-data docutils literal"><span class="pre">initial_state_type</span> <span class="pre">==</span> <span class="pre">2</span></code>:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(u(x, \, y, \, \theta, \, 0) = u_0\)</span> and <span class="math">\(v(x, \, y, \, \theta, \, 0) = v_0\)</span>;</li>
<li><span class="math">\(T(x, \, y, \, \theta, \, 0) = T_0\)</span>.</li>
</ul>
</div></blockquote>
</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>initial_time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.datetime</span></code> representing the initial simulation time.</li>
<li><strong>case</strong> (<em>int</em>) – Identifier.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first simple">
<li><strong>x_velocity_initial</strong> (<em>float</em>) – The initial, uniform <span class="math">\(x\)</span>-velocity <span class="math">\(u_0\)</span>. Default is <span class="math">\(10 m s^{-1}\)</span>.</li>
<li><strong>y_velocity_initial</strong> (<em>float</em>) – The initial, uniform <span class="math">\(y\)</span>-velocity <span class="math">\(v_0\)</span>. Default is <span class="math">\(0 m s^{-1}\)</span>.</li>
<li><strong>brunt_vaisala_initial</strong> (<em>float</em>) – If <code class="xref py py-data docutils literal"><span class="pre">initial_state_type</span> <span class="pre">==</span> <span class="pre">0</span></code>, the uniform Brunt-Vaisala frequence <span class="math">\(N\)</span>. Default is <span class="math">\(0.01\)</span>.</li>
<li><strong>temperature_initial</strong> (<em>float</em>) – If <code class="xref py py-data docutils literal"><span class="pre">initial_state_type</span> <span class="pre">==</span> <span class="pre">1</span></code>, the uniform initial temperature <span class="math">\(T_0\)</span>. Default is <span class="math">\(250 K\)</span>.</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p><a class="reference internal" href="#storages.state_isentropic.StateIsentropic" title="storages.state_isentropic.StateIsentropic"><code class="xref py py-class docutils literal"><span class="pre">StateIsentropic</span></code></a> representing the initial state.
It contains the following variables:</p>
<ul class="simple">
<li>air_density (unstaggered);</li>
<li>air_isentropic_density (unstaggered);</li>
<li>x_velocity (<span class="math">\(x\)</span>-staggered);</li>
<li>x_momentum_isentropic (unstaggered);</li>
<li>y_velocity (<span class="math">\(y\)</span>-staggered);</li>
<li>y_momentum_isentropic (unstaggered);</li>
<li>air_pressure (<span class="math">\(z\)</span>-staggered);</li>
<li>exner_function (<span class="math">\(z\)</span>-staggered);</li>
<li>montgomery_potential (unstaggered);</li>
<li>height (<span class="math">\(z\)</span>-staggered);</li>
<li>air_temperature (unstaggered);</li>
<li>mass_fraction_of_water_vapor_in_air (unstaggered, optional);</li>
<li>mass_fraction_of_cloud_liquid_water_in_air (unstaggered, optional);</li>
<li>mass_fraction_of_precipitation_water_in_air (unstaggered, optional).</li>
</ul>
</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="lateral-boundary-conditions">
<h3>Lateral boundary conditions<a class="headerlink" href="#lateral-boundary-conditions" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="dycore.horizontal_boundary.HorizontalBoundary">
<em class="property">class </em><code class="descclassname">dycore.horizontal_boundary.</code><code class="descname">HorizontalBoundary</code><span class="sig-paren">(</span><em>grid</em>, <em>nb</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.HorizontalBoundary" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract base class whose derived classes implement different types of horizontal boundary conditions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><a class="reference internal" href="#dycore.prognostic_isentropic.PrognosticIsentropic.nb" title="dycore.prognostic_isentropic.PrognosticIsentropic.nb"><strong>nb</strong></a> (<em>int</em>) – Number of boundary layers.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="dycore.horizontal_boundary.HorizontalBoundary.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em>, <em>nb</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.HorizontalBoundary.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</li>
<li><strong>nb</strong> (<em>int</em>) – Number of boundary layers.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.HorizontalBoundary.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>phi_new</em>, <em>phi_now</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.HorizontalBoundary.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the boundary conditions on the field <code class="xref py py-attr docutils literal"><span class="pre">phi_new</span></code>, possibly relying upon the solution
<code class="xref py py-attr docutils literal"><span class="pre">phi_now</span></code> at the current time.
As this method is marked as abstract, its implementation is delegated to the derived classes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>phi_new</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field on which applying the boundary conditions.</li>
<li><strong>phi_now</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field at the current time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="dycore.horizontal_boundary.HorizontalBoundary.factory">
<em class="property">static </em><code class="descname">factory</code><span class="sig-paren">(</span><em>horizontal_boundary_type</em>, <em>grid</em>, <em>nb</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.HorizontalBoundary.factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Static method which returns an instance of the derived class which implements the boundary
conditions specified by <code class="xref py py-data docutils literal"><span class="pre">horizontal_boundary_type</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>horizontal_boundary_type</strong> (<em>str</em>) – <p>String specifying the type of boundary conditions to apply. Either:</p>
<blockquote>
<div><ul>
<li>’periodic’, for periodic boundary conditions;</li>
<li>’relaxed’, for relaxed boundary conditions;</li>
<li>’relaxed-symmetric-xz’, for relaxed boundary conditions for a <span class="math">\(xz\)</span>-symmetric field.</li>
<li>’relaxed-symmetric-yz’, for relaxed boundary conditions for a <span class="math">\(yz\)</span>-symmetric field.</li>
</ul>
</div></blockquote>
</li>
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</li>
<li><strong>nb</strong> (<em>int</em>) – Number of boundary layers.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An instance of the derived class implementing the boundary conditions specified by
<code class="xref py py-data docutils literal"><span class="pre">horizontal_boundary_type</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.HorizontalBoundary.from_computational_to_physical_domain">
<code class="descname">from_computational_to_physical_domain</code><span class="sig-paren">(</span><em>phi_</em>, <em>out_dims</em>, <em>change_sign</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.HorizontalBoundary.from_computational_to_physical_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the computational domain of a stencil, return the
associated physicalm field which may (or may not) satisfy the horizontal boundary conditions.
As this method is marked as abstract, its implementation is delegated to the derived classes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>phi</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the computational domain of a stencil.</li>
<li><strong>out_dims</strong> (<em>tuple</em>) – Tuple of the output array dimensions.</li>
<li><strong>change_sign</strong> (<em>bool</em>) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if the field should change sign through the symmetry plane (if any), <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field defined over the physical domain.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array_like</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.HorizontalBoundary.from_physical_to_computational_domain">
<code class="descname">from_physical_to_computational_domain</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.HorizontalBoundary.from_physical_to_computational_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing a physical field, return the associated stencils’ computational
domain, i.e., the <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> (accomodating the boundary conditions) which will be input
to the stencils. If the physical and computational fields coincide, a deep copy of the physical
domain is returned.
As this method is marked as abstract, its implementation is delegated to the derived classes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the physical field.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The implementation should be designed to work with both staggered and unstaggared fields.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.HorizontalBoundary.set_outermost_layers_x">
<code class="descname">set_outermost_layers_x</code><span class="sig-paren">(</span><em>phi_new</em>, <em>phi_now</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.HorizontalBoundary.set_outermost_layers_x" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the outermost layers of <code class="xref py py-obj docutils literal"><span class="pre">phi_new</span></code> in the <span class="math">\(x\)</span>- (i.e., <code class="xref py py-obj docutils literal"><span class="pre">i</span></code>-) direction so to satisfy
the lateral boundary conditions. For this, possibly rely upon the field <code class="xref py py-obj docutils literal"><span class="pre">phi_now</span></code> at the current time.
As this method is marked as abstract, its implementation is delegated to the derived classes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>phi_new</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field on which applying the boundary conditions.</li>
<li><strong>phi_now</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field at the current time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.HorizontalBoundary.set_outermost_layers_y">
<code class="descname">set_outermost_layers_y</code><span class="sig-paren">(</span><em>phi_new</em>, <em>phi_now</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.HorizontalBoundary.set_outermost_layers_y" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the outermost layers of <code class="xref py py-obj docutils literal"><span class="pre">phi_new</span></code> in the <span class="math">\(y\)</span>- (i.e., <code class="xref py py-obj docutils literal"><span class="pre">j</span></code>-) direction so to satisfy
the lateral boundary conditions. For this, possibly rely upon the field <code class="xref py py-obj docutils literal"><span class="pre">phi_now</span></code> at the current time.
As this method is marked as abstract, its implementation is delegated to the derived classes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>phi_new</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field on which applying the boundary conditions.</li>
<li><strong>phi_now</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field at the current time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="dycore.horizontal_boundary.Periodic">
<em class="property">class </em><code class="descclassname">dycore.horizontal_boundary.</code><code class="descname">Periodic</code><span class="sig-paren">(</span><em>grid</em>, <em>nb</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Periodic" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#dycore.horizontal_boundary.HorizontalBoundary" title="dycore.horizontal_boundary.HorizontalBoundary"><code class="xref py py-class docutils literal"><span class="pre">HorizontalBoundary</span></code></a> to implement horizontally periodic boundary conditions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><a class="reference internal" href="#dycore.prognostic_isentropic.PrognosticIsentropic.nb" title="dycore.prognostic_isentropic.PrognosticIsentropic.nb"><strong>nb</strong></a> (<em>int</em>) – Number of boundary layers.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="dycore.horizontal_boundary.Periodic.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em>, <em>nb</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Periodic.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</li>
<li><strong>nb</strong> (<em>int</em>) – Number of boundary layers.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.Periodic.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>phi_new</em>, <em>phi_now=None</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Periodic.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply horizontally periodic boundary conditions on <code class="xref py py-attr docutils literal"><span class="pre">phi_new</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>phi_new</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field on which applying the boundary conditions.</li>
<li><strong>phi_now</strong> (<cite>array_like</cite>, optional) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field at the current time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The argument <code class="xref py py-data docutils literal"><span class="pre">phi_now</span></code> is not required by the implementation, yet it is retained as optional
argument for compliancy with the class hierarchy interface.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.Periodic.from_computational_to_physical_domain">
<code class="descname">from_computational_to_physical_domain</code><span class="sig-paren">(</span><em>phi_</em>, <em>out_dims=None</em>, <em>change_sign=True</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Periodic.from_computational_to_physical_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Shrink the field <code class="xref py py-obj docutils literal"><span class="pre">phi_</span></code> by removing the <code class="xref py py-attr docutils literal"><span class="pre">nb</span></code> outermost layers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>phi</strong> (<em>array_like</em>) – The <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> to shrink.</li>
<li><strong>out_dims</strong> (<em>tuple</em>) – Tuple of the output array dimensions.</li>
<li><strong>change_sign</strong> (<em>bool</em>) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if the field should change sign through the symmetry plane (if any), <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The shrunk <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array_like</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The arguments <code class="xref py py-data docutils literal"><span class="pre">out_dims</span></code> and <code class="xref py py-data docutils literal"><span class="pre">change_sign</span></code> are not required by the implementation,
yet they are retained as optional arguments for compliancy with the class hierarchy interface.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.Periodic.from_physical_to_computational_domain">
<code class="descname">from_physical_to_computational_domain</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Periodic.from_physical_to_computational_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Periodically extend the field <code class="xref py py-obj docutils literal"><span class="pre">phi</span></code> with <code class="xref py py-attr docutils literal"><span class="pre">nb</span></code> extra layers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>array_like</em>) – The <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> to extend.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The extended <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.Periodic.set_outermost_layers_x">
<code class="descname">set_outermost_layers_x</code><span class="sig-paren">(</span><em>phi_new</em>, <em>phi_now=None</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Periodic.set_outermost_layers_x" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the outermost layers of <code class="xref py py-obj docutils literal"><span class="pre">phi_new</span></code> in the <code class="xref py py-obj docutils literal"><span class="pre">x</span></code>-direction so to satisfy the periodic
boundary conditions. For this, the field <code class="xref py py-obj docutils literal"><span class="pre">phi_now</span></code> at the current time is not required. Yet,
it appears as (default) argument for compliancy with the general API.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>phi_new</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field on which applying the boundary conditions.</li>
<li><strong>phi_now</strong> (<cite>array_like</cite>, optional) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field at the current time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The argument <code class="xref py py-data docutils literal"><span class="pre">phi_now</span></code> is not required by the implementation, yet it is retained as optional
argument for compliancy with the class hierarchy interface.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.Periodic.set_outermost_layers_y">
<code class="descname">set_outermost_layers_y</code><span class="sig-paren">(</span><em>phi_new</em>, <em>phi_now=None</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Periodic.set_outermost_layers_y" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the outermost layers of <code class="xref py py-obj docutils literal"><span class="pre">phi_new</span></code> in the <code class="xref py py-obj docutils literal"><span class="pre">y</span></code>-direction so to satisfy the periodic
boundary conditions. For this, the field <code class="xref py py-obj docutils literal"><span class="pre">phi_now</span></code> at the current time is not required. Yet,
it appears as (default) argument for compliancy with the general API.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>phi_new</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field on which applying the boundary conditions.</li>
<li><strong>phi_now</strong> (<cite>array_like</cite>, optional) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field at the current time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The argument <code class="xref py py-data docutils literal"><span class="pre">phi_now</span></code> is not required by the implementation, yet it is retained as optional
argument for compliancy with the class hierarchy interface.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="dycore.horizontal_boundary.PeriodicXZ">
<em class="property">class </em><code class="descclassname">dycore.horizontal_boundary.</code><code class="descname">PeriodicXZ</code><span class="sig-paren">(</span><em>grid</em>, <em>nb</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.PeriodicXZ" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#dycore.horizontal_boundary.HorizontalBoundary" title="dycore.horizontal_boundary.HorizontalBoundary"><code class="xref py py-class docutils literal"><span class="pre">HorizontalBoundary</span></code></a> to implement horizontally periodic boundary conditions for fields defined
on a computational domain consisting of only one grid point in the <span class="math">\(y\)</span>-direction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><a class="reference internal" href="#dycore.prognostic_isentropic.PrognosticIsentropic.nb" title="dycore.prognostic_isentropic.PrognosticIsentropic.nb"><strong>nb</strong></a> (<em>int</em>) – Number of boundary layers.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="dycore.horizontal_boundary.PeriodicXZ.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em>, <em>nb</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.PeriodicXZ.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</li>
<li><strong>nb</strong> (<em>int</em>) – Number of boundary layers.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.PeriodicXZ.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>phi_new</em>, <em>phi_now=None</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.PeriodicXZ.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply horizontally periodic boundary conditions on <code class="xref py py-attr docutils literal"><span class="pre">phi_new</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>phi_new</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field on which applying the boundary conditions.</li>
<li><strong>phi_now</strong> (<cite>array_like</cite>, optional) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field at the current time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The argument <code class="xref py py-data docutils literal"><span class="pre">phi_now</span></code> is not required by the implementation, yet it is retained as optional
argument for compliancy with the class hierarchy interface.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.PeriodicXZ.from_computational_to_physical_domain">
<code class="descname">from_computational_to_physical_domain</code><span class="sig-paren">(</span><em>phi_</em>, <em>out_dims=None</em>, <em>change_sign=True</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.PeriodicXZ.from_computational_to_physical_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the central <code class="xref py py-data docutils literal"><span class="pre">i-k</span></code>-slice of the input field <code class="xref py py-data docutils literal"><span class="pre">phi_</span></code>, removing the <code class="xref py py-attr docutils literal"><span class="pre">nb</span></code> outermost
layers in <code class="xref py py-data docutils literal"><span class="pre">i</span></code>-direction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>phi</strong> (<em>array_like</em>) – The <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> to shrink.</li>
<li><strong>out_dims</strong> (<em>tuple</em>) – Tuple of the output array dimensions.</li>
<li><strong>change_sign</strong> (<em>bool</em>) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if the field should change sign through the symmetry plane (if any), <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The shrunk <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array_like</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The arguments <code class="xref py py-data docutils literal"><span class="pre">out_dims</span></code> and <code class="xref py py-data docutils literal"><span class="pre">change_sign</span></code> are not required by the implementation,
yet they are retained as optional arguments for compliancy with the class hierarchy interface.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.PeriodicXZ.from_physical_to_computational_domain">
<code class="descname">from_physical_to_computational_domain</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.PeriodicXZ.from_physical_to_computational_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Periodically extend the field <code class="xref py py-obj docutils literal"><span class="pre">phi</span></code> with <code class="xref py py-attr docutils literal"><span class="pre">nb</span></code> extra layers in the <code class="xref py py-obj docutils literal"><span class="pre">j</span></code>-direction,
then repeat it <code class="xref py py-data docutils literal"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">nb</span> <span class="pre">+</span> <span class="pre">1</span></code> times along the <code class="xref py py-obj docutils literal"><span class="pre">i</span></code>-direction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>array_like</em>) – The <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> to extend.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The extended <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.PeriodicXZ.set_outermost_layers_x">
<code class="descname">set_outermost_layers_x</code><span class="sig-paren">(</span><em>phi_new</em>, <em>phi_now=None</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.PeriodicXZ.set_outermost_layers_x" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the outermost layers of <code class="xref py py-obj docutils literal"><span class="pre">phi_new</span></code> in the <code class="xref py py-obj docutils literal"><span class="pre">x</span></code>-direction so to satisfy the periodic
boundary conditions. For this, the field <code class="xref py py-obj docutils literal"><span class="pre">phi_now</span></code> at the current time is not required. Yet,
it appears as (default) argument for compliancy with the general API.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>phi_new</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field on which applying the boundary conditions.</li>
<li><strong>phi_now</strong> (<cite>array_like</cite>, optional) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field at the current time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The argument <code class="xref py py-data docutils literal"><span class="pre">phi_now</span></code> is not required by the implementation, yet it is retained as optional
argument for compliancy with the class hierarchy interface.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="dycore.horizontal_boundary.PeriodicYZ">
<em class="property">class </em><code class="descclassname">dycore.horizontal_boundary.</code><code class="descname">PeriodicYZ</code><span class="sig-paren">(</span><em>grid</em>, <em>nb</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.PeriodicYZ" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#dycore.horizontal_boundary.HorizontalBoundary" title="dycore.horizontal_boundary.HorizontalBoundary"><code class="xref py py-class docutils literal"><span class="pre">HorizontalBoundary</span></code></a> to implement horizontally periodic boundary conditions for fields
defined on a computational domain consisting of only one grid point in the <span class="math">\(x\)</span>-direction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><a class="reference internal" href="#dycore.prognostic_isentropic.PrognosticIsentropic.nb" title="dycore.prognostic_isentropic.PrognosticIsentropic.nb"><strong>nb</strong></a> (<em>int</em>) – Number of boundary layers.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="dycore.horizontal_boundary.PeriodicYZ.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em>, <em>nb</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.PeriodicYZ.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</li>
<li><strong>nb</strong> (<em>int</em>) – Number of boundary layers.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.PeriodicYZ.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>phi_new</em>, <em>phi_now=None</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.PeriodicYZ.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply horizontally periodic boundary conditions on <code class="xref py py-attr docutils literal"><span class="pre">phi_new</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>phi_new</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field on which applying the boundary conditions.</li>
<li><strong>phi_now</strong> (<cite>array_like</cite>, optional) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field at the current time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The argument <code class="xref py py-data docutils literal"><span class="pre">phi_now</span></code> is not required by the implementation, yet it is retained as optional
argument for compliancy with the class hierarchy interface.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.PeriodicYZ.from_computational_to_physical_domain">
<code class="descname">from_computational_to_physical_domain</code><span class="sig-paren">(</span><em>phi_</em>, <em>out_dims=None</em>, <em>change_sign=True</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.PeriodicYZ.from_computational_to_physical_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the central <code class="xref py py-data docutils literal"><span class="pre">j-k</span></code>-slice of the input field <code class="xref py py-data docutils literal"><span class="pre">phi_</span></code>, removing the <code class="xref py py-attr docutils literal"><span class="pre">nb</span></code> outermost
layers in <code class="xref py py-data docutils literal"><span class="pre">j</span></code>-direction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>phi</strong> (<em>array_like</em>) – The <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> to shrink.</li>
<li><strong>out_dims</strong> (<em>tuple</em>) – Tuple of the output array dimensions.</li>
<li><strong>change_sign</strong> (<em>bool</em>) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if the field should change sign through the symmetry plane (if any), <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The shrunk <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array_like</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The arguments <code class="xref py py-data docutils literal"><span class="pre">out_dims</span></code> and <code class="xref py py-data docutils literal"><span class="pre">change_sign</span></code> are not required by the implementation,
yet they are retained as optional arguments for compliancy with the class hierarchy interface.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.PeriodicYZ.from_physical_to_computational_domain">
<code class="descname">from_physical_to_computational_domain</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.PeriodicYZ.from_physical_to_computational_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Periodically extend the field <code class="xref py py-obj docutils literal"><span class="pre">phi</span></code> with <code class="xref py py-attr docutils literal"><span class="pre">nb</span></code> extra layers in the <code class="xref py py-obj docutils literal"><span class="pre">j</span></code>-direction,
then repeat it <code class="xref py py-data docutils literal"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">nb</span> <span class="pre">+</span> <span class="pre">1</span></code> times along the <code class="xref py py-obj docutils literal"><span class="pre">i</span></code>-direction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>array_like</em>) – The <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> to extend.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The extended <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.PeriodicYZ.set_outermost_layers_y">
<code class="descname">set_outermost_layers_y</code><span class="sig-paren">(</span><em>phi_new</em>, <em>phi_now=None</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.PeriodicYZ.set_outermost_layers_y" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the outermost layers of <code class="xref py py-obj docutils literal"><span class="pre">phi_new</span></code> in the <code class="xref py py-obj docutils literal"><span class="pre">y</span></code>-direction so to satisfy the periodic
boundary conditions. For this, the field <code class="xref py py-obj docutils literal"><span class="pre">phi_now</span></code> at the current time is not required. Yet,
it appears as (default) argument for compliancy with the general API.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>phi_new</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field on which applying the boundary conditions.</li>
<li><strong>phi_now</strong> (<cite>array_like</cite>, optional) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field at the current time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The argument <code class="xref py py-data docutils literal"><span class="pre">phi_now</span></code> is not required by the implementation, yet it is retained as optional
argument for compliancy with the class hierarchy interface.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="dycore.horizontal_boundary.Relaxed">
<em class="property">class </em><code class="descclassname">dycore.horizontal_boundary.</code><code class="descname">Relaxed</code><span class="sig-paren">(</span><em>grid</em>, <em>nb</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Relaxed" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#dycore.horizontal_boundary.HorizontalBoundary" title="dycore.horizontal_boundary.HorizontalBoundary"><code class="xref py py-class docutils literal"><span class="pre">HorizontalBoundary</span></code></a> to implement horizontally relaxed boundary conditions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference internal" href="#dycore.prognostic_isentropic.PrognosticIsentropic.nb" title="dycore.prognostic_isentropic.PrognosticIsentropic.nb"><strong>nb</strong></a> (<em>int</em>) – Number of boundary layers.</li>
<li><strong>nr</strong> (<em>int</em>) – Number of layers which will be affected by relaxation.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="dycore.horizontal_boundary.Relaxed.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em>, <em>nb</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Relaxed.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</li>
<li><strong>nb</strong> (<em>int</em>) – Number of boundary layers.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.Relaxed.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>phi_new</em>, <em>phi_now</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Relaxed.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply relaxed lateral boundary conditions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>phi_new</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field on which applying the boundary conditions.</li>
<li><strong>phi_now</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field at the current time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Dirichlet conditions at the boundaries are assumed to be time-independent, so that they
can be inferred from the solution at current time.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.Relaxed.from_computational_to_physical_domain">
<code class="descname">from_computational_to_physical_domain</code><span class="sig-paren">(</span><em>phi_</em>, <em>out_dims=None</em>, <em>change_sign=True</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Relaxed.from_computational_to_physical_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>As no extension is required to apply relaxed boundary conditions, return a deep copy of the
input field <code class="xref py py-obj docutils literal"><span class="pre">phi_</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>phi</strong> (<em>array_like</em>) – A <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a>.</li>
<li><strong>out_dims</strong> (<cite>tuple</cite>, optional) – Tuple of the output array dimensions.</li>
<li><strong>change_sign</strong> (<cite>bool</cite>, optional) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if the field should change sign through the symmetry plane, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A deep copy of <code class="xref py py-obj docutils literal"><span class="pre">phi_</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array_like</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The arguments <code class="xref py py-data docutils literal"><span class="pre">out_dims</span></code> and <code class="xref py py-data docutils literal"><span class="pre">change_sign</span></code> are not required by the implementation,
yet they are retained as optional arguments for compliancy with the class hierarchy interface.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.Relaxed.from_physical_to_computational_domain">
<code class="descname">from_physical_to_computational_domain</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Relaxed.from_physical_to_computational_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>As no extension is required to apply relaxed boundary conditions, return a deep copy of the
input field <code class="xref py py-obj docutils literal"><span class="pre">phi</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>array_like</em>) – A <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A deep copy of <code class="xref py py-obj docutils literal"><span class="pre">phi</span></code>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.Relaxed.set_outermost_layers_x">
<code class="descname">set_outermost_layers_x</code><span class="sig-paren">(</span><em>phi_new</em>, <em>phi_now</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Relaxed.set_outermost_layers_x" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the outermost layers of <code class="xref py py-obj docutils literal"><span class="pre">phi_new</span></code> in the <code class="xref py py-obj docutils literal"><span class="pre">x</span></code>-direction equal to the corresponding
layers of <code class="xref py py-obj docutils literal"><span class="pre">phi_now</span></code>. In other words, apply Dirichlet conditions in <code class="xref py py-obj docutils literal"><span class="pre">x</span></code>-direction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>phi_new</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field on which applying the boundary conditions.</li>
<li><strong>phi_now</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field at the current time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Dirichlet conditions at the boundaries are assumed to be time-independent, so that they
can be inferred from the solution at current time.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.Relaxed.set_outermost_layers_y">
<code class="descname">set_outermost_layers_y</code><span class="sig-paren">(</span><em>phi_new</em>, <em>phi_now</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.Relaxed.set_outermost_layers_y" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the outermost layers of <code class="xref py py-obj docutils literal"><span class="pre">phi_new</span></code> in the <code class="xref py py-obj docutils literal"><span class="pre">y</span></code>-direction equal to the corresponding
layers of <code class="xref py py-obj docutils literal"><span class="pre">phi_now</span></code>. In other words, apply Dirichelt conditions in <code class="xref py py-obj docutils literal"><span class="pre">y</span></code>-direction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>phi_new</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field on which applying the boundary conditions.</li>
<li><strong>phi_now</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field at the current time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Dirichlet conditions at the boundaries are assumed to be time-independent, so that they
can be inferred from the solution at current time.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="dycore.horizontal_boundary.RelaxedSymmetricXZ">
<em class="property">class </em><code class="descclassname">dycore.horizontal_boundary.</code><code class="descname">RelaxedSymmetricXZ</code><span class="sig-paren">(</span><em>grid</em>, <em>nb</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.RelaxedSymmetricXZ" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#dycore.horizontal_boundary.Relaxed" title="dycore.horizontal_boundary.Relaxed"><code class="xref py py-class docutils literal"><span class="pre">Relaxed</span></code></a> to implement horizontally relaxed boundary conditions
for fields symmetric with respect to the <span class="math">\(xz\)</span>-plane <span class="math">\(y = y_c = 0.5 (a_y + b_y)\)</span>,
where <span class="math">\(a_y\)</span> and <span class="math">\(b_y\)</span> denote the extremes of the domain in the <span class="math">\(y\)</span>-direction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference internal" href="#dycore.prognostic_isentropic.PrognosticIsentropic.nb" title="dycore.prognostic_isentropic.PrognosticIsentropic.nb"><strong>nb</strong></a> (<em>int</em>) – Number of boundary layers.</li>
<li><strong>nr</strong> (<em>int</em>) – Number of layers which will be affected by relaxation.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="dycore.horizontal_boundary.RelaxedSymmetricXZ.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em>, <em>nb</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.RelaxedSymmetricXZ.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</li>
<li><strong>nb</strong> (<em>int</em>) – Number of boundary layers.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.RelaxedSymmetricXZ.from_computational_to_physical_domain">
<code class="descname">from_computational_to_physical_domain</code><span class="sig-paren">(</span><em>phi_</em>, <em>out_dims</em>, <em>change_sign=False</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.RelaxedSymmetricXZ.from_computational_to_physical_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Mirror the computational domain with respect to the <span class="math">\(xz\)</span>-plane <span class="math">\(y = y_c\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>phi</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the computational domain of a stencil.</li>
<li><strong>out_dims</strong> (<em>tuple</em>) – Tuple of the output array dimensions.</li>
<li><strong>change_sign</strong> (<cite>bool</cite>, optional) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if the field should change sign through the symmetry plane, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.
Default is false.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field defined over the physical domain.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array_like</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.RelaxedSymmetricXZ.from_physical_to_computational_domain">
<code class="descname">from_physical_to_computational_domain</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.RelaxedSymmetricXZ.from_physical_to_computational_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <span class="math">\(y\)</span>-lowermost half of the domain. To accomodate symmetric conditions,
we retain (at least) <code class="xref py py-attr docutils literal"><span class="pre">nb</span></code> additional layers in the positive direction of the <span class="math">\(y\)</span>-axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the physical field.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="dycore.horizontal_boundary.RelaxedSymmetricYZ">
<em class="property">class </em><code class="descclassname">dycore.horizontal_boundary.</code><code class="descname">RelaxedSymmetricYZ</code><span class="sig-paren">(</span><em>grid</em>, <em>nb</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.RelaxedSymmetricYZ" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#dycore.horizontal_boundary.Relaxed" title="dycore.horizontal_boundary.Relaxed"><code class="xref py py-class docutils literal"><span class="pre">Relaxed</span></code></a> to implement horizontally relaxed boundary conditions
for fields symmetric with respect to the <span class="math">\(yz\)</span>-plane <span class="math">\(x = x_c = 0.5 (a_x + b_x)\)</span>,
where <span class="math">\(a_x\)</span> and <span class="math">\(b_x\)</span> denote the extremes of the domain in the <span class="math">\(x\)</span>-direction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference internal" href="#dycore.prognostic_isentropic.PrognosticIsentropic.nb" title="dycore.prognostic_isentropic.PrognosticIsentropic.nb"><strong>nb</strong></a> (<em>int</em>) – Number of boundary layers.</li>
<li><strong>nr</strong> (<em>int</em>) – Number of layers which will be affected by relaxation.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="dycore.horizontal_boundary.RelaxedSymmetricYZ.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em>, <em>nb</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.RelaxedSymmetricYZ.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</li>
<li><strong>nb</strong> (<em>int</em>) – Number of boundary layers.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.RelaxedSymmetricYZ.from_computational_to_physical_domain">
<code class="descname">from_computational_to_physical_domain</code><span class="sig-paren">(</span><em>phi_</em>, <em>out_dims</em>, <em>change_sign=False</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.RelaxedSymmetricYZ.from_computational_to_physical_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Mirror the computational domain with respect to the <span class="math">\(yz\)</span>-axis <span class="math">\(x = x_c\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>phi</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the computational domain of a stencil.</li>
<li><strong>out_dims</strong> (<em>tuple</em>) – Tuple of the output array dimensions.</li>
<li><strong>change_sign</strong> (<cite>bool</cite>, optional) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if the field should change sign through the symmetry plane, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.
Default is false.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field defined over the physical domain.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array_like</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_boundary.RelaxedSymmetricYZ.from_physical_to_computational_domain">
<code class="descname">from_physical_to_computational_domain</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_boundary.RelaxedSymmetricYZ.from_physical_to_computational_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <span class="math">\(x\)</span>-lowermost half of the domain. To accomodate symmetric conditions,
we retain (at least) <code class="xref py py-attr docutils literal"><span class="pre">nb</span></code> additional layers in the positive direction of the <span class="math">\(x\)</span>-axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the physical field.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="horizontal-smoothing">
<h3>Horizontal smoothing<a class="headerlink" href="#horizontal-smoothing" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothing">
<em class="property">class </em><code class="descclassname">dycore.horizontal_smoothing.</code><code class="descname">HorizontalSmoothing</code><span class="sig-paren">(</span><em>dims</em>, <em>grid</em>, <em>smooth_damp_depth</em>, <em>smooth_coeff</em>, <em>smooth_coeff_max</em>, <em>backend</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothing" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract base class whose derived classes apply horizontal numerical smoothing to a generic (prognostic)
field by means of a GT4Py’s stencil.</p>
<dl class="method">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothing.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>dims</em>, <em>grid</em>, <em>smooth_damp_depth</em>, <em>smooth_coeff</em>, <em>smooth_coeff_max</em>, <em>backend</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothing.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dims</strong> (<em>tuple</em>) – Tuple of the dimension of the arrays on which to apply numerical smoothing.</li>
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</li>
<li><strong>smooth_damp_depth</strong> (<em>int</em>) – Depth of the damping region, i.e., number of vertical layers in the damping region.</li>
<li><strong>smooth_coeff</strong> (<em>float</em>) – Value for the smoothing coefficient far from the top boundary.</li>
<li><strong>smooth_coeff_max</strong> (<em>float</em>) – Maximum value for the smoothing coefficient.</li>
<li><strong>backend</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode</span></code> specifying the backend for the GT4Py’s stencil implementing numerical smoothing.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothing.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothing.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply horizontal smoothing to a prognostic field.
As this method is marked as abstract, its implementation is delegated to the derived classes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field to filter.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the filtered field.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothing.factory">
<em class="property">static </em><code class="descname">factory</code><span class="sig-paren">(</span><em>smooth_type</em>, <em>dims</em>, <em>grid</em>, <em>smooth_damp_depth</em>, <em>smooth_coeff</em>, <em>smooth_coeff_max</em>, <em>backend</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothing.factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Static method returning an instance of the derived class implementing the smoothing technique
specified by <code class="xref py py-data docutils literal"><span class="pre">smooth_type</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>smooth_type</strong> (<em>string</em>) – <p>String specifying the smoothing technique to implement. Either:</p>
<ul>
<li>’first_order’, for first-order numerical smoothing;</li>
<li>’second_order’, for second-order numerical smoothing.</li>
</ul>
</li>
<li><strong>dims</strong> (<em>tuple</em>) – Tuple of the dimension of the arrays on which to apply numerical smoothing.</li>
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</li>
<li><strong>smooth_damp_depth</strong> (<em>int</em>) – Depth of the damping region, i.e., number of vertical layers in the damping region.</li>
<li><strong>smooth_coeff</strong> (<em>float</em>) – Value for the smoothing coefficient far from the top boundary.</li>
<li><strong>smooth_coeff_max</strong> (<em>float</em>) – Maximum value for the smoothing coefficient.</li>
<li><strong>backend</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode</span></code> specifying the backend for the GT4Py’s stencil implementing numerical
smoothing. Default is <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode.NUMPY</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Instance of the suitable derived class.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXYZ">
<em class="property">class </em><code class="descclassname">dycore.horizontal_smoothing.</code><code class="descname">HorizontalSmoothingFirstOrderXYZ</code><span class="sig-paren">(</span><em>dims</em>, <em>grid</em>, <em>smooth_damp_depth=10</em>, <em>smooth_coeff=0.03</em>, <em>smooth_coeff_max=0.24</em>, <em>backend=&lt;Mode.NUMPY: 4&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXYZ" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#dycore.horizontal_smoothing.HorizontalSmoothing" title="dycore.horizontal_smoothing.HorizontalSmoothing"><code class="xref py py-class docutils literal"><span class="pre">HorizontalSmoothing</span></code></a> to apply first-order numerical smoothing to
three-dimensional fields with at least three elements in each direction.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">An instance of this class should only be applied to fields whose dimensions match those specified at instantiation time.
Hence, one should use (at least) one instance per field shape.</p>
</div>
<dl class="method">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXYZ.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>dims</em>, <em>grid</em>, <em>smooth_damp_depth=10</em>, <em>smooth_coeff=0.03</em>, <em>smooth_coeff_max=0.24</em>, <em>backend=&lt;Mode.NUMPY: 4&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXYZ.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dims</strong> (<em>tuple</em>) – Tuple of the dimension of the arrays on which to apply numerical smoothing.</li>
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</li>
<li><strong>smooth_damp_depth</strong> (<cite>int</cite>, optional) – Depth of the damping region, i.e., number of vertical layers in the damping region. Default is 10.</li>
<li><strong>smooth_coeff</strong> (<cite>float</cite>, optional) – Value for the smoothing coefficient far from the top boundary. Default is 0.03.</li>
<li><strong>smooth_coeff_max</strong> (<cite>float</cite>, optional) – Maximum value for the smoothing coefficient. For the sake of numerical stability, it should not
exceed 0.25. Default is 0.24.</li>
<li><strong>backend</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode</span></code> specifying the backend for the GT4Py’s stencil implementing numerical
smoothing. Default is <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode.NUMPY</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To instantiate the class, please prefer the static method <code class="xref py py-meth docutils literal"><span class="pre">factor()</span></code>
of <a class="reference internal" href="#dycore.horizontal_smoothing.HorizontalSmoothing" title="dycore.horizontal_smoothing.HorizontalSmoothing"><code class="xref py py-class docutils literal"><span class="pre">HorizontalSmoothing</span></code></a>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXYZ._stencil_defs">
<code class="descname">_stencil_defs</code><span class="sig-paren">(</span><em>in_phi</em>, <em>gamma</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXYZ._stencil_defs" title="Permalink to this definition">¶</a></dt>
<dd><p>The GT4Py’s stencil applying first-order horizontal smoothing. A centered 5-points formula is used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>in_phi</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the input field to filter.</li>
<li><strong>gamma</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the smoothing coefficient.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the filtered output field.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXYZ._stencil_initialize">
<code class="descname">_stencil_initialize</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXYZ._stencil_initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the GT4Py’s stencil applying horizontal smoothing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field to filter.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXYZ.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXYZ.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply first-order horizontal smoothing to a prognostic field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field to filter.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the filtered field.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXZ">
<em class="property">class </em><code class="descclassname">dycore.horizontal_smoothing.</code><code class="descname">HorizontalSmoothingFirstOrderXZ</code><span class="sig-paren">(</span><em>dims</em>, <em>grid</em>, <em>smooth_damp_depth=10</em>, <em>smooth_coeff=0.03</em>, <em>smooth_coeff_max=0.49</em>, <em>backend=&lt;Mode.NUMPY: 4&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXZ" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#dycore.horizontal_smoothing.HorizontalSmoothing" title="dycore.horizontal_smoothing.HorizontalSmoothing"><code class="xref py py-class docutils literal"><span class="pre">HorizontalSmoothing</span></code></a> to apply first-order numerical smoothing to
three-dimensional fields with only one element in the <span class="math">\(y\)</span>-direction.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">An instance of this class should only be applied to fields whose dimensions match those specified at instantiation time.
Hence, one should use (at least) one instance per field shape.</p>
</div>
<dl class="method">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXZ.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>dims</em>, <em>grid</em>, <em>smooth_damp_depth=10</em>, <em>smooth_coeff=0.03</em>, <em>smooth_coeff_max=0.49</em>, <em>backend=&lt;Mode.NUMPY: 4&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXZ.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dims</strong> (<em>tuple</em>) – Tuple of the dimension of the arrays on which to apply numerical smoothing.</li>
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</li>
<li><strong>smooth_damp_depth</strong> (<cite>int</cite>, optional) – Depth of the damping region, i.e., number of vertical layers in the damping region. Default is 10.</li>
<li><strong>smooth_coeff</strong> (<cite>float</cite>, optional) – Value for the smoothing coefficient far from the top boundary. Default is 0.03.</li>
<li><strong>smooth_coeff_max</strong> (<cite>float</cite>, optional) – Maximum value for the smoothing coefficient. For the sake of numerical stability, it should not
exceed 0.5. Default is 0.49.</li>
<li><strong>backend</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode</span></code> specifying the backend for the GT4Py’s stencil implementing numerical
smoothing. Default is <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode.NUMPY</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXZ._stencil_defs">
<code class="descname">_stencil_defs</code><span class="sig-paren">(</span><em>in_phi</em>, <em>gamma</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXZ._stencil_defs" title="Permalink to this definition">¶</a></dt>
<dd><p>The GT4Py’s stencil applying horizontal smoothing. A standard centered 3-points formula is used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>in_phi</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the input field to filter.</li>
<li><strong>gamma</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the smoothing coefficient.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the filtered output field.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXZ._stencil_initialize">
<code class="descname">_stencil_initialize</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXZ._stencil_initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the GT4Py’s stencil applying horizontal smoothing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field to filter.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXZ.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXZ.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply first-order horizontal smoothing to a prognostic field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field to filter.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the filtered field.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderYZ">
<em class="property">class </em><code class="descclassname">dycore.horizontal_smoothing.</code><code class="descname">HorizontalSmoothingFirstOrderYZ</code><span class="sig-paren">(</span><em>dims</em>, <em>grid</em>, <em>smooth_damp_depth=10</em>, <em>smooth_coeff=0.03</em>, <em>smooth_coeff_max=0.49</em>, <em>backend=&lt;Mode.NUMPY: 4&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderYZ" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#dycore.horizontal_smoothing.HorizontalSmoothing" title="dycore.horizontal_smoothing.HorizontalSmoothing"><code class="xref py py-class docutils literal"><span class="pre">HorizontalSmoothing</span></code></a> to apply first-order numerical smoothing to
three-dimensional fields with only one element in the <span class="math">\(x\)</span>-direction.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">An instance of this class should only be applied to fields whose dimensions match those specified at instantiation time.
Hence, one should use (at least) one instance per field shape.</p>
</div>
<dl class="method">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderYZ.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>dims</em>, <em>grid</em>, <em>smooth_damp_depth=10</em>, <em>smooth_coeff=0.03</em>, <em>smooth_coeff_max=0.49</em>, <em>backend=&lt;Mode.NUMPY: 4&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderYZ.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dims</strong> (<em>tuple</em>) – Tuple of the dimension of the arrays on which to apply numerical smoothing.</li>
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</li>
<li><strong>smooth_damp_depth</strong> (<em>int</em>) – Depth of the damping region, i.e., number of vertical layers in the damping region. Default is 10.</li>
<li><strong>smooth_coeff</strong> (<em>float</em>) – Value for the smoothing coefficient far from the top boundary. Default is 0.03.</li>
<li><strong>smooth_coeff_max</strong> (<em>float</em>) – Maximum value for the smoothing coefficient. For the sake of numerical stability, it should not
exceed 0.5. Default is 0.49.</li>
<li><strong>backend</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode</span></code> specifying the backend for the GT4Py’s stencil implementing numerical
smoothing. Default is <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode.NUMPY</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderYZ._stencil_defs">
<code class="descname">_stencil_defs</code><span class="sig-paren">(</span><em>in_phi</em>, <em>gamma</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderYZ._stencil_defs" title="Permalink to this definition">¶</a></dt>
<dd><p>The GT4Py’s stencil applying horizontal smoothing. A standard centered 3-points formula is used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>in_phi</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the input field to filter.</li>
<li><strong>gamma</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the smoothing coefficient.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the filtered output field.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderYZ._stencil_initialize">
<code class="descname">_stencil_initialize</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderYZ._stencil_initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the GT4Py’s stencil applying horizontal smoothing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field to filter.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderYZ.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderYZ.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply first-order horizontal smoothing to a prognostic field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field to filter.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the filtered field.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXYZ">
<em class="property">class </em><code class="descclassname">dycore.horizontal_smoothing.</code><code class="descname">HorizontalSmoothingSecondOrderXYZ</code><span class="sig-paren">(</span><em>dims</em>, <em>grid</em>, <em>smooth_damp_depth=10</em>, <em>smooth_coeff=0.03</em>, <em>smooth_coeff_max=0.24</em>, <em>backend=&lt;Mode.NUMPY: 4&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXYZ" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#dycore.horizontal_smoothing.HorizontalSmoothing" title="dycore.horizontal_smoothing.HorizontalSmoothing"><code class="xref py py-class docutils literal"><span class="pre">HorizontalSmoothing</span></code></a> to apply second-order numerical smoothing to
three-dimensional fields.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">An instance of this class should only be applied to fields whose dimensions match those specified at instantiation time.
Hence, one should use (at least) one instance per field shape.</p>
</div>
<dl class="method">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXYZ.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>dims</em>, <em>grid</em>, <em>smooth_damp_depth=10</em>, <em>smooth_coeff=0.03</em>, <em>smooth_coeff_max=0.24</em>, <em>backend=&lt;Mode.NUMPY: 4&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXYZ.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dims</strong> (<em>tuple</em>) – Tuple of the dimension of the arrays on which to apply numerical smoothing.</li>
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</li>
<li><strong>smooth_damp_depth</strong> (<cite>int</cite>, optional) – Depth of the damping region, i.e., number of vertical layers in the damping region. Default is 10.</li>
<li><strong>smooth_coeff</strong> (<cite>float</cite>, optional) – Value for the smoothing coefficient far from the top boundary. Default is 0.03.</li>
<li><strong>smooth_coeff_max</strong> (<cite>float</cite>, optional) – Maximum value for the smoothing coefficient. For the sake of numerical stability, it should not
exceed 0.25. Default is 0.24.</li>
<li><strong>backend</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode</span></code> specifying the backend for the GT4Py’s stencil implementing numerical
smoothing. Default is <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode.NUMPY</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXYZ._stencil_defs">
<code class="descname">_stencil_defs</code><span class="sig-paren">(</span><em>in_phi</em>, <em>gamma</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXYZ._stencil_defs" title="Permalink to this definition">¶</a></dt>
<dd><p>The GT4Py’s stencil applying horizontal smoothing. A standard centered 5-points formula is used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>in_phi</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the input field to filter.</li>
<li><strong>gamma</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the smoothing coefficient.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the filtered output field.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXYZ._stencil_initialize">
<code class="descname">_stencil_initialize</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXYZ._stencil_initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the GT4Py’s stencil applying horizontal smoothing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field to filter.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXYZ.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXYZ.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply second-order horizontal smoothing to a prognostic field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field to filter.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the filtered field.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXZ">
<em class="property">class </em><code class="descclassname">dycore.horizontal_smoothing.</code><code class="descname">HorizontalSmoothingSecondOrderXZ</code><span class="sig-paren">(</span><em>dims</em>, <em>grid</em>, <em>smooth_damp_depth=10</em>, <em>smooth_coeff=0.03</em>, <em>smooth_coeff_max=0.49</em>, <em>backend=&lt;Mode.NUMPY: 4&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXZ" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#dycore.horizontal_smoothing.HorizontalSmoothing" title="dycore.horizontal_smoothing.HorizontalSmoothing"><code class="xref py py-class docutils literal"><span class="pre">HorizontalSmoothing</span></code></a> to apply second-order numerical smoothing to
three-dimensional fields with only one element in the <span class="math">\(y\)</span>-direction.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">An instance of this class should only be applied to fields whose dimensions match those specified at instantiation time.
Hence, one should use (at least) one instance per field shape.</p>
</div>
<dl class="method">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXZ.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>dims</em>, <em>grid</em>, <em>smooth_damp_depth=10</em>, <em>smooth_coeff=0.03</em>, <em>smooth_coeff_max=0.49</em>, <em>backend=&lt;Mode.NUMPY: 4&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXZ.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dims</strong> (<em>tuple</em>) – Tuple of the dimension of the arrays on which to apply numerical smoothing.</li>
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</li>
<li><strong>smooth_damp_depth</strong> (<cite>int</cite>, optional) – Depth of the damping region, i.e., number of vertical layers in the damping region. Default is 10.</li>
<li><strong>smooth_coeff</strong> (<cite>float</cite>, optional) – Value for the smoothing coefficient far from the top boundary. Default is 0.03.</li>
<li><strong>smooth_coeff_max</strong> (<cite>float</cite>, optional) – Maximum value for the smoothing coefficient. For the sake of numerical stability, it should not
exceed 0.5. Default is 0.49.</li>
<li><strong>backend</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode</span></code> specifying the backend for the GT4Py’s stencil implementing numerical
smoothing. Default is <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode.NUMPY</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXZ._stencil_defs">
<code class="descname">_stencil_defs</code><span class="sig-paren">(</span><em>in_phi</em>, <em>gamma</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXZ._stencil_defs" title="Permalink to this definition">¶</a></dt>
<dd><p>The GT4Py’s stencil applying horizontal smoothing. A standard centered 5-points formula is used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>in_phi</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the input field to filter.</li>
<li><strong>gamma</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the smoothing coefficient.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the filtered output field.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXZ._stencil_initialize">
<code class="descname">_stencil_initialize</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXZ._stencil_initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the GT4Py’s stencil applying horizontal smoothing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field to filter.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXZ.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXZ.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply second-order horizontal smoothing to a prognostic field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field to filter.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the filtered field.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderYZ">
<em class="property">class </em><code class="descclassname">dycore.horizontal_smoothing.</code><code class="descname">HorizontalSmoothingSecondOrderYZ</code><span class="sig-paren">(</span><em>dims</em>, <em>grid</em>, <em>smooth_damp_depth=10</em>, <em>smooth_coeff=0.03</em>, <em>smooth_coeff_max=0.49</em>, <em>backend=&lt;Mode.NUMPY: 4&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderYZ" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#dycore.horizontal_smoothing.HorizontalSmoothing" title="dycore.horizontal_smoothing.HorizontalSmoothing"><code class="xref py py-class docutils literal"><span class="pre">HorizontalSmoothing</span></code></a> to apply second-order numerical smoothing to
three-dimensional fields with only one element in the <span class="math">\(x\)</span>-direction.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">An instance of this class should only be applied to fields whose dimensions match those specified at instantiation time.
Hence, one should use (at least) one instance per field shape.</p>
</div>
<dl class="method">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderYZ.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>dims</em>, <em>grid</em>, <em>smooth_damp_depth=10</em>, <em>smooth_coeff=0.03</em>, <em>smooth_coeff_max=0.49</em>, <em>backend=&lt;Mode.NUMPY: 4&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderYZ.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dims</strong> (<em>tuple</em>) – Tuple of the dimension of the arrays on which to apply numerical smoothing.</li>
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</li>
<li><strong>smooth_damp_depth</strong> (<cite>int</cite>, optional) – Depth of the damping region, i.e., number of vertical layers in the damping region. Default is 10.</li>
<li><strong>smooth_coeff</strong> (<cite>float</cite>, optional) – Value for the smoothing coefficient far from the top boundary. Default is 0.03.</li>
<li><strong>smooth_coeff_max</strong> (<cite>float</cite>, optional) – Maximum value for the smoothing coefficient. For the sake of numerical stability, it should not
exceed 0.5. Default is 0.49.</li>
<li><strong>backend</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode</span></code> specifying the backend for the GT4Py’s stencil implementing numerical
smoothing. Default is <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode.NUMPY</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderYZ._stencil_defs">
<code class="descname">_stencil_defs</code><span class="sig-paren">(</span><em>in_phi</em>, <em>gamma</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderYZ._stencil_defs" title="Permalink to this definition">¶</a></dt>
<dd><p>The GT4Py’s stencil applying horizontal smoothing. A standard centered 5-points formula is used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>in_phi</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the input field to filter.</li>
<li><strong>gamma</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the smoothing coefficient.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the filtered output field.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderYZ._stencil_initialize">
<code class="descname">_stencil_initialize</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderYZ._stencil_initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the GT4Py’s stencil applying horizontal smoothing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field to filter.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderYZ.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderYZ.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply second-order horizontal smoothing to a prognostic field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field to filter.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the filtered field.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="numerical-fluxes">
<h3>Numerical fluxes<a class="headerlink" href="#numerical-fluxes" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="dycore.flux_isentropic.FluxIsentropic">
<em class="property">class </em><code class="descclassname">dycore.flux_isentropic.</code><code class="descname">FluxIsentropic</code><span class="sig-paren">(</span><em>grid</em>, <em>moist_on</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic.FluxIsentropic" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract base class whose derived classes implement different schemes for computing the numerical fluxes for
the three-dimensional isentropic dynamical core. The conservative form of the governing equations is used.</p>
<dl class="method">
<dt id="dycore.flux_isentropic.FluxIsentropic.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em>, <em>moist_on</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic.FluxIsentropic.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grid</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> representing the underlying grid.</li>
<li><strong>moist_on</strong> (<em>bool</em>) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> for a moist dynamical core, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.flux_isentropic.FluxIsentropic._compute_horizontal_fluxes">
<code class="descname">_compute_horizontal_fluxes</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>dt</em>, <em>s_now</em>, <em>u_now</em>, <em>v_now</em>, <em>mtg_now</em>, <em>U_now</em>, <em>V_now</em>, <em>Qv_now</em>, <em>Qc_now</em>, <em>Qr_now</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic.FluxIsentropic._compute_horizontal_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Method computing the <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code>s_now representing the <span class="math">\(x\)</span>- and <span class="math">\(y\)</span>-fluxes for all
the conservative prognostic variables. The :class:<a href="#id4"><span class="problematic" id="id5">`</span></a>gridtools.Equation`s_now are then set as instance attributes.
As this method is marked as abstract, the implementation is delegated to the derived classes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>i</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(x\)</span>-axis.</li>
<li><strong>j</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(y\)</span>-axis.</li>
<li><strong>k</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(\theta\)</span>-axis.</li>
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Global</span></code> representing the time step.</li>
<li><strong>s_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density.</li>
<li><strong>u_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-velocity.</li>
<li><strong>v_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-velocity.</li>
<li><strong>mtg_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the Montgomery potential.</li>
<li><strong>U_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-momentum.</li>
<li><strong>V_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-momentum.</li>
<li><strong>Qv_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density of water vapour.</li>
<li><strong>Qc_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density of cloud water.</li>
<li><strong>Qr_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density of precipitation water.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.flux_isentropic.FluxIsentropic._compute_vertical_fluxes">
<code class="descname">_compute_vertical_fluxes</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>dt</em>, <em>w</em>, <em>s_now</em>, <em>s_prv</em>, <em>U_now</em>, <em>U_prv</em>, <em>V_now</em>, <em>V_prv</em>, <em>Qv_now</em>, <em>Qv_prv</em>, <em>Qc_now</em>, <em>Qc_prv</em>, <em>Qr_now</em>, <em>Qr_prv</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic.FluxIsentropic._compute_vertical_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Method computing the <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code>s_now representing the <span class="math">\(z\)</span>-flux for all the conservative
model variables. The :class:<a href="#id6"><span class="problematic" id="id7">`</span></a>gridtools.Equation`s_now are then set as instance attributes.
As this method is marked as abstract, the implementation is delegated to the derived classes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>i</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(x\)</span>-axis.</li>
<li><strong>j</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(y\)</span>-axis.</li>
<li><strong>k</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(\theta\)</span>-axis.</li>
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Global</span></code> representing the time step.</li>
<li><strong>w</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the vertical velocity, i.e., the change over time of potential temperature.</li>
<li><strong>s_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density.</li>
<li><strong>s_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density, i.e., the isentropic density stepped
disregarding the vertical advection.</li>
<li><strong>U_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current <span class="math">\(x\)</span>-momentum.</li>
<li><strong>U_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional <span class="math">\(x\)</span>-momentum, i.e., the <span class="math">\(x\)</span>-momentum stepped
disregarding the vertical advection.</li>
<li><strong>V_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current <span class="math">\(y\)</span>-momentum.</li>
<li><strong>V_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional <span class="math">\(y\)</span>-momentum, i.e., the <span class="math">\(y\)</span>-momentum stepped
disregarding the vertical advection.</li>
<li><strong>Qv_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density of water vapor.</li>
<li><strong>Qv_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density of water vapor,
i.e., the isentropic density of water vapor stepped disregarding the vertical advection.</li>
<li><strong>Qc_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density of cloud water.</li>
<li><strong>Qc_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density of cloud water,
i.e., the isentropic density of cloud water stepped disregarding the vertical advection.</li>
<li><strong>Qr_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density of precipitation water.</li>
<li><strong>Qr_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density of precipitation water,
i.e., the isentropic density of precipitation water stepped disregarding the vertical advection.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="dycore.flux_isentropic.FluxIsentropic.factory">
<em class="property">static </em><code class="descname">factory</code><span class="sig-paren">(</span><em>scheme</em>, <em>grid</em>, <em>moist_on</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic.FluxIsentropic.factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Static method which returns an instance of the derived class implementing the numerical scheme
specified by <code class="xref py py-data docutils literal"><span class="pre">scheme</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>scheme</strong> (<em>str</em>) – <p>String specifying the numerical scheme to implement. Either:</p>
<ul>
<li>’upwind’, for the upwind scheme;</li>
<li>’centered’, for a second-order centered scheme;</li>
<li>’maccormack’, for the MacCormack scheme.</li>
</ul>
</li>
<li><strong>grid</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> representing the underlying grid.</li>
<li><strong>moist_on</strong> (<em>bool</em>) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> for a moist dynamical core, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Instance of the derived class implementing the scheme specified by <code class="xref py py-data docutils literal"><span class="pre">scheme</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.flux_isentropic.FluxIsentropic.get_horizontal_fluxes">
<code class="descname">get_horizontal_fluxes</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>dt</em>, <em>s_now</em>, <em>u_now</em>, <em>v_now</em>, <em>mtg_now</em>, <em>U_now</em>, <em>V_now</em>, <em>Qv_now=None</em>, <em>Qc_now=None</em>, <em>Qr_now=None</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic.FluxIsentropic.get_horizontal_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Method returning the <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code>s_now representing the <span class="math">\(x\)</span>- and <span class="math">\(y\)</span>-fluxes
for all the conservative model variables.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(x\)</span>-axis.</li>
<li><strong>j</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(y\)</span>-axis.</li>
<li><strong>k</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(\theta\)</span>-axis.</li>
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Global</span></code> representing the time step.</li>
<li><strong>s_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density.</li>
<li><strong>u_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-velocity.</li>
<li><strong>v_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-velocity.</li>
<li><strong>mtg_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the Montgomery potential.</li>
<li><strong>U_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-momentum.</li>
<li><strong>V_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-momentum.</li>
<li><strong>Qv_now</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density of water vapour.</li>
<li><strong>Qc_now</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density of cloud water.</li>
<li><strong>Qr_now</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density of precipitation water.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>flux_s_x</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-flux for the isentropic density.</li>
<li><strong>flux_s_y</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-flux for the isentropic density.</li>
<li><strong>flux_U_x</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-flux for the <span class="math">\(x\)</span>-momentum.</li>
<li><strong>flux_U_y</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-flux for the <span class="math">\(x\)</span>-momentum.</li>
<li><strong>flux_V_x</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-flux for the <span class="math">\(y\)</span>-momentum.</li>
<li><strong>flux_V_y</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-flux for the <span class="math">\(y\)</span>-momentum.</li>
<li><strong>flux_Qv_x</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-flux for the isentropic density of water vapour.</li>
<li><strong>flux_Qv_y</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-flux for the isentropic density of water vapour.</li>
<li><strong>flux_Qc_x</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-flux for the isentropic density of cloud water.</li>
<li><strong>flux_Qc_y</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-flux for the isentropic density of cloud water.</li>
<li><strong>flux_Qr_x</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-flux for the isentropic density of precipitation water.</li>
<li><strong>flux_Qr_y</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-flux for the isentropic density of precipitation water.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.flux_isentropic.FluxIsentropic.get_vertical_fluxes">
<code class="descname">get_vertical_fluxes</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>dt</em>, <em>w</em>, <em>s_now</em>, <em>s_prv</em>, <em>U_now</em>, <em>U_prv</em>, <em>V_now</em>, <em>V_prv</em>, <em>Qv_now=None</em>, <em>Qv_prv=None</em>, <em>Qc_now=None</em>, <em>Qc_prv=None</em>, <em>Qr_now=None</em>, <em>Qr_prv=None</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic.FluxIsentropic.get_vertical_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Method returning the <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code>s_now representing the <span class="math">\(z\)</span>-flux for all the conservative
model variables.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(x\)</span>-axis.</li>
<li><strong>j</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(y\)</span>-axis.</li>
<li><strong>k</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(\theta\)</span>-axis.</li>
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Global</span></code> representing the time step.</li>
<li><strong>w</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the vertical velocity, i.e., the change over time of potential temperature.</li>
<li><strong>s_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density.</li>
<li><strong>s_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density, i.e., the isentropic density stepped
disregarding the vertical advection.</li>
<li><strong>U_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current <span class="math">\(x\)</span>-momentum.</li>
<li><strong>U_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional <span class="math">\(x\)</span>-momentum, i.e., the <span class="math">\(x\)</span>-momentum stepped
disregarding the vertical advection.</li>
<li><strong>V_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current <span class="math">\(y\)</span>-momentum.</li>
<li><strong>V_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional <span class="math">\(y\)</span>-momentum, i.e., the <span class="math">\(y\)</span>-momentum stepped
disregarding the vertical advection.</li>
<li><strong>Qv_now</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density of water vapor.</li>
<li><strong>Qv_prv</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density of water vapor,
i.e., the isentropic density of water vapor stepped disregarding the vertical advection.</li>
<li><strong>Qc_now</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density of cloud water.</li>
<li><strong>Qc_prv</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density of cloud water,
i.e., the isentropic density of cloud water stepped disregarding the vertical advection.</li>
<li><strong>Qr_now</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density of precipitation water.</li>
<li><strong>Qr_prv</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density of precipitation water,
i.e., the isentropic density of precipitation water stepped disregarding the vertical advection.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>flux_s_z</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(z\)</span>-flux for the isentropic density.</li>
<li><strong>flux_U_x</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(z\)</span>-flux for the <span class="math">\(x\)</span>-momentum.</li>
<li><strong>flux_V_x</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(z\)</span>-flux for the <span class="math">\(y\)</span>-momentum.</li>
<li><strong>flux_Qv_x</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(z\)</span>-flux for the isentropic density of water vapour.</li>
<li><strong>flux_Qc_x</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(z\)</span>-flux for the isentropic density of cloud water.</li>
<li><strong>flux_Qr_x</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(z\)</span>-flux for the isentropic density of precipitation water.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="dycore.flux_isentropic_upwind.FluxIsentropicUpwind">
<em class="property">class </em><code class="descclassname">dycore.flux_isentropic_upwind.</code><code class="descname">FluxIsentropicUpwind</code><span class="sig-paren">(</span><em>grid</em>, <em>moist_on</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_upwind.FluxIsentropicUpwind" title="Permalink to this definition">¶</a></dt>
<dd><p>Class which inherits <a class="reference internal" href="#dycore.flux_isentropic.FluxIsentropic" title="dycore.flux_isentropic.FluxIsentropic"><code class="xref py py-class docutils literal"><span class="pre">FluxIsentropic</span></code></a> to implement the upwind scheme to compute
the numerical fluxes for the governing equations expressed in conservative form using isentropic coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><a class="reference internal" href="#dycore.prognostic_isentropic.PrognosticIsentropic.nb" title="dycore.prognostic_isentropic.PrognosticIsentropic.nb"><strong>nb</strong></a> (<em>int</em>) – Number of boundary layers.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="dycore.flux_isentropic_upwind.FluxIsentropicUpwind.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em>, <em>moist_on</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_upwind.FluxIsentropicUpwind.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grid</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> representing the underlying grid.</li>
<li><strong>moist_on</strong> (<em>bool</em>) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> for a moist dynamical core, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.flux_isentropic_upwind.FluxIsentropicUpwind._compute_horizontal_fluxes">
<code class="descname">_compute_horizontal_fluxes</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>dt</em>, <em>s_now</em>, <em>u_now</em>, <em>v_now</em>, <em>mtg_now</em>, <em>U_now</em>, <em>V_now</em>, <em>Qv_now</em>, <em>Qc_now</em>, <em>Qr_now</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_upwind.FluxIsentropicUpwind._compute_horizontal_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Method computing the <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code>s_now representing the upwind <span class="math">\(x\)</span>- and <span class="math">\(y\)</span>-fluxes for all
the conservative prognostic variables. The :class:<a href="#id8"><span class="problematic" id="id9">`</span></a>gridtools.Equation`s_now are then set as instance attributes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>i</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(x\)</span>-axis.</li>
<li><strong>j</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(y\)</span>-axis.</li>
<li><strong>k</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(\theta\)</span>-axis.</li>
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Global</span></code> representing the time step.</li>
<li><strong>s_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density.</li>
<li><strong>u_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-velocity.</li>
<li><strong>v_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-velocity.</li>
<li><strong>mtg_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the Montgomery potential.</li>
<li><strong>U_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-momentum.</li>
<li><strong>V_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-momentum.</li>
<li><strong>Qv_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density of water vapour.</li>
<li><strong>Qc_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density of cloud water.</li>
<li><strong>Qr_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density of precipitation water.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.flux_isentropic_upwind.FluxIsentropicUpwind._compute_vertical_fluxes">
<code class="descname">_compute_vertical_fluxes</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>dt</em>, <em>w</em>, <em>s_now</em>, <em>s_prv</em>, <em>U_now</em>, <em>U_prv</em>, <em>V_now</em>, <em>V_prv</em>, <em>Qv_now</em>, <em>Qv_prv</em>, <em>Qc_now</em>, <em>Qc_prv</em>, <em>Qr_now</em>, <em>Qr_prv</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_upwind.FluxIsentropicUpwind._compute_vertical_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Method computing the <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code>s_now representing the upwind <span class="math">\(z\)</span>-flux for all the conservative
model variables. The :class:<a href="#id10"><span class="problematic" id="id11">`</span></a>gridtools.Equation`s_now are then set as instance attributes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>i</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(x\)</span>-axis.</li>
<li><strong>j</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(y\)</span>-axis.</li>
<li><strong>k</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(\theta\)</span>-axis.</li>
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Global</span></code> representing the time step.</li>
<li><strong>w</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the vertical velocity, i.e., the change over time of potential temperature.</li>
<li><strong>s_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density.</li>
<li><strong>s_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density, i.e., the isentropic density stepped
disregarding the vertical advection.</li>
<li><strong>U_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current <span class="math">\(x\)</span>-momentum.</li>
<li><strong>U_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional <span class="math">\(x\)</span>-momentum, i.e., the <span class="math">\(x\)</span>-momentum stepped
disregarding the vertical advection.</li>
<li><strong>V_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current <span class="math">\(y\)</span>-momentum.</li>
<li><strong>V_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional <span class="math">\(y\)</span>-momentum, i.e., the <span class="math">\(y\)</span>-momentum stepped
disregarding the vertical advection.</li>
<li><strong>Qv_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density of water vapor.</li>
<li><strong>Qv_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density of water vapor,
i.e., the isentropic density of water vapor stepped disregarding the vertical advection.</li>
<li><strong>Qc_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density of cloud water.</li>
<li><strong>Qc_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density of cloud water,
i.e., the isentropic density of cloud water stepped disregarding the vertical advection.</li>
<li><strong>Qr_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density of precipitation water.</li>
<li><strong>Qr_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density of precipitation water,
i.e., the isentropic density of precipitation water stepped disregarding the vertical advection.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.flux_isentropic_upwind.FluxIsentropicUpwind._get_upwind_flux_x">
<code class="descname">_get_upwind_flux_x</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>u</em>, <em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_upwind.FluxIsentropicUpwind._get_upwind_flux_x" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the upwind flux in <span class="math">\(x\)</span>-direction for a generic
prognostic variable <span class="math">\(\phi\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(x\)</span>-axis.</li>
<li><strong>j</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(y\)</span>-axis.</li>
<li><strong>k</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(\theta\)</span>-axis.</li>
<li><strong>u</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-velocity.</li>
<li><strong>phi</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the field <span class="math">\(\phi\)</span>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the upwind flux in <span class="math">\(x\)</span>-direction for <span class="math">\(\phi\)</span>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.flux_isentropic_upwind.FluxIsentropicUpwind._get_upwind_flux_y">
<code class="descname">_get_upwind_flux_y</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>v</em>, <em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_upwind.FluxIsentropicUpwind._get_upwind_flux_y" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the upwind flux in <span class="math">\(y\)</span>-direction for a generic
prognostic variable <span class="math">\(\phi\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(x\)</span>-axis.</li>
<li><strong>j</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(y\)</span>-axis.</li>
<li><strong>k</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(\theta\)</span>-axis.</li>
<li><strong>v</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-velocity.</li>
<li><strong>phi</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the field <span class="math">\(\phi\)</span>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the upwind flux in <span class="math">\(y\)</span>-direction for <span class="math">\(\phi\)</span>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.flux_isentropic_upwind.FluxIsentropicUpwind._get_upwind_flux_z">
<code class="descname">_get_upwind_flux_z</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>w_mid</em>, <em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_upwind.FluxIsentropicUpwind._get_upwind_flux_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the upwind flux in <span class="math">\(z\)</span>-direction for a generic
prognostic variable <span class="math">\(\phi\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(x\)</span>-axis.</li>
<li><strong>j</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(y\)</span>-axis.</li>
<li><strong>k</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(\theta\)</span>-axis.</li>
<li><strong>w_mid</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the vertical velocity, i.e., the change over time in
potential temperature, at the model half levels.</li>
<li><strong>phi</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the field <span class="math">\(\phi\)</span>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the upwind flux in <span class="math">\(z\)</span>-direction for <span class="math">\(\phi\)</span>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="dycore.flux_isentropic_centered.FluxIsentropicCentered">
<em class="property">class </em><code class="descclassname">dycore.flux_isentropic_centered.</code><code class="descname">FluxIsentropicCentered</code><span class="sig-paren">(</span><em>grid</em>, <em>moist_on</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_centered.FluxIsentropicCentered" title="Permalink to this definition">¶</a></dt>
<dd><p>Class which inherits <a class="reference internal" href="#dycore.flux_isentropic.FluxIsentropic" title="dycore.flux_isentropic.FluxIsentropic"><code class="xref py py-class docutils literal"><span class="pre">FluxIsentropic</span></code></a> to implement a centered scheme to compute
the numerical fluxes for the governing equations expressed in conservative form using isentropic coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><a class="reference internal" href="#dycore.prognostic_isentropic.PrognosticIsentropic.nb" title="dycore.prognostic_isentropic.PrognosticIsentropic.nb"><strong>nb</strong></a> (<em>int</em>) – Number of boundary layers.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="dycore.flux_isentropic_centered.FluxIsentropicCentered.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em>, <em>moist_on</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_centered.FluxIsentropicCentered.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grid</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> representing the underlying grid.</li>
<li><strong>moist_on</strong> (<em>bool</em>) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> for a moist dynamical core, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.flux_isentropic_centered.FluxIsentropicCentered._compute_horizontal_fluxes">
<code class="descname">_compute_horizontal_fluxes</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>dt</em>, <em>s_now</em>, <em>u_now</em>, <em>v_now</em>, <em>mtg_now</em>, <em>U_now</em>, <em>V_now</em>, <em>Qv_now</em>, <em>Qc_now</em>, <em>Qr_now</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_centered.FluxIsentropicCentered._compute_horizontal_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Method computing the <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code>s_now representing the centered <span class="math">\(x\)</span>- and <span class="math">\(y\)</span>-fluxes for all
the conservative prognostic variables. The :class:<a href="#id12"><span class="problematic" id="id13">`</span></a>gridtools.Equation`s_now are then set as instance attributes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>i</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(x\)</span>-axis.</li>
<li><strong>j</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(y\)</span>-axis.</li>
<li><strong>k</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(\theta\)</span>-axis.</li>
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Global</span></code> representing the time step.</li>
<li><strong>s_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density.</li>
<li><strong>u_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-velocity.</li>
<li><strong>v_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-velocity.</li>
<li><strong>mtg_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the Montgomery potential.</li>
<li><strong>U_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-momentum.</li>
<li><strong>V_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-momentum.</li>
<li><strong>Qv_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density of water vapour.</li>
<li><strong>Qc_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density of cloud water.</li>
<li><strong>Qr_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density of precipitation water.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.flux_isentropic_centered.FluxIsentropicCentered._compute_vertical_fluxes">
<code class="descname">_compute_vertical_fluxes</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>dt</em>, <em>w</em>, <em>s_now</em>, <em>s_prv</em>, <em>U_now</em>, <em>U_prv</em>, <em>V_now</em>, <em>V_prv</em>, <em>Qv_now</em>, <em>Qv_prv</em>, <em>Qc_now</em>, <em>Qc_prv</em>, <em>Qr_now</em>, <em>Qr_prv</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_centered.FluxIsentropicCentered._compute_vertical_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Method computing the <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code>s_now representing the centered <span class="math">\(z\)</span>-flux for all the conservative
model variables. The :class:<a href="#id14"><span class="problematic" id="id15">`</span></a>gridtools.Equation`s_now are then set as instance attributes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>i</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(x\)</span>-axis.</li>
<li><strong>j</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(y\)</span>-axis.</li>
<li><strong>k</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(\theta\)</span>-axis.</li>
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Global</span></code> representing the time step.</li>
<li><strong>w</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the vertical velocity, i.e., the change over time of potential temperature.</li>
<li><strong>s_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density.</li>
<li><strong>s_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density, i.e., the isentropic density stepped
disregarding the vertical advection.</li>
<li><strong>U_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current <span class="math">\(x\)</span>-momentum.</li>
<li><strong>U_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional <span class="math">\(x\)</span>-momentum, i.e., the <span class="math">\(x\)</span>-momentum stepped
disregarding the vertical advection.</li>
<li><strong>V_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current <span class="math">\(y\)</span>-momentum.</li>
<li><strong>V_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional <span class="math">\(y\)</span>-momentum, i.e., the <span class="math">\(y\)</span>-momentum stepped
disregarding the vertical advection.</li>
<li><strong>Qv_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density of water vapor.</li>
<li><strong>Qv_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density of water vapor,
i.e., the isentropic density of water vapor stepped disregarding the vertical advection.</li>
<li><strong>Qc_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density of cloud water.</li>
<li><strong>Qc_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density of cloud water,
i.e., the isentropic density of cloud water stepped disregarding the vertical advection.</li>
<li><strong>Qr_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density of precipitation water.</li>
<li><strong>Qr_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density of precipitation water,
i.e., the isentropic density of precipitation water stepped disregarding the vertical advection.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.flux_isentropic_centered.FluxIsentropicCentered._get_centered_flux_x">
<code class="descname">_get_centered_flux_x</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>u</em>, <em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_centered.FluxIsentropicCentered._get_centered_flux_x" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the centered flux in <span class="math">\(x\)</span>-direction for a generic
prognostic variable <span class="math">\(\phi\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(x\)</span>-axis.</li>
<li><strong>j</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(y\)</span>-axis.</li>
<li><strong>k</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(\theta\)</span>-axis.</li>
<li><strong>u</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-velocity.</li>
<li><strong>phi</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the field <span class="math">\(\phi\)</span>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the centered flux in <span class="math">\(x\)</span>-direction for <span class="math">\(\phi\)</span>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.flux_isentropic_centered.FluxIsentropicCentered._get_centered_flux_y">
<code class="descname">_get_centered_flux_y</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>v</em>, <em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_centered.FluxIsentropicCentered._get_centered_flux_y" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the centered flux in <span class="math">\(y\)</span>-direction for a generic
prognostic variable <span class="math">\(\phi\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(x\)</span>-axis.</li>
<li><strong>j</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(y\)</span>-axis.</li>
<li><strong>k</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(\theta\)</span>-axis.</li>
<li><strong>v</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-velocity.</li>
<li><strong>phi</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the field <span class="math">\(\phi\)</span>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the centered flux in <span class="math">\(y\)</span>-direction for <span class="math">\(\phi\)</span>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.flux_isentropic_centered.FluxIsentropicCentered._get_centered_flux_z">
<code class="descname">_get_centered_flux_z</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>w_mid</em>, <em>phi_now</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_centered.FluxIsentropicCentered._get_centered_flux_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the centered flux in <span class="math">\(z\)</span>-direction for a generic
prognostic variable <span class="math">\(\phi\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(x\)</span>-axis.</li>
<li><strong>j</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(y\)</span>-axis.</li>
<li><strong>k</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(\theta\)</span>-axis.</li>
<li><strong>w_mid</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the vertical velocity, i.e., the change over time in
potential temperature, at the model half levels.</li>
<li><strong>phi</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the field <span class="math">\(\phi\)</span>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the centered flux in <span class="math">\(z\)</span>-direction for <span class="math">\(\phi\)</span>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack">
<em class="property">class </em><code class="descclassname">dycore.flux_isentropic_maccormack.</code><code class="descname">FluxIsentropicMacCormack</code><span class="sig-paren">(</span><em>grid</em>, <em>moist_on</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack" title="Permalink to this definition">¶</a></dt>
<dd><p>Class which inherits <a class="reference internal" href="#dycore.flux_isentropic.FluxIsentropic" title="dycore.flux_isentropic.FluxIsentropic"><code class="xref py py-class docutils literal"><span class="pre">FluxIsentropic</span></code></a> to implement the MacCormack scheme to compute
the numerical fluxes for the governing equations expressed in conservative form using isentropic coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><a class="reference internal" href="#dycore.prognostic_isentropic.PrognosticIsentropic.nb" title="dycore.prognostic_isentropic.PrognosticIsentropic.nb"><strong>nb</strong></a> (<em>int</em>) – Number of boundary layers.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em>, <em>moist_on</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grid</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> representing the underlying grid.</li>
<li><strong>moist_on</strong> (<em>bool</em>) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> for a moist dynamical core, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._compute_horizontal_fluxes">
<code class="descname">_compute_horizontal_fluxes</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>dt</em>, <em>s_now</em>, <em>u_now</em>, <em>v_now</em>, <em>mtg_now</em>, <em>U_now</em>, <em>V_now</em>, <em>Qv_now</em>, <em>Qc_now</em>, <em>Qr_now</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._compute_horizontal_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Method computing the <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code>s_now representing the MacCormack <span class="math">\(x\)</span>- and <span class="math">\(y\)</span>-fluxes for all
the conservative prognostic variables. The :class:<a href="#id16"><span class="problematic" id="id17">`</span></a>gridtools.Equation`s_now are then set as instance attributes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>i</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(x\)</span>-axis.</li>
<li><strong>j</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(y\)</span>-axis.</li>
<li><strong>k</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(\theta\)</span>-axis.</li>
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Global</span></code> representing the time step.</li>
<li><strong>s_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density.</li>
<li><strong>u_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-velocity.</li>
<li><strong>v_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-velocity.</li>
<li><strong>mtg_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the Montgomery potential.</li>
<li><strong>U_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-momentum.</li>
<li><strong>V_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-momentum.</li>
<li><strong>Qv_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density of water vapour.</li>
<li><strong>Qc_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density of cloud water.</li>
<li><strong>Qr_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density of precipitation water.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._compute_vertical_fluxes">
<code class="descname">_compute_vertical_fluxes</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>dt</em>, <em>w</em>, <em>s_now</em>, <em>s_prv</em>, <em>U_now</em>, <em>U_prv</em>, <em>V_now</em>, <em>V_prv</em>, <em>Qv_now</em>, <em>Qv_prv</em>, <em>Qc_now</em>, <em>Qc_prv</em>, <em>Qr_now</em>, <em>Qr_prv</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._compute_vertical_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Method computing the <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code>s_now representing the MacCormack <span class="math">\(z\)</span>-flux for all the conservative
model variables. The :class:<a href="#id18"><span class="problematic" id="id19">`</span></a>gridtools.Equation`s_now are then set as instance attributes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>i</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(x\)</span>-axis.</li>
<li><strong>j</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(y\)</span>-axis.</li>
<li><strong>k</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(\theta\)</span>-axis.</li>
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Global</span></code> representing the time step.</li>
<li><strong>w</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the vertical velocity, i.e., the change over time of potential temperature.</li>
<li><strong>s_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density.</li>
<li><strong>s_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density, i.e., the isentropic density stepped
disregarding the vertical advection.</li>
<li><strong>U_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current <span class="math">\(x\)</span>-momentum.</li>
<li><strong>U_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional <span class="math">\(x\)</span>-momentum, i.e., the <span class="math">\(x\)</span>-momentum stepped
disregarding the vertical advection.</li>
<li><strong>V_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current <span class="math">\(y\)</span>-momentum.</li>
<li><strong>V_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional <span class="math">\(y\)</span>-momentum, i.e., the <span class="math">\(y\)</span>-momentum stepped
disregarding the vertical advection.</li>
<li><strong>Qv_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density of water vapor.</li>
<li><strong>Qv_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density of water vapor,
i.e., the isentropic density of water vapor stepped disregarding the vertical advection.</li>
<li><strong>Qc_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density of cloud water.</li>
<li><strong>Qc_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density of cloud water,
i.e., the isentropic density of cloud water stepped disregarding the vertical advection.</li>
<li><strong>Qr_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density of precipitation water.</li>
<li><strong>Qr_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density of precipitation water,
i.e., the isentropic density of precipitation water stepped disregarding the vertical advection.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_flux_x">
<code class="descname">_get_maccormack_flux_x</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>u_now_unstg</em>, <em>phi_now</em>, <em>u_prd_unstg</em>, <em>phi_prd</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_flux_x" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the MacCormack flux in <span class="math">\(x\)</span>-direction for a
generic prognostic variable <span class="math">\(\phi\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(x\)</span>-axis.</li>
<li><strong>j</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(y\)</span>-axis.</li>
<li><strong>k</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(\theta\)</span>-axis.</li>
<li><strong>u_now_unstg</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the unstaggered <span class="math">\(x\)</span>-velocity at the current time.</li>
<li><strong>phi_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the field <span class="math">\(\phi\)</span> at the current time.</li>
<li><strong>u_prd_unstg</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the predicted value for the unstaggered <span class="math">\(x\)</span>-velocity.</li>
<li><strong>phi_prd</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the predicted value for the field <span class="math">\(\phi\)</span>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the MacCormack flux in <span class="math">\(x\)</span>-direction for <span class="math">\(\phi\)</span>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_flux_x_density">
<code class="descname">_get_maccormack_flux_x_density</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>U_now</em>, <em>U_prd</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_flux_x_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the MacCormack flux in <span class="math">\(x\)</span>-direction for the
isentropic density.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(x\)</span>-axis.</li>
<li><strong>j</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(y\)</span>-axis.</li>
<li><strong>k</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(\theta\)</span>-axis.</li>
<li><strong>U_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-momentum at the current time.</li>
<li><strong>U_prd</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the predicted value for the <span class="math">\(x\)</span>-momentum.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the MacCormack flux in <span class="math">\(x\)</span>-direction for the isentropic density.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_flux_y">
<code class="descname">_get_maccormack_flux_y</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>v_now_unstg</em>, <em>phi_now</em>, <em>v_prd_unstg</em>, <em>phi_prd</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_flux_y" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the MacCormack flux in <span class="math">\(y\)</span>-direction for a
generic prognostic variable <span class="math">\(\phi\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(x\)</span>-axis.</li>
<li><strong>j</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(y\)</span>-axis.</li>
<li><strong>k</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(\theta\)</span>-axis.</li>
<li><strong>v_now_unstg</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the unstaggered <span class="math">\(y\)</span>-velocity at the current time.</li>
<li><strong>phi_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the field <span class="math">\(\phi\)</span> at the current time.</li>
<li><strong>v_prd_unstg</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the predicted value for the unstaggered <span class="math">\(y\)</span>-velocity.</li>
<li><strong>phi_prd</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the predicted value for the field <span class="math">\(\phi\)</span>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the MacCormack flux in <span class="math">\(y\)</span>-direction for <span class="math">\(\phi\)</span>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_flux_y_density">
<code class="descname">_get_maccormack_flux_y_density</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>V_now</em>, <em>V_prd</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_flux_y_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the MacCormack flux in <span class="math">\(y\)</span>-direction for the
isentropic density.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(x\)</span>-axis.</li>
<li><strong>j</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(y\)</span>-axis.</li>
<li><strong>k</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(\theta\)</span>-axis.</li>
<li><strong>V_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-momentum at the current time.</li>
<li><strong>V_prd</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the predicted value for the <span class="math">\(y\)</span>-momentum.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the MacCormack flux in <span class="math">\(y\)</span>-direction for the isentropic density.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_flux_z">
<code class="descname">_get_maccormack_flux_z</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>w</em>, <em>phi_now</em>, <em>phi_prv</em>, <em>phi_prd</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_flux_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the MacCormack flux in <span class="math">\(z\)</span>-direction for a
generic prognostic variable <span class="math">\(\phi\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(x\)</span>-axis.</li>
<li><strong>j</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(y\)</span>-axis.</li>
<li><strong>k</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(\theta\)</span>-axis.</li>
<li><strong>w</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the vertical velocity, i.e., the change over time in potential temperature.</li>
<li><strong>phi_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the field <span class="math">\(\phi\)</span> at current time.</li>
<li><strong>phi_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional value for <span class="math">\(\phi\)</span>, i.e., <span class="math">\(\phi\)</span> stepped disregarding
the vertical advection.</li>
<li><strong>phi_prd</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the predicted value for the field <span class="math">\(\phi\)</span>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the MacCormack flux in <span class="math">\(z\)</span>-direction for <span class="math">\(\phi\)</span>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_horizontal_predicted_value_constituent">
<code class="descname">_get_maccormack_horizontal_predicted_value_constituent</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>dt</em>, <em>u_now_unstg</em>, <em>v_now_unstg</em>, <em>Q_now</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_horizontal_predicted_value_constituent" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the predicted value for the isentropic density of a generic
water constituent <span class="math">\(Q\)</span>, computed without taking the vertical advection into account.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(x\)</span>-axis.</li>
<li><strong>j</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(y\)</span>-axis.</li>
<li><strong>k</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(\theta\)</span>-axis.</li>
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Global</span></code> representing the time step.</li>
<li><strong>u_now_unstg</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the unstaggered <span class="math">\(x\)</span>-velocity.</li>
<li><strong>v_now_unstg</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the unstaggered <span class="math">\(y\)</span>-velocity.</li>
<li><strong>Q_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density of a generic water constituent <span class="math">\(Q\)</span>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the predicted value for <span class="math">\(Q\)</span>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_horizontal_predicted_value_density">
<code class="descname">_get_maccormack_horizontal_predicted_value_density</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>dt</em>, <em>s_now</em>, <em>U_now</em>, <em>V_now</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_horizontal_predicted_value_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the predicted value for the isentropic density,
computed without taking the vertical advection into account.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(x\)</span>-axis.</li>
<li><strong>j</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(y\)</span>-axis.</li>
<li><strong>k</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(\theta\)</span>-axis.</li>
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Global</span></code> representing the time step.</li>
<li><strong>s_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density.</li>
<li><strong>U_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-momentum.</li>
<li><strong>V_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-momentum.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the predicted value for the isentropic density.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_horizontal_predicted_value_momentum_x">
<code class="descname">_get_maccormack_horizontal_predicted_value_momentum_x</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>dt</em>, <em>s_now</em>, <em>u_now_unstg</em>, <em>v_now_unstg</em>, <em>mtg_now</em>, <em>U_now</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_horizontal_predicted_value_momentum_x" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the predicted value for the <span class="math">\(x\)</span>-momentum,
computed without taking the vertical advection into account.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(x\)</span>-axis.</li>
<li><strong>j</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(y\)</span>-axis.</li>
<li><strong>k</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(\theta\)</span>-axis.</li>
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Global</span></code> representing the time step.</li>
<li><strong>s_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density.</li>
<li><strong>u_now_unstg</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the unstaggered <span class="math">\(x\)</span>-velocity.</li>
<li><strong>v_now_unstg</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the unstaggered <span class="math">\(y\)</span>-velocity.</li>
<li><strong>mtg_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the Montgomery potential.</li>
<li><strong>U_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-momentum.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the predicted value for the <span class="math">\(x\)</span>-momentum.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_horizontal_predicted_value_momentum_y">
<code class="descname">_get_maccormack_horizontal_predicted_value_momentum_y</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>dt</em>, <em>s_now</em>, <em>u_now_unstg</em>, <em>v_now_unstg</em>, <em>mtg_now</em>, <em>V_now</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_horizontal_predicted_value_momentum_y" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the predicted value for the <span class="math">\(y\)</span>-momentum,
computed without taking the vertical advection into account.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(x\)</span>-axis.</li>
<li><strong>j</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(y\)</span>-axis.</li>
<li><strong>k</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(\theta\)</span>-axis.</li>
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Global</span></code> representing the time step.</li>
<li><strong>s_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density.</li>
<li><strong>u_now_unstg</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the unstaggered <span class="math">\(x\)</span>-velocity.</li>
<li><strong>v_now_unstg</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the unstaggered <span class="math">\(y\)</span>-velocity.</li>
<li><strong>mtg_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the Montgomery potential.</li>
<li><strong>V_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-momentum.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the predicted value for the <span class="math">\(y\)</span>-momentum.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_vertical_predicted_value">
<code class="descname">_get_maccormack_vertical_predicted_value</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>dt</em>, <em>w</em>, <em>phi_now</em>, <em>phi_prv</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_vertical_predicted_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the predicted value for a generic conservative prognostic
variable <span class="math">\(\phi\)</span>, computed taking only the vertical advection into account.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(x\)</span>-axis.</li>
<li><strong>j</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(y\)</span>-axis.</li>
<li><strong>k</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(\theta\)</span>-axis.</li>
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Global</span></code> representing the time step.</li>
<li><strong>w</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the vertical velocity, i.e., the change over time in potential temperature.</li>
<li><strong>phi_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the field <span class="math">\(\phi\)</span> at current time.</li>
<li><strong>phi_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional value for <span class="math">\(\phi\)</span>, i.e., <span class="math">\(\phi\)</span> stepped
disregarding the vertical advection.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the predicted value for <span class="math">\(\phi\)</span>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_velocity">
<code class="descname">_get_velocity</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>s</em>, <em>mnt</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing an unstaggered velocity component.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(x\)</span>-axis.</li>
<li><strong>j</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(y\)</span>-axis.</li>
<li><strong>k</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Index</span></code> representing the index running along the <span class="math">\(\theta\)</span>-axis.</li>
<li><strong>s</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density.</li>
<li><strong>mnt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing either the <span class="math">\(x\)</span>- or the <span class="math">\(y\)</span>-momentum.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the diagnosed unstaggered velocity component.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="prognostics">
<h3>Prognostics<a class="headerlink" href="#prognostics" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="dycore.prognostic_isentropic.PrognosticIsentropic">
<em class="property">class </em><code class="descclassname">dycore.prognostic_isentropic.</code><code class="descname">PrognosticIsentropic</code><span class="sig-paren">(</span><em>flux_scheme</em>, <em>grid</em>, <em>moist_on</em>, <em>backend</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic.PrognosticIsentropic" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract base class whose derived classes implement different schemes to carry out the prognostic steps of
the three-dimensional moist isentropic dynamical core. The conservative form of the governing equations is used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>ni</strong> (<em>int</em>) – Extent of the computational domain in the <span class="math">\(x\)</span>-direction.</li>
<li><strong>nj</strong> (<em>int</em>) – Extent of the computational domain in the <span class="math">\(y\)</span>-direction.</li>
<li><strong>nk</strong> (<em>int</em>) – Extent of the computational domain in the <span class="math">\(z\)</span>-direction.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="dycore.prognostic_isentropic.PrognosticIsentropic.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>flux_scheme</em>, <em>grid</em>, <em>moist_on</em>, <em>backend</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic.PrognosticIsentropic.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>flux_scheme</strong> (<em>str</em>) – <p>String specifying the flux scheme to use. Either:</p>
<ul>
<li>’upwind’, for the upwind flux;</li>
<li>’centered’, for a second-order centered flux;</li>
<li>’maccormack’, for the MacCormack flux.</li>
</ul>
</li>
<li><strong>grid</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> representing the underlying grid.</li>
<li><strong>moist_on</strong> (<em>bool</em>) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> for a moist dynamical core, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</li>
<li><strong>backend</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode</span></code> specifying the backend for the GT4Py’s stencils.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.prognostic_isentropic.PrognosticIsentropic._stencil_stepping_by_coupling_physics_with_dynamics_allocate_inputs">
<code class="descname">_stencil_stepping_by_coupling_physics_with_dynamics_allocate_inputs</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic.PrognosticIsentropic._stencil_stepping_by_coupling_physics_with_dynamics_allocate_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Allocate the attributes which serve as inputs to the GT4Py’s stencil which step the solution
by coupling physics with dynamics, i.e., accounting for the change over time in potential temperature.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>s</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the isentropic density.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.prognostic_isentropic.PrognosticIsentropic._stencil_stepping_by_coupling_physics_with_dynamics_allocate_outputs">
<code class="descname">_stencil_stepping_by_coupling_physics_with_dynamics_allocate_outputs</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic.PrognosticIsentropic._stencil_stepping_by_coupling_physics_with_dynamics_allocate_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Allocate the Numpy arrays which will store the solution updated by coupling physics with dynamics.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>s</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the the isentropic density.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.prognostic_isentropic.PrognosticIsentropic._stencil_stepping_by_coupling_physics_with_dynamics_defs">
<code class="descname">_stencil_stepping_by_coupling_physics_with_dynamics_defs</code><span class="sig-paren">(</span><em>dt</em>, <em>w</em>, <em>s_now</em>, <em>s_prv</em>, <em>U_now</em>, <em>U_prv</em>, <em>V_now</em>, <em>V_prv</em>, <em>Qv_now=None</em>, <em>Qv_prv=None</em>, <em>Qc_now=None</em>, <em>Qc_prv=None</em>, <em>Qr_now=None</em>, <em>Qr_prv=None</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic.PrognosticIsentropic._stencil_stepping_by_coupling_physics_with_dynamics_defs" title="Permalink to this definition">¶</a></dt>
<dd><p>GT4Py’s stencil stepping the solution by coupling physics with dynamics, i.e., by accounting for the
change over time in potential temperature.
As this method is marked as abstract, its implementation is delegated to the derived classes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Global</span></code> representing the time step.</li>
<li><strong>w</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the vertical velocity, i.e., the change over time in potential temperature.</li>
<li><strong>s_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density.</li>
<li><strong>s_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density.</li>
<li><strong>U_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current <span class="math">\(x\)</span>-momentum.</li>
<li><strong>U_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional <span class="math">\(x\)</span>-momentum.</li>
<li><strong>V_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current <span class="math">\(y\)</span>-momentum.</li>
<li><strong>V_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional <span class="math">\(y\)</span>-momentum.</li>
<li><strong>Qv_now</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density of water vapor.</li>
<li><strong>Qv_prv</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density of water vapor.</li>
<li><strong>Qc_now</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density of cloud liquid water.</li>
<li><strong>Qc_prv</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density of cloud liquid water.</li>
<li><strong>Qr_now</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density of precipitation water.</li>
<li><strong>Qr_prv</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density of precipitation water.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>s_new</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the updated isentropic density.</li>
<li><strong>U_new</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the updated <span class="math">\(x\)</span>-momentum.</li>
<li><strong>V_new</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the updated <span class="math">\(y\)</span>-momentum.</li>
<li><strong>Qv_new</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the updated isentropic density of water vapor.</li>
<li><strong>Qc_new</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the updated isentropic density of cloud liquid water.</li>
<li><strong>Qr_new</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the updated isentropic density of precipitation water.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.prognostic_isentropic.PrognosticIsentropic._stencil_stepping_by_coupling_physics_with_dynamics_initialize">
<code class="descname">_stencil_stepping_by_coupling_physics_with_dynamics_initialize</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic.PrognosticIsentropic._stencil_stepping_by_coupling_physics_with_dynamics_initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the GT4Py’s stencil in charge of stepping the solution by coupling physics with dynamics,
i.e., by accounting for the change over time in potential temperature.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>s</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the isentropic density.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.prognostic_isentropic.PrognosticIsentropic._stencil_stepping_by_coupling_physics_with_dynamics_set_inputs">
<code class="descname">_stencil_stepping_by_coupling_physics_with_dynamics_set_inputs</code><span class="sig-paren">(</span><em>dt</em>, <em>w</em>, <em>s_now</em>, <em>s_prv</em>, <em>U_now</em>, <em>U_prv</em>, <em>V_now</em>, <em>V_prv</em>, <em>Qv_now=None</em>, <em>Qv_prv=None</em>, <em>Qc_now=None</em>, <em>Qc_prv=None</em>, <em>Qr_now=None</em>, <em>Qr_prv=None</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic.PrognosticIsentropic._stencil_stepping_by_coupling_physics_with_dynamics_set_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the attributes which serve as inputs to the GT4Py’s stencil which steps the solution
by resolving the vertical advection, i.e., by accounting for the change over time in potential temperature.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dt</strong> (<em>obj</em>) – A <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the time step.</li>
<li><strong>w</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the vertical velocity, i.e., the change over time in potential temperature.</li>
<li><strong>s_now</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the current isentropic density.</li>
<li><strong>s_prv</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the provisional isentropic density.</li>
<li><strong>U_now</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the current <span class="math">\(x\)</span>-momentum.</li>
<li><strong>U_prv</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the provisional <span class="math">\(x\)</span>-momentum.</li>
<li><strong>V_now</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the current <span class="math">\(y\)</span>-momentum.</li>
<li><strong>V_prv</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the provisional <span class="math">\(y\)</span>-momentum.</li>
<li><strong>Qv_now</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the current isentropic density of water vapor.</li>
<li><strong>Qv_prv</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the provisional isentropic density of water vapor.</li>
<li><strong>Qc_now</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the current isentropic density of cloud liquid water.</li>
<li><strong>Qc_prv</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the provisional isentropic density of cloud liquid water.</li>
<li><strong>Qr_now</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the current isentropic density of precipitation water.</li>
<li><strong>Qr_prv</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the provisional isentropic density of precipitation water.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.prognostic_isentropic.PrognosticIsentropic._stencils_stepping_by_neglecting_vertical_advection_allocate_inputs">
<code class="descname">_stencils_stepping_by_neglecting_vertical_advection_allocate_inputs</code><span class="sig-paren">(</span><em>s_</em>, <em>u_</em>, <em>v_</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic.PrognosticIsentropic._stencils_stepping_by_neglecting_vertical_advection_allocate_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Allocate the attributes which serve as inputs to the GT4Py’s stencils which step the solution
disregarding the vertical advection.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>s</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the isentropic density at current time.</li>
<li><strong>u</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the <span class="math">\(x\)</span>-velocity at current time.</li>
<li><strong>v</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the <span class="math">\(y\)</span>-velocity at current time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.prognostic_isentropic.PrognosticIsentropic._stencils_stepping_by_neglecting_vertical_advection_allocate_outputs">
<code class="descname">_stencils_stepping_by_neglecting_vertical_advection_allocate_outputs</code><span class="sig-paren">(</span><em>s_</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic.PrognosticIsentropic._stencils_stepping_by_neglecting_vertical_advection_allocate_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Allocate the Numpy arrays which will store the solution updated by neglecting the vertical advection.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>s</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the isentropic density.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.prognostic_isentropic.PrognosticIsentropic._stencils_stepping_by_neglecting_vertical_advection_set_inputs">
<code class="descname">_stencils_stepping_by_neglecting_vertical_advection_set_inputs</code><span class="sig-paren">(</span><em>dt</em>, <em>s_</em>, <em>u_</em>, <em>v_</em>, <em>mtg_</em>, <em>U_</em>, <em>V_</em>, <em>Qv_</em>, <em>Qc_</em>, <em>Qr_</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic.PrognosticIsentropic._stencils_stepping_by_neglecting_vertical_advection_set_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the attributes which serve as inputs to the GT4Py’s stencils which step the solution
disregarding the vertical advection.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dt</strong> (<em>obj</em>) – A <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the time step.</li>
<li><strong>s</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the isentropic density
at current time.</li>
<li><strong>u</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the <span class="math">\(x\)</span>-velocity
at current time.</li>
<li><strong>v</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the <span class="math">\(y\)</span>-velocity
at current time.</li>
<li><strong>p</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the pressure at current time.</li>
<li><strong>mtg</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the Montgomery potential
at current time.</li>
<li><strong>U</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the <span class="math">\(x\)</span>-momentum
at current time.</li>
<li><strong>V</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the <span class="math">\(y\)</span>-momentum
at current time.</li>
<li><strong>Qv</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the isentropic density
of water vapour at current time.</li>
<li><strong>Qc</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the isentropic density
of cloud water at current time.</li>
<li><strong>Qr</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the isentropic density
of precipitation water at current time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="dycore.prognostic_isentropic.PrognosticIsentropic.boundary">
<code class="descname">boundary</code><a class="headerlink" href="#dycore.prognostic_isentropic.PrognosticIsentropic.boundary" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the attribute implementing the horizontal boundary conditions.
If this is set to <code class="xref py py-obj docutils literal"><span class="pre">None</span></code>, a <code class="xref py py-class docutils literal"><span class="pre">ValueError</span></code> is thrown.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Instance of the derived class of <a class="reference internal" href="#dycore.horizontal_boundary.HorizontalBoundary" title="dycore.horizontal_boundary.HorizontalBoundary"><code class="xref py py-class docutils literal"><span class="pre">HorizontalBoundary</span></code></a> implementing
the horizontal boundary conditions.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">obj</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="dycore.prognostic_isentropic.PrognosticIsentropic.diagnostic">
<code class="descname">diagnostic</code><a class="headerlink" href="#dycore.prognostic_isentropic.PrognosticIsentropic.diagnostic" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the attribute implementing the diagnostic step of the three-dimensional moist isentropic dynamical core.
If this is set to <code class="xref py py-obj docutils literal"><span class="pre">None</span></code>, a <code class="xref py py-class docutils literal"><span class="pre">ValueError</span></code> is thrown.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference internal" href="#dycore.diagnostic_isentropic.DiagnosticIsentropic" title="dycore.diagnostic_isentropic.DiagnosticIsentropic"><code class="xref py py-class docutils literal"><span class="pre">DiagnosticIsentropic</span></code></a> carrying out the diagnostic step of the
three-dimensional moist isentropic dynamical core.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">obj</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="dycore.prognostic_isentropic.PrognosticIsentropic.factory">
<em class="property">static </em><code class="descname">factory</code><span class="sig-paren">(</span><em>time_scheme</em>, <em>flux_scheme</em>, <em>grid</em>, <em>moist_on</em>, <em>backend</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic.PrognosticIsentropic.factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Static method returning an instace of the derived class implementing the time stepping scheme specified
by <code class="xref py py-data docutils literal"><span class="pre">time_scheme</span></code>, using the flux scheme specified by <code class="xref py py-data docutils literal"><span class="pre">flux_scheme</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>time_scheme</strong> (<em>str</em>) – <p>String specifying the time stepping method to implement. Either:</p>
<ul>
<li>’forward_euler’, for the forward Euler scheme;</li>
<li>’centered’, for a centered scheme.</li>
</ul>
</li>
<li><strong>flux_scheme</strong> (<em>str</em>) – <p>String specifying the scheme to use. Either:</p>
<ul>
<li>’upwind’, for the upwind flux;</li>
<li>’centered’, for a second-order centered flux;</li>
<li>’maccormack’, for the MacCormack flux.</li>
</ul>
</li>
<li><strong>grid</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> representing the underlying grid.</li>
<li><strong>moist_on</strong> (<em>bool</em>) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> for a moist dynamical core, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</li>
<li><strong>backend</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Mode</span></code> specifying the backend for the GT4Py’s stencils.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An instace of the derived class implementing the scheme specified by <code class="xref py py-data docutils literal"><span class="pre">scheme</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="dycore.prognostic_isentropic.PrognosticIsentropic.nb">
<code class="descname">nb</code><a class="headerlink" href="#dycore.prognostic_isentropic.PrognosticIsentropic.nb" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of boundary layers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The number of boundary layers.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.prognostic_isentropic.PrognosticIsentropic.step_coupling_physics_with_dynamics">
<code class="descname">step_coupling_physics_with_dynamics</code><span class="sig-paren">(</span><em>dt</em>, <em>state_now</em>, <em>state_prv</em>, <em>state_old=None</em>, <em>diagnostics=None</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic.PrognosticIsentropic.step_coupling_physics_with_dynamics" title="Permalink to this definition">¶</a></dt>
<dd><p>Method advancing the conservative, prognostic model variables one time step forward by coupling physics with
dynamics, i.e., by accounting for the change over time in potential temperature.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the time step.</li>
<li><strong>state_now</strong> (<em>obj</em>) – <p><a class="reference internal" href="#storages.state_isentropic.StateIsentropic" title="storages.state_isentropic.StateIsentropic"><code class="xref py py-class docutils literal"><span class="pre">StateIsentropic</span></code></a> representing the current state.
It should contain the following variables:</p>
<ul>
<li>air_isentropic_density (unstaggered);</li>
<li>x_momentum_isentropic (unstaggered);</li>
<li>y_momentum_isentropic (unstaggered);</li>
<li>water_vapor_isentropic_density (unstaggered, optional);</li>
<li>cloud_liquid_water_isentropic_density (unstaggered, optional);</li>
<li>precipitation_water_isentropic_density (unstaggered, optional).</li>
</ul>
</li>
<li><strong>state_prv</strong> (<em>obj</em>) – <p><a class="reference internal" href="#storages.state_isentropic.StateIsentropic" title="storages.state_isentropic.StateIsentropic"><code class="xref py py-class docutils literal"><span class="pre">StateIsentropic</span></code></a> representing the provisional state, i.e.,
the state stepped taking only the horizontal derivatives into account.
It should contain the following variables:</p>
<ul>
<li>air_isentropic_density (unstaggered);</li>
<li>x_momentum_isentropic (unstaggered);</li>
<li>y_momentum_isentropic (unstaggered);</li>
<li>water_vapor_isentropic_density (unstaggered, optional);</li>
<li>cloud_liquid_water_isentropic_density (unstaggered, optional);</li>
<li>precipitation_water_isentropic_density (unstaggered, optional).</li>
</ul>
<p>This may be the output of <a class="reference internal" href="#dycore.prognostic_isentropic.PrognosticIsentropic.step_neglecting_vertical_advection" title="dycore.prognostic_isentropic.PrognosticIsentropic.step_neglecting_vertical_advection"><code class="xref py py-meth docutils literal"><span class="pre">step_neglecting_vertical_advection()</span></code></a>.</p>
</li>
<li><strong>diagnostics</strong> (<cite>obj</cite>, optional) – <p><a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> collecting the following variables:</p>
<ul>
<li>change_over_time_in_air_potential_temperature (unstaggered).</li>
</ul>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p><a class="reference internal" href="#storages.state_isentropic.StateIsentropic" title="storages.state_isentropic.StateIsentropic"><code class="xref py py-class docutils literal"><span class="pre">StateIsentropic</span></code></a> containing the updated prognostic variables, i.e.,</p>
<ul class="simple">
<li>air_isentropic_density (unstaggered);</li>
<li>x_momentum_isentropic (unstaggered);</li>
<li>y_momentum_isentropic (unstaggered);</li>
<li>water_vapor_isentropic_density (unstaggered, optional);</li>
<li>cloud_liquid_water_isentropic_density (unstaggered, optional);</li>
<li>precipitation_water_isentropic_density (unstaggered, optional).</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.prognostic_isentropic.PrognosticIsentropic.step_neglecting_vertical_advection">
<code class="descname">step_neglecting_vertical_advection</code><span class="sig-paren">(</span><em>dt</em>, <em>state</em>, <em>state_old=None</em>, <em>diagnostics=None</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic.PrognosticIsentropic.step_neglecting_vertical_advection" title="Permalink to this definition">¶</a></dt>
<dd><p>Method advancing the conservative, prognostic model variables one time step forward.
Only horizontal derivates are considered; possible vertical derivatives are disregarded.
As this method is marked as abstract, its implementation is delegated to the derived classes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the time step.</li>
<li><strong>state</strong> (<em>obj</em>) – <p><a class="reference internal" href="#storages.state_isentropic.StateIsentropic" title="storages.state_isentropic.StateIsentropic"><code class="xref py py-class docutils literal"><span class="pre">StateIsentropic</span></code></a> representing the current state.
It should contain the following variables:</p>
<ul>
<li>air_isentropic_density (unstaggered);</li>
<li>x_velocity (<span class="math">\(x\)</span>-staggered);</li>
<li>y_velocity (<span class="math">\(y\)</span>-staggered);</li>
<li>x_momentum_isentropic (unstaggered);</li>
<li>y_momentum_isentropic (unstaggered);</li>
<li>air_pressure (<span class="math">\(z\)</span>-staggered);</li>
<li>montgomery_potential (isentropic);</li>
<li>mass_fraction_of_water_vapor_in_air (unstaggered, optional);</li>
<li>mass_fraction_of_cloud_liquid_water_in_air (unstaggered, optional);</li>
<li>mass_fraction_of_precipitation_water_in_air (unstaggered, optional).</li>
</ul>
</li>
<li><strong>state_old</strong> (<cite>obj</cite>, optional) – <p><a class="reference internal" href="#storages.state_isentropic.StateIsentropic" title="storages.state_isentropic.StateIsentropic"><code class="xref py py-class docutils literal"><span class="pre">StateIsentropic</span></code></a> representing the old state.
It should contain the following variables:</p>
<ul>
<li>air_isentropic_density (unstaggered);</li>
<li>x_momentum_isentropic (unstaggered);</li>
<li>y_momentum_isentropic (unstaggered);</li>
<li>mass_fraction_of_water_vapor_in_air (unstaggered, optional);</li>
<li>mass_fraction_of_cloud_liquid_water_in_air (unstaggered, optional);</li>
<li>mass_fraction_of_precipitation_water_in_air (unstaggered, optional).</li>
</ul>
</li>
<li><strong>diagnostics</strong> (<cite>obj</cite>, optional) – <a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> possibly collecting useful diagnostics.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p><a class="reference internal" href="#storages.state_isentropic.StateIsentropic" title="storages.state_isentropic.StateIsentropic"><code class="xref py py-class docutils literal"><span class="pre">StateIsentropic</span></code></a> containing the updated prognostic variables, i.e.,</p>
<ul class="simple">
<li>air_isentropic_density (unstaggered);</li>
<li>x_momentum_isentropic (unstaggered);</li>
<li>y_momentum_isentropic (unstaggered);</li>
<li>water_vapor_isentropic_density (unstaggered, optional);</li>
<li>cloud_liquid_water_isentropic_density (unstaggered, optional);</li>
<li>precipitation_water_isentropic_density (unstaggered, optional).</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler">
<em class="property">class </em><code class="descclassname">dycore.prognostic_isentropic_forward_euler.</code><code class="descname">PrognosticIsentropicForwardEuler</code><span class="sig-paren">(</span><em>flux_scheme</em>, <em>grid</em>, <em>moist_on</em>, <em>backend</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#dycore.prognostic_isentropic.PrognosticIsentropic" title="dycore.prognostic_isentropic.PrognosticIsentropic"><code class="xref py py-class docutils literal"><span class="pre">PrognosticIsentropic</span></code></a> to implement
the forward Euler scheme carrying out the prognostic step of the three-dimensional moist isentropic dynamical core.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference internal" href="#parameterizations.adjustment.Adjustment.time_levels" title="parameterizations.adjustment.Adjustment.time_levels"><strong>time_levels</strong></a> (<em>int</em>) – Number of time levels the scheme relies on.</li>
<li><strong>steps</strong> (<em>int</em>) – Number of steps the scheme entails.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>flux_scheme</em>, <em>grid</em>, <em>moist_on</em>, <em>backend</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>flux_scheme</strong> (<em>str</em>) – <p>String specifying the flux scheme to use. Either:</p>
<ul>
<li>’upwind’, for the upwind flux;</li>
<li>’centered’, for a second-order centered flux;</li>
<li>’maccormack’, for the MacCormack flux.</li>
</ul>
</li>
<li><strong>grid</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> representing the underlying grid.</li>
<li><strong>moist_on</strong> (<em>bool</em>) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> for a moist dynamical core, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</li>
<li><strong>backend</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode</span></code> specifying the backend for the GT$Py’s stencils.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To instantiate an object of this class, one should prefer the static method
<a class="reference internal" href="#dycore.prognostic_isentropic.PrognosticIsentropic.factory" title="dycore.prognostic_isentropic.PrognosticIsentropic.factory"><code class="xref py py-meth docutils literal"><span class="pre">factory()</span></code></a> of
<a class="reference internal" href="#dycore.prognostic_isentropic.PrognosticIsentropic" title="dycore.prognostic_isentropic.PrognosticIsentropic"><code class="xref py py-class docutils literal"><span class="pre">PrognosticIsentropic</span></code></a>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler._stencil_stepping_by_coupling_physics_with_dynamics_defs">
<code class="descname">_stencil_stepping_by_coupling_physics_with_dynamics_defs</code><span class="sig-paren">(</span><em>dt</em>, <em>s_now</em>, <em>U_now</em>, <em>V_now</em>, <em>s_prv</em>, <em>U_prv</em>, <em>V_prv</em>, <em>Qv_now=None</em>, <em>Qc_now=None</em>, <em>Qr_now=None</em>, <em>Qv_prv=None</em>, <em>Qc_prv=None</em>, <em>Qr_prv=None</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler._stencil_stepping_by_coupling_physics_with_dynamics_defs" title="Permalink to this definition">¶</a></dt>
<dd><p>GT4Py’s stencil stepping the solution by coupling physics with dynamics, i.e., by accounting for the
change over time in potential temperature.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Global</span></code> representing the time step.</li>
<li><strong>s_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density.</li>
<li><strong>U_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current <span class="math">\(x\)</span>-momentum.</li>
<li><strong>V_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current <span class="math">\(y\)</span>-momentum.</li>
<li><strong>s_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density.</li>
<li><strong>U_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional <span class="math">\(x\)</span>-momentum.</li>
<li><strong>V_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional <span class="math">\(y\)</span>-momentum.</li>
<li><strong>Qv_now</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density of water vapor.</li>
<li><strong>Qc_now</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density of cloud liquid water.</li>
<li><strong>Qr_now</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density of precipitation water.</li>
<li><strong>Qv_prv</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density of water vapor.</li>
<li><strong>Qc_prv</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density of cloud liquid water.</li>
<li><strong>Qr_prv</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density of precipitation water.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>s_new</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the updated isentropic density.</li>
<li><strong>U_new</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the updated <span class="math">\(x\)</span>-momentum.</li>
<li><strong>V_new</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the updated <span class="math">\(y\)</span>-momentum.</li>
<li><strong>Qv_new</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the updated isentropic density of water vapor.</li>
<li><strong>Qc_new</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the updated isentropic density of cloud liquid water.</li>
<li><strong>Qr_new</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the updated isentropic density of precipitation water.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler._stencil_stepping_by_neglecting_vertical_advection_first_defs">
<code class="descname">_stencil_stepping_by_neglecting_vertical_advection_first_defs</code><span class="sig-paren">(</span><em>dt</em>, <em>in_s</em>, <em>in_u</em>, <em>in_v</em>, <em>in_mtg</em>, <em>in_U</em>, <em>in_V</em>, <em>in_Qv=None</em>, <em>in_Qc=None</em>, <em>in_Qr=None</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler._stencil_stepping_by_neglecting_vertical_advection_first_defs" title="Permalink to this definition">¶</a></dt>
<dd><p>GT4Py’s stencil stepping the isentropic density and the water constituents via the forward Euler scheme.
Further, it computes provisional values for the momentums, i.e., it updates the momentums disregarding
the forcing terms involving the Montgomery potential.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Global</span></code> representing the time step.</li>
<li><strong>in_s</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density at the current time.</li>
<li><strong>in_u</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-velocity at the current time.</li>
<li><strong>in_v</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-velocity at the current time.</li>
<li><strong>in_mtg</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the Montgomery potential at the current time.</li>
<li><strong>in_U</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-momentum at the current time.</li>
<li><strong>in_V</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-momentum at the current time.</li>
<li><strong>in_Qv</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the mass of water vapour at the current time.</li>
<li><strong>in_Qc</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the mass of cloud water at the current time.</li>
<li><strong>in_Qr</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the mass of precipitation water at the current time.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>out_s</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the stepped isentropic density.</li>
<li><strong>out_U</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional <span class="math">\(x\)</span>-momentum.</li>
<li><strong>out_V</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional <span class="math">\(y\)</span>-momentum.</li>
<li><strong>out_Qv</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the stepped mass of water vapour.</li>
<li><strong>out_Qc</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the stepped mass of cloud water.</li>
<li><strong>out_Qr</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the stepped mass of precipitation water.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler._stencil_stepping_by_neglecting_vertical_advection_second_defs">
<code class="descname">_stencil_stepping_by_neglecting_vertical_advection_second_defs</code><span class="sig-paren">(</span><em>dt</em>, <em>in_s</em>, <em>in_mtg</em>, <em>in_U</em>, <em>in_V</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler._stencil_stepping_by_neglecting_vertical_advection_second_defs" title="Permalink to this definition">¶</a></dt>
<dd><p>GT4Py’s stencil stepping the momentums via a one-time-level scheme.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Global</span></code> representing the time step.</li>
<li><strong>in_s</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the stepped isentropic density.</li>
<li><strong>in_mtg</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the Montgomery potential diagnosed from the stepped isentropic density.</li>
<li><strong>in_U</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional <span class="math">\(x\)</span>-momentum.</li>
<li><strong>in_V</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional <span class="math">\(y\)</span>-momentum.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>out_U</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the stepped <span class="math">\(x\)</span>-momentum.</li>
<li><strong>out_V</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the stepped <span class="math">\(y\)</span>-momentum.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler._stencils_stepping_by_neglecting_vertical_advection_allocate_temporaries">
<code class="descname">_stencils_stepping_by_neglecting_vertical_advection_allocate_temporaries</code><span class="sig-paren">(</span><em>s_</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler._stencils_stepping_by_neglecting_vertical_advection_allocate_temporaries" title="Permalink to this definition">¶</a></dt>
<dd><p>Allocate the Numpy arrays which will store temporary fields.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>s</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the isentropic density
at current time.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler._stencils_stepping_by_neglecting_vertical_advection_initialize">
<code class="descname">_stencils_stepping_by_neglecting_vertical_advection_initialize</code><span class="sig-paren">(</span><em>s_</em>, <em>u_</em>, <em>v_</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler._stencils_stepping_by_neglecting_vertical_advection_initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the GT4Py’s stencils implementing the forward Euler scheme.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>s</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the isentropic density
at current time.</li>
<li><strong>u</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the <span class="math">\(x\)</span>-velocity
at current time.</li>
<li><strong>v</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the <span class="math">\(y\)</span>-velocity
at current time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler.step_neglecting_vertical_advection">
<code class="descname">step_neglecting_vertical_advection</code><span class="sig-paren">(</span><em>dt</em>, <em>state</em>, <em>state_old=None</em>, <em>diagnostics=None</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler.step_neglecting_vertical_advection" title="Permalink to this definition">¶</a></dt>
<dd><p>Method advancing the conservative, prognostic model variables one time step forward via the forward Euler method.
Only horizontal derivates are considered; possible vertical derivatives are disregarded.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the time step.</li>
<li><strong>state</strong> (<em>obj</em>) – <p><a class="reference internal" href="#storages.state_isentropic.StateIsentropic" title="storages.state_isentropic.StateIsentropic"><code class="xref py py-class docutils literal"><span class="pre">StateIsentropic</span></code></a> representing the current state.
It should contain the following variables:</p>
<ul>
<li>air_isentropic_density (unstaggered);</li>
<li>x_velocity (<span class="math">\(x\)</span>-staggered);</li>
<li>y_velocity (<span class="math">\(y\)</span>-staggered);</li>
<li>x_momentum_isentropic (unstaggered);</li>
<li>y_momentum_isentropic (unstaggered);</li>
<li>air_pressure (<span class="math">\(z\)</span>-staggered);</li>
<li>montgomery_potential (isentropic);</li>
<li>mass_fraction_of_water_vapor_in_air (unstaggered, optional);</li>
<li>mass_fraction_of_cloud_liquid_water_in_air (unstaggered, optional);</li>
<li>mass_fraction_of_precipitation_water_in_air (unstaggered, optional).</li>
</ul>
</li>
<li><strong>state_old</strong> (<cite>obj</cite>, optional) – <p><a class="reference internal" href="#storages.state_isentropic.StateIsentropic" title="storages.state_isentropic.StateIsentropic"><code class="xref py py-class docutils literal"><span class="pre">StateIsentropic</span></code></a> representing the old state.
It should contain the following variables:</p>
<ul>
<li>air_isentropic_density (unstaggered);</li>
<li>x_momentum_isentropic (unstaggered);</li>
<li>y_momentum_isentropic (unstaggered);</li>
<li>mass_fraction_of_water_vapor_in_air (unstaggered, optional);</li>
<li>mass_fraction_of_cloud_liquid_water_in_air (unstaggered, optional);</li>
<li>mass_fraction_of_precipitation_water_in_air (unstaggered, optional).</li>
</ul>
</li>
<li><strong>diagnostics</strong> (<cite>obj</cite>, optional) – <a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> possibly collecting useful diagnostics.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p><a class="reference internal" href="#storages.state_isentropic.StateIsentropic" title="storages.state_isentropic.StateIsentropic"><code class="xref py py-class docutils literal"><span class="pre">StateIsentropic</span></code></a> containing the updated prognostic variables, i.e.,</p>
<ul class="simple">
<li>air_isentropic_density (unstaggered);</li>
<li>x_momentum_isentropic (unstaggered);</li>
<li>y_momentum_isentropic (unstaggered);</li>
<li>water_vapor_isentropic_density (unstaggered, optional);</li>
<li>cloud_liquid_water_isentropic_density (unstaggered, optional);</li>
<li>precipitation_water_isentropic_density (unstaggered, optional).</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered">
<em class="property">class </em><code class="descclassname">dycore.prognostic_isentropic_centered.</code><code class="descname">PrognosticIsentropicCentered</code><span class="sig-paren">(</span><em>flux_scheme</em>, <em>grid</em>, <em>moist_on</em>, <em>backend</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#dycore.prognostic_isentropic.PrognosticIsentropic" title="dycore.prognostic_isentropic.PrognosticIsentropic"><code class="xref py py-class docutils literal"><span class="pre">PrognosticIsentropic</span></code></a> to implement
a centered time-integration scheme to carry out the prognostic step of the three-dimensional
moist isentropic dynamical core.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>ni</strong> (<em>int</em>) – Extent of the computational domain in the <span class="math">\(x\)</span>-direction.</li>
<li><strong>nj</strong> (<em>int</em>) – Extent of the computational domain in the <span class="math">\(y\)</span>-direction.</li>
<li><strong>nk</strong> (<em>int</em>) – Extent of the computational domain in the <span class="math">\(z\)</span>-direction.</li>
<li><a class="reference internal" href="#parameterizations.adjustment.Adjustment.time_levels" title="parameterizations.adjustment.Adjustment.time_levels"><strong>time_levels</strong></a> (<em>int</em>) – Number of time levels the scheme relies on.</li>
<li><strong>steps</strong> (<em>int</em>) – Number of steps the scheme entails.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>flux_scheme</em>, <em>grid</em>, <em>moist_on</em>, <em>backend</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>flux_scheme</strong> (<em>str</em>) – <p>String specifying the flux scheme to use. Either:</p>
<ul>
<li>’upwind’, for the upwind flux;</li>
<li>’centered’, for a second-order centered flux;</li>
<li>’maccormack’, for the MacCormack flux.</li>
</ul>
</li>
<li><strong>grid</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> representing the underlying grid.</li>
<li><strong>moist_on</strong> (<em>bool</em>) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> for a moist dynamical core, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</li>
<li><strong>backend</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode</span></code> specifying the backend for the GT4Py’s stencils.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To instantiate an object of this class, one should prefer the static method
<a class="reference internal" href="#dycore.prognostic_isentropic.PrognosticIsentropic.factory" title="dycore.prognostic_isentropic.PrognosticIsentropic.factory"><code class="xref py py-meth docutils literal"><span class="pre">factory()</span></code></a> of
<a class="reference internal" href="#dycore.prognostic_isentropic.PrognosticIsentropic" title="dycore.prognostic_isentropic.PrognosticIsentropic"><code class="xref py py-class docutils literal"><span class="pre">PrognosticIsentropic</span></code></a>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered._set_stencils_stepping_by_neglecting_vertical_advection_inputs">
<code class="descname">_set_stencils_stepping_by_neglecting_vertical_advection_inputs</code><span class="sig-paren">(</span><em>dt</em>, <em>s_</em>, <em>u_</em>, <em>v_</em>, <em>mtg_</em>, <em>U_</em>, <em>V_</em>, <em>Qv_</em>, <em>Qc_</em>, <em>Qr_</em>, <em>s_old_</em>, <em>U_old_</em>, <em>V_old_</em>, <em>Qv_old_</em>, <em>Qc_old_</em>, <em>Qr_old_</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered._set_stencils_stepping_by_neglecting_vertical_advection_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the attributes which serve as inputs to the GT4Py’s stencil.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dt</strong> (<em>obj</em>) – A <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the time step.</li>
<li><strong>s</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the isentropic density
at current time.</li>
<li><strong>u</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the <span class="math">\(x\)</span>-velocity
at current time.</li>
<li><strong>v</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the <span class="math">\(y\)</span>-velocity
at current time.</li>
<li><strong>mtg</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the Montgomery potential
at current time.</li>
<li><strong>U</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the <span class="math">\(x\)</span>-momentum
at current time.</li>
<li><strong>V</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the <span class="math">\(y\)</span>-momentum
at current time.</li>
<li><strong>Qv</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the mass of water vapour
at current time.</li>
<li><strong>Qc</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the mass of cloud water
at current time.</li>
<li><strong>Qr</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the mass of precipitation water
at current time.</li>
<li><strong>s_old</strong> (<cite>array_like</cite>, optional) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the isentropic density
at the previous time level.</li>
<li><strong>U_old</strong> (<cite>array_like</cite>, optional) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the <span class="math">\(x\)</span>-momentum
at the previous time level.</li>
<li><strong>V_old</strong> (<cite>array_like</cite>, optional) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the <span class="math">\(y\)</span>-momentum
at the previous time level.</li>
<li><strong>Qv_old</strong> (<cite>array_like</cite>, optional) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the mass of water vapour
at the previous time level.</li>
<li><strong>Qc_old</strong> (<cite>array_like</cite>, optional) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the mass of cloud water
at the previous time level.</li>
<li><strong>Qr_old</strong> (<cite>array_like</cite>, optional) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the mass of precipitation water
at the previous time level.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered._stencil_stepping_by_coupling_physics_with_dynamics_defs">
<code class="descname">_stencil_stepping_by_coupling_physics_with_dynamics_defs</code><span class="sig-paren">(</span><em>dt</em>, <em>s_now</em>, <em>U_now</em>, <em>V_now</em>, <em>s_prv</em>, <em>U_prv</em>, <em>V_prv</em>, <em>Qv_now=None</em>, <em>Qc_now=None</em>, <em>Qr_now=None</em>, <em>Qv_prv=None</em>, <em>Qc_prv=None</em>, <em>Qr_prv=None</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered._stencil_stepping_by_coupling_physics_with_dynamics_defs" title="Permalink to this definition">¶</a></dt>
<dd><p>GT4Py’s stencil stepping the solution by coupling physics with dynamics, i.e., by accounting for the
change over time in potential temperature.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Global</span></code> representing the time step.</li>
<li><strong>s_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density.</li>
<li><strong>U_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current <span class="math">\(x\)</span>-momentum.</li>
<li><strong>V_now</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current <span class="math">\(y\)</span>-momentum.</li>
<li><strong>s_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density.</li>
<li><strong>U_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional <span class="math">\(x\)</span>-momentum.</li>
<li><strong>V_prv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional <span class="math">\(y\)</span>-momentum.</li>
<li><strong>Qv_now</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density of water vapor.</li>
<li><strong>Qc_now</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density of cloud liquid water.</li>
<li><strong>Qr_now</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the current isentropic density of precipitation water.</li>
<li><strong>Qv_prv</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density of water vapor.</li>
<li><strong>Qc_prv</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density of cloud liquid water.</li>
<li><strong>Qr_prv</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the provisional isentropic density of precipitation water.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>s_new</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the updated isentropic density.</li>
<li><strong>U_new</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the updated <span class="math">\(x\)</span>-momentum.</li>
<li><strong>V_new</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the updated <span class="math">\(y\)</span>-momentum.</li>
<li><strong>Qv_new</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the updated isentropic density of water vapor.</li>
<li><strong>Qc_new</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the updated isentropic density of cloud liquid water.</li>
<li><strong>Qr_new</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the updated isentropic density of precipitation water.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered._stencil_stepping_by_neglecting_vertical_advection_defs">
<code class="descname">_stencil_stepping_by_neglecting_vertical_advection_defs</code><span class="sig-paren">(</span><em>dt</em>, <em>in_s</em>, <em>in_u</em>, <em>in_v</em>, <em>in_mtg</em>, <em>in_U</em>, <em>in_V</em>, <em>old_s</em>, <em>old_U</em>, <em>old_V</em>, <em>in_Qv=None</em>, <em>in_Qc=None</em>, <em>in_Qr=None</em>, <em>old_Qv=None</em>, <em>old_Qc=None</em>, <em>old_Qr=None</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered._stencil_stepping_by_neglecting_vertical_advection_defs" title="Permalink to this definition">¶</a></dt>
<dd><p>GT4Py’s stencil implementing the centered time-integration scheme.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Global</span></code> representing the time step.</li>
<li><strong>in_s</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density at the current time.</li>
<li><strong>in_u</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-velocity at the current time.</li>
<li><strong>in_v</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-velocity at the current time.</li>
<li><strong>in_mtg</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the Montgomery potential at the current time.</li>
<li><strong>in_U</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-momentum at the current time.</li>
<li><strong>in_V</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-momentum at the current time.</li>
<li><strong>old_s</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the isentropic density at the previous time level.</li>
<li><strong>old_U</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(x\)</span>-momentum at the previous time level.</li>
<li><strong>old_V</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the <span class="math">\(y\)</span>-momentum at the previous time level.</li>
<li><strong>in_Qv</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the mass of water vapour at the current time.</li>
<li><strong>in_Qc</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the mass of cloud water at the current time.</li>
<li><strong>in_Qr</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the mass of precipitation water at the current time.</li>
<li><strong>old_Qv</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the mass of water vapour at the previous time level.</li>
<li><strong>old_Qc</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the mass of cloud water at the previous time level.</li>
<li><strong>old_Qr</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the mass of precipitation water at the previous time level.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>out_s</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the stepped isentropic density.</li>
<li><strong>out_U</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the stepped <span class="math">\(x\)</span>-momentum.</li>
<li><strong>out_V</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the stepped <span class="math">\(y\)</span>-momentum.</li>
<li><strong>out_Qv</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the stepped mass of water vapour.</li>
<li><strong>out_Qc</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the stepped mass of cloud water.</li>
<li><strong>out_Qr</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the stepped mass of precipitation water.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered._stencil_stepping_by_neglecting_vertical_advection_initialize">
<code class="descname">_stencil_stepping_by_neglecting_vertical_advection_initialize</code><span class="sig-paren">(</span><em>s_</em>, <em>u_</em>, <em>v_</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered._stencil_stepping_by_neglecting_vertical_advection_initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the GT4Py’s stencil implementing the centered time-integration scheme.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>s</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the isentropic density at current time.</li>
<li><strong>u</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the <span class="math">\(x\)</span>-velocity at current time.</li>
<li><strong>v</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the <span class="math">\(y\)</span>-velocity at current time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered._stencils_stepping_by_neglecting_vertical_advection_allocate_inputs">
<code class="descname">_stencils_stepping_by_neglecting_vertical_advection_allocate_inputs</code><span class="sig-paren">(</span><em>s_</em>, <em>u_</em>, <em>v_</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered._stencils_stepping_by_neglecting_vertical_advection_allocate_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Allocate the attributes which will serve as inputs to the GT4Py’s stencil.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>s</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the isentropic density at current time.</li>
<li><strong>u</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the <span class="math">\(x\)</span>-velocity at current time.</li>
<li><strong>v</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the stencils’ computational domain for the <span class="math">\(y\)</span>-velocity at current time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered.step_neglecting_vertical_advection">
<code class="descname">step_neglecting_vertical_advection</code><span class="sig-paren">(</span><em>dt</em>, <em>state</em>, <em>state_old=None</em>, <em>diagnostics=None</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered.step_neglecting_vertical_advection" title="Permalink to this definition">¶</a></dt>
<dd><p>Method advancing the conservative, prognostic model variables one time step forward via a centered time-integration scheme.
Only horizontal derivates are considered; possible vertical derivatives are disregarded.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the time step.</li>
<li><strong>state</strong> (<em>obj</em>) – <p><a class="reference internal" href="#storages.state_isentropic.StateIsentropic" title="storages.state_isentropic.StateIsentropic"><code class="xref py py-class docutils literal"><span class="pre">StateIsentropic</span></code></a> representing the current state.
It should contain the following variables:</p>
<ul>
<li>air_isentropic_density (unstaggered);</li>
<li>x_velocity (<span class="math">\(x\)</span>-staggered);</li>
<li>x_momentum_isentropic (unstaggered);</li>
<li>y_velocity (<span class="math">\(y\)</span>-staggered);</li>
<li>y_momentum_isentropic (unstaggered);</li>
<li>air_pressure (<span class="math">\(z\)</span>-staggered);</li>
<li>montgomery_potential (isentropic);</li>
<li>mass_fraction_of_water_vapor_in_air (unstaggered, optional);</li>
<li>mass_fraction_of_cloud_liquid_water_in_air (unstaggered, optional);</li>
<li>mass_fraction_of_precipitation_water_in_air (unstaggered, optional).</li>
</ul>
</li>
<li><strong>state_old</strong> (<cite>obj</cite>, optional) – <p><a class="reference internal" href="#storages.state_isentropic.StateIsentropic" title="storages.state_isentropic.StateIsentropic"><code class="xref py py-class docutils literal"><span class="pre">StateIsentropic</span></code></a> representing the old state.
It should contain the following variables:</p>
<ul>
<li>air_isentropic_density (unstaggered);</li>
<li>x_momentum_isentropic (unstaggered);</li>
<li>y_momentum_isentropic (unstaggered);</li>
<li>mass_fraction_of_water_vapor_in_air (unstaggered, optional);</li>
<li>mass_fraction_of_cloud_liquid_water_in_air (unstaggered, optional);</li>
<li>mass_fraction_of_precipitation_water_in_air (unstaggered, optional).</li>
</ul>
</li>
<li><strong>diagnostics</strong> (<cite>obj</cite>, optional) – <a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> possibly collecting useful diagnostics.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p><a class="reference internal" href="#storages.state_isentropic.StateIsentropic" title="storages.state_isentropic.StateIsentropic"><code class="xref py py-class docutils literal"><span class="pre">StateIsentropic</span></code></a> containing the updated prognostic variables, i.e.,</p>
<ul class="simple">
<li>air_isentropic_density (unstaggered);</li>
<li>x_momentum_isentropic (unstaggered);</li>
<li>y_momentum_isentropic (unstaggered);</li>
<li>water_vapor_isentropic_density (unstaggered, optional);</li>
<li>cloud_liquid_water_isentropic_density (unstaggered, optional);</li>
<li>precipitation_water_isentropic_density (unstaggered, optional).</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="wave-absorber">
<h3>Wave absorber<a class="headerlink" href="#wave-absorber" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="dycore.vertical_damping.VerticalDamping">
<em class="property">class </em><code class="descclassname">dycore.vertical_damping.</code><code class="descname">VerticalDamping</code><span class="sig-paren">(</span><em>grid</em>, <em>damp_depth</em>, <em>damp_max</em>, <em>backend</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.vertical_damping.VerticalDamping" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract base class whose derived classes implement different vertical damping, i.e., wave absorbing, techniques.</p>
<dl class="method">
<dt id="dycore.vertical_damping.VerticalDamping.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em>, <em>damp_depth</em>, <em>damp_max</em>, <em>backend</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.vertical_damping.VerticalDamping.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</li>
<li><strong>damp_depth</strong> (<em>int</em>) – Number of vertical layers in the damping region.</li>
<li><strong>damp_max</strong> (<em>float</em>) – Maximum value for the damping coefficient.</li>
<li><strong>backend</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode</span></code> specifying the backend for the GT4Py’s stencils implementing the dynamical core.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.vertical_damping.VerticalDamping.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>dt</em>, <em>phi_now</em>, <em>phi_new</em>, <em>phi_ref</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.vertical_damping.VerticalDamping.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply vertical damping to a generic field <span class="math">\(\phi\)</span>.
As this method is marked as abstract, its implementation is delegated to the derived classes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the time step.</li>
<li><strong>phi_now</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field <span class="math">\(\phi\)</span> at the current time level.</li>
<li><strong>phi_new</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field <span class="math">\(\phi\)</span> at the next time level, on
which the absorber will be applied.</li>
<li><strong>phi_ref</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing a reference value for <span class="math">\(\phi\)</span>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the damped field <span class="math">\(\phi\)</span>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array_like</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="dycore.vertical_damping.VerticalDamping.factory">
<em class="property">static </em><code class="descname">factory</code><span class="sig-paren">(</span><em>damp_type</em>, <em>grid</em>, <em>damp_depth</em>, <em>damp_max</em>, <em>backend</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.vertical_damping.VerticalDamping.factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Static method which returns an instance of the derived class implementing the damping method
specified by <code class="xref py py-data docutils literal"><span class="pre">damp_type</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>damp_type</strong> (<em>str</em>) – <p>String specifying the damper to implement. Either:</p>
<blockquote>
<div><ul>
<li>’rayleigh’, for a Rayleigh damper.</li>
</ul>
</div></blockquote>
</li>
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</li>
<li><strong>damp_depth</strong> (<em>int</em>) – Number of vertical layers in the damping region. Default is 15.</li>
<li><strong>damp_max</strong> (<em>float</em>) – Maximum value for the damping coefficient. Default is 0.0002.</li>
<li><strong>backend</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode</span></code> specifying the backend for the GT4Py’s stencils implementing the dynamical core.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An instance of the derived class implementing the damping method specified by <code class="xref py py-data docutils literal"><span class="pre">damp_type</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="dycore.vertical_damping.VerticalDampingRayleigh">
<em class="property">class </em><code class="descclassname">dycore.vertical_damping.</code><code class="descname">VerticalDampingRayleigh</code><span class="sig-paren">(</span><em>grid</em>, <em>damp_depth</em>, <em>damp_max</em>, <em>backend</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.vertical_damping.VerticalDampingRayleigh" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#dycore.vertical_damping.VerticalDamping" title="dycore.vertical_damping.VerticalDamping"><code class="xref py py-class docutils literal"><span class="pre">VerticalDamping</span></code></a> to implement a Rayleigh absorber.</p>
<dl class="method">
<dt id="dycore.vertical_damping.VerticalDampingRayleigh.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em>, <em>damp_depth</em>, <em>damp_max</em>, <em>backend</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.vertical_damping.VerticalDampingRayleigh.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</li>
<li><strong>damp_depth</strong> (<em>int</em>) – Number of vertical layers in the damping region.</li>
<li><strong>damp_max</strong> (<em>float</em>) – Maximum value for the damping coefficient.</li>
<li><strong>backend</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode</span></code> specifying the backend for the GT4Py’s stencils implementing the dynamical core.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.vertical_damping.VerticalDampingRayleigh._stencil_defs">
<code class="descname">_stencil_defs</code><span class="sig-paren">(</span><em>dt</em>, <em>phi_now</em>, <em>phi_new</em>, <em>phi_ref</em>, <em>R</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.vertical_damping.VerticalDampingRayleigh._stencil_defs" title="Permalink to this definition">¶</a></dt>
<dd><p>The GT4Py’s stencil applying Rayleigh vertical damping.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Global</span></code> representing the time step.</li>
<li><strong>phi_now</strong> (<em>ibj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the field <span class="math">\(\phi\)</span> at the current time level.</li>
<li><strong>phi_new</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the field <span class="math">\(\phi\)</span> at the next time level, on
which the absorber will be applied.</li>
<li><strong>phi_ref</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing a reference value for <span class="math">\(\phi\)</span>.</li>
<li><strong>R</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the damping coefficient.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the damped field <span class="math">\(\phi\)</span>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.vertical_damping.VerticalDampingRayleigh._stencil_initialize">
<code class="descname">_stencil_initialize</code><span class="sig-paren">(</span><em>phi_now</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.vertical_damping.VerticalDampingRayleigh._stencil_initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the GT4Py’s stencil applying Rayleigh vertical damping.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi_now</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field <span class="math">\(\phi\)</span> at the current time level.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.vertical_damping.VerticalDampingRayleigh._stencil_set_inputs">
<code class="descname">_stencil_set_inputs</code><span class="sig-paren">(</span><em>dt</em>, <em>phi_now</em>, <em>phi_new</em>, <em>phi_ref</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.vertical_damping.VerticalDampingRayleigh._stencil_set_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the attributes which stores the stencil’s input fields.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the time step.</li>
<li><strong>phi_now</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field <span class="math">\(\phi\)</span> at the current time level.</li>
<li><strong>phi_new</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field <span class="math">\(\phi\)</span> at the next time level, on
which the absorber will be applied.</li>
<li><strong>phi_ref</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing a reference value for <span class="math">\(\phi\)</span>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dycore.vertical_damping.VerticalDampingRayleigh.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>dt</em>, <em>phi_now</em>, <em>phi_new</em>, <em>phi_ref</em><span class="sig-paren">)</span><a class="headerlink" href="#dycore.vertical_damping.VerticalDampingRayleigh.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply vertical damping to a generic field <span class="math">\(\phi\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the time step.</li>
<li><strong>phi_now</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field <span class="math">\(\phi\)</span> at the current time level.</li>
<li><strong>phi_new</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field <span class="math">\(\phi\)</span> at the next time level, on
which the absorber will be applied.</li>
<li><strong>phi_ref</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing a reference value for <span class="math">\(\phi\)</span>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the damped field <span class="math">\(\phi\)</span>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array_like</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="grids">
<h2>Grids<a class="headerlink" href="#grids" title="Permalink to this headline">¶</a></h2>
<div class="section" id="two-dimensional-grids">
<h3>Two-dimensional grids<a class="headerlink" href="#two-dimensional-grids" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="grids.grid_xy.GridXY">
<em class="property">class </em><code class="descclassname">grids.grid_xy.</code><code class="descname">GridXY</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_y</em>, <em>ny</em>, <em>units_x='degrees_east'</em>, <em>dims_x='longitude'</em>, <em>units_y='degrees_north'</em>, <em>dims_y='latitude'</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.grid_xy.GridXY" title="Permalink to this definition">¶</a></dt>
<dd><p>Rectangular and regular two-dimensional grid embedded in a reference system whose coordinates are,
in the order, <span class="math">\(x\)</span> and <span class="math">\(y\)</span>. No assumption is made on the nature of the coordinates. For
instance, <span class="math">\(x\)</span> may be the longitude, in which case <span class="math">\(x \equiv \lambda\)</span>, and <span class="math">\(y\)</span> may
be the latitude, in which case <span class="math">\(y \equiv \phi\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference internal" href="#grids.grid_xyz.GridXYZ.x" title="grids.grid_xyz.GridXYZ.x"><strong>x</strong></a> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the <span class="math">\(x\)</span> main levels.</li>
<li><a class="reference internal" href="#grids.grid_xyz.GridXYZ.x_half_levels" title="grids.grid_xyz.GridXYZ.x_half_levels"><strong>x_half_levels</strong></a> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the <span class="math">\(x\)</span> half levels.</li>
<li><a class="reference internal" href="#grids.grid_xyz.GridXYZ.nx" title="grids.grid_xyz.GridXYZ.nx"><strong>nx</strong></a> (<em>int</em>) – Number of grid points along <span class="math">\(x\)</span>.</li>
<li><a class="reference internal" href="#grids.grid_xyz.GridXYZ.dx" title="grids.grid_xyz.GridXYZ.dx"><strong>dx</strong></a> (<em>float</em>) – The <span class="math">\(x\)</span>-spacing.</li>
<li><a class="reference internal" href="#grids.grid_xyz.GridXYZ.y" title="grids.grid_xyz.GridXYZ.y"><strong>y</strong></a> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the <span class="math">\(y\)</span> main levels.</li>
<li><a class="reference internal" href="#grids.grid_xyz.GridXYZ.y_half_levels" title="grids.grid_xyz.GridXYZ.y_half_levels"><strong>y_half_levels</strong></a> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the <span class="math">\(y\)</span> half levels.</li>
<li><a class="reference internal" href="#grids.grid_xyz.GridXYZ.ny" title="grids.grid_xyz.GridXYZ.ny"><strong>ny</strong></a> (<em>int</em>) – Number of grid points along <span class="math">\(y\)</span>.</li>
<li><a class="reference internal" href="#grids.grid_xyz.GridXYZ.dy" title="grids.grid_xyz.GridXYZ.dy"><strong>dy</strong></a> (<em>float</em>) – The <span class="math">\(y\)</span>-spacing.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="grids.grid_xy.GridXY.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_y</em>, <em>ny</em>, <em>units_x='degrees_east'</em>, <em>dims_x='longitude'</em>, <em>units_y='degrees_north'</em>, <em>dims_y='latitude'</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.grid_xy.GridXY.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>domain_x</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((x_{start}, ~ x_{stop})\)</span>.</li>
<li><strong>nx</strong> (<em>int</em>) – Number of grid points along <span class="math">\(x\)</span>.</li>
<li><strong>domain_y</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((y_{start}, ~ y_{stop})\)</span>.</li>
<li><strong>ny</strong> (<em>int</em>) – Number of grid points along <span class="math">\(y\)</span>.</li>
<li><strong>units_x</strong> (<cite>str</cite>, optional) – Units for the <span class="math">\(x\)</span>-coordinate.</li>
<li><strong>dims_x</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(x\)</span>-coordinate.</li>
<li><strong>units_y</strong> (<cite>str</cite>, optional) – Units for the <span class="math">\(y\)</span>-coordinate.</li>
<li><strong>dims_y</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(y\)</span>-coordinate.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Axes labels should use the <a class="reference external" href="http://cfconventions.org">CF Conventions</a>.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="grids.grid_xz.GridXZ">
<em class="property">class </em><code class="descclassname">grids.grid_xz.</code><code class="descname">GridXZ</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='m'</em>, <em>dims_x='x'</em>, <em>units_z='m'</em>, <em>dims_z='z'</em>, <em>z_interface=None</em>, <em>topo_type='terrain_flat'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.grid_xz.GridXZ" title="Permalink to this definition">¶</a></dt>
<dd><p>Rectangular and regular two-dimensional grid embedded in a reference system whose coordinates are</p>
<blockquote>
<div><ul class="simple">
<li>the horizontal coordinate <span class="math">\(x\)</span>;</li>
<li>the vertical (terrain-following) coordinate <span class="math">\(z\)</span>.</li>
</ul>
</div></blockquote>
<p>The vertical coordinate <span class="math">\(z\)</span> may be formulated to define a hybrid terrain-following coordinate system
with terrain-following coordinate lines between the surface terrain-height and <span class="math">\(z = z_F\)</span>, where
<span class="math">\(z\)</span>-coordinate lines change back to flat horizontal lines. However, no assumption is made on the actual
nature of <span class="math">\(z\)</span> which may be either pressure-based or height-based.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference internal" href="#grids.grid_xyz.GridXYZ.x" title="grids.grid_xyz.GridXYZ.x"><strong>x</strong></a> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the <span class="math">\(x\)</span>-axis.</li>
<li><a class="reference internal" href="#grids.grid_xyz.GridXYZ.nx" title="grids.grid_xyz.GridXYZ.nx"><strong>nx</strong></a> (<em>int</em>) – Number of grid points along <span class="math">\(x\)</span>.</li>
<li><a class="reference internal" href="#grids.grid_xyz.GridXYZ.dx" title="grids.grid_xyz.GridXYZ.dx"><strong>dx</strong></a> (<em>float</em>) – The <span class="math">\(x\)</span>-spacing.</li>
<li><strong>z</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the <span class="math">\(z\)</span>-main levels.</li>
<li><strong>z_half_levels</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the <span class="math">\(z\)</span>-half levels.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>dz</strong> (<em>float</em>) – The <span class="math">\(z\)</span>-spacing.</li>
<li><strong>z_interface</strong> (<em>float</em>) – The interface coordinate <span class="math">\(z_F\)</span>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For the sake of compliancy with the <a class="reference external" href="http://www.cosmo-model.org">COSMO model</a>, the vertical grid points are
ordered from the top of the domain to the surface.</p>
</div>
<dl class="method">
<dt id="grids.grid_xz.GridXZ.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='m'</em>, <em>dims_x='x'</em>, <em>units_z='m'</em>, <em>dims_z='z'</em>, <em>z_interface=None</em>, <em>topo_type='terrain_flat'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.grid_xz.GridXZ.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>domain_x</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((x_{left}, ~ x_{right})\)</span>.</li>
<li><strong>nx</strong> (<em>int</em>) – Number of grid points in the <span class="math">\(x\)</span>-direction.</li>
<li><strong>domain_z</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((z_{top}, ~ z_{surface})\)</span>.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>units_x</strong> (<cite>str</cite>, optional) – <p>Units for the <span class="math">\(x\)</span>-coordinate. Must be compliant with the <a class="reference external" href="http://cfconventions.org">CF Conventions</a>
(see also <a class="reference internal" href="#grids.axis.Axis.__init__" title="grids.axis.Axis.__init__"><code class="xref py py-meth docutils literal"><span class="pre">grids.axis.Axis.__init__()</span></code></a>).</p>
</li>
<li><strong>dims_x</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(x\)</span>-coordinate.</li>
<li><strong>units_z</strong> (<cite>str</cite>, optional) – <p>Units for the <span class="math">\(z\)</span>-coordinate. Must be compliant with the <a class="reference external" href="http://cfconventions.org">CF Conventions</a>
(see also <a class="reference internal" href="#grids.axis.Axis.__init__" title="grids.axis.Axis.__init__"><code class="xref py py-meth docutils literal"><span class="pre">grids.axis.Axis.__init__()</span></code></a>).</p>
</li>
<li><strong>dims_z</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(z\)</span>-coordinate.</li>
<li><strong>z_interface</strong> (<cite>float</cite>, optional) – Interface value <span class="math">\(z_F\)</span>. If not specified, it is assumed that <span class="math">\(z_F = z_T\)</span>, with <span class="math">\(z_T\)</span> the
value of <span class="math">\(z\)</span> at the top of the domain. In other words, a fully terrain-following coordinate system is
supposed.</li>
<li><strong>topo_type</strong> (<cite>str</cite>, optional) – Topography type. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a> for further details.</li>
<li><strong>topo_time</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the simulation time after which the topography should stop
increasing. Default is 0, corresponding to a time-invariant terrain surface-height. See
<a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a> for further details.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><p class="first last"><strong>kwargs</strong> – Keyword arguments to be forwarded to the constructor of <a class="reference internal" href="#grids.topography.Topography1d" title="grids.topography.Topography1d"><code class="xref py py-class docutils literal"><span class="pre">Topography1d</span></code></a>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="grids.grid_xz.GridXZ.topography_height">
<code class="descname">topography_height</code><a class="headerlink" href="#grids.grid_xz.GridXZ.topography_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the topography (i.e., terrain-surface) height.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">One-dimensional <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the topography height.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.grid_xz.GridXZ.update_topography">
<code class="descname">update_topography</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.grid_xz.GridXZ.update_topography" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the (time-dependent) topography.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the elapsed simulation time.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="grids.sigma.Sigma2d">
<em class="property">class </em><code class="descclassname">grids.sigma.</code><code class="descname">Sigma2d</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='m'</em>, <em>dims_x='x'</em>, <em>z_interface=None</em>, <em>topo_type='flat_terrain'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sigma.Sigma2d" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#grids.grid_xz.GridXZ" title="grids.grid_xz.GridXZ"><code class="xref py py-class docutils literal"><span class="pre">GridXZ</span></code></a> to represent a rectangular and regular
two-dimensional grid embedded in a reference system whose coordinates are</p>
<blockquote>
<div><ul class="simple">
<li>the horizontal coordinate <span class="math">\(x\)</span>;</li>
<li>the pressure-based terrain-following coordinate <span class="math">\(\sigma = p / p_{SL}\)</span>,                  where <span class="math">\(p\)</span> is the pressure and <span class="math">\(p_{SL}\)</span> the pressure at the sea level.</li>
</ul>
</div></blockquote>
<p>The vertical coordinate <span class="math">\(\sigma\)</span> may be formulated to define a hybrid terrain-following coordinate system
with terrain-following coordinate lines between the surface terrain-height and <span class="math">\(\sigma = \sigma_F\)</span>, where
<span class="math">\(\sigma\)</span>-coordinate lines change back to flat horizontal lines.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference internal" href="#grids.grid_xyz.GridXYZ.x" title="grids.grid_xyz.GridXYZ.x"><strong>x</strong></a> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the <span class="math">\(x\)</span>-axis.</li>
<li><a class="reference internal" href="#grids.grid_xyz.GridXYZ.nx" title="grids.grid_xyz.GridXYZ.nx"><strong>nx</strong></a> (<em>int</em>) – Number of grid points along <span class="math">\(x\)</span>.</li>
<li><a class="reference internal" href="#grids.grid_xyz.GridXYZ.dx" title="grids.grid_xyz.GridXYZ.dx"><strong>dx</strong></a> (<em>float</em>) – The <span class="math">\(x\)</span>-spacing.</li>
<li><strong>z</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the <span class="math">\(\sigma\)</span>-main levels.</li>
<li><strong>z_half_levels</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the <span class="math">\(\sigma\)</span>-half levels.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>dz</strong> (<em>float</em>) – The <span class="math">\(\sigma\)</span>-spacing.</li>
<li><strong>z_interface</strong> (<em>float</em>) – The interface coordinate <span class="math">\(\sigma_F\)</span>.</li>
<li><strong>height</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> representing the geometric height of the main levels.</li>
<li><strong>height_half_levels</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> representing the geometric height of the half levels.</li>
<li><strong>height_interface</strong> (<em>float</em>) – Geometric height corresponding to <span class="math">\(\sigma = \sigma_F\)</span>.</li>
<li><strong>reference_pressure</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> representing the reference pressure at the main levels.</li>
<li><strong>reference_pressure_half_levels</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> representing the reference pressure at the half levels.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="grids.sigma.Sigma2d.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='m'</em>, <em>dims_x='x'</em>, <em>z_interface=None</em>, <em>topo_type='flat_terrain'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sigma.Sigma2d.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>domain_x</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((x_{left}, ~ x_{right})\)</span>.</li>
<li><strong>nx</strong> (<em>int</em>) – Number of grid points in the <span class="math">\(x\)</span>-direction.</li>
<li><strong>domain_z</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((\sigma_{top}, ~ \sigma_{surface})\)</span>.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>units_x</strong> (<cite>str</cite>, optional) – <p>Units for the <span class="math">\(x\)</span>-coordinate. Must be compliant with the <a class="reference external" href="http://cfconventions.org">CF Conventions</a>
(see also <a class="reference internal" href="#grids.axis.Axis.__init__" title="grids.axis.Axis.__init__"><code class="xref py py-meth docutils literal"><span class="pre">grids.axis.Axis.__init__()</span></code></a>).</p>
</li>
<li><strong>dims_x</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(x\)</span>-coordinate.</li>
<li><strong>z_interface</strong> (<cite>float</cite>, optional) – Interface value <span class="math">\(\sigma_F\)</span>. If not specified, it is assumed that <span class="math">\(\sigma_F = \sigma_T\)</span>,
with <span class="math">\(\sigma_T\)</span> the value of <span class="math">\(\sigma\)</span> at the top of the domain. In other words, a fully
terrain-following coordinate system is supposed.</li>
<li><strong>topo_type</strong> (<cite>str</cite>, optional) – Topography type. Default is ‘flat_terrain’. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a> for further details.</li>
<li><strong>topo_time</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the simulation time after which the topography should stop
increasing. Default is 0, corresponding to a time-invariant terrain surface-height. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a>
for further details.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><p class="first last"><strong>**kwargs</strong> – Keyword arguments to be forwarded to the constructor of <a class="reference internal" href="#grids.topography.Topography1d" title="grids.topography.Topography1d"><code class="xref py py-class docutils literal"><span class="pre">Topography1d</span></code></a>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.sigma.Sigma2d._update_metric_terms">
<code class="descname">_update_metric_terms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grids.sigma.Sigma2d._update_metric_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the class by computing the metric terms, i.e., the geometric height and the reference pressure,
at both half and main levels. In doing this, a logarithmic vertical profile of reference pressure is assumed.
This method should be called every time the topography is updated or changed.</p>
</dd></dl>

<dl class="method">
<dt id="grids.sigma.Sigma2d.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sigma.Sigma2d.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the grid half levels using <a class="reference external" href="https://matplotlib.org/2.1.1/api/_as_gen/matplotlib.pyplot.html#module-matplotlib.pyplot" title="(in Matplotlib v2.1.1)"><code class="xref py py-mod docutils literal"><span class="pre">matplotlib.pyplot</span></code></a>’s utilities.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><strong>**kwargs</strong> – Keyword arguments to be forwarded to <a class="reference external" href="https://matplotlib.org/2.1.1/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="(in Matplotlib v2.1.1)"><code class="xref py py-func docutils literal"><span class="pre">matplotlib.pyplot.subplots()</span></code></a>.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For the sake of compliancy with the notation employed by <a class="reference external" href="http://www.cosmo-model.org">COSMO</a>,
the vertical geometric height is denoted by <span class="math">\(z\)</span>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="grids.sigma.Sigma2d.update_topography">
<code class="descname">update_topography</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sigma.Sigma2d.update_topography" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the (time-dependent) topography. In turn, the metric terms are re-computed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the elapsed simulation time.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="grids.gal_chen.GalChen2d">
<em class="property">class </em><code class="descclassname">grids.gal_chen.</code><code class="descname">GalChen2d</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='m'</em>, <em>dims_x='x'</em>, <em>z_interface=None</em>, <em>topo_type='flat_terrain'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.gal_chen.GalChen2d" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <code class="xref py py-class docutils literal"><span class="pre">GridXZ</span></code> to represent a rectangular and regular two-dimensional
grid embedded in a reference system whose coordinates are</p>
<blockquote>
<div><ul class="simple">
<li>the horizontal coordinate <span class="math">\(x\)</span>;</li>
<li>the height-based Gal-Chen terrain-following coordinate <span class="math">\(\mu\)</span>.</li>
</ul>
</div></blockquote>
<p>The vertical coordinate <span class="math">\(\mu\)</span> may be formulated to define a hybrid terrain-following coordinate system
with terrain-following coordinate lines between the surface terrain-height and <span class="math">\(\mu = \mu_F\)</span>, where
<span class="math">\(\mu\)</span>-coordinate lines change back to flat horizontal lines.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference internal" href="#grids.grid_xyz.GridXYZ.x" title="grids.grid_xyz.GridXYZ.x"><strong>x</strong></a> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> object representing the <span class="math">\(x\)</span>-axis.</li>
<li><a class="reference internal" href="#grids.grid_xyz.GridXYZ.nx" title="grids.grid_xyz.GridXYZ.nx"><strong>nx</strong></a> (<em>int</em>) – Number of grid points along <span class="math">\(x\)</span>.</li>
<li><a class="reference internal" href="#grids.grid_xyz.GridXYZ.dx" title="grids.grid_xyz.GridXYZ.dx"><strong>dx</strong></a> (<em>float</em>) – The <span class="math">\(x\)</span>-spacing.</li>
<li><strong>z</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the <span class="math">\(\mu\)</span>-main levels.</li>
<li><strong>z_half_levels</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the <span class="math">\(\mu\)</span>-half levels.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>dz</strong> (<em>float</em>) – The <span class="math">\(\mu\)</span>-spacing.</li>
<li><strong>z_interface</strong> (<em>float</em>) – The interface coordinate <span class="math">\(\mu_F\)</span>.</li>
<li><strong>height</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> representing the geometric height of the main levels.</li>
<li><strong>height_half_levels</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> representing the geometric height of the half levels.</li>
<li><strong>height_interface</strong> (<em>float</em>) – Geometric height corresponding to <span class="math">\(\mu = \mu_F\)</span>.</li>
<li><strong>reference_pressure</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> representing the reference pressure at the main levels.</li>
<li><strong>reference_pressure_half_levels</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> representing the reference pressure at the half levels.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="grids.gal_chen.GalChen2d.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='m'</em>, <em>dims_x='x'</em>, <em>z_interface=None</em>, <em>topo_type='flat_terrain'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.gal_chen.GalChen2d.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>domain_x</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((x_{left}, ~ x_{right})\)</span>.</li>
<li><strong>nx</strong> (<em>int</em>) – Number of grid points in the <span class="math">\(x\)</span>-direction.</li>
<li><strong>domain_z</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((\mu_{top}, ~ \mu_{surface})\)</span>.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>units_x</strong> (<cite>str</cite>, optional) – <p>Units for the <span class="math">\(x\)</span>-coordinate. Must be compliant with the <a class="reference external" href="http://cfconventions.org">CF Conventions</a>
(see also <a class="reference internal" href="#grids.axis.Axis.__init__" title="grids.axis.Axis.__init__"><code class="xref py py-meth docutils literal"><span class="pre">grids.axis.Axis.__init__()</span></code></a>).</p>
</li>
<li><strong>dims_x</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(x\)</span>-coordinate.</li>
<li><strong>z_interface</strong> (<cite>float</cite>, optional) – Interface value <span class="math">\(\mu_F\)</span>. If not specified, it is assumed that <span class="math">\(\mu_F = \mu_T\)</span>, with <span class="math">\(\mu_T\)</span>
the value of <span class="math">\(\mu\)</span> at the top of the domain. In other words, a fully terrain-following coordinate system
is supposed.</li>
<li><strong>topo_type</strong> (<cite>str</cite>, optional) – Topography type. Default is ‘flat_terrain’. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a> for further details.</li>
<li><strong>topo_time</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the simulation time after which the topography should stop increasing.
Default is 0, corresponding to a time-invariant terrain surface-height. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a> for further
details.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><p class="first last"><strong>**kwargs</strong> – Keyword arguments to be forwarded to the constructor of <a class="reference internal" href="#grids.topography.Topography1d" title="grids.topography.Topography1d"><code class="xref py py-class docutils literal"><span class="pre">Topography1d</span></code></a>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.gal_chen.GalChen2d._update_metric_terms">
<code class="descname">_update_metric_terms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grids.gal_chen.GalChen2d._update_metric_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the class by computing the metric terms, i.e., the geometric height and the reference pressure,
at both half and main levels. In doing this, a logarithmic vertical profile of reference pressure is assumed.
This method should be called every time the topography is updated or changed.</p>
</dd></dl>

<dl class="method">
<dt id="grids.gal_chen.GalChen2d.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.gal_chen.GalChen2d.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the grid half levels using <a class="reference external" href="https://matplotlib.org/2.1.1/api/_as_gen/matplotlib.pyplot.html#module-matplotlib.pyplot" title="(in Matplotlib v2.1.1)"><code class="xref py py-mod docutils literal"><span class="pre">matplotlib.pyplot</span></code></a>’s utilities.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><strong>**kwargs</strong> – Keyword arguments to be forwarded to <a class="reference external" href="https://matplotlib.org/2.1.1/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="(in Matplotlib v2.1.1)"><code class="xref py py-func docutils literal"><span class="pre">matplotlib.pyplot.subplots()</span></code></a>.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For the sake of compliancy with the notation employed by <a class="reference external" href="http://www.cosmo-model.org">COSMO</a>,
the vertical geometric height is denoted by <span class="math">\(z\)</span>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="grids.gal_chen.GalChen2d.update_topography">
<code class="descname">update_topography</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.gal_chen.GalChen2d.update_topography" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the (time-dependent) topography. In turn, the metric terms are re-computed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the elapsed simulation time.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="grids.sleve.SLEVE2d">
<em class="property">class </em><code class="descclassname">grids.sleve.</code><code class="descname">SLEVE2d</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='m'</em>, <em>dims_x='x'</em>, <em>z_interface=None</em>, <em>N=100</em>, <em>s1=8000.0</em>, <em>s2=5000.0</em>, <em>topo_type='flat_terrain'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sleve.SLEVE2d" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#grids.grid_xz.GridXZ" title="grids.grid_xz.GridXZ"><code class="xref py py-class docutils literal"><span class="pre">GridXZ</span></code></a> to represent a rectangular and regular two-dimensional
grid embedded in a reference system whose coordinates are</p>
<blockquote>
<div><ul class="simple">
<li>the horizontal coordinate <span class="math">\(x\)</span>;</li>
<li>the height-based SLEVE terrain-following coordinate <span class="math">\(\mu\)</span>.</li>
</ul>
</div></blockquote>
<p>The vertical coordinate <span class="math">\(\mu\)</span> may be formulated to define a hybrid terrain-following coordinate system
with terrain-following coordinate lines between the surface terrain-height and <span class="math">\(\mu = \mu_F\)</span>, where
<span class="math">\(\mu\)</span>-coordinate lines change back to flat horizontal lines.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference internal" href="#grids.grid_xyz.GridXYZ.x" title="grids.grid_xyz.GridXYZ.x"><strong>x</strong></a> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the <span class="math">\(x\)</span>-axis.</li>
<li><a class="reference internal" href="#grids.grid_xyz.GridXYZ.nx" title="grids.grid_xyz.GridXYZ.nx"><strong>nx</strong></a> (<em>int</em>) – Number of grid points along <span class="math">\(x\)</span>.</li>
<li><a class="reference internal" href="#grids.grid_xyz.GridXYZ.dx" title="grids.grid_xyz.GridXYZ.dx"><strong>dx</strong></a> (<em>float</em>) – The <span class="math">\(x\)</span>-spacing.</li>
<li><strong>z</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the <span class="math">\(\mu\)</span>-main levels.</li>
<li><strong>z_half_levels</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the <span class="math">\(\mu\)</span>-half levels.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>dz</strong> (<em>float</em>) – The <span class="math">\(\mu\)</span>-spacing.</li>
<li><strong>z_interface</strong> (<em>float</em>) – The interface coordinate <span class="math">\(\mu_F\)</span>.</li>
<li><strong>height</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> representing the geometric height of the main levels.</li>
<li><strong>height_half_levels</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> representing the geometric height of the half levels.</li>
<li><strong>height_interface</strong> (<em>float</em>) – Geometric height corresponding to <span class="math">\(\mu = \mu_F\)</span>.</li>
<li><strong>reference_pressure</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> representing the reference pressure at the main levels.</li>
<li><strong>reference_pressure_half_levels</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> representing the reference pressure at the half levels.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="grids.sleve.SLEVE2d.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='m'</em>, <em>dims_x='x'</em>, <em>z_interface=None</em>, <em>N=100</em>, <em>s1=8000.0</em>, <em>s2=5000.0</em>, <em>topo_type='flat_terrain'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sleve.SLEVE2d.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>domain_x</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((x_{left}, ~ x_{right})\)</span>.</li>
<li><strong>nx</strong> (<em>int</em>) – Number of grid points in the <span class="math">\(x\)</span>-direction.</li>
<li><strong>domain_z</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((\mu_{top}, ~ \mu_{surface})\)</span>.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>units_x</strong> (<cite>str</cite>, optional) – <p>Units for the <span class="math">\(x\)</span>-coordinate. Must be compliant with the <a class="reference external" href="http://cfconventions.org">CF Conventions</a>
(see also <a class="reference internal" href="#grids.axis.Axis.__init__" title="grids.axis.Axis.__init__"><code class="xref py py-meth docutils literal"><span class="pre">grids.axis.Axis.__init__()</span></code></a>).</p>
</li>
<li><strong>dims_x</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(x\)</span>-coordinate.</li>
<li><strong>z_interface</strong> (<cite>float</cite>, optional) – Interface value <span class="math">\(\mu_F\)</span>. If not specified, it is assumed that <span class="math">\(\mu_F = \mu_T\)</span>, with
<span class="math">\(\mu_T\)</span> the value of <span class="math">\(\mu\)</span> at the top of the domain. In other words, a fully terrain-following
coordinate system is supposed.</li>
<li><strong>N</strong> (<cite>int</cite>, optional) – Number of filter iterations performed to extract the large-scale component of the surface terrain-height.
Defaults to 100.</li>
<li><strong>s1</strong> (<cite>float</cite>, optional) – Large-scale decay constant. Defaults to <span class="math">\(8000 ~ m\)</span>.</li>
<li><strong>s2</strong> (<cite>float</cite>, optional) – Small-scale decay constant. Defaults to <span class="math">\(5000 ~ m\)</span>.</li>
<li><strong>topo_type</strong> (<cite>str</cite>, optional) – Topography type. Defaults to ‘flat_terrain’. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a> for further details.</li>
<li><strong>topo_time</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the simulation time after which the topography should stop
increasing. Default is 0, corresponding to a time-invariant terrain surface-height. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a>
for further details.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><p class="first last"><strong>**kwargs</strong> – Keyword arguments to be forwarded to the constructor of <a class="reference internal" href="#grids.topography.Topography1d" title="grids.topography.Topography1d"><code class="xref py py-class docutils literal"><span class="pre">Topography1d</span></code></a>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.sleve.SLEVE2d._update_metric_terms">
<code class="descname">_update_metric_terms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grids.sleve.SLEVE2d._update_metric_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the class by computing the metric terms, i.e., the geometric height and the reference pressure,
at both half and main levels. In doing this, a logarithmic vertical profile of reference pressure is assumed.
This method should be called every time the topography is updated or changed.</p>
</dd></dl>

<dl class="method">
<dt id="grids.sleve.SLEVE2d.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sleve.SLEVE2d.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the grid half levels using <a class="reference external" href="https://matplotlib.org/2.1.1/api/_as_gen/matplotlib.pyplot.html#module-matplotlib.pyplot" title="(in Matplotlib v2.1.1)"><code class="xref py py-mod docutils literal"><span class="pre">matplotlib.pyplot</span></code></a>’s utilities.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><strong>**kwargs</strong> – Keyword arguments to be forwarded to <a class="reference external" href="https://matplotlib.org/2.1.1/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="(in Matplotlib v2.1.1)"><code class="xref py py-func docutils literal"><span class="pre">matplotlib.pyplot.subplots()</span></code></a>.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For the sake of compliancy with the notation employed by <a class="reference external" href="http://www.cosmo-model.org">COSMO</a>,
the vertical geometric height is denoted by <span class="math">\(z\)</span>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="grids.sleve.SLEVE2d.update_topography">
<code class="descname">update_topography</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sleve.SLEVE2d.update_topography" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the (time-dependent) topography. In turn, the metric terms are re-computed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the elasped simulation time.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="three-dimensional-grids">
<h3>Three-dimensional grids<a class="headerlink" href="#three-dimensional-grids" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="grids.grid_xyz.GridXYZ">
<em class="property">class </em><code class="descclassname">grids.grid_xyz.</code><code class="descname">GridXYZ</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_y</em>, <em>ny</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='degrees_east'</em>, <em>dims_x='longitude'</em>, <em>units_y='degrees_north'</em>, <em>dims_y='latitude'</em>, <em>units_z='m'</em>, <em>dims_z='z'</em>, <em>z_interface=None</em>, <em>topo_type='flat_terrain'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.grid_xyz.GridXYZ" title="Permalink to this definition">¶</a></dt>
<dd><p>Rectangular and regular three-dimensional grid embedded in a reference system whose coordinates are</p>
<blockquote>
<div><ul class="simple">
<li>the first horizontal coordinate <span class="math">\(x\)</span>;</li>
<li>the second horizontal coordinate <span class="math">\(y\)</span>;</li>
<li>the vertical (terrain-following) coordinate <span class="math">\(z\)</span>.</li>
</ul>
</div></blockquote>
<p>The vertical coordinate <span class="math">\(z\)</span> may be formulated to define a hybrid terrain-following coordinate system
with terrain-following coordinate lines between the surface terrain-height and <span class="math">\(z = z_F\)</span>, where
<span class="math">\(z\)</span>-coordinate lines change back to flat horizontal lines. However, no assumption is made on the actual
nature of <span class="math">\(z\)</span> which may be either pressure-based or height-based.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>xy_grid</strong> (<em>obj</em>) – <cite>~grids.grid_xy.GridXY</cite> representing the horizontal grid..</li>
<li><strong>z</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the <span class="math">\(z\)</span>-main levels.</li>
<li><strong>z_half_levels</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the <span class="math">\(z\)</span>-half levels.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>dz</strong> (<em>float</em>) – The <span class="math">\(z\)</span>-spacing.</li>
<li><strong>z_interface</strong> (<em>float</em>) – The interface coordinate <span class="math">\(z_F\)</span>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For the sake of compliancy with the <a class="reference external" href="http://cosmo-model.org">COSMO model</a>, the vertical grid points are ordered
from the top of the domain to the surface.</p>
</div>
<dl class="method">
<dt id="grids.grid_xyz.GridXYZ.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_y</em>, <em>ny</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='degrees_east'</em>, <em>dims_x='longitude'</em>, <em>units_y='degrees_north'</em>, <em>dims_y='latitude'</em>, <em>units_z='m'</em>, <em>dims_z='z'</em>, <em>z_interface=None</em>, <em>topo_type='flat_terrain'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.grid_xyz.GridXYZ.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>domain_x</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((x_{start}, ~ x_{stop})\)</span>.</li>
<li><strong>nx</strong> (<em>int</em>) – Number of grid points in the <span class="math">\(x\)</span>-direction.</li>
<li><strong>domain_y</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((y_{start}, ~ y_{stop})\)</span>.</li>
<li><strong>ny</strong> (<em>int</em>) – Number of grid points in the <span class="math">\(y\)</span>-direction.</li>
<li><strong>domain_z</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((z_{top}, ~ z_{surface})\)</span>.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>units_x</strong> (<cite>str</cite>, optional) – <p>Units for the <span class="math">\(x\)</span>-coordinate. Must be compliant with the <a class="reference external" href="cfconventions.org">CF Conventions</a>.</p>
</li>
<li><strong>dims_x</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(x\)</span>-coordinate.</li>
<li><strong>units_y</strong> (<cite>str</cite>, optional) – <p>Units for the <span class="math">\(y\)</span>-coordinate. Must be compliant with the <a class="reference external" href="cfconventions.org">CF Conventions</a>.</p>
</li>
<li><strong>dims_y</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(y\)</span>-coordinate.</li>
<li><strong>units_z</strong> (<cite>str</cite>, optional) – <p>Units for the <span class="math">\(z\)</span>-coordinate. Must be compliant with the <a class="reference external" href="cfconventions.org">CF Conventions</a>.</p>
</li>
<li><strong>dims_z</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(z\)</span>-coordinate.</li>
<li><strong>z_interface</strong> (<cite>float</cite>, optional) – Interface value <span class="math">\(z_F\)</span>. If not specified, it is assumed that <span class="math">\(z_F = z_T\)</span>, with <span class="math">\(z_T\)</span>
the value of <span class="math">\(z\)</span> at the top of the domain. In other words, a fully terrain-following coordinate
system is supposed.</li>
<li><strong>topo_type</strong> (<cite>str</cite>, optional) – Topography type. Default is ‘flat_terrain’. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a> for further details.</li>
<li><strong>topo_time</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the simulation time after which the topography should stop
increasing. Default is 0, corresponding to a time-invariant terrain surface-height. See
<a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a> for further details.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><p class="first last"><strong>kwargs</strong> – Keyword arguments to be forwarded to the constructor of <a class="reference internal" href="#grids.topography.Topography2d" title="grids.topography.Topography2d"><code class="xref py py-class docutils literal"><span class="pre">Topography2d</span></code></a>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="grids.grid_xyz.GridXYZ.dx">
<code class="descname">dx</code><a class="headerlink" href="#grids.grid_xyz.GridXYZ.dx" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <span class="math">\(x\)</span>-spacing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The <span class="math">\(x\)</span>-spacing.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="grids.grid_xyz.GridXYZ.dy">
<code class="descname">dy</code><a class="headerlink" href="#grids.grid_xyz.GridXYZ.dy" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <span class="math">\(y\)</span>-spacing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The <span class="math">\(y\)</span>-spacing.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="grids.grid_xyz.GridXYZ.nx">
<code class="descname">nx</code><a class="headerlink" href="#grids.grid_xyz.GridXYZ.nx" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of grid points in the <span class="math">\(x\)</span>-direction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Number of grid points in the <span class="math">\(x\)</span>-direction.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="grids.grid_xyz.GridXYZ.ny">
<code class="descname">ny</code><a class="headerlink" href="#grids.grid_xyz.GridXYZ.ny" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of grid points in the <span class="math">\(y\)</span>-direction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Number of grid points in the <span class="math">\(y\)</span>-direction.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="grids.grid_xyz.GridXYZ.topography_height">
<code class="descname">topography_height</code><a class="headerlink" href="#grids.grid_xyz.GridXYZ.topography_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the topography (i.e., terrain-surface) height.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Two-dimensional <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the topography height.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.grid_xyz.GridXYZ.update_topography">
<code class="descname">update_topography</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.grid_xyz.GridXYZ.update_topography" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the (time-dependent) topography.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the elapsed simulation time.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="grids.grid_xyz.GridXYZ.x">
<code class="descname">x</code><a class="headerlink" href="#grids.grid_xyz.GridXYZ.x" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <span class="math">\(x\)</span>-axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the <span class="math">\(x\)</span>-axis.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">obj</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="grids.grid_xyz.GridXYZ.x_half_levels">
<code class="descname">x_half_levels</code><a class="headerlink" href="#grids.grid_xyz.GridXYZ.x_half_levels" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <span class="math">\(x\)</span>-half levels.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the <span class="math">\(x\)</span>-half levels.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">obj</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="grids.grid_xyz.GridXYZ.y">
<code class="descname">y</code><a class="headerlink" href="#grids.grid_xyz.GridXYZ.y" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <span class="math">\(y\)</span>-axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the <span class="math">\(y\)</span>-axis.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">obj</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="grids.grid_xyz.GridXYZ.y_half_levels">
<code class="descname">y_half_levels</code><a class="headerlink" href="#grids.grid_xyz.GridXYZ.y_half_levels" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the <span class="math">\(y\)</span>-half levels.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the <span class="math">\(y\)</span>-half levels.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">obj</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="grids.sigma.Sigma3d">
<em class="property">class </em><code class="descclassname">grids.sigma.</code><code class="descname">Sigma3d</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_y</em>, <em>ny</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='degrees_east'</em>, <em>dims_x='longitude'</em>, <em>units_y='degrees_north'</em>, <em>dims_y='latitude'</em>, <em>z_interface=None</em>, <em>topo_type='flat_terrain'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sigma.Sigma3d" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> to represent a rectangular and regular computational grid
embedded in a three-dimensional terrain-following reference system, whose coordinates are:</p>
<blockquote>
<div><ul class="simple">
<li>first horizontal coordinate <span class="math">\(x\)</span>, e.g., the longitude;</li>
<li>second horizontal coordinate <span class="math">\(y\)</span>, e.g., the latitude;</li>
<li>the pressure-based terrain-following coordinate <span class="math">\(\sigma = p / p_{SL}\)</span>,                  where <span class="math">\(p\)</span> is the pressure and <span class="math">\(p_{SL}\)</span> the pressure at the sea level.</li>
</ul>
</div></blockquote>
<p>The vertical coordinate <span class="math">\(\sigma\)</span> may be formulated to define a hybrid terrain-following coordinate system
with terrain-following coordinate lines between the surface terrain-height and <span class="math">\(\sigma = \sigma_F\)</span>, where
<span class="math">\(\sigma\)</span>-coordinate lines change back to flat horizontal lines.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>xy_grid</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.grid_xy.GridXY" title="grids.grid_xy.GridXY"><code class="xref py py-class docutils literal"><span class="pre">GridXY</span></code></a> representing the horizontal grid.</li>
<li><strong>z</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the <span class="math">\(\sigma\)</span>-main levels.</li>
<li><strong>z_half_levels</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the <span class="math">\(\sigma\)</span>-half levels.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>dz</strong> (<em>float</em>) – The <span class="math">\(\sigma\)</span>-spacing.</li>
<li><strong>z_interface</strong> (<em>float</em>) – The interface coordinate <span class="math">\(\sigma_F\)</span>.</li>
<li><strong>height</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> representing the geometric height of the main levels.</li>
<li><strong>height_half_levels</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> representing the geometric height of the half levels.</li>
<li><strong>height_interface</strong> (<em>float</em>) – Geometric height corresponding to <span class="math">\(\sigma = \sigma_F\)</span>.</li>
<li><strong>reference_pressure</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the reference pressure at the main levels.</li>
<li><strong>reference_pressure_half_levels</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> storing the reference pressure at the half levels.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="grids.sigma.Sigma3d.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_y</em>, <em>ny</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='degrees_east'</em>, <em>dims_x='longitude'</em>, <em>units_y='degrees_north'</em>, <em>dims_y='latitude'</em>, <em>z_interface=None</em>, <em>topo_type='flat_terrain'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sigma.Sigma3d.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>domain_x</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((x_{left}, ~ x_{right})\)</span>.</li>
<li><strong>nx</strong> (<em>int</em>) – Number of grid points in the <span class="math">\(x\)</span>-direction.</li>
<li><strong>domain_y</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((y_{left}, ~ y_{right})\)</span>.</li>
<li><strong>ny</strong> (<em>int</em>) – Number of grid points in the <span class="math">\(y\)</span>-direction.</li>
<li><strong>domain_z</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((\sigma_{top}, ~ \sigma_{surface})\)</span>.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>units_x</strong> (<cite>str</cite>, optional) – <p>Units for the <span class="math">\(x\)</span>-coordinate. Must be compliant with the <a class="reference external" href="http://cfconventions.org">CF Conventions</a>
(see also <a class="reference internal" href="#grids.axis.Axis.__init__" title="grids.axis.Axis.__init__"><code class="xref py py-meth docutils literal"><span class="pre">grids.axis.Axis.__init__()</span></code></a>).</p>
</li>
<li><strong>dims_x</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(x\)</span>-coordinate.</li>
<li><strong>units_y</strong> (<cite>str</cite>, optional) – <p>Units for the <span class="math">\(y\)</span>-coordinate. Must be compliant with the <a class="reference external" href="http://cfconventions.org">CF Conventions</a>
(see also <a class="reference internal" href="#grids.axis.Axis.__init__" title="grids.axis.Axis.__init__"><code class="xref py py-meth docutils literal"><span class="pre">grids.axis.Axis.__init__()</span></code></a>).</p>
</li>
<li><strong>dims_y</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(y\)</span>-coordinate.</li>
<li><strong>z_interface</strong> (<cite>float</cite>, optional) – Interface value <span class="math">\(\sigma_F\)</span>. If not specified, it is assumed that <span class="math">\(\sigma_F = \sigma_T\)</span>,
with <span class="math">\(\sigma_T\)</span> the value of  <span class="math">\(\sigma\)</span> at the top of the domain. In other words, a fully
terrain-following coordinate system is supposed.</li>
<li><strong>topo_type</strong> (<cite>str</cite>, optional) – Topography type. Default is ‘flat_terrain’. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a> for further details.</li>
<li><strong>topo_time</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the simulation time after which the topography should stop
increasing. Default is 0, corresponding to a time-invariant terrain surface-height.
See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a> for further details.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><p class="first last"><strong>**kwargs</strong> – Keyword arguments to be forwarded to the constructor of <a class="reference internal" href="#grids.topography.Topography2d" title="grids.topography.Topography2d"><code class="xref py py-class docutils literal"><span class="pre">Topography2d</span></code></a>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.sigma.Sigma3d._update_metric_terms">
<code class="descname">_update_metric_terms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grids.sigma.Sigma3d._update_metric_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the class by computing the metric terms, i.e., the geometric height and the reference pressure,
at both half and main levels. In doing this, a logarithmic vertical profile of reference pressure is assumed.
This method should be called every time the topography is updated or changed.</p>
</dd></dl>

<dl class="method">
<dt id="grids.sigma.Sigma3d.update_topography">
<code class="descname">update_topography</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sigma.Sigma3d.update_topography" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the (time-dependent) topography. In turn, the metric terms are re-computed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the elapsed simulation time.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="grids.gal_chen.GalChen3d">
<em class="property">class </em><code class="descclassname">grids.gal_chen.</code><code class="descname">GalChen3d</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_y</em>, <em>ny</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='degrees_east'</em>, <em>dims_x='longitude'</em>, <em>units_y='degrees_north'</em>, <em>dims_y='latitude'</em>, <em>z_interface=None</em>, <em>topo_type='flat_terrain'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.gal_chen.GalChen3d" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> to represent a rectangular and regular computational grid
embedded in a three-dimensional terrain-following reference system, whose coordinates are:</p>
<blockquote>
<div><ul class="simple">
<li>first horizontal coordinate <span class="math">\(x\)</span>, e.g., the longitude;</li>
<li>second horizontal coordinate <span class="math">\(y\)</span>, e.g., the latitude;</li>
<li>the Gal-Chen terrain-following coordinate <span class="math">\(\mu\)</span>.</li>
</ul>
</div></blockquote>
<p>The vertical coordinate <span class="math">\(\mu\)</span> may be formulated to define a hybrid terrain-following coordinate system
with terrain-following coordinate lines between the surface terrain-height and <span class="math">\(\mu = \mu_F\)</span>, where
<span class="math">\(\mu\)</span>-coordinate lines change back to flat horizontal lines.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>xy_grid</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.grid_xy.GridXY" title="grids.grid_xy.GridXY"><code class="xref py py-class docutils literal"><span class="pre">GridXY</span></code></a> representing the horizontal grid.</li>
<li><strong>z</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the <span class="math">\(z\)</span>-main levels.</li>
<li><strong>z_half_levels</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the <span class="math">\(z\)</span>-half levels.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>dz</strong> (<em>float</em>) – The <span class="math">\(z\)</span>-spacing.</li>
<li><strong>z_interface</strong> (<em>float</em>) – The interface coordinate <span class="math">\(z_F\)</span>.</li>
<li><strong>height</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> representing the geometric height of the main levels.</li>
<li><strong>height_half_levels</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> representing the geometric height of the half levels.</li>
<li><strong>height_interface</strong> (<em>float</em>) – Geometric height corresponding to <span class="math">\(\mu = \mu_F\)</span>.</li>
<li><strong>reference_pressure</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> representing the reference pressure at the main levels.</li>
<li><strong>reference_pressure_half_levels</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> representing the reference pressure at the half levels.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="grids.gal_chen.GalChen3d.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_y</em>, <em>ny</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='degrees_east'</em>, <em>dims_x='longitude'</em>, <em>units_y='degrees_north'</em>, <em>dims_y='latitude'</em>, <em>z_interface=None</em>, <em>topo_type='flat_terrain'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.gal_chen.GalChen3d.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>domain_x</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((x_{left}, ~ x_{right})\)</span>.</li>
<li><strong>nx</strong> (<em>int</em>) – Number of grid points in the <span class="math">\(x\)</span>-direction.</li>
<li><strong>domain_y</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((y_{left}, ~ y_{right})\)</span>.</li>
<li><strong>ny</strong> (<em>int</em>) – Number of grid points in the <span class="math">\(y\)</span>-direction.</li>
<li><strong>domain_z</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((\mu_{top}, ~ \mu_{surface})\)</span>.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>units_x</strong> (<cite>str</cite>, optional) – <p>Units for the <span class="math">\(x\)</span>-coordinate. Must be compliant with the <a class="reference external" href="http://cfconventions.org">CF Conventions</a>
(see also <a class="reference internal" href="#grids.axis.Axis.__init__" title="grids.axis.Axis.__init__"><code class="xref py py-meth docutils literal"><span class="pre">grids.axis.Axis.__init__()</span></code></a>).</p>
</li>
<li><strong>dims_x</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(x\)</span>-coordinate.</li>
<li><strong>str</strong><strong>, </strong><strong>optional</strong> (<em>units_y</em>) – <p>Units for the <span class="math">\(y\)</span>-coordinate. Must be compliant with the <a class="reference external" href="http://cfconventions.org">CF Conventions</a>
(see also <a class="reference internal" href="#grids.axis.Axis.__init__" title="grids.axis.Axis.__init__"><code class="xref py py-meth docutils literal"><span class="pre">grids.axis.Axis.__init__()</span></code></a>).</p>
</li>
<li><strong>dims_y</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(y\)</span>-coordinate.</li>
<li><strong>z_interface</strong> (<cite>float</cite>, optional) – Interface value <span class="math">\(zmu_F = \mu_F\)</span>. If not specified, it is assumed that <span class="math">\(\mu_F = \mu_T\)</span>, with
<span class="math">\(\mu_T\)</span> the value of <span class="math">\(\mu\)</span> at the top of the domain. In other words, a fully terrain-following
coordinate nsystem is supposed.</li>
<li><strong>topo_type</strong> (<cite>str</cite>, optional) – Topography type. Default is ‘flat_terrain’. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a> for further details.</li>
<li><strong>topo_time</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the simulation time after which the topography should stop increasing.
Default is 0, corresponding to a time-invariant terrain surface-height. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a> for further
details.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><p class="first last"><strong>**kwargs</strong> – Keyword arguments to be forwarded to the constructor of <a class="reference internal" href="#grids.topography.Topography2d" title="grids.topography.Topography2d"><code class="xref py py-class docutils literal"><span class="pre">Topography2d</span></code></a>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.gal_chen.GalChen3d._update_metric_terms">
<code class="descname">_update_metric_terms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grids.gal_chen.GalChen3d._update_metric_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the class by computing the metric terms, i.e., the geometric height and the reference pressure,
at both half and main levels. In doing this, a logarithmic vertical profile of reference pressure is assumed.
This method should be called every time the topography is updated or changed.</p>
</dd></dl>

<dl class="method">
<dt id="grids.gal_chen.GalChen3d.update_topography">
<code class="descname">update_topography</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.gal_chen.GalChen3d.update_topography" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the (time-dependent) topography. In turn, the metric terms are re-computed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the elapsed simulation time.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="grids.sleve.SLEVE3d">
<em class="property">class </em><code class="descclassname">grids.sleve.</code><code class="descname">SLEVE3d</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_y</em>, <em>ny</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='degrees_east'</em>, <em>dims_x='longitude'</em>, <em>units_y='degrees_north'</em>, <em>dims_y='latitude'</em>, <em>z_interface=None</em>, <em>N=100</em>, <em>s1=8000.0</em>, <em>s2=5000.0</em>, <em>topo_type='flat_terrain'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sleve.SLEVE3d" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> to represent a rectangular and regular computational grid
embedded in a three-dimensional terrain-following reference system, whose coordinates are:</p>
<blockquote>
<div><ul class="simple">
<li>first horizontal coordinate <span class="math">\(x\)</span>, e.g., the longitude;</li>
<li>second horizontal coordinate <span class="math">\(y\)</span>, e.g., the latitude;</li>
<li>the SLEVE terrain-following coordinate <span class="math">\(\mu\)</span>.</li>
</ul>
</div></blockquote>
<p>The vertical coordinate <span class="math">\(\mu\)</span> may be formulated to define a hybrid terrain-following coordinate system
with terrain-following coordinate lines between the surface terrain-height and <span class="math">\(\mu = \mu_F\)</span>, where
<span class="math">\(\mu\)</span>-coordinate lines change back to flat horizontal lines.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>xy_grid</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.grid_xy.GridXY" title="grids.grid_xy.GridXY"><code class="xref py py-class docutils literal"><span class="pre">GridXY</span></code></a> representing the horizontal grid.</li>
<li><strong>z</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the <span class="math">\(z\)</span>-main levels.</li>
<li><strong>z_half_levels</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the <span class="math">\(z\)</span>-half levels.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>dz</strong> (<em>float</em>) – The <span class="math">\(z\)</span>-spacing.</li>
<li><strong>z_interface</strong> (<em>float</em>) – The interface coordinate <span class="math">\(z_F\)</span>.</li>
<li><strong>height</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> representing the geometric height of the main levels.</li>
<li><strong>height_half_levels</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> representing the geometric height of the half levels.</li>
<li><strong>height_interface</strong> (<em>float</em>) – Geometric height corresponding to <span class="math">\(\mu = \mu_F\)</span>.</li>
<li><strong>reference_pressure</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> representing the reference pressure at the main levels.</li>
<li><strong>reference_pressure_half_levels</strong> (<em>obj</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> representing the reference pressure at the half levels.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="grids.sleve.SLEVE3d.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>domain_x</em>, <em>nx</em>, <em>domain_y</em>, <em>ny</em>, <em>domain_z</em>, <em>nz</em>, <em>units_x='degrees_east'</em>, <em>dims_x='longitude'</em>, <em>units_y='degrees_north'</em>, <em>dims_y='latitude'</em>, <em>z_interface=None</em>, <em>N=100</em>, <em>s1=8000.0</em>, <em>s2=5000.0</em>, <em>topo_type='flat_terrain'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sleve.SLEVE3d.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>domain_x</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((x_{left}, ~ x_{right})\)</span>.</li>
<li><strong>nx</strong> (<em>int</em>) – Number of grid points in the <span class="math">\(x\)</span>-direction.</li>
<li><strong>domain_y</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((y_{left}, ~ y_{right})\)</span>.</li>
<li><strong>ny</strong> (<em>int</em>) – Number of grid points in the <span class="math">\(y\)</span>-direction.</li>
<li><strong>domain_z</strong> (<em>tuple</em>) – Tuple in the form <span class="math">\((\mu_{top}, ~ \mu_{surface})\)</span>.</li>
<li><strong>nz</strong> (<em>int</em>) – Number of vertical main levels.</li>
<li><strong>units_x</strong> (<cite>str</cite>, optional) – <p>Units for the <span class="math">\(x\)</span>-coordinate. Must be compliant with the <a class="reference external" href="http://cfconventions.org">CF Conventions</a>
(see also <a class="reference internal" href="#grids.axis.Axis.__init__" title="grids.axis.Axis.__init__"><code class="xref py py-meth docutils literal"><span class="pre">grids.axis.Axis.__init__()</span></code></a>).</p>
</li>
<li><strong>dims_x</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(x\)</span>-coordinate.</li>
<li><strong>units_y</strong> (<cite>str</cite>, optional) – <p>Units for the <span class="math">\(y\)</span>-coordinate. Must be compliant with the <a class="reference external" href="http://cfconventions.org">CF Conventions</a>
(see also <a class="reference internal" href="#grids.axis.Axis.__init__" title="grids.axis.Axis.__init__"><code class="xref py py-meth docutils literal"><span class="pre">grids.axis.Axis.__init__()</span></code></a>).</p>
</li>
<li><strong>dims_y</strong> (<cite>str</cite>, optional) – Label for the <span class="math">\(y\)</span>-coordinate.</li>
<li><strong>z_interface</strong> (<cite>float</cite>, optional) – Interface value <span class="math">\(zmu_F = \mu_F\)</span>. If not specified, it is assumed that <span class="math">\(\mu_F = \mu_T\)</span>, with
<span class="math">\(\mu_T\)</span> the value of <span class="math">\(\mu\)</span> at the top of the domain. In other words, a fully terrain-following
coordinate nsystem is supposed.</li>
<li><strong>N</strong> (<cite>int</cite>, optional) – Number of filter iterations performed to determine the large-scale component of the surface terrain-height.
Defaults to 100.</li>
<li><strong>s1</strong> (<cite>float</cite>, optional) – Large-scale decay constant. Defaults to <span class="math">\(8000 ~ m\)</span>.</li>
<li><strong>s2</strong> (<cite>float</cite>, optional) – Small-scale decay constant. Defaults to <span class="math">\(5000 ~ m\)</span>.</li>
<li><strong>topo_type</strong> (<cite>str</cite>, optional) – Topography type. Defaults to ‘flat_terrain’. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a> for further details.</li>
<li><strong>topo_time</strong> (<cite>obj</cite>, optional) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the simulation time after which the topography should stop
increasing. Default is 0, corresponding to a time-invariant terrain surface-height. See <a class="reference internal" href="#module-grids.topography" title="grids.topography"><code class="xref py py-mod docutils literal"><span class="pre">grids.topography</span></code></a>
for further details.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><p class="first last"><strong>**kwargs</strong> – Keyword arguments to be forwarded to the constructor of <a class="reference internal" href="#grids.topography.Topography2d" title="grids.topography.Topography2d"><code class="xref py py-class docutils literal"><span class="pre">Topography2d</span></code></a>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.sleve.SLEVE3d._update_metric_terms">
<code class="descname">_update_metric_terms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grids.sleve.SLEVE3d._update_metric_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the class by computing the metric terms, i.e., the geometric height and the reference pressure,
at both half and main levels. In doing this, a logarithmic vertical profile of reference pressure is assumed.
This method should be called every time the topography is updated or changed.</p>
</dd></dl>

<dl class="method">
<dt id="grids.sleve.SLEVE3d.update_topography">
<code class="descname">update_topography</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.sleve.SLEVE3d.update_topography" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the (time-dependent) topography. In turn, the metric terms are re-computed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the elapsed simulation time.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="model">
<h2>Model<a class="headerlink" href="#model" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="model.Model">
<em class="property">class </em><code class="descclassname">model.</code><code class="descname">Model</code><span class="sig-paren">(</span><em>dynamical_core</em>, <em>diagnostics=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#model.Model" title="Permalink to this definition">¶</a></dt>
<dd><p>This class is intended to represent and run a generic climate or meteorological numerical model.</p>
<dl class="method">
<dt id="model.Model.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>dt</em>, <em>simulation_time</em>, <em>state</em>, <em>save_iterations=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#model.Model.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call operator integrating the model forward in time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the time step.</li>
<li><strong>simulation_time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the simulation time.</li>
<li><strong>state</strong> (<em>obj</em>) – The initial state, as an instance of <a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> or one of its derived classes.</li>
<li><strong>save_freq</strong> (<cite>tuple</cite>, optional) – The iterations at which the state should be saved. Default is empty, meaning that only the initial and
final states are saved.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>state_out</strong> (<em>obj</em>) – The final state, of the same class of <code class="xref py py-data docutils literal"><span class="pre">state</span></code>.</li>
<li><strong>state_save</strong> (<em>obj</em>) – The sequence of saved states, of the same class of <code class="xref py py-data docutils literal"><span class="pre">state</span></code>.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.Model.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>dynamical_core</em>, <em>diagnostics=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#model.Model.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dynamical_core</strong> (<em>obj</em>) – An instance of <a class="reference internal" href="#dycore.dycore.DynamicalCore" title="dycore.dycore.DynamicalCore"><code class="xref py py-class docutils literal"><span class="pre">DynamicalCore</span></code></a> or one of its derived classes, implementing a dynamical core.</li>
<li><strong>diagnostics</strong> (<cite>list</cite>, optional) – List of diagnostics. Default is empty.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-namelist">
<span id="namelist"></span><h2>Namelist<a class="headerlink" href="#module-namelist" title="Permalink to this headline">¶</a></h2>
<p>Configuration and global variables used throughout the package.</p>
<dl class="docutils">
<dt>Physical constants:</dt>
<dd><ul class="first last simple">
<li><code class="xref py py-data docutils literal"><span class="pre">namelist.p_ref</span></code>: Reference pressure ([<span class="math">\(Pa\)</span>]).</li>
<li><code class="xref py py-data docutils literal"><span class="pre">namelist.p_sl</span></code>: Reference pressure at sea level ([<span class="math">\(Pa\)</span>]).</li>
<li><code class="xref py py-data docutils literal"><span class="pre">namelist.T_sl</span></code>: Reference temperature at sea level ([<span class="math">\(K\)</span>]).</li>
<li><code class="xref py py-data docutils literal"><span class="pre">namelist.beta</span></code>: Rate of increase in reference temperature with the logarithm           of reference pressure ([<span class="math">\(K ~ Pa^{-1}\)</span>]).</li>
<li><code class="xref py py-data docutils literal"><span class="pre">namelist.Rd</span></code>: Gas constant for dry airi ([<span class="math">\(J ~ K^{-1} ~ Kg^{-1}\)</span>]).</li>
<li><code class="xref py py-data docutils literal"><span class="pre">namelist.Rv</span></code>: Gas constant for water vapor ([<span class="math">\(J ~ K^{-1} ~ Kg^{-1}\)</span>]).</li>
<li><code class="xref py py-data docutils literal"><span class="pre">namelist.cp</span></code>: Specific heat of dry air at constant pressure ([<span class="math">\(J ~ K^{-1} ~ Kg^{-1}\)</span>]).</li>
<li><code class="xref py py-data docutils literal"><span class="pre">namelist.g</span></code>: Mean gravitational acceleration ([<span class="math">\(m ~ s^{-2}\)</span>]).</li>
</ul>
</dd>
<dt>Grid settings:</dt>
<dd><ul class="first last">
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.domain_x</span></code>: Tuple storing the boundaries of the domain in the <span class="math">\(x\)</span>-direction              in the form (<span class="math">\(x_{west}\)</span>, <span class="math">\(x_{east}\)</span>).</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.nx</span></code>: Number of grid points in the <span class="math">\(x\)</span>-direction.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.domain_y</span></code>: Tuple storing the boundaries of the domain in the <span class="math">\(y\)</span>-direction              in the form (<span class="math">\(y_{south}\)</span>, <span class="math">\(y_{north}\)</span>).</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.ny</span></code>: Number of grid points in the <span class="math">\(y\)</span>-direction.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.domain_z</span></code>: Tuple storing the boundaries of the domain in the <span class="math">\(z\)</span>-direction              in the form (<span class="math">\(z_{top}\)</span>, <span class="math">\(z_{bottom}\)</span>).</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.nz</span></code>: Number of grid points in the <span class="math">\(z\)</span>-direction.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.z_interface</span></code>: For a hybrid coordinate system, interface level at which terrain-following              <span class="math">\(z\)</span>-coordinate lines get back to horizontal lines.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.topo_type</span></code>: Topography type. Available options are:</p>
<blockquote>
<div><ul class="simple">
<li>‘flat_terrain’;</li>
<li>‘gaussian’;</li>
<li>‘schaer’;</li>
<li>‘user_defined’.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.topo_time</span></code>: <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> object representing the elapsed simulation time                               after which the topography should stop increasing.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.topo_max_height</span></code>: When <code class="xref py py-data docutils literal"><span class="pre">topo_type</span></code> is ‘gaussian’, maximum mountain height ([<span class="math">\(m\)</span>]).</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.topo_width_x</span></code>: When <code class="xref py py-data docutils literal"><span class="pre">topo_type</span></code> is ‘gaussian’, mountain half-width in <span class="math">\(x\)</span>-direction             ([<span class="math">\(m\)</span>]).</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.topo_width_y</span></code>: When <code class="xref py py-data docutils literal"><span class="pre">topo_type</span></code> is ‘gaussian’, mountain half-width in <span class="math">\(y\)</span>-direction             ([<span class="math">\(m\)</span>]).</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.topo_str</span></code>: When <code class="xref py py-data docutils literal"><span class="pre">topo_type</span></code> is ‘user_defined’, terrain profile expression in the              independent variables <span class="math">\(x\)</span> and <span class="math">\(y\)</span>. Must be fully C++-compliant.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.topo_kwargs</span></code>: Dictionary storing <code class="xref py py-data docutils literal"><span class="pre">topo_max_height</span></code>, <code class="xref py py-data docutils literal"><span class="pre">topo_width_x</span></code>,           <code class="xref py py-data docutils literal"><span class="pre">topo_width_y</span></code> and <code class="xref py py-data docutils literal"><span class="pre">topo_str</span></code>.</p>
</li>
</ul>
</dd>
<dt>Model settings:</dt>
<dd><ul class="first last">
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.model_name</span></code>: Name of the model to implement. Available options are:</p>
<blockquote>
<div><ul class="simple">
<li>‘isentropic’, for the isentropic model.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.moist_on</span></code>: <code class="xref py py-data docutils literal"><span class="pre">True</span></code> if water constituents should be taken into account, <code class="xref py py-data docutils literal"><span class="pre">False</span></code> otherwise.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.horizontal_boundary_type</span></code>: Horizontal boundary conditions. Available options are:</p>
<blockquote>
<div><ul class="simple">
<li>‘periodic’, for periodic boundary conditions;</li>
<li>‘relaxed’, for relaxed boundary conditions.</li>
</ul>
</div></blockquote>
</li>
</ul>
</dd>
<dt>Numerical settings:</dt>
<dd><ul class="first last">
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.time_scheme</span></code>: Time integration scheme to implement. Available options are:</p>
<blockquote>
<div><ul class="simple">
<li>‘forward_euler’, for the forward Euler scheme;</li>
<li>‘centered’, for a centered time-integration scheme.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.flux_scheme</span></code>: Numerical flux to use. Available options are:</p>
<blockquote>
<div><ul class="simple">
<li>‘upwind’, for the upwind scheme;</li>
<li>‘centered’, for a second-order centered scheme;</li>
<li>‘maccormack’, for the MacCormack scheme.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.damp_on</span></code>: <code class="xref py py-data docutils literal"><span class="pre">True</span></code> if (explicit) vertical damping should be applied, <code class="xref py py-data docutils literal"><span class="pre">False</span></code> otherwise.             Note that when vertical damping is switched off, the numerical diffusion is monotonically increased towards             the top of the model, so to act as a diffusive wave absorber.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.damp_type</span></code>: Type of vertical damping to apply. Available options are:</p>
<blockquote>
<div><ul class="simple">
<li>‘rayleigh’, for Rayleigh vertical damping.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.damp_depth</span></code>: Number of levels (either main levels or half levels) in the absorbing region.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.damp_max</span></code>: Maximum value which should be assumed by the damping coefficient.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.smooth_on</span></code>: <code class="xref py py-data docutils literal"><span class="pre">True</span></code> to enable numerical horizontal smoothing, <code class="xref py py-data docutils literal"><span class="pre">False</span></code> otherwise.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.smooth_type</span></code>: Type of smoothing technique to implement. Available options are:</p>
<blockquote>
<div><ul class="simple">
<li>‘first_order’, for first-order smoothing;</li>
<li>‘second_order’, for second-order smoothing.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.smooth_depth</span></code>: Number of levels (either main levels or half levels) in the smoothing absorbing region.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.smooth_coeff</span></code>: The smoothing coefficient.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.smooth_coeff_max</span></code>: Maximum value for the smoothing coefficient when smoothing vertical damping is enabled.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.smooth_moist_on</span></code>: <code class="xref py py-data docutils literal"><span class="pre">True</span></code> to enable numerical horizontal smoothing on the moisture constituents,                 <code class="xref py py-data docutils literal"><span class="pre">False</span></code> otherwise.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.smooth_moist_type</span></code>: Type of smoothing technique to apply on the moisture constituents. Available options are:</p>
<blockquote>
<div><ul class="simple">
<li>‘first_order’, for first-order smoothing;</li>
<li>‘second_order’, for second-order smoothing.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.smooth_moist_depth</span></code>: Number of levels (either main levels or half levels) in the smoothing absorbing region           for the moisture constituents.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.smooth_coeff_moist</span></code>: The smoothing coefficient for the moisture components.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.smooth_coeff_moist_max</span></code>: Maximum value for the smoothing coefficient for the moisture components when                 smoothing vertical damping is enabled.</p>
</li>
</ul>
</dd>
<dt>Microphysics settings:</dt>
<dd><ul class="first last simple">
<li><code class="xref py py-data docutils literal"><span class="pre">namelist.coupling_physics_dynamics_on</span></code>: <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> to couple physics with dynamics, i.e., to take the change over             time in potential temperature, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</li>
<li><code class="xref py py-data docutils literal"><span class="pre">namelist.sedimentation_on</span></code>: <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> to account for rain sedimentation, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</li>
</ul>
</dd>
<dt>Simulation settings:</dt>
<dd><ul class="first last">
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.dt</span></code>: <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> object representing the timestep.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.initial_time</span></code>: <code class="xref py py-class docutils literal"><span class="pre">datetime.datetime</span></code> representing the initial simulation time.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.simulation_time</span></code>: <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> object representing the simulation time.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.initial_state_type</span></code>: Integer identifying the initial state. See the documentation for the method              <code class="xref py py-meth docutils literal"><span class="pre">get_initial_state()</span></code> of               <code class="xref py py-class docutils literal"><span class="pre">DycoreIsentropic</span></code>.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.x_velocity_initial</span></code>: The initial, uniform <span class="math">\(x\)</span>-velocity ([<span class="math">\(m s^{-1}\)</span>]).</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.y_velocity_initial</span></code>: The initial, uniform <span class="math">\(y\)</span>-velocity ([<span class="math">\(m s^{-1}\)</span>]).</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.brunt_vaisala_initial</span></code>: The initial, uniform Brunt-Vaisala frequency.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.temperature_initial</span></code>: The initial, uniform temperature ([<span class="math">\(K\)</span>]).</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.initial_state_kwargs</span></code>: Dictionary storing <code class="xref py py-data docutils literal"><span class="pre">x_velocity_initial</span></code>,               <code class="xref py py-data docutils literal"><span class="pre">y_velocity_initial</span></code>, <code class="xref py py-data docutils literal"><span class="pre">brunt_vaisala_initial</span></code> and <code class="xref py py-data docutils literal"><span class="pre">temperature_initial</span></code>.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.backend</span></code>: GT4Py’s backend to use. Available options are:</p>
<blockquote>
<div><ul class="simple">
<li><code class="xref py py-data docutils literal"><span class="pre">gridtools.mode.NUMPY</span></code>: Numpy (i.e., vectorized) backend.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.save_iterations</span></code>: List of the iterations at which the state should be saved.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.save_dest</span></code>: Path to the location where results should be saved.</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.tol</span></code>: Tolerance used to compare floats (see <code class="xref py py-mod docutils literal"><span class="pre">utils</span></code>).</p>
</li>
<li><p class="first"><code class="xref py py-data docutils literal"><span class="pre">namelist.datatype</span></code>: Datatype for <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a>. Either <code class="xref py py-data docutils literal"><span class="pre">np.float32</span></code> or <code class="xref py py-data docutils literal"><span class="pre">np.float64</span></code>.</p>
</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="parameterizations">
<h2>Parameterizations<a class="headerlink" href="#parameterizations" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="parameterizations.adjustment.Adjustment">
<em class="property">class </em><code class="descclassname">parameterizations.adjustment.</code><code class="descname">Adjustment</code><span class="sig-paren">(</span><em>grid</em><span class="sig-paren">)</span><a class="headerlink" href="#parameterizations.adjustment.Adjustment" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract base class whose derived classes implement different ajustment schemes.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All the derived classes should be model-agnostic.</p>
</div>
<dl class="method">
<dt id="parameterizations.adjustment.Adjustment.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>dt</em>, <em>state</em><span class="sig-paren">)</span><a class="headerlink" href="#parameterizations.adjustment.Adjustment.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Entry-point method applying the parameterization scheme.
As this method is marked as abstract, its implementation is delegated to the derived classes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the timestep.</li>
<li><strong>state</strong> (<em>obj</em>) – <a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> or one of its derived classes representing the current state.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>state_new</strong> (<em>obj</em>) – <a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> storing the output, adjusted state.</li>
<li><strong>diagnostics</strong> (<em>obj</em>) – <a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> storing possible output diagnostics.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parameterizations.adjustment.Adjustment.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em><span class="sig-paren">)</span><a class="headerlink" href="#parameterizations.adjustment.Adjustment.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="parameterizations.adjustment.Adjustment.time_levels">
<code class="descname">time_levels</code><a class="headerlink" href="#parameterizations.adjustment.Adjustment.time_levels" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the attribute representing the number of time levels the dynamical core relies on.
If this is set to <code class="xref py py-obj docutils literal"><span class="pre">None</span></code>, a <code class="xref py py-class docutils literal"><span class="pre">ValueError</span></code> is thrown.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The number of time levels the dynamical core relies on.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="parameterizations.tendency.Tendency">
<em class="property">class </em><code class="descclassname">parameterizations.tendency.</code><code class="descname">Tendency</code><span class="sig-paren">(</span><em>grid</em><span class="sig-paren">)</span><a class="headerlink" href="#parameterizations.tendency.Tendency" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract base class whose derived classes implement different parameterization schemes, providing tendencies.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All the derived classes should be model-agnostic.</p>
</div>
<dl class="method">
<dt id="parameterizations.tendency.Tendency.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>dt</em>, <em>state</em><span class="sig-paren">)</span><a class="headerlink" href="#parameterizations.tendency.Tendency.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Entry-point method applying the parameterization scheme.
As this method is marked as abstract, its implementation is delegated to the derived classes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the timestep.</li>
<li><strong>state</strong> (<em>obj</em>) – <a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> or one of its derived classes representing the current state.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>tendencies</strong> (<em>obj</em>) – <a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> storing the output tendencies.</li>
<li><strong>diagnostics</strong> (<em>obj</em>) – <a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> storing possible output diagnostics.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parameterizations.tendency.Tendency.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em><span class="sig-paren">)</span><a class="headerlink" href="#parameterizations.tendency.Tendency.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<div class="section" id="microphysics">
<h3>Microphysics<a class="headerlink" href="#microphysics" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="parameterizations.adjustment_microphysics.AdjustmentMicrophysics">
<em class="property">class </em><code class="descclassname">parameterizations.adjustment_microphysics.</code><code class="descname">AdjustmentMicrophysics</code><span class="sig-paren">(</span><em>grid</em>, <em>rain_evaporation_on</em>, <em>backend</em><span class="sig-paren">)</span><a class="headerlink" href="#parameterizations.adjustment_microphysics.AdjustmentMicrophysics" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract base class whose derived classes implement different parameterization schemes carrying out
microphysical adjustments. The model variables which get adjusted are:</p>
<ul class="simple">
<li>the mass fraction of water vapor;</li>
<li>the mass fraction of cloud liquid water;</li>
<li>the mass fraction of precipitation water.</li>
</ul>
<p>The class also computes the following diagnostics:</p>
<ul class="simple">
<li>the raindrop fall speed ([<span class="math">\(m \, s^{-1}\)</span>]).</li>
</ul>
<dl class="method">
<dt id="parameterizations.adjustment_microphysics.AdjustmentMicrophysics.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em>, <em>rain_evaporation_on</em>, <em>backend</em><span class="sig-paren">)</span><a class="headerlink" href="#parameterizations.adjustment_microphysics.AdjustmentMicrophysics.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</li>
<li><strong>rain_evaporation_on</strong> (<em>bool</em>) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if the evaporation of raindrops should be taken into account, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</li>
<li><strong>backend</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode</span></code> specifying the backend for the GT4Py’s stencils.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parameterizations.adjustment_microphysics.AdjustmentMicrophysics._stencil_raindrop_fall_velocity_defs">
<code class="descname">_stencil_raindrop_fall_velocity_defs</code><span class="sig-paren">(</span><em>in_rho</em>, <em>in_rho_s</em>, <em>in_qr</em><span class="sig-paren">)</span><a class="headerlink" href="#parameterizations.adjustment_microphysics.AdjustmentMicrophysics._stencil_raindrop_fall_velocity_defs" title="Permalink to this definition">¶</a></dt>
<dd><p>GT4Py’s stencil providing auxiliary quantitites required to compute the raindrop velocity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>in_rho</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the density.</li>
<li><strong>in_rho_s</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the surface density.</li>
<li><strong>in_qr</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the mass fraction of precipitation water.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>out_prod</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the product between air density and mass fraction of precipitation water,
in units of [<span class="math">\(g ~ cm^{-3}\)</span>].</li>
<li><strong>out_prod</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the ration between surface air density and air density.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parameterizations.adjustment_microphysics.AdjustmentMicrophysics._stencil_raindrop_fall_velocity_initialize">
<code class="descname">_stencil_raindrop_fall_velocity_initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#parameterizations.adjustment_microphysics.AdjustmentMicrophysics._stencil_raindrop_fall_velocity_initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the GT4Py’s stencil providing auxiliary quantitites required to compute the raindrop velocity.</p>
</dd></dl>

<dl class="method">
<dt id="parameterizations.adjustment_microphysics.AdjustmentMicrophysics._stencil_raindrop_fall_velocity_set_inputs">
<code class="descname">_stencil_raindrop_fall_velocity_set_inputs</code><span class="sig-paren">(</span><em>rho</em>, <em>qr</em><span class="sig-paren">)</span><a class="headerlink" href="#parameterizations.adjustment_microphysics.AdjustmentMicrophysics._stencil_raindrop_fall_velocity_set_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the Numpy arrays which serve as inputs to the GT4Py’s stencil providing auxiliary quantitites required to
compute the raindrop velocity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>rho</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the density.</li>
<li><strong>qr</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the mass fraction of precipitation water.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="parameterizations.adjustment_microphysics.AdjustmentMicrophysics.factory">
<em class="property">static </em><code class="descname">factory</code><span class="sig-paren">(</span><em>micro_scheme</em>, <em>grid</em>, <em>rain_evaporation_on</em>, <em>backend</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#parameterizations.adjustment_microphysics.AdjustmentMicrophysics.factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Static method returning an instance of the derived class implementing the microphysics scheme
specified by <code class="xref py py-obj docutils literal"><span class="pre">micro_scheme</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>micro_scheme</strong> (<em>str</em>) – <p>String specifying the microphysics parameterization scheme to implement. Either:</p>
<ul>
<li>’kessler’, for the Kessler scheme.</li>
</ul>
</li>
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</li>
<li><strong>rain_evaporation_on</strong> (<em>bool</em>) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if the evaporation of raindrops should be taken into account, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</li>
<li><strong>backend</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode</span></code> specifying the backend for the GT4Py’s stencils.</li>
<li><strong>**kwargs</strong> – Keyword arguments to be forwarded to the derived class.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parameterizations.adjustment_microphysics.AdjustmentMicrophysics.get_raindrop_fall_velocity">
<code class="descname">get_raindrop_fall_velocity</code><span class="sig-paren">(</span><em>state</em><span class="sig-paren">)</span><a class="headerlink" href="#parameterizations.adjustment_microphysics.AdjustmentMicrophysics.get_raindrop_fall_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the raindrop fall velocity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>state</strong> (<em>obj</em>) – <p><a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> or one of its derived classes representing the current state.
It should contain the following variables:</p>
<ul class="simple">
<li>air_density (unstaggered);</li>
<li>mass_fraction_of_precipitation_water_in_air (unstaggered).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the raindrop fall velocity.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="parameterizations.adjustment_microphysics.AdjustmentMicrophysicsKessler">
<em class="property">class </em><code class="descclassname">parameterizations.adjustment_microphysics.</code><code class="descname">AdjustmentMicrophysicsKessler</code><span class="sig-paren">(</span><em>grid</em>, <em>rain_evaporation_on</em>, <em>backend</em>, <em>a=0.5</em>, <em>k1=0.001</em>, <em>k2=2.2</em><span class="sig-paren">)</span><a class="headerlink" href="#parameterizations.adjustment_microphysics.AdjustmentMicrophysicsKessler" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#parameterizations.adjustment_microphysics.AdjustmentMicrophysics" title="parameterizations.adjustment_microphysics.AdjustmentMicrophysics"><code class="xref py py-class docutils literal"><span class="pre">AdjustmentMicrophysics</span></code></a>
to implement the Kessler scheme.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>a</strong> (<em>float</em>) – Autoconversion threshold, in units of [<span class="math">\(g ~ kg^{-1}\)</span>].</li>
<li><strong>k1</strong> (<em>float</em>) – Rate of autoconversion, in units of [<span class="math">\(s^{-1}\)</span>].</li>
<li><strong>k2</strong> (<em>float</em>) – Rate of autoaccretion, in units of [<span class="math">\(s^{-1}\)</span>].</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="parameterizations.adjustment_microphysics.AdjustmentMicrophysicsKessler.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>dt</em>, <em>state</em><span class="sig-paren">)</span><a class="headerlink" href="#parameterizations.adjustment_microphysics.AdjustmentMicrophysicsKessler.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Entry-point method performing microphysics adjustments and computing microphysics diagnostics.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the timestep.</li>
<li><strong>state</strong> (<em>obj</em>) – <p><a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> or one of its derived classes representing the current state.
It should contain the following variables:</p>
<ul>
<li>air_density (unstaggered);</li>
<li>mass_fraction_of_water_vapor_in_air (unstaggered);</li>
<li>mass_fraction_of_cloud_liquid_water_in_air (unstaggered);</li>
<li>mass_fraction_of_precipitation_water_in_air (unstaggered).</li>
</ul>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>state_new</strong> (<em>obj</em>) – <a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> or one of its derived classes representing the adjusted state.
This contains the same variables contained in the input state, with the following variables being update:<ul>
<li>mass_fraction_of_water_vapor_in_air (unstaggered);</li>
<li>mass_fraction_of_cloud_liquid_water_in_air (unstaggered);</li>
<li>mass_fraction_of_precipitation_water_in_air (unstaggered).</li>
</ul>
</li>
<li><strong>diagnostics</strong> (<em>obj</em>) – <a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> storing the following fields:<ul>
<li>change_over_time_in_air_potential_temperature (unstaggered).</li>
</ul>
</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="parameterizations.adjustment_microphysics.AdjustmentMicrophysicsKessler.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em>, <em>rain_evaporation_on</em>, <em>backend</em>, <em>a=0.5</em>, <em>k1=0.001</em>, <em>k2=2.2</em><span class="sig-paren">)</span><a class="headerlink" href="#parameterizations.adjustment_microphysics.AdjustmentMicrophysicsKessler.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</li>
<li><strong>rain_evaporation_on</strong> (<em>bool</em>) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if the evaporation of raindrops should be taken into account, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</li>
<li><strong>backend</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.mode</span></code> specifying the backend for the GT4Py’s stencils.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><strong>a</strong> (<em>float</em>) – Autoconversion threshold, in units of [<span class="math">\(g ~ kg^{-1}\)</span>]. Default is <span class="math">\(0.5 ~ g ~ kg^{-1}\)</span>.</li>
<li><strong>k1</strong> (<em>float</em>) – Rate of autoconversion, in units of [<span class="math">\(s^{-1}\)</span>]. Default is <span class="math">\(0.001 ~ s^{-1}\)</span>.</li>
<li><strong>k2</strong> (<em>float</em>) – Rate of autoaccretion, in units of [<span class="math">\(s^{-1}\)</span>]. Default is <span class="math">\(2.2 ~ s^{-1}\)</span>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To instantiate this class, one should prefer the static method
<a class="reference internal" href="#parameterizations.adjustment_microphysics.AdjustmentMicrophysics.factory" title="parameterizations.adjustment_microphysics.AdjustmentMicrophysics.factory"><code class="xref py py-meth docutils literal"><span class="pre">factory()</span></code></a> of
<a class="reference internal" href="#parameterizations.adjustment_microphysics.AdjustmentMicrophysics" title="parameterizations.adjustment_microphysics.AdjustmentMicrophysics"><code class="xref py py-class docutils literal"><span class="pre">AdjustmentMicrophysics</span></code></a>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="parameterizations.adjustment_microphysics.AdjustmentMicrophysicsKessler._stencil_adjust_initialize">
<code class="descname">_stencil_adjust_initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#parameterizations.adjustment_microphysics.AdjustmentMicrophysicsKessler._stencil_adjust_initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the GT4Py’s stencil adjusting the solution and computing the change over time in potential temperature.</p>
</dd></dl>

<dl class="method">
<dt id="parameterizations.adjustment_microphysics.AdjustmentMicrophysicsKessler._stencil_adjust_set_inputs">
<code class="descname">_stencil_adjust_set_inputs</code><span class="sig-paren">(</span><em>qv</em>, <em>qc</em>, <em>qr</em>, <em>Ar</em>, <em>Cr</em><span class="sig-paren">)</span><a class="headerlink" href="#parameterizations.adjustment_microphysics.AdjustmentMicrophysicsKessler._stencil_adjust_set_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the Numpy arrays which serve as inputs to the GT4Py’s stencil computing auxiliary quantities
required by the Kessler scheme.</p>
</dd></dl>

<dl class="method">
<dt id="parameterizations.adjustment_microphysics.AdjustmentMicrophysicsKessler._stencil_auxiliary_defs">
<code class="descname">_stencil_auxiliary_defs</code><span class="sig-paren">(</span><em>in_rho</em>, <em>in_p</em>, <em>in_ps</em>, <em>in_qv</em>, <em>in_qc</em>, <em>in_qr</em><span class="sig-paren">)</span><a class="headerlink" href="#parameterizations.adjustment_microphysics.AdjustmentMicrophysicsKessler._stencil_auxiliary_defs" title="Permalink to this definition">¶</a></dt>
<dd><p>GT4Py’s stencil computing auxiliary quantities required by the Kessler scheme.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>in_rho</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the air density.</li>
<li><strong>in_p</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the pressure.</li>
<li><strong>in_ps</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the saturation vapor pressure.</li>
<li><strong>in_qv</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the mass fraction of water vapor.</li>
<li><strong>in_qc</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the mass fraction of cloud liquid water.</li>
<li><strong>in_qr</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the mass fraction of precipitation water.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>out_qvs</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the saturation mass fraction of water vapor.</li>
<li><strong>out_Ar</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the source term accounting for the contribution of autoconversion to
the development of rain.</li>
<li><strong>aux_Cr</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the product between the rate of accretion and the mass fraction of
cloud liquid water.
This is required to compute the source term accounting for the contribution of accretion to the growth of rain.</li>
<li><strong>aux_Er_1</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the inverse of air density, expressed in [<span class="math">\(g ~ cm^{-3}\)</span>].
This is required to compute the source term accounting for the evaporation of rain.</li>
<li><strong>aux_Er_2</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the ratio between the mass fraction of water vapor and the saturation
mass fraction of water vapor.
This is required to compute the source term accounting for the evaporation of rain.</li>
<li><strong>aux_Er_3</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the product between air density, expressed in [<span class="math">\(g ~ cm^{-3}\)</span>],
and the mass fraction of precipitation water.
This is required to compute the source term accounting for the evaporation of rain.</li>
<li><strong>aux_Er_4</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">gridtools.Equation</span></code> representing the product between the pressure, expressed in [<span class="math">\(mbar\)</span>], and the
saturation mass fraction of water vapor.
This is required to compute the source term accounting for the evaporation of rain.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Doms, G., et al. (2015). <em>A description of the nonhydrostatic regional COSMO-model. Part II: Physical parameterization.</em>                        Retrieved from <a href="#id39"><span class="problematic" id="id40">`http://www.cosmo-model.org`_</span></a>.
Mielikainen, J., B. Huang, J. Wang, H. L. A. Huang, and M. D. Goldberg. (2013). <em>Compute Unified Device Architecture                    (CUDA)-based parallelization of WRF Kessler cloud microphysics scheme</em>. Computer &amp; Geosciences, 52:292-299.</p>
</dd></dl>

<dl class="method">
<dt id="parameterizations.adjustment_microphysics.AdjustmentMicrophysicsKessler._stencil_auxiliary_initialize">
<code class="descname">_stencil_auxiliary_initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#parameterizations.adjustment_microphysics.AdjustmentMicrophysicsKessler._stencil_auxiliary_initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the GT4Py’s stencil providing auxiliary quantitites required by the Kessler scheme.</p>
</dd></dl>

<dl class="method">
<dt id="parameterizations.adjustment_microphysics.AdjustmentMicrophysicsKessler._stencil_auxiliary_set_inputs">
<code class="descname">_stencil_auxiliary_set_inputs</code><span class="sig-paren">(</span><em>rho</em>, <em>p</em>, <em>ps</em>, <em>qv</em>, <em>qc</em>, <em>qr</em><span class="sig-paren">)</span><a class="headerlink" href="#parameterizations.adjustment_microphysics.AdjustmentMicrophysicsKessler._stencil_auxiliary_set_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the Numpy arrays which serve as inputs to the GT4Py’s stencil computing auxiliary quantities
required by the Kessler scheme.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>rho</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the air density.</li>
<li><strong>p</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the pressure.</li>
<li><strong>ps</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the saturation vapor pressure.</li>
<li><strong>qv</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the mass fraction of water vapor.</li>
<li><strong>qc</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the mass fraction of cloud liquid water.</li>
<li><strong>qr</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the mass fraction of precipitation water.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="storages">
<h2>Storages<a class="headerlink" href="#storages" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="storages.grid_data.GridData">
<em class="property">class </em><code class="descclassname">storages.grid_data.</code><code class="descname">GridData</code><span class="sig-paren">(</span><em>time</em>, <em>grid</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#storages.grid_data.GridData" title="Permalink to this definition">¶</a></dt>
<dd><p>Class storing and handling time-dependent variables defined on a grid. Ideally, this class should be used to
represent the state, or a sequence of states at different time levels, of a <em>generic</em> climate or meteorological model.
The model variables, in the shape of <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a>s, are passed to the constructor as keyword arguments.
After conversion to <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a>s, the variables are packed in a dictionary whose keys are the input keywords.
The class attribute <code class="xref py py-data docutils literal"><span class="pre">units</span></code> lists, for any admissible keyword, the units in which the associated field should
be expressed. Any variable can be accessed via the accessor operator by specifying the corresponding
keyword. Other methods are provided to update the state, or to create a sequence of states (useful for animation purposes).
This class is designed to be as general as possible. Hence, it is not endowed with any method whose
implementation depends on the variables actually stored by the class. This kind of methods might be provided by some
derived classes, each one representing the state of a <em>specific</em> model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.datetime</span></code> representing the time instant at which the variables are defined.</li>
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="storages.grid_data.GridData.__getitem__">
<code class="descname">__getitem__</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#storages.grid_data.GridData.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a shallow copy of a gridded variable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>key</strong> (<em>str</em>) – The name of the variable to return.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Shallow copy of the <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> representing the variable, or <code class="xref py py-obj docutils literal"><span class="pre">None</span></code> if the variable is not found.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">obj</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="storages.grid_data.GridData.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>time</em>, <em>grid</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#storages.grid_data.GridData.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.datetime</span></code> representing the time instant at which the variables are defined.</li>
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</li>
<li><strong>**kwargs</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing a gridded variable.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="storages.grid_data.GridData.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#storages.grid_data.GridData.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a list of variables, passed as keyword arguments.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.datetime</span></code> representing the time instant at which the variables are defined.</li>
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> or one of its derived classes.</li>
<li><strong>**kwargs</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing a gridded variable.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="storages.grid_data.GridData.append">
<code class="descname">append</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#storages.grid_data.GridData.append" title="Permalink to this definition">¶</a></dt>
<dd><p>Append a new state to the sequence of states.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>obj</em>) – Another <a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> (or a derived class), whose <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a>s
will be concatenated along the temporal axis to the corresponding ones in the current object.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="xref py py-data docutils literal"><span class="pre">other</span></code> is supposed to contain exactly the same variables stored by the current object.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="storages.grid_data.GridData.get_max">
<code class="descname">get_max</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#storages.grid_data.GridData.get_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the maximum value of a variable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>key</strong> (<em>str</em>) – The name of the variable.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The maximum value of the variable of interest.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="storages.grid_data.GridData.get_min">
<code class="descname">get_min</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#storages.grid_data.GridData.get_min" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the minimum value of a variable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>key</strong> (<em>str</em>) – The name of the variable.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The minimum value of the variable of interest.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="storages.grid_data.GridData.pop">
<code class="descname">pop</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#storages.grid_data.GridData.pop" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a shallow copy of a gridded variable, then remove it from the dictionary.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>key</strong> (<em>str</em>) – The name of the variable to return and remove.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Shallow copy of the <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> representing the variable, or <code class="xref py py-obj docutils literal"><span class="pre">None</span></code> if the variable is not found.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">obj</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="storages.grid_data.GridData.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#storages.grid_data.GridData.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Sync the current object with another <a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> (or a derived class).
This implies that, for each variable stored in the input object:</p>
<ul class="simple">
<li>if the current object contains a variable with the same name, that variable is updated;</li>
<li>if the current object does not contain any variable with the same name, a new variable is added to the current object.</li>
</ul>
<p>Note that after the update, the stored variables might not be defined at the same time level.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>obj</em>) – Another <a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> (or a derived class) with which the current object will be synced.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="storages.state_isentropic.StateIsentropic">
<em class="property">class </em><code class="descclassname">storages.state_isentropic.</code><code class="descname">StateIsentropic</code><span class="sig-paren">(</span><em>time</em>, <em>grid</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#storages.state_isentropic.StateIsentropic" title="Permalink to this definition">¶</a></dt>
<dd><p>This class inherits <a class="reference internal" href="#storages.grid_data.GridData" title="storages.grid_data.GridData"><code class="xref py py-class docutils literal"><span class="pre">GridData</span></code></a> to represent the state of the three-dimensional
(moist) isentropic model. The stored variables might be:</p>
<ul class="simple">
<li>air_density (unstaggered);</li>
<li>air_isentropic_density (unstaggered);</li>
<li>x_velocity (<span class="math">\(x\)</span>-staggered);</li>
<li>y_velocity (<span class="math">\(y\)</span>-staggered);</li>
<li>x_momentum_isentropic (unstaggered);</li>
<li>y_momentum_isentropic (unstaggered);</li>
<li>air_pressure (<span class="math">\(z\)</span>-staggered);</li>
<li>exner_function (<span class="math">\(z\)</span>-staggered);</li>
<li>montgomery_potential (unstaggered);</li>
<li>height (<span class="math">\(z\)</span>-staggered);</li>
<li>air_temperature (unstaggered);</li>
<li>mass_fraction_water_vapor_in_air (unstaggered);</li>
<li>water_vapor_isentropic_density (unstaggered);</li>
<li>mass_fraction_of_cloud_liquid_water_in_air (unstaggered);</li>
<li>cloud_liquid_water_isentropic_density (unstaggered);</li>
<li>mass_fraction_of_precipitation_water_in_air (unstaggered);</li>
<li>precipitation_water_isentropic_density (unstaggered).</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">At any point, an instance of this class may or may not contain all the listed model variables. Indeed, variables
might be added gradually, according to user’s needs.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><strong>grid</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> representing the underlying grid.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="storages.state_isentropic.StateIsentropic.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>time</em>, <em>grid</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#storages.state_isentropic.StateIsentropic.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the time instant at which the state is defined.</li>
<li><strong>grid</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> representing the underlying grid.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><strong>air_density</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the density.</li>
<li><strong>air_isentropic_density</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the isentropic density.</li>
<li><strong>x_velocity</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the <span class="math">\(x\)</span>-velocity.</li>
<li><strong>y_velocity</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the <span class="math">\(y\)</span>-velocity.</li>
<li><strong>x_momentum_isentropic</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the (isentropic) <span class="math">\(x\)</span>-momentum.</li>
<li><strong>y_momentum_isentropic</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the (isentropic) <span class="math">\(y\)</span>-momentum.</li>
<li><strong>air_pressure</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the pressure.</li>
<li><strong>exner_function</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the Exner function.</li>
<li><strong>montgomery_potential</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the Montgomery potential.</li>
<li><strong>height</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the geometrical height of the half-levels.</li>
<li><strong>air_temperature</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the temperature.</li>
<li><strong>mass_fraction_of_water_vapor_in_air</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the mass fraction of water vapor.</li>
<li><strong>water_vapor_isentropic_density</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the isentropic density of water vapor.</li>
<li><strong>mass_fraction_of_cloud_liquid_water_in_air</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the mass fraction of cloud water.</li>
<li><strong>cloud_liquid_water_isentropic_density</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the isentropic density of cloud water.</li>
<li><strong>mass_fraction_of_precipitation_water_in_air</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the mass fraction of precipitation water.</li>
<li><strong>precipitation_water_isentropic_density</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the isentropic density of precipitation water.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="storages.state_isentropic.StateIsentropic.contour_xz">
<code class="descname">contour_xz</code><span class="sig-paren">(</span><em>field_to_plot</em>, <em>y_level</em>, <em>time_level</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#storages.state_isentropic.StateIsentropic.contour_xz" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a contour plot of a field at the cross-section <span class="math">\(y = \bar{y}\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>field_to_plot</strong> (<em>str</em>) – <p>String specifying the field to plot. This might be:</p>
<ul>
<li>the name of a variable stored in the current object;</li>
<li><dl class="first docutils">
<dt>’x_velocity_unstaggered_perturbation’, for the discrepancy of the <span class="math">\(x\)</span>-velocity with respect to</dt>
<dd>the initial condition; the current object must contain the following variables:<ul class="last">
<li>air_isentropic_density;</li>
<li>x_momentum_isentropic;</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>’vertical_velocity’, for the vertical velocity; only for steady-state flows; the current object must contain</dt>
<dd>the following variables:<ul class="last">
<li>air_isentropic_density;</li>
<li>x_momentum_isentropic;</li>
<li>height.</li>
</ul>
</dd>
</dl>
</li>
</ul>
</li>
<li><strong>y_level</strong> (<em>int</em>) – Index corresponding to the <span class="math">\(y\)</span>-level identifying the cross-section to plot.</li>
<li><strong>time_level</strong> (<em>int</em>) – The index corresponding to the time level to plot.</li>
<li><strong>**kwargs</strong> – Keyword arguments to specify different plotting settings.
See <a class="reference internal" href="#utils.utils_plot.contour_xz" title="utils.utils_plot.contour_xz"><code class="xref py py-func docutils literal"><span class="pre">utils.utils_plot.contour_xz()</span></code></a> for the complete list.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="storages.state_isentropic.StateIsentropic.contourf_xy">
<code class="descname">contourf_xy</code><span class="sig-paren">(</span><em>field_to_plot</em>, <em>z_level</em>, <em>time_level</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#storages.state_isentropic.StateIsentropic.contourf_xy" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a contourf plot of a field at the level <span class="math">\(\theta = \bar{\theta}\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>field_to_plot</strong> (<em>str</em>) – <p>String specifying the field to plot. This might be:</p>
<ul>
<li>the name of a variable stored in the current object;</li>
<li>’horizontal_velocity’, for the horizontal velocity; the current object must contain the following variables:<blockquote>
<div><ul>
<li>air_isentropic_density;</li>
<li>x_momentum_isentropic;</li>
<li>y_momentum_isentropic.</li>
</ul>
</div></blockquote>
</li>
</ul>
</li>
<li><strong>z_level</strong> (<em>int</em>) – Index corresponding to the <span class="math">\(\theta\)</span>-level identifying the cross-section to plot.</li>
<li><strong>time_level</strong> (<em>int</em>) – The index corresponding to the time level to plot.</li>
<li><strong>**kwargs</strong> – Keyword arguments to specify different plotting settings.
See <a class="reference internal" href="#utils.utils_plot.contourf_xy" title="utils.utils_plot.contourf_xy"><code class="xref py py-func docutils literal"><span class="pre">utils.utils_plot.contourf_xy()</span></code></a> for the complete list.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="storages.state_isentropic.StateIsentropic.contourf_xz">
<code class="descname">contourf_xz</code><span class="sig-paren">(</span><em>field_to_plot</em>, <em>y_level</em>, <em>time_level</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#storages.state_isentropic.StateIsentropic.contourf_xz" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a contourf plot of a field at the cross-section <span class="math">\(y = \bar{y}\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>field_to_plot</strong> (<em>str</em>) – <p>String specifying the field to plot. This might be:</p>
<ul>
<li>the name of a variable stored in the current object;</li>
<li><dl class="first docutils">
<dt>’x_velocity_unstaggered_perturbation’, for the discrepancy of the <span class="math">\(x\)</span>-velocity with respect to</dt>
<dd>the initial condition; the current object must contain the following variables:<ul class="last">
<li>air_isentropic_density;</li>
<li>x_momentum_isentropic;</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>’vertical_velocity’, for the vertical velocity; only for steady-state flows; the current object must contain</dt>
<dd>the following variables:<ul class="last">
<li>air_isentropic_density;</li>
<li>x_momentum_isentropic;</li>
<li>height.</li>
</ul>
</dd>
</dl>
</li>
</ul>
</li>
<li><strong>y_level</strong> (<em>int</em>) – Index corresponding to the <span class="math">\(y\)</span>-level identifying the cross-section to plot.</li>
<li><strong>time_level</strong> (<em>int</em>) – The index corresponding to the time level to plot.</li>
<li><strong>**kwargs</strong> – Keyword arguments to specify different plotting settings.
See <a class="reference internal" href="#utils.utils_plot.contour_xz" title="utils.utils_plot.contour_xz"><code class="xref py py-func docutils literal"><span class="pre">utils.utils_plot.contour_xz()</span></code></a> for the complete list.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="storages.state_isentropic.StateIsentropic.get_cfl">
<code class="descname">get_cfl</code><span class="sig-paren">(</span><em>dt</em><span class="sig-paren">)</span><a class="headerlink" href="#storages.state_isentropic.StateIsentropic.get_cfl" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the CFL number.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dt</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the time step.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The CFL number.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the CFL number exceeds the unity, i.e., if the CFL condition is violated, the method throws a warning.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="storages.state_isentropic.StateIsentropic.quiver_xy">
<code class="descname">quiver_xy</code><span class="sig-paren">(</span><em>field_to_plot</em>, <em>z_level</em>, <em>time_level</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#storages.state_isentropic.StateIsentropic.quiver_xy" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a quiver plot of a vector field at the level <span class="math">\(\theta = \bar{\theta}\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>field_to_plot</strong> (<em>str</em>) – <p>String specifying the field to plot. This might be:</p>
<ul>
<li>’horizontal_velocity’, for the horizontal velocity; the current object must contain the following variables:<blockquote>
<div><ul>
<li>air_isentropic_density;</li>
<li>x_momentum_isentropic;</li>
<li>y_momentum_isentropic.</li>
</ul>
</div></blockquote>
</li>
</ul>
</li>
<li><strong>z_level</strong> (<em>int</em>) – Index corresponding to the <span class="math">\(\theta\)</span>-level identifying the cross-section to plot.</li>
<li><strong>time_level</strong> (<em>int</em>) – The index corresponding to the time level to plot.</li>
<li><strong>**kwargs</strong> – Keyword arguments to specify different plotting settings.
See <a class="reference internal" href="#utils.utils_plot.quiver_xy" title="utils.utils_plot.quiver_xy"><code class="xref py py-func docutils literal"><span class="pre">utils.utils_plot.quiver_xy()</span></code></a> for the complete list.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-grids.topography">
<span id="topography"></span><h2>Topography<a class="headerlink" href="#module-grids.topography" title="Permalink to this headline">¶</a></h2>
<p>Classes representing one- and two-dimensional topographies, possibly time-dependent.
Indeed, although clearly not physical, a terrain surface (slowly) growing in the early stages
of a simulation may help to retrieve numerical stability, as it prevents steep gradients
in the first few iterations.</p>
<p>Letting <span class="math">\(h_s = h_s(x)\)</span> be a one-dimensional topography, with <span class="math">\(x \in [a,b]\)</span>,
the user may choose among:</p>
<blockquote>
<div><ul>
<li><p class="first">a flat terrain, i.e., <span class="math">\(h_s(x) \equiv 0\)</span>;</p>
</li>
<li><p class="first">a Gaussian-shaped mountain, i.e.,</p>
<blockquote>
<div><div class="math">
\[h_s(x) = h_{max} \exp{\left[ - \left( \frac{x - c}{\sigma_x} \right)^2 \right]},\]</div>
</div></blockquote>
<p>where <span class="math">\(c = 0.5 (a + b)\)</span>.</p>
</li>
</ul>
</div></blockquote>
<p>For the two-dimensional case, letting <span class="math">\(h_s = h_s(x,y)\)</span> be the topography, with
<span class="math">\(x \in [a_x,b_x]\)</span> and <span class="math">\(y \in [a_y,b_y]\)</span>, the following profiles are provided:</p>
<blockquote>
<div><ul>
<li><p class="first">flat terrain, i.e., <span class="math">\(h_s(x,y) \equiv 0\)</span>;</p>
</li>
<li><p class="first">Gaussian shaped-mountain, i.e.</p>
<blockquote>
<div><div class="math">
\[h_s(x,y) = h_{max} \exp{\left[ - \left( \frac{x - c_x}{\sigma_x} \right)^2 - \left( \frac{y - c_y}{\sigma_y} \right)^2 \right]} ,\]</div>
</div></blockquote>
<p>where <span class="math">\(c_x = 0.5 (a_x + b_x)\)</span> and <span class="math">\(c_y = 0.5 (a_y + b_y)\)</span>;</p>
</li>
<li><p class="first">modified Gaussian-shaped mountain proposed by Schaer and Durran (1997),</p>
<blockquote>
<div><div class="math">
\[h_s(x,y) = \frac{h_{max}}{\left[ 1 + \left( \frac{x}{\sigma_x} \right)^2 + \left( \frac{y}{\sigma_y} \right)^2 \right]^{3/2}}.\]</div>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<p>Yet, user-defined profiles are supported as well, provided that they admit an analytical expression.
This is passed to the class as a string, which is then parsed in C++ via <a class="reference external" href="http://cython.org">Cython</a>
(see <code class="xref py py-class docutils literal"><span class="pre">parser_1d</span></code> and <code class="xref py py-class docutils literal"><span class="pre">parser_2d</span></code>). Hence, the string itself must be
fully C++-compliant.</p>
<p class="rubric">References</p>
<p>Schaer, C., and Durran, D. R. (1997). <em>Vortex formation and vortex shedding in continuosly stratified flows     past isolated topography</em>. Journal of Atmospheric Sciences, 54:534-554.</p>
<dl class="class">
<dt id="grids.topography.Topography1d">
<em class="property">class </em><code class="descclassname">grids.topography.</code><code class="descname">Topography1d</code><span class="sig-paren">(</span><em>x</em>, <em>topo_type='flat_terrain'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.topography.Topography1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Class representing a one-dimensional topography.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>topo</strong> (<em>array_like</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> representing the topography (in meters).</li>
<li><strong>topo_type</strong> (<em>str</em>) – <p>Topography type. Either:</p>
<ul>
<li>’flat_terrain’;</li>
<li>’gaussian’;</li>
<li>’user_defined’.</li>
</ul>
</li>
<li><strong>topo_time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> object representing the elapsed simulation time after which the topography
should stop increasing.</li>
<li><strong>topo_fact</strong> (<em>float</em>) – Topography factor. It runs in between 0 (at the beginning of the simulation) and 1 (once the simulation
has been run for <code class="xref py py-attr docutils literal"><span class="pre">topo_time</span></code>).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="grids.topography.Topography1d.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>x</em>, <em>topo_type='flat_terrain'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.topography.Topography1d.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.axis.Axis" title="grids.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> representing the underlying horizontal axis.</li>
<li><strong>topo_type</strong> (<cite>str</cite>, optional) – <p>Topography type. Either:</p>
<blockquote>
<div><ul>
<li>’flat_terrain’ (default);</li>
<li>’gaussian’;</li>
<li>’user_defined’.</li>
</ul>
</div></blockquote>
</li>
<li><strong>topo_time</strong> (<em>obj</em>) – class:<cite>datetime.timedelta</cite> representing the elapsed simulation time after which the topography
should stop increasing. Default is 0, corresponding to a time-invariant terrain surface-height.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><strong>topo_max_height</strong> (<em>float</em>) – When <code class="xref py py-data docutils literal"><span class="pre">topo_type</span></code> is ‘gaussian’, maximum mountain height (in meters). Default is 500.</li>
<li><strong>topo_width_x</strong> (<em>float</em>) – When <code class="xref py py-data docutils literal"><span class="pre">topo_type</span></code> is ‘gaussian’, mountain half-width (in meters). Default is 10000.</li>
<li><strong>topo_str</strong> (<em>str</em>) – When <code class="xref py py-data docutils literal"><span class="pre">topo_type</span></code> is ‘user_defined’, terrain profile expression in the independent variable <span class="math">\(x\)</span>.
Must be fully C++-compliant.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.topography.Topography1d.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.topography.Topography1d.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update topography at current simulation time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the elapsed simulation time.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="grids.topography.Topography2d">
<em class="property">class </em><code class="descclassname">grids.topography.</code><code class="descname">Topography2d</code><span class="sig-paren">(</span><em>grid</em>, <em>topo_type='flat_terrain'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.topography.Topography2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Class representing a two-dimensional topography.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>topo</strong> (<em>array_like</em>) – <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.10.1)"><code class="xref py py-class docutils literal"><span class="pre">xarray.DataArray</span></code></a> representing the topography (in meters).</li>
<li><strong>topo_type</strong> (<em>str</em>) – <p>Topography type. Either:</p>
<ul>
<li>’flat_terrain’;</li>
<li>’gaussian’;</li>
<li>’schaer’;</li>
<li>’user_defined’.</li>
</ul>
</li>
<li><strong>topo_time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the elapsed simulation time after which the topography
should stop increasing.</li>
<li><strong>topo_fact</strong> (<em>float</em>) – Topography factor. It runs in between 0 (at the beginning of the simulation) and 1 (once the simulation
has been run for <code class="xref py py-attr docutils literal"><span class="pre">topo_time</span></code>).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="grids.topography.Topography2d.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>grid</em>, <em>topo_type='flat_terrain'</em>, <em>topo_time=datetime.timedelta(0)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.topography.Topography2d.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>grid</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.grid_xy.GridXY" title="grids.grid_xy.GridXY"><code class="xref py py-class docutils literal"><span class="pre">GridXY</span></code></a> representing the underlying grid.</li>
<li><strong>topo_type</strong> (<cite>str</cite>, optional) – <p>Topography type. Either:</p>
<blockquote>
<div><ul>
<li>’flat_terrain’ (default);</li>
<li>’gaussian’;</li>
<li>’schaer’;</li>
<li>’user_defined’.</li>
</ul>
</div></blockquote>
</li>
<li><strong>topo_time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the elapsed simulation time after which the topography
should stop increasing. Default is 0, corresponding to a time-invariant terrain surface-height.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><strong>topo_max_height</strong> (<em>float</em>) – When <code class="xref py py-data docutils literal"><span class="pre">topo_type</span></code> is either ‘gaussian’ or ‘schaer’, maximum mountain height (in meters).
Default is 500.</li>
<li><strong>topo_width_x</strong> (<em>float</em>) – When <code class="xref py py-data docutils literal"><span class="pre">topo_type</span></code> is either ‘gaussian’ or ‘schaer’, mountain half-width in <span class="math">\(x\)</span>-direction
(in meters). Default is 10000.</li>
<li><strong>topo_width_y</strong> (<em>float</em>) – When <code class="xref py py-data docutils literal"><span class="pre">topo_type</span></code> is either ‘gaussian’ or ‘schaer’, mountain half-width in <span class="math">\(y\)</span>-direction
(in meters). Default is 10000.</li>
<li><strong>topo_str</strong> (<em>str</em>) – When <code class="xref py py-data docutils literal"><span class="pre">topo_type</span></code> is ‘user_defined’, terrain profile expression in the independent variables
<span class="math">\(x\)</span> and <span class="math">\(y\)</span>. Must be fully C++-compliant.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.topography.Topography2d.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>grid</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.topography.Topography2d.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the topography using the <a class="reference external" href="https://matplotlib.org/tutorials/toolkits/mplot3d.html">mplot3d toolkit</a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>grid</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.grid_xy.GridXY" title="grids.grid_xy.GridXY"><code class="xref py py-class docutils literal"><span class="pre">GridXY</span></code></a> representing the underlying grid.</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><strong>**kwargs</strong> – Keyword arguments to be forwarded to <a class="reference external" href="https://matplotlib.org/2.1.1/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="(in Matplotlib v2.1.1)"><code class="xref py py-func docutils literal"><span class="pre">matplotlib.pyplot.figure()</span></code></a>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="grids.topography.Topography2d.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#grids.topography.Topography2d.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update topography at current simulation time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>obj</em>) – <code class="xref py py-class docutils literal"><span class="pre">datetime.timedelta</span></code> representing the elapsed simulation time.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<div class="section" id="parsers">
<h3>Parsers<a class="headerlink" href="#parsers" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="grids.parser.parser_1d.Parser1d">
<em class="property">class </em><code class="descclassname">grids.parser.parser_1d.</code><code class="descname">Parser1d</code><a class="headerlink" href="#grids.parser.parser_1d.Parser1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Cython wrapper for the C++ class <code class="xref py py-obj docutils literal"><span class="pre">parser_1d_cpp</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><strong>parser</strong> (<em>obj</em>) – Pointer to a <code class="xref py py-obj docutils literal"><span class="pre">parser_1d_cpp</span></code> object.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="grids.parser.parser_1d.Parser1d.evaluate">
<code class="descname">evaluate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grids.parser.parser_1d.Parser1d.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the expression.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> of the evaluations.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="grids.parser.parser_2d.Parser2d">
<em class="property">class </em><code class="descclassname">grids.parser.parser_2d.</code><code class="descname">Parser2d</code><a class="headerlink" href="#grids.parser.parser_2d.Parser2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Cython wrapper for the C++ class <code class="xref py py-obj docutils literal"><span class="pre">parser_2d_cpp</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><strong>parser</strong> (<em>obj</em>) – Pointer to a <code class="xref py py-obj docutils literal"><span class="pre">parser_2d_cpp</span></code> object.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="grids.parser.parser_2d.Parser2d.evaluate">
<code class="descname">evaluate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grids.parser.parser_2d.Parser2d.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the expression.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Two-dimensional <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> of the evaluations.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-utils.utils">
<span id="utilities"></span><h2>Utilities<a class="headerlink" href="#module-utils.utils" title="Permalink to this headline">¶</a></h2>
<p>Some useful utilities.</p>
<dl class="function">
<dt id="utils.utils._get_prefix">
<code class="descclassname">utils.utils.</code><code class="descname">_get_prefix</code><span class="sig-paren">(</span><em>units</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.utils._get_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the prefix from the units name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>units</strong> (<em>str</em>) – The units.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The prefix.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.utils.convert_datetime64_to_datetime">
<code class="descclassname">utils.utils.</code><code class="descname">convert_datetime64_to_datetime</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.utils.convert_datetime64_to_datetime" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert <code class="xref py py-class docutils literal"><span class="pre">numpy.datetime64</span></code> to <code class="xref py py-class docutils literal"><span class="pre">datetime.datetime</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>obj</em>) – The <code class="xref py py-class docutils literal"><span class="pre">numpy.datetime64</span></code> object to convert.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The converted <code class="xref py py-class docutils literal"><span class="pre">datetime.datetime</span></code> object.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">obj</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="https://stackoverflow.com/questions/13703720/converting-between-datetime-timestamp-and-datetime64">https://stackoverflow.com/questions/13703720/converting-between-datetime-timestamp-and-datetime64</a>.</p>
</dd></dl>

<dl class="function">
<dt id="utils.utils.equal_to">
<code class="descclassname">utils.utils.</code><code class="descname">equal_to</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>tol=None</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.utils.equal_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare floating point numbers (or arrays of floating point numbers), properly accounting for round-off errors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (<cite>float</cite> or <cite>array_like</cite>) – Left-hand side.</li>
<li><strong>b</strong> (<cite>float</cite> or <cite>array_like</cite>) – Right-hand side.</li>
<li><strong>tol</strong> (<cite>float</cite>, optional) – Tolerance.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if <code class="xref py py-data docutils literal"><span class="pre">a</span></code> is equal to <code class="xref py py-data docutils literal"><span class="pre">b</span></code> up to <code class="xref py py-data docutils literal"><span class="pre">tol</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.utils.get_factor">
<code class="descclassname">utils.utils.</code><code class="descname">get_factor</code><span class="sig-paren">(</span><em>units</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.utils.get_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert units prefix to the corresponding factor.
For the conversion, the <a class="reference external" href="http://cfconventions.org/">CF Conventions</a> are used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>units</strong> (<em>str</em>) – The units.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The factor.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.utils.greater_or_equal_than">
<code class="descclassname">utils.utils.</code><code class="descname">greater_or_equal_than</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>tol=None</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.utils.greater_or_equal_than" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare floating point numbers (or arrays of floating point numbers), properly accounting for round-off errors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (<cite>float</cite> or <cite>array_like</cite>) – Left-hand side.</li>
<li><strong>b</strong> (<cite>float</cite> or <cite>array_like</cite>) – Right-hand side.</li>
<li><strong>tol</strong> (<cite>float</cite>, optional) – Tolerance.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if <code class="xref py py-data docutils literal"><span class="pre">a</span></code> is greater than or equal to <code class="xref py py-data docutils literal"><span class="pre">b</span></code> up to <code class="xref py py-data docutils literal"><span class="pre">tol</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.utils.greater_than">
<code class="descclassname">utils.utils.</code><code class="descname">greater_than</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>tol=None</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.utils.greater_than" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare floating point numbers (or arrays of floating point numbers), properly accounting for round-off errors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (<cite>float</cite> or <cite>array_like</cite>) – Left-hand side.</li>
<li><strong>b</strong> (<cite>float</cite> or <cite>array_like</cite>) – Right-hand side.</li>
<li><strong>tol</strong> (<cite>float</cite>, optional) – Tolerance.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if <code class="xref py py-data docutils literal"><span class="pre">a</span></code> is greater than <code class="xref py py-data docutils literal"><span class="pre">b</span></code> up to <code class="xref py py-data docutils literal"><span class="pre">tol</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.utils.set_namelist">
<code class="descclassname">utils.utils.</code><code class="descname">set_namelist</code><span class="sig-paren">(</span><em>user_namelist=None</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.utils.set_namelist" title="Permalink to this definition">¶</a></dt>
<dd><p>Place the user-defined namelist module in the Python search path.
This is achieved by physically copying the content of the user-provided module into TASMANIA_ROOT/namelist.py.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>user_namelist</strong> (<em>str</em>) – Path to the user-defined namelist. If not specified, the default namelist TASMANIA_ROOT/_namelist.py is used.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.utils.smaller_or_equal_than">
<code class="descclassname">utils.utils.</code><code class="descname">smaller_or_equal_than</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>tol=None</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.utils.smaller_or_equal_than" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare floating point numbers (or arrays of floating point numbers), properly accounting for round-off errors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (<cite>float</cite> or <cite>array_like</cite>) – Left-hand side.</li>
<li><strong>b</strong> (<cite>float</cite> or <cite>array_like</cite>) – Right-hand side.</li>
<li><strong>tol</strong> (<cite>float</cite>, optional) – Tolerance.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if <code class="xref py py-data docutils literal"><span class="pre">a</span></code> is smaller than or equal to <code class="xref py py-data docutils literal"><span class="pre">b</span></code> up to <code class="xref py py-data docutils literal"><span class="pre">tol</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.utils.smaller_than">
<code class="descclassname">utils.utils.</code><code class="descname">smaller_than</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>tol=None</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.utils.smaller_than" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare floating point numbers (or arrays of floating point numbers), properly accounting for round-off errors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (<cite>float</cite> or <cite>array_like</cite>) – Left-hand side.</li>
<li><strong>b</strong> (<cite>float</cite> or <cite>array_like</cite>) – Right-hand side.</li>
<li><strong>tol</strong> (<cite>float</cite>, optional) – Tolerance.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if <code class="xref py py-data docutils literal"><span class="pre">a</span></code> is smaller than <code class="xref py py-data docutils literal"><span class="pre">b</span></code> up to <code class="xref py py-data docutils literal"><span class="pre">tol</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<div class="section" id="module-utils.utils_meteo">
<span id="meteo-utilities"></span><h3>Meteo utilities<a class="headerlink" href="#module-utils.utils_meteo" title="Permalink to this headline">¶</a></h3>
<p>Meteo-oriented utilities.</p>
<dl class="function">
<dt id="utils.utils_meteo.apply_goff_gratch_formula">
<code class="descclassname">utils.utils_meteo.</code><code class="descname">apply_goff_gratch_formula</code><span class="sig-paren">(</span><em>T</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.utils_meteo.apply_goff_gratch_formula" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the saturation vapor pressure over water at a given temperature, relying upon the Goff-Gratch formula.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>T</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the temperature ([<span class="math">\(K\)</span>]).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the saturation water vapor pressure ([<span class="math">\(Pa\)</span>]).</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Goff, J. A., and S. Gratch. (1946). <cite>Low-pressure properties of water from -160 to 212 F</cite>.              Transactions of the American Society of Heating and Ventilating Engineers, 95-122.</p>
</dd></dl>

<dl class="function">
<dt id="utils.utils_meteo.apply_teten_formula">
<code class="descclassname">utils.utils_meteo.</code><code class="descname">apply_teten_formula</code><span class="sig-paren">(</span><em>T</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.utils_meteo.apply_teten_formula" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the saturation vapor pressure over water at a given temperature, relying upon the Teten’s formula.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>T</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the temperature ([<span class="math">\(K\)</span>]).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the saturation water vapor pressure ([<span class="math">\(Pa\)</span>]).</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.utils_meteo.convert_relative_humidity_to_water_vapor">
<code class="descclassname">utils.utils_meteo.</code><code class="descname">convert_relative_humidity_to_water_vapor</code><span class="sig-paren">(</span><em>method</em>, <em>p</em>, <em>T</em>, <em>rh</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.utils_meteo.convert_relative_humidity_to_water_vapor" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert relative humidity to water vapor mixing ratio.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>method</strong> (<em>str</em>) – <p>String specifying the formula to be used to compute the saturation water vapor pressure. Either:</p>
<ul>
<li>’teten’, for the Teten’s formula;</li>
<li>’goff_gratch’, for the Goff-Gratch formula.</li>
</ul>
</li>
<li><strong>p</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the pressure ([<span class="math">\(Pa\)</span>]).</li>
<li><strong>T</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the temperature ([<span class="math">\(K\)</span>]).</li>
<li><strong>rh</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the relative humidity ([<span class="math">\(-\)</span>]).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the fraction of water vapor ([<span class="math">\(g \, g^{-1}\)</span>]).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array_like</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Vaisala, O. (2013). <cite>Humidity conversion formulas: Calculation formulas for humidity</cite>. Retrieved from           <a class="reference external" href="https://www.vaisala.com">https://www.vaisala.com</a>.</p>
</dd></dl>

<dl class="function">
<dt id="utils.utils_meteo.get_isentropic_isothermal_analytical_solution">
<code class="descclassname">utils.utils_meteo.</code><code class="descname">get_isentropic_isothermal_analytical_solution</code><span class="sig-paren">(</span><em>grid</em>, <em>x_velocity_initial</em>, <em>temperature</em>, <em>mountain_height</em>, <em>mountain_width</em>, <em>x_staggered=True</em>, <em>z_staggered=False</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.utils_meteo.get_isentropic_isothermal_analytical_solution" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the analytical expression of a two-dimensional, hydrostatic, isentropic and isothermal flow over an isolated
<cite>Switch of Agnesi</cite> mountain.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>grid</strong> (<em>obj</em>) – <a class="reference internal" href="#grids.grid_xyz.GridXYZ" title="grids.grid_xyz.GridXYZ"><code class="xref py py-class docutils literal"><span class="pre">GridXYZ</span></code></a> representing the underlying grid. It must consist of only one points in <span class="math">\(y\)</span>-direction.</li>
<li><strong>x_velocity_initial</strong> (<em>float</em>) – The initial <span class="math">\(x\)</span>-velocity, in units of [<span class="math">\(m \, s^{-1}\)</span>].</li>
<li><strong>temperature</strong> (<em>float</em>) – The temperature, in units of [<span class="math">\(K\)</span>].</li>
<li><strong>mountain_height</strong> (<em>float</em>) – The maximum mountain height, in units of [<span class="math">\(m\)</span>].</li>
<li><strong>mountain_width</strong> (<em>float</em>) – The mountain half-width at half-height, in units of [<span class="math">\(m\)</span>].</li>
<li><strong>x_staggered</strong> (<cite>bool</cite>, optional) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if the solution should be staggered in the <span class="math">\(x\)</span>-direction, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.
Default is <code class="xref py py-obj docutils literal"><span class="pre">True</span></code>.</li>
<li><strong>z_staggered</strong> (<cite>bool</cite>, optional) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if the solution should be staggered in the vertical direction, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise.
Default is <code class="xref py py-obj docutils literal"><span class="pre">False</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>u</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the <span class="math">\(x\)</span>-velocity.</li>
<li><strong>w</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the vertical velocity.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Durran, D. R. (1981). <cite>The effects of moisture on mountain lee waves</cite>.          Doctoral dissertation, Massachussets Institute of Technology.</p>
</dd></dl>

</div>
<div class="section" id="module-utils.utils_plot">
<span id="plotting-utilities"></span><h3>Plotting utilities<a class="headerlink" href="#module-utils.utils_plot" title="Permalink to this headline">¶</a></h3>
<p>Plotting utilities.</p>
<dl class="function">
<dt id="utils.utils_plot.contour_xz">
<code class="descclassname">utils.utils_plot.</code><code class="descname">contour_xz</code><span class="sig-paren">(</span><em>grid</em>, <em>height</em>, <em>field</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.utils_plot.contour_xz" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a <span class="math">\(xz\)</span>-contour of a gridded field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <span class="math">\(~grids.grid_xyz.GridXYZ\)</span> or one of its derived classes.</li>
<li><strong>height</strong> (<em>array_like</em>) – Two-dimensional <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the height of the vertical coordinate isolines.</li>
<li><strong>field</strong> (<em>array_like</em>) – Two-dimensional <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field to plot.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><strong>show</strong> (<em>bool</em>) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if the plot should be showed, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise. Default is <code class="xref py py-obj docutils literal"><span class="pre">True</span></code>.</li>
<li><strong>destination</strong> (<em>str</em>) – String specify the path to the location where the plot will be saved. Default is <code class="xref py py-obj docutils literal"><span class="pre">None</span></code>, meaning that the plot
will not be saved. Note that the plot may be saved only if <code class="xref py py-data docutils literal"><span class="pre">show</span></code> is set to <code class="xref py py-obj docutils literal"><span class="pre">False</span></code>.</li>
<li><strong>fontsize</strong> (<em>int</em>) – The fontsize to be used. Default is 12.</li>
<li><strong>figsize</strong> (<em>sequence</em>) – Sequence representing the figure size. Default is [8,8].</li>
<li><strong>title</strong> (<em>str</em>) – The figure title. Default is an empty string.</li>
<li><strong>x_label</strong> (<em>str</em>) – Label for the <span class="math">\(x\)</span>-axis. Default is ‘&lt;axis_dimension&gt; [&lt;axis_units&gt;]’.</li>
<li><strong>x_factor</strong> (<em>float</em>) – Scaling factor for the <span class="math">\(x\)</span>-axis. Default is 1.</li>
<li><strong>x_lim</strong> (<em>sequence</em>) – Sequence representing the interval of the <span class="math">\(x\)</span>-axis to visualize. By default, the entire domain is shown.</li>
<li><strong>z_label</strong> (<em>str</em>) – Label for the <span class="math">\(z\)</span>-axis. Default is ‘&lt;axis_dimension&gt; [&lt;axis_units&gt;]’.</li>
<li><strong>z_factor</strong> (<em>float</em>) – Scaling factor for the <span class="math">\(z\)</span>-axis. Default is 1.</li>
<li><strong>z_lim</strong> (<em>sequence</em>) – Sequence representing the interval of the <span class="math">\(z\)</span>-axis to visualize. By default, the entire domain is shown.</li>
<li><strong>field_factor</strong> (<em>float</em>) – Scaling factor for the field. Default is 1.</li>
<li><strong>plot_height</strong> (<em>bool</em>) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> to plot the height of the vertical coordinate isolines, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise. Default is <code class="xref py py-obj docutils literal"><span class="pre">True</span></code>.</li>
<li><strong>text</strong> (<em>str</em>) – Text to be added to the figure as anchored text. By default, no extra text is shown.</li>
<li><strong>text_loc</strong> (<em>str</em>) – String specifying the location where the text box should be placed. Default is ‘upper right’;
please see <a class="reference external" href="https://matplotlib.org/2.1.1/api/offsetbox_api.html#matplotlib.offsetbox.AnchoredText" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.offsetbox.AnchoredText</span></code></a> for all the available options.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.utils_plot.contourf_xy">
<code class="descclassname">utils.utils_plot.</code><code class="descname">contourf_xy</code><span class="sig-paren">(</span><em>grid</em>, <em>field</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.utils_plot.contourf_xy" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a <span class="math">\(xy\)</span>-contourf of a gridded field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <span class="math">\(~grids.grid_xyz.GridXYZ\)</span> or one of its derived classes.</li>
<li><strong>topography</strong> (<em>array_like</em>) – One-dimensional <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the underlying topography.</li>
<li><strong>height</strong> (<em>array_like</em>) – Two-dimensional <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the height of the vertical coordinate isolines.</li>
<li><strong>field</strong> (<em>array_like</em>) – Two-dimensional <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field to plot.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><strong>show</strong> (<em>bool</em>) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if the plot should be showed, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise. Default is <code class="xref py py-obj docutils literal"><span class="pre">True</span></code>.</li>
<li><strong>destination</strong> (<em>str</em>) – String specify the path to the location where the plot will be saved. Default is <code class="xref py py-obj docutils literal"><span class="pre">None</span></code>, meaning that the plot
will not be saved. Note that the plot may be saved only if <code class="xref py py-data docutils literal"><span class="pre">show</span></code> is set to <code class="xref py py-obj docutils literal"><span class="pre">False</span></code>.</li>
<li><strong>fontsize</strong> (<em>int</em>) – The fontsize to be used. Default is 12.</li>
<li><strong>figsize</strong> (<em>sequence</em>) – Sequence representing the figure size. Default is [8,8].</li>
<li><strong>title</strong> (<em>str</em>) – The figure title. Default is an empty string.</li>
<li><strong>x_label</strong> (<em>str</em>) – Label for the <span class="math">\(x\)</span>-axis. Default is ‘&lt;axis_dimension&gt; [&lt;axis_units&gt;]’.</li>
<li><strong>x_factor</strong> (<em>float</em>) – Scaling factor for the <span class="math">\(x\)</span>-axis. Default is 1.</li>
<li><strong>x_lim</strong> (<em>sequence</em>) – Sequence representing the interval of the <span class="math">\(x\)</span>-axis to visualize. By default, the entire domain is shown.</li>
<li><strong>y_label</strong> (<em>str</em>) – Label for the <span class="math">\(y\)</span>-axis. Default is ‘&lt;axis_dimension&gt; [&lt;axis_units&gt;]’.</li>
<li><strong>y_factor</strong> (<em>float</em>) – Scaling factor for the <span class="math">\(y\)</span>-axis. Default is 1.</li>
<li><strong>y_lim</strong> (<em>sequence</em>) – Sequence representing the interval of the <span class="math">\(y\)</span>-axis to visualize. By default, the entire domain is shown.</li>
<li><strong>field_factor</strong> (<em>float</em>) – Scaling factor for the field. Default is 1.</li>
<li><strong>cmap_name</strong> (<em>str</em>) – Name of the Matplotlib’s color map to be used. All the color maps provided by Matplotlib, as well as the corresponding inverted
versions, are available.</li>
<li><strong>cbar_levels</strong> (<em>int</em>) – Number of levels for the color bar. Default is 14.</li>
<li><strong>cbar_ticks_step</strong> (<em>int</em>) – Distance between two consecutive labelled ticks of the color bar. Default is 1, i.e., all ticks are displayed with the
corresponding label.</li>
<li><strong>cbar_center</strong> (<em>float</em>) – Center of the range covered by the color bar. By default, the color bar cover the spectrum identified by the minimum
and the maximum assumed by the field.</li>
<li><strong>cbar_half-width</strong> (<em>float</em>) – Half-width of the range covered by the color bar. By default, the color bar cover the spectrum identified by the minimum
and the maximum assumed by the field.</li>
<li><strong>cbar_x_label</strong> (<em>str</em>) – Label for the horizontal axis of the color bar. Default is an empty string.</li>
<li><strong>cbar_y_label</strong> (<em>str</em>) – Label for the vertical axis of the color bar. Default is an empty string.</li>
<li><strong>cbar_orientation</strong> (<em>str</em>) – Orientation of the color bar. Either ‘vertical’ (default) or ‘horizontal’.</li>
<li><strong>text</strong> (<em>str</em>) – Text to be added to the figure as anchored text. By default, no extra text is shown.</li>
<li><strong>text_loc</strong> (<em>str</em>) – String specifying the location where the text box should be placed. Default is ‘upper right’;
please see <a class="reference external" href="https://matplotlib.org/2.1.1/api/offsetbox_api.html#matplotlib.offsetbox.AnchoredText" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.offsetbox.AnchoredText</span></code></a> for all the available options.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.utils_plot.contourf_xz">
<code class="descclassname">utils.utils_plot.</code><code class="descname">contourf_xz</code><span class="sig-paren">(</span><em>grid</em>, <em>topography</em>, <em>height</em>, <em>field</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.utils_plot.contourf_xz" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a <span class="math">\(xz\)</span>-contourf of a gridded field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <span class="math">\(~grids.grid_xyz.GridXYZ\)</span> or one of its derived classes.</li>
<li><strong>topography</strong> (<em>array_like</em>) – One-dimensional <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the underlying topography.</li>
<li><strong>height</strong> (<em>array_like</em>) – Two-dimensional <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the height of the vertical coordinate isolines.</li>
<li><strong>field</strong> (<em>array_like</em>) – Two-dimensional <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the field to plot.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><strong>show</strong> (<em>bool</em>) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if the plot should be showed, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise. Default is <code class="xref py py-obj docutils literal"><span class="pre">True</span></code>.</li>
<li><strong>destination</strong> (<em>str</em>) – String specify the path to the location where the plot will be saved. Default is <code class="xref py py-obj docutils literal"><span class="pre">None</span></code>, meaning that the plot
will not be saved. Note that the plot may be saved only if <code class="xref py py-data docutils literal"><span class="pre">show</span></code> is set to <code class="xref py py-obj docutils literal"><span class="pre">False</span></code>.</li>
<li><strong>fontsize</strong> (<em>int</em>) – The fontsize to be used. Default is 12.</li>
<li><strong>figsize</strong> (<em>sequence</em>) – Sequence representing the figure size. Default is [8,8].</li>
<li><strong>title</strong> (<em>str</em>) – The figure title. Default is an empty string.</li>
<li><strong>x_label</strong> (<em>str</em>) – Label for the <span class="math">\(x\)</span>-axis. Default is ‘&lt;axis_dimension&gt; [&lt;axis_units&gt;]’.</li>
<li><strong>x_factor</strong> (<em>float</em>) – Scaling factor for the <span class="math">\(x\)</span>-axis. Default is 1.</li>
<li><strong>x_lim</strong> (<em>sequence</em>) – Sequence representing the interval of the <span class="math">\(x\)</span>-axis to visualize. By default, the entire domain is shown.</li>
<li><strong>z_label</strong> (<em>str</em>) – Label for the <span class="math">\(z\)</span>-axis. Default is ‘&lt;axis_dimension&gt; [&lt;axis_units&gt;]’.</li>
<li><strong>z_factor</strong> (<em>float</em>) – Scaling factor for the <span class="math">\(z\)</span>-axis. Default is 1.</li>
<li><strong>z_lim</strong> (<em>sequence</em>) – Sequence representing the interval of the <span class="math">\(z\)</span>-axis to visualize. By default, the entire domain is shown.</li>
<li><strong>field_factor</strong> (<em>float</em>) – Scaling factor for the field. Default is 1.</li>
<li><strong>plot_height</strong> (<em>bool</em>) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> to plot the height of the vertical coordinate isolines, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise. Default is <code class="xref py py-obj docutils literal"><span class="pre">True</span></code>.</li>
<li><strong>cmap_name</strong> (<em>str</em>) – Name of the Matplotlib’s color map to be used. All the color maps provided by Matplotlib, as well as the corresponding inverted
versions, are available.</li>
<li><strong>cbar_levels</strong> (<em>int</em>) – Number of levels for the color bar. Default is 14.</li>
<li><strong>cbar_ticks_step</strong> (<em>int</em>) – Distance between two consecutive labelled ticks of the color bar. Default is 1, i.e., all ticks are displayed with the
corresponding label.</li>
<li><strong>cbar_center</strong> (<em>float</em>) – Center of the range covered by the color bar. By default, the color bar cover the spectrum identified by the minimum
and the maximum assumed by the field.</li>
<li><strong>cbar_half-width</strong> (<em>float</em>) – Half-width of the range covered by the color bar. By default, the color bar cover the spectrum identified by the minimum
and the maximum assumed by the field.</li>
<li><strong>cbar_x_label</strong> (<em>str</em>) – Label for the horizontal axis of the color bar. Default is an empty string.</li>
<li><strong>cbar_y_label</strong> (<em>str</em>) – Label for the vertical axis of the color bar. Default is an empty string.</li>
<li><strong>cbar_orientation</strong> (<em>str</em>) – Orientation of the color bar. Either ‘vertical’ (default) or ‘horizontal’.</li>
<li><strong>text</strong> (<em>str</em>) – Text to be added to the figure as anchored text. By default, no extra text is shown.</li>
<li><strong>text_loc</strong> (<em>str</em>) – String specifying the location where the text box should be placed. Default is ‘upper right’;
please see <a class="reference external" href="https://matplotlib.org/2.1.1/api/offsetbox_api.html#matplotlib.offsetbox.AnchoredText" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.offsetbox.AnchoredText</span></code></a> for all the available options.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.utils_plot.quiver_xy">
<code class="descclassname">utils.utils_plot.</code><code class="descname">quiver_xy</code><span class="sig-paren">(</span><em>grid</em>, <em>vx</em>, <em>vy</em>, <em>scalar=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.utils_plot.quiver_xy" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a <span class="math">\(xy\)</span>-quiver plot of a gridded vectorial field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>grid</strong> (<em>obj</em>) – The underlying grid, as an instance of <span class="math">\(~grids.grid_xyz.GridXYZ\)</span> or one of its derived classes.</li>
<li><strong>vx</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the <span class="math">\(x\)</span>-component of the field to plot.</li>
<li><strong>vy</strong> (<em>array_like</em>) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing the <span class="math">\(y\)</span>-component of the field to plot.</li>
<li><strong>scalar</strong> (<cite>array_like</cite>, optional) – <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> representing a scalar field associated with the vectorial field.
The arrows will be colored based on the corresponding scalar value. If not specified, the arrows will be colored
based on their magnitude.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><strong>show</strong> (<em>bool</em>) – <code class="xref py py-obj docutils literal"><span class="pre">True</span></code> if the plot should be showed, <code class="xref py py-obj docutils literal"><span class="pre">False</span></code> otherwise. Default is <code class="xref py py-obj docutils literal"><span class="pre">True</span></code>.</li>
<li><strong>destination</strong> (<em>str</em>) – String specify the path to the location where the plot will be saved. Default is <code class="xref py py-obj docutils literal"><span class="pre">None</span></code>, meaning that the plot
will not be saved. Note that the plot may be saved only if <code class="xref py py-data docutils literal"><span class="pre">show</span></code> is set to <code class="xref py py-obj docutils literal"><span class="pre">False</span></code>.</li>
<li><strong>fontsize</strong> (<em>int</em>) – The fontsize to be used. Default is 12.</li>
<li><strong>figsize</strong> (<em>sequence</em>) – Sequence representing the figure size. Default is [8,8].</li>
<li><strong>title</strong> (<em>str</em>) – The figure title. Default is an empty string.</li>
<li><strong>x_label</strong> (<em>str</em>) – Label for the <span class="math">\(x\)</span>-axis. Default is ‘&lt;axis_dimension&gt; [&lt;axis_units&gt;]’.</li>
<li><strong>x_factor</strong> (<em>float</em>) – Scaling factor for the <span class="math">\(x\)</span>-axis. Default is 1.</li>
<li><strong>x_lim</strong> (<em>sequence</em>) – Sequence representing the interval of the <span class="math">\(x\)</span>-axis to visualize. By default, the entire domain is shown.</li>
<li><strong>x_step</strong> (<em>int</em>) – Distance between the <span class="math">\(x\)</span>-indeces of any pair of plotted points consecutive in the <span class="math">\(x\)</span>-direction.
Default is 2, i.e., only half of the points will be drawn.</li>
<li><strong>y_label</strong> (<em>str</em>) – Label for the <span class="math">\(y\)</span>-axis. Default is ‘&lt;axis_dimension&gt; [&lt;axis_units&gt;]’.</li>
<li><strong>y_factor</strong> (<em>float</em>) – Scaling factor for the <span class="math">\(y\)</span>-axis. Default is 1.</li>
<li><strong>y_lim</strong> (<em>sequence</em>) – Sequence representing the interval of the <span class="math">\(y\)</span>-axis to visualize. By default, the entire domain is shown.</li>
<li><strong>y_step</strong> (<em>int</em>) – Distance between the <span class="math">\(y\)</span>-indeces of any pair of plotted points consecutive along the <span class="math">\(y\)</span>-direction.
Default is 2, i.e., only half of the points will be drawn.</li>
<li><strong>field_factor</strong> (<em>float</em>) – Scaling factor for the field. Default is 1.</li>
<li><strong>cmap_name</strong> (<em>str</em>) – Name of the Matplotlib’s color map to be used. All the color maps provided by Matplotlib, as well as the corresponding inverted
versions, are available. If not specified, no color map will be used, and the arrows will draw black.</li>
<li><strong>cbar_levels</strong> (<em>int</em>) – Number of levels for the color bar. Default is 14.</li>
<li><strong>cbar_ticks_step</strong> (<em>int</em>) – Distance between two consecutive labelled ticks of the color bar. Default is 1, i.e., all ticks are displayed with the
corresponding label.</li>
<li><strong>cbar_center</strong> (<em>float</em>) – Center of the range covered by the color bar. By default, the color bar cover the spectrum identified by the minimum
and the maximum assumed by the field.</li>
<li><strong>cbar_half-width</strong> (<em>float</em>) – Half-width of the range covered by the color bar. By default, the color bar cover the spectrum identified by the minimum
and the maximum assumed by the field.</li>
<li><strong>cbar_x_label</strong> (<em>str</em>) – Label for the horizontal axis of the color bar. Default is an empty string.</li>
<li><strong>cbar_y_label</strong> (<em>str</em>) – Label for the vertical axis of the color bar. Default is an empty string.</li>
<li><strong>cbar_orientation</strong> (<em>str</em>) – Orientation of the color bar. Either ‘vertical’ (default) or ‘horizontal’.</li>
<li><strong>text</strong> (<em>str</em>) – Text to be added to the figure as anchored text. By default, no extra text is shown.</li>
<li><strong>text_loc</strong> (<em>str</em>) – String specifying the location where the text box should be placed. Default is ‘upper right’;
please see <a class="reference external" href="https://matplotlib.org/2.1.1/api/offsetbox_api.html#matplotlib.offsetbox.AnchoredText" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.offsetbox.AnchoredText</span></code></a> for all the available options.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.utils_plot.reverse_colormap">
<code class="descclassname">utils.utils_plot.</code><code class="descname">reverse_colormap</code><span class="sig-paren">(</span><em>cmap</em>, <em>name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.utils_plot.reverse_colormap" title="Permalink to this definition">¶</a></dt>
<dd><p>Reverse a Matplotlib colormap.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cmap</strong> (<em>obj</em>) – The <a class="reference external" href="https://matplotlib.org/2.1.1/api/_as_gen/matplotlib.colors.LinearSegmentedColormap.html#matplotlib.colors.LinearSegmentedColormap" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.colors.LinearSegmentedColormap</span></code></a> to invert.</li>
<li><strong>name</strong> (<cite>str</cite>, optional) – The name of the reversed colormap. By default, this is obtained by appending ‘_r’ to the name of the input colormap.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The reversed <a class="reference external" href="https://matplotlib.org/2.1.1/api/_as_gen/matplotlib.colors.LinearSegmentedColormap.html#matplotlib.colors.LinearSegmentedColormap" title="(in Matplotlib v2.1.1)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.colors.LinearSegmentedColormap</span></code></a>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obj</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="https://stackoverflow.com/questions/3279560/invert-colormap-in-matplotlib">https://stackoverflow.com/questions/3279560/invert-colormap-in-matplotlib</a>.</p>
</dd></dl>

</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="index.html" class="btn btn-neutral" title="Welcome to gt4ess’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Stefano Ubbiali.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
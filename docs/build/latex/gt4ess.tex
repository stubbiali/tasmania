%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax

\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
 \ifdefined\DeclareUnicodeCharacterAsOptional
  \DeclareUnicodeCharacter{"00A0}{\nobreakspace}
  \DeclareUnicodeCharacter{"2500}{\sphinxunichar{2500}}
  \DeclareUnicodeCharacter{"2502}{\sphinxunichar{2502}}
  \DeclareUnicodeCharacter{"2514}{\sphinxunichar{2514}}
  \DeclareUnicodeCharacter{"251C}{\sphinxunichar{251C}}
  \DeclareUnicodeCharacter{"2572}{\textbackslash}
 \else
  \DeclareUnicodeCharacter{00A0}{\nobreakspace}
  \DeclareUnicodeCharacter{2500}{\sphinxunichar{2500}}
  \DeclareUnicodeCharacter{2502}{\sphinxunichar{2502}}
  \DeclareUnicodeCharacter{2514}{\sphinxunichar{2514}}
  \DeclareUnicodeCharacter{251C}{\sphinxunichar{251C}}
  \DeclareUnicodeCharacter{2572}{\textbackslash}
 \fi
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}
\usepackage{times}
\usepackage[Bjarne]{fncychap}
\usepackage[dontkeepoldnames]{sphinx}

\usepackage{geometry}

% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}
\addto\captionsenglish{\renewcommand{\contentsname}{Contents:}}

\addto\captionsenglish{\renewcommand{\figurename}{Fig.}}
\addto\captionsenglish{\renewcommand{\tablename}{Table}}
\addto\captionsenglish{\renewcommand{\literalblockname}{Listing}}

\addto\captionsenglish{\renewcommand{\literalblockcontinuedname}{continued from previous page}}
\addto\captionsenglish{\renewcommand{\literalblockcontinuesname}{continues on next page}}

\addto\extrasenglish{\def\pageautorefname{page}}

\setcounter{tocdepth}{1}



\title{gt4ess Documentation}
\date{Mar 17, 2018}
\release{0.1.0}
\author{Stefano Ubbiali}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{Release}
\makeindex

\begin{document}

\maketitle
\sphinxtableofcontents
\phantomsection\label{\detokenize{index::doc}}



\chapter{API Documentation}
\label{\detokenize{api:welcome-to-gt4ess-s-documentation}}\label{\detokenize{api::doc}}\label{\detokenize{api:api-documentation}}

\section{Axis}
\label{\detokenize{api:axis}}\index{Axis (class in grids.axis)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.axis.Axis}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{grids.axis.}\sphinxbfcode{Axis}}{\emph{coords}, \emph{dims}, \emph{attrs=None}}{}
Class representing a one-dimensional axis. The class API is designed to be similar to
that provided by \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}}.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{coords} (\sphinxstyleliteralemphasis{list}) \textendash{} One-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} storing axis coordinates, wrapped within a list.

\item {} 
\sphinxstyleliteralstrong{values} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} One-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} storing axis coordinates. This attrribute is semantically identical
to \sphinxcode{coords} and it is introduced only for the sake of compliancy with \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}}’s API.

\item {} 
\sphinxstyleliteralstrong{dims} (\sphinxstyleliteralemphasis{str}) \textendash{} Axis dimension, i.e., label.

\item {} 
\sphinxstyleliteralstrong{attrs} (\sphinxstyleliteralemphasis{dict}) \textendash{} Axis attributes, e.g., the units.

\end{itemize}

\end{description}\end{quote}
\index{\_\_getitem\_\_() (grids.axis.Axis method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.axis.Axis.__getitem__}}\pysiglinewithargsret{\sphinxbfcode{\_\_getitem\_\_}}{\emph{i}}{}
Get direct access to the coordinate vector.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{i} (\sphinxtitleref{int} or {\color{red}\bfseries{}{}`}array\_like) \textendash{} The index, or a sequence of indices.

\item[{Returns}] \leavevmode
The coordinate(s).

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_init\_\_() (grids.axis.Axis method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.axis.Axis.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{coords}, \emph{dims}, \emph{attrs=None}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{coords} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} One-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the axis values.

\item {} 
\sphinxstyleliteralstrong{dims} (\sphinxstyleliteralemphasis{str}) \textendash{} Axis label.

\item {} 
\sphinxstyleliteralstrong{attrs} (\sphinxtitleref{dict}, optional) \textendash{} 
Axis attributes. This may be used to specify, e.g., the units, which, following the
\sphinxhref{http://cfconventions.org}{CF Conventions}, may be either:
\begin{itemize}
\item {} 
’m’ (meters) or multiples, for height-based coordinates;

\item {} 
’Pa’ (Pascal) or multiples, for pressure-based coordinates;

\item {} 
’K’ (Kelvin), for temperature-based coordinates;

\item {} 
’degrees\_east’, for longitude;

\item {} 
’degrees\_north’, for latitude.

\end{itemize}


\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_check\_arguments() (grids.axis.Axis method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.axis.Axis._check_arguments}}\pysiglinewithargsret{\sphinxbfcode{\_check\_arguments}}{\emph{coords}, \emph{attr}}{}
Convert user-specified units to base units, e.g., km \textendash{}\textgreater{} m, hPa \textendash{}\textgreater{} Pa.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{coords} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} One-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the axis values.

\item {} 
\sphinxstyleliteralstrong{attrs} (\sphinxstyleliteralemphasis{dict}) \textendash{} 
Axis attributes. This may be used to specify, e.g., the units, which, following the
\sphinxhref{http://cfconventions.org}{CF Conventions}, may be either:
\begin{itemize}
\item {} 
’m’ (meters) or multiples, for height-based coordinates;

\item {} 
’Pa’ (Pascal) or multiples, for pressure-based coordinates;

\item {} 
’K’ (Kelvin), for temperature-based coordinates;

\item {} 
’degrees\_east’, for longitude;

\item {} 
’degrees\_north’, for latitude.

\end{itemize}


\end{itemize}

\item[{Returns}] \leavevmode
The axis coordinates expressed in base units.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\section{Dynamics}
\label{\detokenize{api:dynamics}}

\subsection{Diagnostics}
\label{\detokenize{api:diagnostics}}\index{DiagnosticIsentropic (class in dycore.diagnostic\_isentropic)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.diagnostic\_isentropic.}\sphinxbfcode{DiagnosticIsentropic}}{\emph{grid}, \emph{moist\_on}, \emph{backend}}{}
Class implementing the diagnostic steps of the three-dimensional moist isentropic dynamical core
using GT4Py’s stencils.
\index{\_\_init\_\_() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{moist\_on}, \emph{backend}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py’s stencils.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_diagnosing\_air\_density\_defs() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_air_density_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_air\_density\_defs}}{\emph{in\_theta}, \emph{in\_s}, \emph{in\_h}}{}
GT4Py’s stencil diagnosing the density.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_theta} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the vertical half levels.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_h} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the geometric height at the half-levels.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the diagnosed density.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_diagnosing\_air\_density\_initialize() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_air_density_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_air\_density\_initialize}}{}{}
Initialize the GT4Py’s stencil in charge of diagnosing the density.

\end{fulllineitems}

\index{\_stencil\_diagnosing\_air\_density\_set\_inputs() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_air_density_set_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_air\_density\_set\_inputs}}{\emph{s}, \emph{h}}{}
Update the private instance attributes which serve as inputs to the GT4Py’s stencil which diagnoses the density.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{s} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} with shape (\sphinxcode{nx}, \sphinxcode{ny}, \sphinxcode{nz}) representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{h} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} with shape (\sphinxcode{nx}, \sphinxcode{ny}, \sphinxcode{nz+1}) representing the height of the half-levels.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_diagnosing\_air\_pressure\_defs() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_air_pressure_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_air\_pressure\_defs}}{\emph{in\_s}, \emph{in\_p}}{}
GT4Py’s stencil diagnosing the pressure.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_p} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the pressure.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the diagnosed pressure.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_diagnosing\_air\_pressure\_initialize() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_air_pressure_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_air\_pressure\_initialize}}{}{}
Initialize the GT4Py’s stencil in charge of diagnosing the pressure.

\end{fulllineitems}

\index{\_stencil\_diagnosing\_air\_pressure\_set\_inputs() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_air_pressure_set_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_air\_pressure\_set\_inputs}}{\emph{s}}{}
Update the private instance attributes which serve as inputs to the GT4Py’s stencil which diagnoses the pressure.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{s} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} with shape (\sphinxcode{nx}, \sphinxcode{ny}, \sphinxcode{nz}) representing the isentropic density.

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_diagnosing\_height\_defs() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_height_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_height\_defs}}{\emph{in\_theta}, \emph{in\_exn}, \emph{in\_p}, \emph{in\_h}}{}
GT4Py’s stencil diagnosing the geometric height of the isentropes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_theta} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the vertical half levels.

\item {} 
\sphinxstyleliteralstrong{in\_exn} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Exner function.

\item {} 
\sphinxstyleliteralstrong{in\_p} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the pressure.

\item {} 
\sphinxstyleliteralstrong{in\_h} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the geometric height of the isentropes.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the diagnosed geometric height of the isentropes.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_diagnosing\_height\_initialize() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_height_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_height\_initialize}}{}{}
Initialize the GT4Py’s stencil in charge of diagnosing the geometric height of the half-level isentropes.

\end{fulllineitems}

\index{\_stencil\_diagnosing\_mass\_fraction\_of\_water\_constituents\_in\_air\_defs() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_mass_fraction_of_water_constituents_in_air_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_mass\_fraction\_of\_water\_constituents\_in\_air\_defs}}{\emph{in\_s}, \emph{in\_Qv}, \emph{in\_Qc}, \emph{in\_Qr}}{}
GT4Py’s stencil diagnosing the mass fraction of each water constituent.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_U} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_V} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_Qv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_Qc} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of cloud water.

\item {} 
\sphinxstyleliteralstrong{in\_Qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_qv} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the diagnosed mass fraction of water vapor.

\item {} 
\sphinxstylestrong{out\_qc} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the diagnosed mass fraction of cloud water.

\item {} 
\sphinxstylestrong{out\_qr} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the diagnosed mass fraction of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_diagnosing\_mass\_fraction\_of\_water\_constituents\_in\_air\_initialize() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_mass_fraction_of_water_constituents_in_air_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_mass\_fraction\_of\_water\_constituents\_in\_air\_initialize}}{}{}
Initialize the GT4Py’s stencil in charge of diagnosing the mass fraction of each water constituent.

\end{fulllineitems}

\index{\_stencil\_diagnosing\_mass\_fraction\_of\_water\_constituents\_in\_air\_set\_inputs() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_mass_fraction_of_water_constituents_in_air_set_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_mass\_fraction\_of\_water\_constituents\_in\_air\_set\_inputs}}{\emph{s}, \emph{Qv}, \emph{Qc}, \emph{Qr}}{}
Update the private instance attributes which serve as inputs to the GT4Py’s stencil which diagnose
the mass fraction of each water constituent.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{s} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} with shape (\sphinxcode{nx}, \sphinxcode{ny}, \sphinxcode{nz}) representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{Qv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{Qc} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of cloud water.

\item {} 
\sphinxstyleliteralstrong{Qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of precipitation water.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_diagnosing\_montgomery\_defs() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_montgomery_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_montgomery\_defs}}{\emph{in\_exn}, \emph{in\_mtg}}{}
GT4Py’s stencil diagnosing the Exner function.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_exn} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Exner function.

\item {} 
\sphinxstyleliteralstrong{in\_mtg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the diagnosed Montgomery potential.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_diagnosing\_montgomery\_initialize() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_montgomery_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_montgomery\_initialize}}{}{}
Initialize the GT4Py’s stencil in charge of diagnosing the Montgomery potential.

\end{fulllineitems}

\index{\_stencil\_diagnosing\_velocity\_x\_defs() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_velocity_x_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_velocity\_x\_defs}}{\emph{in\_s}, \emph{in\_U}}{}
GT4Py’s stencil diagnosing the \(x\)-component of the velocity.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_U} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-momentum.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the diagnosed \(x\)-velocity.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_diagnosing\_velocity\_x\_initialize() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_velocity_x_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_velocity\_x\_initialize}}{}{}
Initialize the GT4Py’s stencil in charge of diagnosing the \(x\)-component of the velocity.

\end{fulllineitems}

\index{\_stencil\_diagnosing\_velocity\_y\_defs() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_velocity_y_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_velocity\_y\_defs}}{\emph{in\_s}, \emph{in\_V}}{}
GT4Py’s stencil diagnosing the \(y\)-component of the velocity.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_V} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-momentum.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the diagnosed \(y\)-velocity.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_diagnosing\_velocity\_y\_initialize() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_velocity_y_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_velocity\_y\_initialize}}{}{}
Initialize the GT4Py’s stencil in charge of diagnosing the \(y\)-component of the velocity.

\end{fulllineitems}

\index{\_stencil\_diagnosing\_water\_constituents\_isentropic\_density\_defs() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_water_constituents_isentropic_density_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_water\_constituents\_isentropic\_density\_defs}}{\emph{in\_s}, \emph{in\_qv}, \emph{in\_qc}, \emph{in\_qr}}{}
GT4Py’s stencil diagnosing the isentropic density of each water constituent, i.e.,
\(Q_v\), \(Q_c\) and \(Q_r\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_qv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_qc} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of cloud water.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_Qv} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the diagnosed \(Qv\).

\item {} 
\sphinxstylestrong{out\_Qc} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the diagnosed \(Qc\).

\item {} 
\sphinxstylestrong{out\_Qr} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the diagnosed \(Qr\).

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_diagnosing\_water\_constituents\_isentropic\_density\_initialize() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_water_constituents_isentropic_density_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_water\_constituents\_isentropic\_density\_initialize}}{}{}
Initialize the GT4Py’s stencil in charge of diagnosing the isentropic density of each water constituent.

\end{fulllineitems}

\index{\_stencil\_diagnosing\_water\_constituents\_isentropic\_density\_set\_inputs() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_water_constituents_isentropic_density_set_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_water\_constituents\_isentropic\_density\_set\_inputs}}{\emph{s}, \emph{qv}, \emph{qc}, \emph{qr}}{}
Update the private instance attributes which serve as inputs to the GT4Py’s stencil which diagnoses
the isentropic density of each water constituent.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{s} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} with shape (\sphinxcode{nx}, \sphinxcode{ny}, \sphinxcode{nz}) representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{qv} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} with shape (\sphinxcode{nx}, \sphinxcode{ny}, \sphinxcode{nz}) representing the mass fraction of
water vapor.

\item {} 
\sphinxstyleliteralstrong{qc} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} with shape (\sphinxcode{nx}, \sphinxcode{ny}, \sphinxcode{nz}) representing the mass fraction of
cloud water.

\item {} 
\sphinxstyleliteralstrong{qr} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} with shape (\sphinxcode{nx}, \sphinxcode{ny}, \sphinxcode{nz}) representing the mass fraction of
precipitation water.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencils\_diagnosing\_velocity\_set\_inputs() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencils_diagnosing_velocity_set_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencils\_diagnosing\_velocity\_set\_inputs}}{\emph{s}, \emph{U}, \emph{V}}{}
Update the private instance attributes which serve as inputs to the GT4Py’s stencils which diagnose
the velocity components.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{s} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} with shape (\sphinxcode{nx}, \sphinxcode{ny}, \sphinxcode{nz}) representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{U} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} with shape (\sphinxcode{nx}, \sphinxcode{ny}, \sphinxcode{nz}) representing the \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{V} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} with shape (\sphinxcode{nx}, \sphinxcode{ny}, \sphinxcode{nz}) representing the \(y\)-velocity.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{diagnostic (dycore.diagnostic\_isentropic.DiagnosticIsentropic attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic.diagnostic}}\pysigline{\sphinxbfcode{diagnostic}}
Get the attribute implementing the diagnostic step of the three-dimensional moist isentropic dynamical core.
If this is set to \sphinxcode{None}, a \sphinxcode{ValueError} is thrown.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
{\hyperref[\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic}]{\sphinxcrossref{\sphinxcode{DiagnosticIsentropic}}}} carrying out the diagnostic step of the
three-dimensional moist isentropic dynamical core.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_air\_density() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic.get_air_density}}\pysiglinewithargsret{\sphinxbfcode{get\_air\_density}}{\emph{state}}{}
Diagnosis of the density.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes containing the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
height (\(z\)-staggered).

\end{itemize}


\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} collecting the diagnosed variables, namely:
\begin{itemize}
\item {} 
air\_density (unstaggered).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_air\_temperature() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic.get_air_temperature}}\pysiglinewithargsret{\sphinxbfcode{get\_air\_temperature}}{\emph{state}}{}
Diagnosis of the temperature.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes containing the following variables:
\begin{itemize}
\item {} 
exner\_function (\(z\)-staggered).

\end{itemize}


\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} collecting the diagnosed variables, namely:
\begin{itemize}
\item {} 
air\_temperature (unstaggered).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_diagnostic\_variables() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic.get_diagnostic_variables}}\pysiglinewithargsret{\sphinxbfcode{get\_diagnostic\_variables}}{\emph{state}, \emph{pt}}{}
Diagnosis of the pressure, the Exner function, the Montgomery potential, and the geometric height of the half-levels.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes containing the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{pt} (\sphinxstyleliteralemphasis{float}) \textendash{} Pressure value at the top of the domain.

\end{itemize}

\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} collecting the diagnosed variables, namely:
\begin{itemize}
\item {} 
air\_pressure (\(z\)-staggered);

\item {} 
exner\_function (\(z\)-staggered);

\item {} 
montgomery\_potential (unstaggered);

\item {} 
height (\(z\)-staggered).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_mass\_fraction\_of\_water\_constituents\_in\_air() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic.get_mass_fraction_of_water_constituents_in_air}}\pysiglinewithargsret{\sphinxbfcode{get\_mass\_fraction\_of\_water\_constituents\_in\_air}}{\emph{state}}{}
Diagnosis of the mass fraction of each water constituents, i.e., \(q_v\), \(q_c\) and \(q_r\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes containing the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
water\_vapor\_isentropic\_density (unstaggered);

\item {} 
cloud\_liquid\_water\_isentropic\_density (unstaggered);

\item {} 
precipitation\_water\_isentropic\_density (unstaggered).

\end{itemize}


\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} collecting the diagnosed variables, namely:
\begin{itemize}
\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_velocity\_components() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic.get_velocity_components}}\pysiglinewithargsret{\sphinxbfcode{get\_velocity\_components}}{\emph{state}, \emph{state\_old=None}}{}
Diagnosis of the velocity components \(u\) and \(v\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes containing the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{state\_old} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes containing the following variables,
defined at the previous time level:
\begin{itemize}
\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
y\_velocity (\(y\)-staggered).

\end{itemize}


\end{itemize}

\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} collecting the diagnosed variables, namely:
\begin{itemize}
\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
y\_velocity (\(y\)-staggered).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The first and last rows (respectively, columns) of the staggered \(x\)-velocity (resp., \(y\)-velocity)
are set only if the state at the previous time level is provided.
\end{sphinxadmonition}

\end{fulllineitems}

\index{get\_water\_constituents\_isentropic\_density() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic.get_water_constituents_isentropic_density}}\pysiglinewithargsret{\sphinxbfcode{get\_water\_constituents\_isentropic\_density}}{\emph{state}}{}
Diagnosis of the isentropic density of each water constituent, i.e., \(Q_v\), \(Q_c\) and \(Q_v\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes containing the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}


\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} collecting the diagnosed variables, namely:
\begin{itemize}
\item {} 
water\_vapor\_isentropic\_density (unstaggered);

\item {} 
cloud\_liquid\_water\_isentropic\_density (unstaggered);

\item {} 
precipitation\_water\_isentropic\_density (unstaggered).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{Dynamical cores}
\label{\detokenize{api:dynamical-cores}}\index{DynamicalCore (class in dycore.dycore)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore.DynamicalCore}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.dycore.}\sphinxbfcode{DynamicalCore}}{\emph{grid}, \emph{moist\_on}}{}
Abstract base class whose derived classes implement different dynamical cores.
The class inherits \sphinxcode{sympl.TimeStepper}.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode
\sphinxstyleliteralstrong{microphysics} (\sphinxstyleliteralemphasis{obj}) \textendash{} Derived class of \sphinxcode{Microphysics} taking care of the cloud microphysics.

\end{description}\end{quote}
\index{\_\_call\_\_() (dycore.dycore.DynamicalCore method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore.DynamicalCore.__call__}}\pysiglinewithargsret{\sphinxbfcode{\_\_call\_\_}}{\emph{dt}, \emph{state}, \emph{diagnostics=None}}{}
Call operator advancing the input state one step forward.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} object representing the time step.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} The current state, as an instance of {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{diagnostics} (\sphinxtitleref{obj}, optional) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing the possibly required diagnostics. Default is \sphinxcode{None}.

\end{itemize}

\item[{Returns}] \leavevmode
The state at the next time level. This is of the same class of \sphinxcode{state}.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_init\_\_() (dycore.dycore.DynamicalCore method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore.DynamicalCore.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{moist\_on}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{factory() (dycore.dycore.DynamicalCore static method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore.DynamicalCore.factory}}\pysiglinewithargsret{\sphinxbfcode{static }\sphinxbfcode{factory}}{\emph{model}, \emph{*args}, \emph{**kwargs}}{}
Static method returning an instance of the derived class implementing the dynamical core specified by \sphinxcode{model}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{model} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the dynamical core to implement. Either:
\begin{itemize}
\item {} 
’isentropic’, for the hydrostatic, isentropic dynamical core;

\item {} 
’isentropic\_isothermal’, for the hydrostatic, isentropic, isothermal dynamical core.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{*args} \textendash{} Positional arguments to forward to the derived class.

\item {} 
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to forward to the derived class.

\end{itemize}

\item[{Returns}] \leavevmode
Instance of the derived class implementing the specified model.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_initial\_state() (dycore.dycore.DynamicalCore method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore.DynamicalCore.get_initial_state}}\pysiglinewithargsret{\sphinxbfcode{get\_initial\_state}}{\emph{*args}}{}
Get the initial state.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{*args} \textendash{} The arguments depend on the specific dynamical core which the derived class implements.

\item[{Returns}] \leavevmode
The initial state, as an instance of {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{update\_topography() (dycore.dycore.DynamicalCore method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore.DynamicalCore.update_topography}}\pysiglinewithargsret{\sphinxbfcode{update\_topography}}{\emph{time}}{}
Update the underlying (time-dependent) topography.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the elapsed simulation time.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{DynamicalCoreIsentropic (class in dycore.dycore\_isentropic)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore_isentropic.DynamicalCoreIsentropic}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.dycore\_isentropic.}\sphinxbfcode{DynamicalCoreIsentropic}}{\emph{time\_scheme}, \emph{flux\_scheme}, \emph{horizontal\_boundary\_type}, \emph{grid}, \emph{moist\_on}, \emph{backend}, \emph{damp\_on=True}, \emph{damp\_type='rayleigh'}, \emph{damp\_depth=15}, \emph{damp\_max=0.0002}, \emph{smooth\_on=True}, \emph{smooth\_type='first\_order'}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.24}, \emph{smooth\_moist\_on=False}, \emph{smooth\_moist\_type='first\_order'}, \emph{smooth\_moist\_damp\_depth=10}, \emph{smooth\_coeff\_moist=0.03}, \emph{smooth\_coeff\_moist\_max=0.24}, \emph{physics\_dynamics\_coupling\_on=False}, \emph{sedimentation\_on=False}}{}
This class inherits {\hyperref[\detokenize{api:dycore.dycore.DynamicalCore}]{\sphinxcrossref{\sphinxcode{DynamicalCore}}}} to implement the three-dimensional
(moist) isentropic dynamical core using GT4Py’s stencils. The class offers different numerical
schemes to carry out the prognostic step of the dynamical core, and supports different types of
lateral boundary conditions.
\index{\_\_call\_\_() (dycore.dycore\_isentropic.DynamicalCoreIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore_isentropic.DynamicalCoreIsentropic.__call__}}\pysiglinewithargsret{\sphinxbfcode{\_\_call\_\_}}{\emph{dt}, \emph{state}, \emph{diagnostics=None}}{}
Call operator advancing the state variables one step forward.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
air\_pressure (\(z\)-staggered);

\item {} 
montgomery\_potential (unstaggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{diagnostics} (\sphinxtitleref{obj}, optional) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing possibly required diagnostics, namely:
\begin{itemize}
\item {} 
change\_over\_time\_in\_air\_potential\_temperature (unstaggered);

\item {} 
raindrop\_fall\_velocity (unstaggered).

\end{itemize}

Default is \sphinxcode{None}.


\end{itemize}

\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the state at the next time level.
It contains the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
air\_pressure (\(z\)-staggered);

\item {} 
exner\_function (\(z\)-staggered);

\item {} 
montgomery\_potential (unstaggered);

\item {} 
height (\(z\)-staggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered);

\item {} 
air\_density (unstaggered, only if cloud microphysics is switched on);

\item {} 
air\_temperature (unstaggered, only if cloud microphysics is switched on).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_init\_\_() (dycore.dycore\_isentropic.DynamicalCoreIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore_isentropic.DynamicalCoreIsentropic.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{time\_scheme}, \emph{flux\_scheme}, \emph{horizontal\_boundary\_type}, \emph{grid}, \emph{moist\_on}, \emph{backend}, \emph{damp\_on=True}, \emph{damp\_type='rayleigh'}, \emph{damp\_depth=15}, \emph{damp\_max=0.0002}, \emph{smooth\_on=True}, \emph{smooth\_type='first\_order'}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.24}, \emph{smooth\_moist\_on=False}, \emph{smooth\_moist\_type='first\_order'}, \emph{smooth\_moist\_damp\_depth=10}, \emph{smooth\_coeff\_moist=0.03}, \emph{smooth\_coeff\_moist\_max=0.24}, \emph{physics\_dynamics\_coupling\_on=False}, \emph{sedimentation\_on=False}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{time\_scheme} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the time stepping method to implement.
See {\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic}]{\sphinxcrossref{\sphinxcode{PrognosticIsentropic}}}} for the available options.

\item {} 
\sphinxstyleliteralstrong{flux\_scheme} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the numerical fluc to use.
See \sphinxcode{PrognosticFlux} for the available options.

\item {} 
\sphinxstyleliteralstrong{horizontal\_boundary\_type} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the horizontal boundary conditions.
See {\hyperref[\detokenize{api:dycore.horizontal_boundary.HorizontalBoundary}]{\sphinxcrossref{\sphinxcode{HorizontalBoundary}}}} for the available options.

\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py’s stencils implementing the dynamical core.

\item {} 
\sphinxstyleliteralstrong{damp\_on} (\sphinxtitleref{bool}, optional) \textendash{} \sphinxcode{True} if vertical damping is enabled, \sphinxcode{False} otherwise. Default is \sphinxcode{True}.

\item {} 
\sphinxstyleliteralstrong{damp\_type} (\sphinxtitleref{str}, optional) \textendash{} String specifying the type of vertical damping to apply. Default is ‘rayleigh’.
See {\hyperref[\detokenize{api:dycore.vertical_damping.VerticalDamping}]{\sphinxcrossref{\sphinxcode{dycore.vertical\_damping.VerticalDamping}}}} for the available options.

\item {} 
\sphinxstyleliteralstrong{damp\_depth} (\sphinxtitleref{int}, optional) \textendash{} Number of vertical layers in the damping region. Default is 15.

\item {} 
\sphinxstyleliteralstrong{damp\_max} (\sphinxtitleref{float}, optional) \textendash{} Maximum value for the damping coefficient. Default is 0.0002.

\item {} 
\sphinxstyleliteralstrong{smooth\_on} (\sphinxtitleref{bool}, optional) \textendash{} \sphinxcode{True} if numerical smoothing is enabled, \sphinxcode{False} otherwise. Default is \sphinxcode{True}.

\item {} 
\sphinxstyleliteralstrong{smooth\_type} (\sphinxtitleref{str}, optional) \textendash{} String specifying the smoothing technique to implement. Default is ‘first-order’.
See {\hyperref[\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothing}]{\sphinxcrossref{\sphinxcode{dycore.horizontal\_smoothing.HorizontalSmoothing}}}} for the available options.

\item {} 
\sphinxstyleliteralstrong{smooth\_damp\_depth} (\sphinxtitleref{int}, optional) \textendash{} Number of vertical layers in the smoothing damping region. Default is 10.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff} (\sphinxtitleref{float}, optional) \textendash{} Smoothing coefficient. Default is 0.03.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff\_max} (\sphinxtitleref{float}, optional) \textendash{} Maximum value for the smoothing coefficient. Default is 0.24.
See {\hyperref[\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothing}]{\sphinxcrossref{\sphinxcode{HorizontalSmoothing}}}} for further details.

\item {} 
\sphinxstyleliteralstrong{smooth\_moist\_on} (\sphinxtitleref{bool}, optional) \textendash{} \sphinxcode{True} if numerical smoothing on water constituents is enabled, \sphinxcode{False} otherwise. Default is \sphinxcode{True}.

\item {} 
\sphinxstyleliteralstrong{smooth\_moist\_type} (\sphinxtitleref{str}, optional) \textendash{} String specifying the smoothing technique to apply to the water constituents. Default is ‘first-order’.
See {\hyperref[\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothing}]{\sphinxcrossref{\sphinxcode{dycore.horizontal\_smoothing.HorizontalSmoothing}}}} for the available options.

\item {} 
\sphinxstyleliteralstrong{smooth\_moist\_damp\_depth} (\sphinxtitleref{int}, optional) \textendash{} Number of vertical layers in the smoothing damping region for the water constituents. Default is 10.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff\_moist} (\sphinxtitleref{float}, optional) \textendash{} Smoothing coefficient for the water constituents. Default is 0.03.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff\_moist\_max} (\sphinxtitleref{float}, optional) \textendash{} Maximum value for the smoothing coefficient for the water constituents. Default is 0.24.
See {\hyperref[\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothing}]{\sphinxcrossref{\sphinxcode{HorizontalSmoothing}}}} for further details.

\item {} 
\sphinxstyleliteralstrong{physics\_dynamics\_coupling\_on} (\sphinxtitleref{bool}, optional) \textendash{} \sphinxcode{True} to couple physics with dynamics, i.e., to account for the change over time in potential temperature,
\sphinxcode{False} otherwise. Default is \sphinxcode{False}.

\item {} 
\sphinxstyleliteralstrong{sedimentation\_on} (\sphinxtitleref{bool}, optional) \textendash{} \sphinxcode{True} to account for rain sedimentation, \sphinxcode{False} otherwise. Default is \sphinxcode{False}.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_carry\_out\_large\_timestep\_dry() (dycore.dycore\_isentropic.DynamicalCoreIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore_isentropic.DynamicalCoreIsentropic._carry_out_large_timestep_dry}}\pysiglinewithargsret{\sphinxbfcode{\_carry\_out\_large\_timestep\_dry}}{\emph{dt}, \emph{state}, \emph{diagnostics}}{}
Method advancing the dry isentropic state by a single time step.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
air\_pressure (\(z\)-staggered);

\item {} 
montgomery\_potential (unstaggered).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{diagnostics} (\sphinxtitleref{obj}, optional) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing possibly required diagnostics.
By the time being, it is not actually used.

\end{itemize}

\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the state at the next time level.
It contains the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
air\_pressure (\(z\)-staggered);

\item {} 
exner\_function (\(z\)-staggered);

\item {} 
montgomery\_potential (unstaggered);

\item {} 
height (\(z\)-staggered).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_carry\_out\_large\_timestep\_moist() (dycore.dycore\_isentropic.DynamicalCoreIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore_isentropic.DynamicalCoreIsentropic._carry_out_large_timestep_moist}}\pysiglinewithargsret{\sphinxbfcode{\_carry\_out\_large\_timestep\_moist}}{\emph{dt}, \emph{state}, \emph{diagnostics}}{}
Method advancing the moist isentropic state by a single time step.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
air\_pressure (\(z\)-staggered);

\item {} 
montgomery\_potential (unstaggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{diagnostics} (\sphinxtitleref{obj}, optional) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing possibly required diagnostics, namely:
\begin{itemize}
\item {} 
change\_over\_time\_in\_air\_potential\_temperature (unstaggered).

\end{itemize}


\end{itemize}

\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the state at the next time level.
It contains the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
air\_pressure (\(z\)-staggered);

\item {} 
exner\_function (\(z\)-staggered);

\item {} 
montgomery\_potential (unstaggered);

\item {} 
height (\(z\)-staggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered);

\item {} 
air\_density (unstaggered, only if cloud microphysics is switched on);

\item {} 
air\_temperature (unstaggered, only if cloud microphysics is switched on).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_initial\_state() (dycore.dycore\_isentropic.DynamicalCoreIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore_isentropic.DynamicalCoreIsentropic.get_initial_state}}\pysiglinewithargsret{\sphinxbfcode{get\_initial\_state}}{\emph{initial\_time}, \emph{initial\_state\_type}, \emph{**kwargs}}{}
Get the initial state, based on the identifier \sphinxcode{initial\_state\_type}. Particularly:
\begin{itemize}
\item {} 
if \sphinxcode{initial\_state\_type == 0}:
\begin{itemize}
\item {} 
\(u(x, \, y, \, \theta, \, 0) = u_0\) and \(v(x, \, y, \, \theta, \, 0) = v_0\);

\item {} 
the Exner function, the pressure, the Montgomery potential, the height of the isentropes,                             and the isentropic density are derived from the Brunt-Vaisala frequency \(N\);

\item {} 
the mass fraction of water vapor is derived from the relative humidity, which is horizontally uniform                                 and different from zero only in a band close to the surface;

\item {} 
the mass fraction of cloud water and precipitation water is zero;

\end{itemize}

\item {} 
if \sphinxcode{initial\_state\_type == 1}:
\begin{itemize}
\item {} 
\(u(x, \, y, \, \theta, \, 0) = u_0\) and \(v(x, \, y, \, \theta, \, 0) = v_0\);

\item {} 
the Exner function, the pressure, the Montgomery potential, the height of the isentropes,                             and the isentropic density are derived from the Brunt-Vaisala frequency \(N\);

\item {} 
the mass fraction of water vapor is derived from the relative humidity, which is sinusoidal in the                            \(x\)-direction and uniform in the \(y\)-direction, and different from zero only in a band                              close to the surface;

\item {} 
the mass fraction of cloud water and precipitation water is zero.

\end{itemize}

\item {} 
if \sphinxcode{initial\_state\_type == 2}:
\begin{itemize}
\item {} 
\(u(x, \, y, \, \theta, \, 0) = u_0\) and \(v(x, \, y, \, \theta, \, 0) = v_0\);

\item {} 
\(T(x, \, y, \, \theta, \, 0) = T_0\).

\end{itemize}

\end{itemize}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{initial\_time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.datetime} representing the initial simulation time.

\item {} 
\sphinxstyleliteralstrong{case} (\sphinxstyleliteralemphasis{int}) \textendash{} Identifier.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{x\_velocity\_initial} (\sphinxstyleliteralemphasis{float}) \textendash{} The initial, uniform \(x\)-velocity \(u_0\). Default is \(10 m s^{-1}\).

\item {} 
\sphinxstyleliteralstrong{y\_velocity\_initial} (\sphinxstyleliteralemphasis{float}) \textendash{} The initial, uniform \(y\)-velocity \(v_0\). Default is \(0 m s^{-1}\).

\item {} 
\sphinxstyleliteralstrong{brunt\_vaisala\_initial} (\sphinxstyleliteralemphasis{float}) \textendash{} If \sphinxcode{initial\_state\_type == 0}, the uniform Brunt-Vaisala frequence \(N\). Default is \(0.01\).

\item {} 
\sphinxstyleliteralstrong{temperature\_initial} (\sphinxstyleliteralemphasis{float}) \textendash{} If \sphinxcode{initial\_state\_type == 1}, the uniform initial temperature \(T_0\). Default is \(250 K\).

\end{itemize}

\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the initial state.
It contains the following variables:
\begin{itemize}
\item {} 
air\_density (unstaggered);

\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
air\_pressure (\(z\)-staggered);

\item {} 
exner\_function (\(z\)-staggered);

\item {} 
montgomery\_potential (unstaggered);

\item {} 
height (\(z\)-staggered);

\item {} 
air\_temperature (unstaggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{Lateral boundary conditions}
\label{\detokenize{api:lateral-boundary-conditions}}\index{HorizontalBoundary (class in dycore.horizontal\_boundary)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.HorizontalBoundary}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_boundary.}\sphinxbfcode{HorizontalBoundary}}{\emph{grid}, \emph{nb}}{}
Abstract base class whose derived classes implement different types of horizontal boundary conditions.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.nb}]{\sphinxcrossref{\sphinxstyleliteralstrong{nb}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.horizontal\_boundary.HorizontalBoundary method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.HorizontalBoundary.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{nb}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{nb} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.horizontal\_boundary.HorizontalBoundary method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.HorizontalBoundary.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{phi\_new}, \emph{phi\_now}}{}
Apply the boundary conditions on the field \sphinxcode{phi\_new}, possibly relying upon the solution
\sphinxcode{phi\_now} at the current time.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{factory() (dycore.horizontal\_boundary.HorizontalBoundary static method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.HorizontalBoundary.factory}}\pysiglinewithargsret{\sphinxbfcode{static }\sphinxbfcode{factory}}{\emph{horizontal\_boundary\_type}, \emph{grid}, \emph{nb}}{}
Static method which returns an instance of the derived class which implements the boundary
conditions specified by \sphinxcode{horizontal\_boundary\_type}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{horizontal\_boundary\_type} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the type of boundary conditions to apply. Either:
\begin{itemize}
\item {} 
’periodic’, for periodic boundary conditions;

\item {} 
’relaxed’, for relaxed boundary conditions;

\item {} 
’relaxed-symmetric-xz’, for relaxed boundary conditions for a \(xz\)-symmetric field.

\item {} 
’relaxed-symmetric-yz’, for relaxed boundary conditions for a \(yz\)-symmetric field.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{nb} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{itemize}

\item[{Returns}] \leavevmode
An instance of the derived class implementing the boundary conditions specified by
\sphinxcode{horizontal\_boundary\_type}.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{from\_computational\_to\_physical\_domain() (dycore.horizontal\_boundary.HorizontalBoundary method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.HorizontalBoundary.from_computational_to_physical_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_computational\_to\_physical\_domain}}{\emph{phi\_}, \emph{out\_dims}, \emph{change\_sign}}{}
Given a \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the computational domain of a stencil, return the
associated physicalm field which may (or may not) satisfy the horizontal boundary conditions.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the computational domain of a stencil.

\item {} 
\sphinxstyleliteralstrong{out\_dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the output array dimensions.

\item {} 
\sphinxstyleliteralstrong{change\_sign} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the field should change sign through the symmetry plane (if any), \sphinxcode{False} otherwise.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field defined over the physical domain.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{from\_physical\_to\_computational\_domain() (dycore.horizontal\_boundary.HorizontalBoundary method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.HorizontalBoundary.from_physical_to_computational_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_physical\_to\_computational\_domain}}{\emph{phi}}{}
Given a \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing a physical field, return the associated stencils’ computational
domain, i.e., the \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} (accomodating the boundary conditions) which will be input
to the stencils. If the physical and computational fields coincide, a deep copy of the physical
domain is returned.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the physical field.

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The implementation should be designed to work with both staggered and unstaggared fields.
\end{sphinxadmonition}

\end{fulllineitems}

\index{set\_outermost\_layers\_x() (dycore.horizontal\_boundary.HorizontalBoundary method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.HorizontalBoundary.set_outermost_layers_x}}\pysiglinewithargsret{\sphinxbfcode{set\_outermost\_layers\_x}}{\emph{phi\_new}, \emph{phi\_now}}{}
Set the outermost layers of \sphinxcode{phi\_new} in the \(x\)- (i.e., \sphinxcode{i}-) direction so to satisfy
the lateral boundary conditions. For this, possibly rely upon the field \sphinxcode{phi\_now} at the current time.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{set\_outermost\_layers\_y() (dycore.horizontal\_boundary.HorizontalBoundary method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.HorizontalBoundary.set_outermost_layers_y}}\pysiglinewithargsret{\sphinxbfcode{set\_outermost\_layers\_y}}{\emph{phi\_new}, \emph{phi\_now}}{}
Set the outermost layers of \sphinxcode{phi\_new} in the \(y\)- (i.e., \sphinxcode{j}-) direction so to satisfy
the lateral boundary conditions. For this, possibly rely upon the field \sphinxcode{phi\_now} at the current time.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{Periodic (class in dycore.horizontal\_boundary)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.Periodic}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_boundary.}\sphinxbfcode{Periodic}}{\emph{grid}, \emph{nb}}{}
This class inherits {\hyperref[\detokenize{api:dycore.horizontal_boundary.HorizontalBoundary}]{\sphinxcrossref{\sphinxcode{HorizontalBoundary}}}} to implement horizontally periodic boundary conditions.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.nb}]{\sphinxcrossref{\sphinxstyleliteralstrong{nb}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.horizontal\_boundary.Periodic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.Periodic.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{nb}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{nb} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.horizontal\_boundary.Periodic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.Periodic.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{phi\_new}, \emph{phi\_now=None}}{}
Apply horizontally periodic boundary conditions on \sphinxcode{phi\_new}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxtitleref{array\_like}, optional) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The argument \sphinxcode{phi\_now} is not required by the implementation, yet it is retained as optional
argument for compliancy with the class hierarchy interface.
\end{sphinxadmonition}

\end{fulllineitems}

\index{from\_computational\_to\_physical\_domain() (dycore.horizontal\_boundary.Periodic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.Periodic.from_computational_to_physical_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_computational\_to\_physical\_domain}}{\emph{phi\_}, \emph{out\_dims=None}, \emph{change\_sign=True}}{}
Shrink the field \sphinxcode{phi\_} by removing the \sphinxcode{nb} outermost layers.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} The \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} to shrink.

\item {} 
\sphinxstyleliteralstrong{out\_dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the output array dimensions.

\item {} 
\sphinxstyleliteralstrong{change\_sign} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the field should change sign through the symmetry plane (if any), \sphinxcode{False} otherwise.

\end{itemize}

\item[{Returns}] \leavevmode
The shrunk \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}}.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The arguments \sphinxcode{out\_dims} and \sphinxcode{change\_sign} are not required by the implementation,
yet they are retained as optional arguments for compliancy with the class hierarchy interface.
\end{sphinxadmonition}

\end{fulllineitems}

\index{from\_physical\_to\_computational\_domain() (dycore.horizontal\_boundary.Periodic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.Periodic.from_physical_to_computational_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_physical\_to\_computational\_domain}}{\emph{phi}}{}
Periodically extend the field \sphinxcode{phi} with \sphinxcode{nb} extra layers.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} The \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} to extend.

\item[{Returns}] \leavevmode
The extended \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}}.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{set\_outermost\_layers\_x() (dycore.horizontal\_boundary.Periodic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.Periodic.set_outermost_layers_x}}\pysiglinewithargsret{\sphinxbfcode{set\_outermost\_layers\_x}}{\emph{phi\_new}, \emph{phi\_now=None}}{}
Set the outermost layers of \sphinxcode{phi\_new} in the \sphinxcode{x}-direction so to satisfy the periodic
boundary conditions. For this, the field \sphinxcode{phi\_now} at the current time is not required. Yet,
it appears as (default) argument for compliancy with the general API.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxtitleref{array\_like}, optional) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The argument \sphinxcode{phi\_now} is not required by the implementation, yet it is retained as optional
argument for compliancy with the class hierarchy interface.
\end{sphinxadmonition}

\end{fulllineitems}

\index{set\_outermost\_layers\_y() (dycore.horizontal\_boundary.Periodic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.Periodic.set_outermost_layers_y}}\pysiglinewithargsret{\sphinxbfcode{set\_outermost\_layers\_y}}{\emph{phi\_new}, \emph{phi\_now=None}}{}
Set the outermost layers of \sphinxcode{phi\_new} in the \sphinxcode{y}-direction so to satisfy the periodic
boundary conditions. For this, the field \sphinxcode{phi\_now} at the current time is not required. Yet,
it appears as (default) argument for compliancy with the general API.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxtitleref{array\_like}, optional) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The argument \sphinxcode{phi\_now} is not required by the implementation, yet it is retained as optional
argument for compliancy with the class hierarchy interface.
\end{sphinxadmonition}

\end{fulllineitems}


\end{fulllineitems}

\index{PeriodicXZ (class in dycore.horizontal\_boundary)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.PeriodicXZ}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_boundary.}\sphinxbfcode{PeriodicXZ}}{\emph{grid}, \emph{nb}}{}
This class inherits {\hyperref[\detokenize{api:dycore.horizontal_boundary.HorizontalBoundary}]{\sphinxcrossref{\sphinxcode{HorizontalBoundary}}}} to implement horizontally periodic boundary conditions for fields defined
on a computational domain consisting of only one grid point in the \(y\)-direction.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.nb}]{\sphinxcrossref{\sphinxstyleliteralstrong{nb}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.horizontal\_boundary.PeriodicXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.PeriodicXZ.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{nb}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{nb} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.horizontal\_boundary.PeriodicXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.PeriodicXZ.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{phi\_new}, \emph{phi\_now=None}}{}
Apply horizontally periodic boundary conditions on \sphinxcode{phi\_new}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxtitleref{array\_like}, optional) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The argument \sphinxcode{phi\_now} is not required by the implementation, yet it is retained as optional
argument for compliancy with the class hierarchy interface.
\end{sphinxadmonition}

\end{fulllineitems}

\index{from\_computational\_to\_physical\_domain() (dycore.horizontal\_boundary.PeriodicXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.PeriodicXZ.from_computational_to_physical_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_computational\_to\_physical\_domain}}{\emph{phi\_}, \emph{out\_dims=None}, \emph{change\_sign=True}}{}
Return the central \sphinxcode{i-k}-slice of the input field \sphinxcode{phi\_}, removing the \sphinxcode{nb} outermost
layers in \sphinxcode{i}-direction.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} The \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} to shrink.

\item {} 
\sphinxstyleliteralstrong{out\_dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the output array dimensions.

\item {} 
\sphinxstyleliteralstrong{change\_sign} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the field should change sign through the symmetry plane (if any), \sphinxcode{False} otherwise.

\end{itemize}

\item[{Returns}] \leavevmode
The shrunk \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}}.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The arguments \sphinxcode{out\_dims} and \sphinxcode{change\_sign} are not required by the implementation,
yet they are retained as optional arguments for compliancy with the class hierarchy interface.
\end{sphinxadmonition}

\end{fulllineitems}

\index{from\_physical\_to\_computational\_domain() (dycore.horizontal\_boundary.PeriodicXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.PeriodicXZ.from_physical_to_computational_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_physical\_to\_computational\_domain}}{\emph{phi}}{}
Periodically extend the field \sphinxcode{phi} with \sphinxcode{nb} extra layers in the \sphinxcode{j}-direction,
then repeat it \sphinxcode{2 * nb + 1} times along the \sphinxcode{i}-direction.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} The \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} to extend.

\item[{Returns}] \leavevmode
The extended \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}}.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{set\_outermost\_layers\_x() (dycore.horizontal\_boundary.PeriodicXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.PeriodicXZ.set_outermost_layers_x}}\pysiglinewithargsret{\sphinxbfcode{set\_outermost\_layers\_x}}{\emph{phi\_new}, \emph{phi\_now=None}}{}
Set the outermost layers of \sphinxcode{phi\_new} in the \sphinxcode{x}-direction so to satisfy the periodic
boundary conditions. For this, the field \sphinxcode{phi\_now} at the current time is not required. Yet,
it appears as (default) argument for compliancy with the general API.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxtitleref{array\_like}, optional) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The argument \sphinxcode{phi\_now} is not required by the implementation, yet it is retained as optional
argument for compliancy with the class hierarchy interface.
\end{sphinxadmonition}

\end{fulllineitems}


\end{fulllineitems}

\index{PeriodicYZ (class in dycore.horizontal\_boundary)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.PeriodicYZ}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_boundary.}\sphinxbfcode{PeriodicYZ}}{\emph{grid}, \emph{nb}}{}
This class inherits {\hyperref[\detokenize{api:dycore.horizontal_boundary.HorizontalBoundary}]{\sphinxcrossref{\sphinxcode{HorizontalBoundary}}}} to implement horizontally periodic boundary conditions for fields
defined on a computational domain consisting of only one grid point in the \(x\)-direction.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.nb}]{\sphinxcrossref{\sphinxstyleliteralstrong{nb}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.horizontal\_boundary.PeriodicYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.PeriodicYZ.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{nb}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{nb} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.horizontal\_boundary.PeriodicYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.PeriodicYZ.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{phi\_new}, \emph{phi\_now=None}}{}
Apply horizontally periodic boundary conditions on \sphinxcode{phi\_new}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxtitleref{array\_like}, optional) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The argument \sphinxcode{phi\_now} is not required by the implementation, yet it is retained as optional
argument for compliancy with the class hierarchy interface.
\end{sphinxadmonition}

\end{fulllineitems}

\index{from\_computational\_to\_physical\_domain() (dycore.horizontal\_boundary.PeriodicYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.PeriodicYZ.from_computational_to_physical_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_computational\_to\_physical\_domain}}{\emph{phi\_}, \emph{out\_dims=None}, \emph{change\_sign=True}}{}
Return the central \sphinxcode{j-k}-slice of the input field \sphinxcode{phi\_}, removing the \sphinxcode{nb} outermost
layers in \sphinxcode{j}-direction.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} The \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} to shrink.

\item {} 
\sphinxstyleliteralstrong{out\_dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the output array dimensions.

\item {} 
\sphinxstyleliteralstrong{change\_sign} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the field should change sign through the symmetry plane (if any), \sphinxcode{False} otherwise.

\end{itemize}

\item[{Returns}] \leavevmode
The shrunk \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}}.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The arguments \sphinxcode{out\_dims} and \sphinxcode{change\_sign} are not required by the implementation,
yet they are retained as optional arguments for compliancy with the class hierarchy interface.
\end{sphinxadmonition}

\end{fulllineitems}

\index{from\_physical\_to\_computational\_domain() (dycore.horizontal\_boundary.PeriodicYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.PeriodicYZ.from_physical_to_computational_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_physical\_to\_computational\_domain}}{\emph{phi}}{}
Periodically extend the field \sphinxcode{phi} with \sphinxcode{nb} extra layers in the \sphinxcode{j}-direction,
then repeat it \sphinxcode{2 * nb + 1} times along the \sphinxcode{i}-direction.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} The \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} to extend.

\item[{Returns}] \leavevmode
The extended \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}}.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{set\_outermost\_layers\_y() (dycore.horizontal\_boundary.PeriodicYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.PeriodicYZ.set_outermost_layers_y}}\pysiglinewithargsret{\sphinxbfcode{set\_outermost\_layers\_y}}{\emph{phi\_new}, \emph{phi\_now=None}}{}
Set the outermost layers of \sphinxcode{phi\_new} in the \sphinxcode{y}-direction so to satisfy the periodic
boundary conditions. For this, the field \sphinxcode{phi\_now} at the current time is not required. Yet,
it appears as (default) argument for compliancy with the general API.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxtitleref{array\_like}, optional) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The argument \sphinxcode{phi\_now} is not required by the implementation, yet it is retained as optional
argument for compliancy with the class hierarchy interface.
\end{sphinxadmonition}

\end{fulllineitems}


\end{fulllineitems}

\index{Relaxed (class in dycore.horizontal\_boundary)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.Relaxed}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_boundary.}\sphinxbfcode{Relaxed}}{\emph{grid}, \emph{nb}}{}
This class inherits {\hyperref[\detokenize{api:dycore.horizontal_boundary.HorizontalBoundary}]{\sphinxcrossref{\sphinxcode{HorizontalBoundary}}}} to implement horizontally relaxed boundary conditions.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.nb}]{\sphinxcrossref{\sphinxstyleliteralstrong{nb}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\item {} 
\sphinxstyleliteralstrong{nr} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of layers which will be affected by relaxation.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.horizontal\_boundary.Relaxed method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.Relaxed.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{nb}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{nb} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.horizontal\_boundary.Relaxed method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.Relaxed.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{phi\_new}, \emph{phi\_now}}{}
Apply relaxed lateral boundary conditions.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The Dirichlet conditions at the boundaries are assumed to be time-independent, so that they
can be inferred from the solution at current time.
\end{sphinxadmonition}

\end{fulllineitems}

\index{from\_computational\_to\_physical\_domain() (dycore.horizontal\_boundary.Relaxed method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.Relaxed.from_computational_to_physical_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_computational\_to\_physical\_domain}}{\emph{phi\_}, \emph{out\_dims=None}, \emph{change\_sign=True}}{}
As no extension is required to apply relaxed boundary conditions, return a deep copy of the
input field \sphinxcode{phi\_}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} A \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}}.

\item {} 
\sphinxstyleliteralstrong{out\_dims} (\sphinxtitleref{tuple}, optional) \textendash{} Tuple of the output array dimensions.

\item {} 
\sphinxstyleliteralstrong{change\_sign} (\sphinxtitleref{bool}, optional) \textendash{} \sphinxcode{True} if the field should change sign through the symmetry plane, \sphinxcode{False} otherwise.

\end{itemize}

\item[{Returns}] \leavevmode
A deep copy of \sphinxcode{phi\_}.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The arguments \sphinxcode{out\_dims} and \sphinxcode{change\_sign} are not required by the implementation,
yet they are retained as optional arguments for compliancy with the class hierarchy interface.
\end{sphinxadmonition}

\end{fulllineitems}

\index{from\_physical\_to\_computational\_domain() (dycore.horizontal\_boundary.Relaxed method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.Relaxed.from_physical_to_computational_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_physical\_to\_computational\_domain}}{\emph{phi}}{}
As no extension is required to apply relaxed boundary conditions, return a deep copy of the
input field \sphinxcode{phi}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} A \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}}.

\item[{Returns}] \leavevmode
A deep copy of \sphinxcode{phi}.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{set\_outermost\_layers\_x() (dycore.horizontal\_boundary.Relaxed method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.Relaxed.set_outermost_layers_x}}\pysiglinewithargsret{\sphinxbfcode{set\_outermost\_layers\_x}}{\emph{phi\_new}, \emph{phi\_now}}{}
Set the outermost layers of \sphinxcode{phi\_new} in the \sphinxcode{x}-direction equal to the corresponding
layers of \sphinxcode{phi\_now}. In other words, apply Dirichlet conditions in \sphinxcode{x}-direction.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The Dirichlet conditions at the boundaries are assumed to be time-independent, so that they
can be inferred from the solution at current time.
\end{sphinxadmonition}

\end{fulllineitems}

\index{set\_outermost\_layers\_y() (dycore.horizontal\_boundary.Relaxed method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.Relaxed.set_outermost_layers_y}}\pysiglinewithargsret{\sphinxbfcode{set\_outermost\_layers\_y}}{\emph{phi\_new}, \emph{phi\_now}}{}
Set the outermost layers of \sphinxcode{phi\_new} in the \sphinxcode{y}-direction equal to the corresponding
layers of \sphinxcode{phi\_now}. In other words, apply Dirichelt conditions in \sphinxcode{y}-direction.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The Dirichlet conditions at the boundaries are assumed to be time-independent, so that they
can be inferred from the solution at current time.
\end{sphinxadmonition}

\end{fulllineitems}


\end{fulllineitems}

\index{RelaxedSymmetricXZ (class in dycore.horizontal\_boundary)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.RelaxedSymmetricXZ}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_boundary.}\sphinxbfcode{RelaxedSymmetricXZ}}{\emph{grid}, \emph{nb}}{}
This class inherits {\hyperref[\detokenize{api:dycore.horizontal_boundary.Relaxed}]{\sphinxcrossref{\sphinxcode{Relaxed}}}} to implement horizontally relaxed boundary conditions
for fields symmetric with respect to the \(xz\)-plane \(y = y_c = 0.5 (a_y + b_y)\),
where \(a_y\) and \(b_y\) denote the extremes of the domain in the \(y\)-direction.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.nb}]{\sphinxcrossref{\sphinxstyleliteralstrong{nb}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\item {} 
\sphinxstyleliteralstrong{nr} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of layers which will be affected by relaxation.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.horizontal\_boundary.RelaxedSymmetricXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.RelaxedSymmetricXZ.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{nb}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{nb} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{from\_computational\_to\_physical\_domain() (dycore.horizontal\_boundary.RelaxedSymmetricXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.RelaxedSymmetricXZ.from_computational_to_physical_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_computational\_to\_physical\_domain}}{\emph{phi\_}, \emph{out\_dims}, \emph{change\_sign=False}}{}
Mirror the computational domain with respect to the \(xz\)-plane \(y = y_c\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the computational domain of a stencil.

\item {} 
\sphinxstyleliteralstrong{out\_dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the output array dimensions.

\item {} 
\sphinxstyleliteralstrong{change\_sign} (\sphinxtitleref{bool}, optional) \textendash{} \sphinxcode{True} if the field should change sign through the symmetry plane, \sphinxcode{False} otherwise.
Default is false.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field defined over the physical domain.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{from\_physical\_to\_computational\_domain() (dycore.horizontal\_boundary.RelaxedSymmetricXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.RelaxedSymmetricXZ.from_physical_to_computational_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_physical\_to\_computational\_domain}}{\emph{phi}}{}
Return the \(y\)-lowermost half of the domain. To accomodate symmetric conditions,
we retain (at least) \sphinxcode{nb} additional layers in the positive direction of the \(y\)-axis.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the physical field.

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{RelaxedSymmetricYZ (class in dycore.horizontal\_boundary)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.RelaxedSymmetricYZ}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_boundary.}\sphinxbfcode{RelaxedSymmetricYZ}}{\emph{grid}, \emph{nb}}{}
This class inherits {\hyperref[\detokenize{api:dycore.horizontal_boundary.Relaxed}]{\sphinxcrossref{\sphinxcode{Relaxed}}}} to implement horizontally relaxed boundary conditions
for fields symmetric with respect to the \(yz\)-plane \(x = x_c = 0.5 (a_x + b_x)\),
where \(a_x\) and \(b_x\) denote the extremes of the domain in the \(x\)-direction.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.nb}]{\sphinxcrossref{\sphinxstyleliteralstrong{nb}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\item {} 
\sphinxstyleliteralstrong{nr} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of layers which will be affected by relaxation.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.horizontal\_boundary.RelaxedSymmetricYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.RelaxedSymmetricYZ.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{nb}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{nb} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{from\_computational\_to\_physical\_domain() (dycore.horizontal\_boundary.RelaxedSymmetricYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.RelaxedSymmetricYZ.from_computational_to_physical_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_computational\_to\_physical\_domain}}{\emph{phi\_}, \emph{out\_dims}, \emph{change\_sign=False}}{}
Mirror the computational domain with respect to the \(yz\)-axis \(x = x_c\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the computational domain of a stencil.

\item {} 
\sphinxstyleliteralstrong{out\_dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the output array dimensions.

\item {} 
\sphinxstyleliteralstrong{change\_sign} (\sphinxtitleref{bool}, optional) \textendash{} \sphinxcode{True} if the field should change sign through the symmetry plane, \sphinxcode{False} otherwise.
Default is false.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field defined over the physical domain.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{from\_physical\_to\_computational\_domain() (dycore.horizontal\_boundary.RelaxedSymmetricYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.RelaxedSymmetricYZ.from_physical_to_computational_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_physical\_to\_computational\_domain}}{\emph{phi}}{}
Return the \(x\)-lowermost half of the domain. To accomodate symmetric conditions,
we retain (at least) \sphinxcode{nb} additional layers in the positive direction of the \(x\)-axis.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the physical field.

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{Horizontal smoothing}
\label{\detokenize{api:horizontal-smoothing}}\index{HorizontalSmoothing (class in dycore.horizontal\_smoothing)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothing}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_smoothing.}\sphinxbfcode{HorizontalSmoothing}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth}, \emph{smooth\_coeff}, \emph{smooth\_coeff\_max}, \emph{backend}}{}
Abstract base class whose derived classes apply horizontal numerical smoothing to a generic (prognostic)
field by means of a GT4Py’s stencil.
\index{\_\_init\_\_() (dycore.horizontal\_smoothing.HorizontalSmoothing method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothing.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth}, \emph{smooth\_coeff}, \emph{smooth\_coeff\_max}, \emph{backend}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the dimension of the arrays on which to apply numerical smoothing.

\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{smooth\_damp\_depth} (\sphinxstyleliteralemphasis{int}) \textendash{} Depth of the damping region, i.e., number of vertical layers in the damping region.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff} (\sphinxstyleliteralemphasis{float}) \textendash{} Value for the smoothing coefficient far from the top boundary.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff\_max} (\sphinxstyleliteralemphasis{float}) \textendash{} Maximum value for the smoothing coefficient.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py’s stencil implementing numerical smoothing.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.horizontal\_smoothing.HorizontalSmoothing method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothing.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{phi}}{}
Apply horizontal smoothing to a prognostic field.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to filter.

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the filtered field.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{factory() (dycore.horizontal\_smoothing.HorizontalSmoothing static method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothing.factory}}\pysiglinewithargsret{\sphinxbfcode{static }\sphinxbfcode{factory}}{\emph{smooth\_type}, \emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth}, \emph{smooth\_coeff}, \emph{smooth\_coeff\_max}, \emph{backend}}{}
Static method returning an instance of the derived class implementing the smoothing technique
specified by \sphinxcode{smooth\_type}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{smooth\_type} (\sphinxstyleliteralemphasis{string}) \textendash{} 
String specifying the smoothing technique to implement. Either:
\begin{itemize}
\item {} 
’first\_order’, for first-order numerical smoothing;

\item {} 
’second\_order’, for second-order numerical smoothing.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the dimension of the arrays on which to apply numerical smoothing.

\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{smooth\_damp\_depth} (\sphinxstyleliteralemphasis{int}) \textendash{} Depth of the damping region, i.e., number of vertical layers in the damping region.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff} (\sphinxstyleliteralemphasis{float}) \textendash{} Value for the smoothing coefficient far from the top boundary.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff\_max} (\sphinxstyleliteralemphasis{float}) \textendash{} Maximum value for the smoothing coefficient.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py’s stencil implementing numerical
smoothing. Default is \sphinxcode{gridtools.mode.NUMPY}.

\end{itemize}

\item[{Returns}] \leavevmode
Instance of the suitable derived class.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{HorizontalSmoothingFirstOrderXYZ (class in dycore.horizontal\_smoothing)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXYZ}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_smoothing.}\sphinxbfcode{HorizontalSmoothingFirstOrderXYZ}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.24}, \emph{backend=\textless{}Mode.NUMPY: 4\textgreater{}}}{}
This class inherits {\hyperref[\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothing}]{\sphinxcrossref{\sphinxcode{HorizontalSmoothing}}}} to apply first-order numerical smoothing to
three-dimensional fields with at least three elements in each direction.

\begin{sphinxadmonition}{note}{Note:}
An instance of this class should only be applied to fields whose dimensions match those specified at instantiation time.
Hence, one should use (at least) one instance per field shape.
\end{sphinxadmonition}
\index{\_\_init\_\_() (dycore.horizontal\_smoothing.HorizontalSmoothingFirstOrderXYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXYZ.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.24}, \emph{backend=\textless{}Mode.NUMPY: 4\textgreater{}}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the dimension of the arrays on which to apply numerical smoothing.

\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{smooth\_damp\_depth} (\sphinxtitleref{int}, optional) \textendash{} Depth of the damping region, i.e., number of vertical layers in the damping region. Default is 10.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff} (\sphinxtitleref{float}, optional) \textendash{} Value for the smoothing coefficient far from the top boundary. Default is 0.03.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff\_max} (\sphinxtitleref{float}, optional) \textendash{} Maximum value for the smoothing coefficient. For the sake of numerical stability, it should not
exceed 0.25. Default is 0.24.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py’s stencil implementing numerical
smoothing. Default is \sphinxcode{gridtools.mode.NUMPY}.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
To instantiate the class, please prefer the static method \sphinxcode{factor()}
of {\hyperref[\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothing}]{\sphinxcrossref{\sphinxcode{HorizontalSmoothing}}}}.
\end{sphinxadmonition}

\end{fulllineitems}

\index{\_stencil\_defs() (dycore.horizontal\_smoothing.HorizontalSmoothingFirstOrderXYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXYZ._stencil_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_defs}}{\emph{in\_phi}, \emph{gamma}}{}
The GT4Py’s stencil applying first-order horizontal smoothing. A centered 5-points formula is used.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the input field to filter.

\item {} 
\sphinxstyleliteralstrong{gamma} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the smoothing coefficient.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the filtered output field.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_initialize() (dycore.horizontal\_smoothing.HorizontalSmoothingFirstOrderXYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXYZ._stencil_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_initialize}}{\emph{phi}}{}
Initialize the GT4Py’s stencil applying horizontal smoothing.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to filter.

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.horizontal\_smoothing.HorizontalSmoothingFirstOrderXYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXYZ.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{phi}}{}
Apply first-order horizontal smoothing to a prognostic field.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to filter.

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the filtered field.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{HorizontalSmoothingFirstOrderXZ (class in dycore.horizontal\_smoothing)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXZ}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_smoothing.}\sphinxbfcode{HorizontalSmoothingFirstOrderXZ}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.49}, \emph{backend=\textless{}Mode.NUMPY: 4\textgreater{}}}{}
This class inherits {\hyperref[\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothing}]{\sphinxcrossref{\sphinxcode{HorizontalSmoothing}}}} to apply first-order numerical smoothing to
three-dimensional fields with only one element in the \(y\)-direction.

\begin{sphinxadmonition}{note}{Note:}
An instance of this class should only be applied to fields whose dimensions match those specified at instantiation time.
Hence, one should use (at least) one instance per field shape.
\end{sphinxadmonition}
\index{\_\_init\_\_() (dycore.horizontal\_smoothing.HorizontalSmoothingFirstOrderXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXZ.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.49}, \emph{backend=\textless{}Mode.NUMPY: 4\textgreater{}}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the dimension of the arrays on which to apply numerical smoothing.

\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{smooth\_damp\_depth} (\sphinxtitleref{int}, optional) \textendash{} Depth of the damping region, i.e., number of vertical layers in the damping region. Default is 10.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff} (\sphinxtitleref{float}, optional) \textendash{} Value for the smoothing coefficient far from the top boundary. Default is 0.03.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff\_max} (\sphinxtitleref{float}, optional) \textendash{} Maximum value for the smoothing coefficient. For the sake of numerical stability, it should not
exceed 0.5. Default is 0.49.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py’s stencil implementing numerical
smoothing. Default is \sphinxcode{gridtools.mode.NUMPY}.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_defs() (dycore.horizontal\_smoothing.HorizontalSmoothingFirstOrderXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXZ._stencil_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_defs}}{\emph{in\_phi}, \emph{gamma}}{}
The GT4Py’s stencil applying horizontal smoothing. A standard centered 3-points formula is used.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the input field to filter.

\item {} 
\sphinxstyleliteralstrong{gamma} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the smoothing coefficient.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the filtered output field.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_initialize() (dycore.horizontal\_smoothing.HorizontalSmoothingFirstOrderXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXZ._stencil_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_initialize}}{\emph{phi}}{}
Initialize the GT4Py’s stencil applying horizontal smoothing.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to filter.

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.horizontal\_smoothing.HorizontalSmoothingFirstOrderXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXZ.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{phi}}{}
Apply first-order horizontal smoothing to a prognostic field.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to filter.

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the filtered field.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{HorizontalSmoothingFirstOrderYZ (class in dycore.horizontal\_smoothing)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderYZ}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_smoothing.}\sphinxbfcode{HorizontalSmoothingFirstOrderYZ}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.49}, \emph{backend=\textless{}Mode.NUMPY: 4\textgreater{}}}{}
This class inherits {\hyperref[\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothing}]{\sphinxcrossref{\sphinxcode{HorizontalSmoothing}}}} to apply first-order numerical smoothing to
three-dimensional fields with only one element in the \(x\)-direction.

\begin{sphinxadmonition}{note}{Note:}
An instance of this class should only be applied to fields whose dimensions match those specified at instantiation time.
Hence, one should use (at least) one instance per field shape.
\end{sphinxadmonition}
\index{\_\_init\_\_() (dycore.horizontal\_smoothing.HorizontalSmoothingFirstOrderYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderYZ.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.49}, \emph{backend=\textless{}Mode.NUMPY: 4\textgreater{}}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the dimension of the arrays on which to apply numerical smoothing.

\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{smooth\_damp\_depth} (\sphinxstyleliteralemphasis{int}) \textendash{} Depth of the damping region, i.e., number of vertical layers in the damping region. Default is 10.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff} (\sphinxstyleliteralemphasis{float}) \textendash{} Value for the smoothing coefficient far from the top boundary. Default is 0.03.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff\_max} (\sphinxstyleliteralemphasis{float}) \textendash{} Maximum value for the smoothing coefficient. For the sake of numerical stability, it should not
exceed 0.5. Default is 0.49.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py’s stencil implementing numerical
smoothing. Default is \sphinxcode{gridtools.mode.NUMPY}.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_defs() (dycore.horizontal\_smoothing.HorizontalSmoothingFirstOrderYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderYZ._stencil_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_defs}}{\emph{in\_phi}, \emph{gamma}}{}
The GT4Py’s stencil applying horizontal smoothing. A standard centered 3-points formula is used.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the input field to filter.

\item {} 
\sphinxstyleliteralstrong{gamma} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the smoothing coefficient.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the filtered output field.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_initialize() (dycore.horizontal\_smoothing.HorizontalSmoothingFirstOrderYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderYZ._stencil_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_initialize}}{\emph{phi}}{}
Initialize the GT4Py’s stencil applying horizontal smoothing.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to filter.

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.horizontal\_smoothing.HorizontalSmoothingFirstOrderYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderYZ.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{phi}}{}
Apply first-order horizontal smoothing to a prognostic field.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to filter.

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the filtered field.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{HorizontalSmoothingSecondOrderXYZ (class in dycore.horizontal\_smoothing)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXYZ}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_smoothing.}\sphinxbfcode{HorizontalSmoothingSecondOrderXYZ}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.24}, \emph{backend=\textless{}Mode.NUMPY: 4\textgreater{}}}{}
This class inherits {\hyperref[\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothing}]{\sphinxcrossref{\sphinxcode{HorizontalSmoothing}}}} to apply second-order numerical smoothing to
three-dimensional fields.

\begin{sphinxadmonition}{note}{Note:}
An instance of this class should only be applied to fields whose dimensions match those specified at instantiation time.
Hence, one should use (at least) one instance per field shape.
\end{sphinxadmonition}
\index{\_\_init\_\_() (dycore.horizontal\_smoothing.HorizontalSmoothingSecondOrderXYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXYZ.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.24}, \emph{backend=\textless{}Mode.NUMPY: 4\textgreater{}}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the dimension of the arrays on which to apply numerical smoothing.

\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{smooth\_damp\_depth} (\sphinxtitleref{int}, optional) \textendash{} Depth of the damping region, i.e., number of vertical layers in the damping region. Default is 10.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff} (\sphinxtitleref{float}, optional) \textendash{} Value for the smoothing coefficient far from the top boundary. Default is 0.03.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff\_max} (\sphinxtitleref{float}, optional) \textendash{} Maximum value for the smoothing coefficient. For the sake of numerical stability, it should not
exceed 0.25. Default is 0.24.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py’s stencil implementing numerical
smoothing. Default is \sphinxcode{gridtools.mode.NUMPY}.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_defs() (dycore.horizontal\_smoothing.HorizontalSmoothingSecondOrderXYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXYZ._stencil_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_defs}}{\emph{in\_phi}, \emph{gamma}}{}
The GT4Py’s stencil applying horizontal smoothing. A standard centered 5-points formula is used.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the input field to filter.

\item {} 
\sphinxstyleliteralstrong{gamma} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the smoothing coefficient.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the filtered output field.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_initialize() (dycore.horizontal\_smoothing.HorizontalSmoothingSecondOrderXYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXYZ._stencil_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_initialize}}{\emph{phi}}{}
Initialize the GT4Py’s stencil applying horizontal smoothing.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to filter.

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.horizontal\_smoothing.HorizontalSmoothingSecondOrderXYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXYZ.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{phi}}{}
Apply second-order horizontal smoothing to a prognostic field.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to filter.

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the filtered field.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{HorizontalSmoothingSecondOrderXZ (class in dycore.horizontal\_smoothing)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXZ}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_smoothing.}\sphinxbfcode{HorizontalSmoothingSecondOrderXZ}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.49}, \emph{backend=\textless{}Mode.NUMPY: 4\textgreater{}}}{}
This class inherits {\hyperref[\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothing}]{\sphinxcrossref{\sphinxcode{HorizontalSmoothing}}}} to apply second-order numerical smoothing to
three-dimensional fields with only one element in the \(y\)-direction.

\begin{sphinxadmonition}{note}{Note:}
An instance of this class should only be applied to fields whose dimensions match those specified at instantiation time.
Hence, one should use (at least) one instance per field shape.
\end{sphinxadmonition}
\index{\_\_init\_\_() (dycore.horizontal\_smoothing.HorizontalSmoothingSecondOrderXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXZ.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.49}, \emph{backend=\textless{}Mode.NUMPY: 4\textgreater{}}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the dimension of the arrays on which to apply numerical smoothing.

\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{smooth\_damp\_depth} (\sphinxtitleref{int}, optional) \textendash{} Depth of the damping region, i.e., number of vertical layers in the damping region. Default is 10.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff} (\sphinxtitleref{float}, optional) \textendash{} Value for the smoothing coefficient far from the top boundary. Default is 0.03.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff\_max} (\sphinxtitleref{float}, optional) \textendash{} Maximum value for the smoothing coefficient. For the sake of numerical stability, it should not
exceed 0.5. Default is 0.49.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py’s stencil implementing numerical
smoothing. Default is \sphinxcode{gridtools.mode.NUMPY}.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_defs() (dycore.horizontal\_smoothing.HorizontalSmoothingSecondOrderXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXZ._stencil_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_defs}}{\emph{in\_phi}, \emph{gamma}}{}
The GT4Py’s stencil applying horizontal smoothing. A standard centered 5-points formula is used.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the input field to filter.

\item {} 
\sphinxstyleliteralstrong{gamma} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the smoothing coefficient.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the filtered output field.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_initialize() (dycore.horizontal\_smoothing.HorizontalSmoothingSecondOrderXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXZ._stencil_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_initialize}}{\emph{phi}}{}
Initialize the GT4Py’s stencil applying horizontal smoothing.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to filter.

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.horizontal\_smoothing.HorizontalSmoothingSecondOrderXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXZ.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{phi}}{}
Apply second-order horizontal smoothing to a prognostic field.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to filter.

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the filtered field.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{HorizontalSmoothingSecondOrderYZ (class in dycore.horizontal\_smoothing)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderYZ}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_smoothing.}\sphinxbfcode{HorizontalSmoothingSecondOrderYZ}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.49}, \emph{backend=\textless{}Mode.NUMPY: 4\textgreater{}}}{}
This class inherits {\hyperref[\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothing}]{\sphinxcrossref{\sphinxcode{HorizontalSmoothing}}}} to apply second-order numerical smoothing to
three-dimensional fields with only one element in the \(x\)-direction.

\begin{sphinxadmonition}{note}{Note:}
An instance of this class should only be applied to fields whose dimensions match those specified at instantiation time.
Hence, one should use (at least) one instance per field shape.
\end{sphinxadmonition}
\index{\_\_init\_\_() (dycore.horizontal\_smoothing.HorizontalSmoothingSecondOrderYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderYZ.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.49}, \emph{backend=\textless{}Mode.NUMPY: 4\textgreater{}}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the dimension of the arrays on which to apply numerical smoothing.

\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{smooth\_damp\_depth} (\sphinxtitleref{int}, optional) \textendash{} Depth of the damping region, i.e., number of vertical layers in the damping region. Default is 10.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff} (\sphinxtitleref{float}, optional) \textendash{} Value for the smoothing coefficient far from the top boundary. Default is 0.03.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff\_max} (\sphinxtitleref{float}, optional) \textendash{} Maximum value for the smoothing coefficient. For the sake of numerical stability, it should not
exceed 0.5. Default is 0.49.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py’s stencil implementing numerical
smoothing. Default is \sphinxcode{gridtools.mode.NUMPY}.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_defs() (dycore.horizontal\_smoothing.HorizontalSmoothingSecondOrderYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderYZ._stencil_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_defs}}{\emph{in\_phi}, \emph{gamma}}{}
The GT4Py’s stencil applying horizontal smoothing. A standard centered 5-points formula is used.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the input field to filter.

\item {} 
\sphinxstyleliteralstrong{gamma} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the smoothing coefficient.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the filtered output field.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_initialize() (dycore.horizontal\_smoothing.HorizontalSmoothingSecondOrderYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderYZ._stencil_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_initialize}}{\emph{phi}}{}
Initialize the GT4Py’s stencil applying horizontal smoothing.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to filter.

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.horizontal\_smoothing.HorizontalSmoothingSecondOrderYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderYZ.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{phi}}{}
Apply second-order horizontal smoothing to a prognostic field.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to filter.

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the filtered field.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{Numerical fluxes}
\label{\detokenize{api:numerical-fluxes}}\index{FluxIsentropic (class in dycore.flux\_isentropic)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic.FluxIsentropic}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.flux\_isentropic.}\sphinxbfcode{FluxIsentropic}}{\emph{grid}, \emph{moist\_on}}{}
Abstract base class whose derived classes implement different schemes for computing the numerical fluxes for
the three-dimensional isentropic dynamical core. The conservative form of the governing equations is used.
\index{\_\_init\_\_() (dycore.flux\_isentropic.FluxIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic.FluxIsentropic.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{moist\_on}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_compute\_horizontal\_fluxes() (dycore.flux\_isentropic.FluxIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic.FluxIsentropic._compute_horizontal_fluxes}}\pysiglinewithargsret{\sphinxbfcode{\_compute\_horizontal\_fluxes}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{s\_now}, \emph{u\_now}, \emph{v\_now}, \emph{mtg\_now}, \emph{U\_now}, \emph{V\_now}, \emph{Qv\_now}, \emph{Qc\_now}, \emph{Qr\_now}}{}
Method computing the \sphinxcode{gridtools.Equation}s\_now representing the \(x\)- and \(y\)-fluxes for all
the conservative prognostic variables. The :class:{\color{red}\bfseries{}{}`}gridtools.Equation{}`s\_now are then set as instance attributes.
As this method is marked as abstract, the implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{s\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{u\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{v\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{mtg\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential.

\item {} 
\sphinxstyleliteralstrong{U\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{V\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{Qv\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of water vapour.

\item {} 
\sphinxstyleliteralstrong{Qc\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of cloud water.

\item {} 
\sphinxstyleliteralstrong{Qr\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of precipitation water.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_compute\_vertical\_fluxes() (dycore.flux\_isentropic.FluxIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic.FluxIsentropic._compute_vertical_fluxes}}\pysiglinewithargsret{\sphinxbfcode{\_compute\_vertical\_fluxes}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{w}, \emph{s\_now}, \emph{s\_prv}, \emph{U\_now}, \emph{U\_prv}, \emph{V\_now}, \emph{V\_prv}, \emph{Qv\_now}, \emph{Qv\_prv}, \emph{Qc\_now}, \emph{Qc\_prv}, \emph{Qr\_now}, \emph{Qr\_prv}}{}
Method computing the \sphinxcode{gridtools.Equation}s\_now representing the \(z\)-flux for all the conservative
model variables. The :class:{\color{red}\bfseries{}{}`}gridtools.Equation{}`s\_now are then set as instance attributes.
As this method is marked as abstract, the implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{w} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the vertical velocity, i.e., the change over time of potential temperature.

\item {} 
\sphinxstyleliteralstrong{s\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density.

\item {} 
\sphinxstyleliteralstrong{s\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density, i.e., the isentropic density stepped
disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{U\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{U\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(x\)-momentum, i.e., the \(x\)-momentum stepped
disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{V\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{V\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(y\)-momentum, i.e., the \(y\)-momentum stepped
disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{Qv\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{Qv\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of water vapor,
i.e., the isentropic density of water vapor stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{Qc\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of cloud water.

\item {} 
\sphinxstyleliteralstrong{Qc\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of cloud water,
i.e., the isentropic density of cloud water stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{Qr\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of precipitation water.

\item {} 
\sphinxstyleliteralstrong{Qr\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of precipitation water,
i.e., the isentropic density of precipitation water stepped disregarding the vertical advection.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{factory() (dycore.flux\_isentropic.FluxIsentropic static method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic.FluxIsentropic.factory}}\pysiglinewithargsret{\sphinxbfcode{static }\sphinxbfcode{factory}}{\emph{scheme}, \emph{grid}, \emph{moist\_on}}{}
Static method which returns an instance of the derived class implementing the numerical scheme
specified by \sphinxcode{scheme}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{scheme} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the numerical scheme to implement. Either:
\begin{itemize}
\item {} 
’upwind’, for the upwind scheme;

\item {} 
’centered’, for a second-order centered scheme;

\item {} 
’maccormack’, for the MacCormack scheme.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\end{itemize}

\item[{Returns}] \leavevmode
Instance of the derived class implementing the scheme specified by \sphinxcode{scheme}.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_horizontal\_fluxes() (dycore.flux\_isentropic.FluxIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic.FluxIsentropic.get_horizontal_fluxes}}\pysiglinewithargsret{\sphinxbfcode{get\_horizontal\_fluxes}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{s\_now}, \emph{u\_now}, \emph{v\_now}, \emph{mtg\_now}, \emph{U\_now}, \emph{V\_now}, \emph{Qv\_now=None}, \emph{Qc\_now=None}, \emph{Qr\_now=None}}{}
Method returning the \sphinxcode{gridtools.Equation}s\_now representing the \(x\)- and \(y\)-fluxes
for all the conservative model variables.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{s\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{u\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{v\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{mtg\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential.

\item {} 
\sphinxstyleliteralstrong{U\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{V\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{Qv\_now} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of water vapour.

\item {} 
\sphinxstyleliteralstrong{Qc\_now} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of cloud water.

\item {} 
\sphinxstyleliteralstrong{Qr\_now} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{flux\_s\_x} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-flux for the isentropic density.

\item {} 
\sphinxstylestrong{flux\_s\_y} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-flux for the isentropic density.

\item {} 
\sphinxstylestrong{flux\_U\_x} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-flux for the \(x\)-momentum.

\item {} 
\sphinxstylestrong{flux\_U\_y} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-flux for the \(x\)-momentum.

\item {} 
\sphinxstylestrong{flux\_V\_x} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-flux for the \(y\)-momentum.

\item {} 
\sphinxstylestrong{flux\_V\_y} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-flux for the \(y\)-momentum.

\item {} 
\sphinxstylestrong{flux\_Qv\_x} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-flux for the isentropic density of water vapour.

\item {} 
\sphinxstylestrong{flux\_Qv\_y} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-flux for the isentropic density of water vapour.

\item {} 
\sphinxstylestrong{flux\_Qc\_x} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-flux for the isentropic density of cloud water.

\item {} 
\sphinxstylestrong{flux\_Qc\_y} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-flux for the isentropic density of cloud water.

\item {} 
\sphinxstylestrong{flux\_Qr\_x} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-flux for the isentropic density of precipitation water.

\item {} 
\sphinxstylestrong{flux\_Qr\_y} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-flux for the isentropic density of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{get\_vertical\_fluxes() (dycore.flux\_isentropic.FluxIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic.FluxIsentropic.get_vertical_fluxes}}\pysiglinewithargsret{\sphinxbfcode{get\_vertical\_fluxes}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{w}, \emph{s\_now}, \emph{s\_prv}, \emph{U\_now}, \emph{U\_prv}, \emph{V\_now}, \emph{V\_prv}, \emph{Qv\_now=None}, \emph{Qv\_prv=None}, \emph{Qc\_now=None}, \emph{Qc\_prv=None}, \emph{Qr\_now=None}, \emph{Qr\_prv=None}}{}
Method returning the \sphinxcode{gridtools.Equation}s\_now representing the \(z\)-flux for all the conservative
model variables.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{w} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the vertical velocity, i.e., the change over time of potential temperature.

\item {} 
\sphinxstyleliteralstrong{s\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density.

\item {} 
\sphinxstyleliteralstrong{s\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density, i.e., the isentropic density stepped
disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{U\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{U\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(x\)-momentum, i.e., the \(x\)-momentum stepped
disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{V\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{V\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(y\)-momentum, i.e., the \(y\)-momentum stepped
disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{Qv\_now} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{Qv\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of water vapor,
i.e., the isentropic density of water vapor stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{Qc\_now} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of cloud water.

\item {} 
\sphinxstyleliteralstrong{Qc\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of cloud water,
i.e., the isentropic density of cloud water stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{Qr\_now} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of precipitation water.

\item {} 
\sphinxstyleliteralstrong{Qr\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of precipitation water,
i.e., the isentropic density of precipitation water stepped disregarding the vertical advection.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{flux\_s\_z} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(z\)-flux for the isentropic density.

\item {} 
\sphinxstylestrong{flux\_U\_x} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(z\)-flux for the \(x\)-momentum.

\item {} 
\sphinxstylestrong{flux\_V\_x} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(z\)-flux for the \(y\)-momentum.

\item {} 
\sphinxstylestrong{flux\_Qv\_x} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the \(z\)-flux for the isentropic density of water vapour.

\item {} 
\sphinxstylestrong{flux\_Qc\_x} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the \(z\)-flux for the isentropic density of cloud water.

\item {} 
\sphinxstylestrong{flux\_Qr\_x} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the \(z\)-flux for the isentropic density of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{FluxIsentropicUpwind (class in dycore.flux\_isentropic\_upwind)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_upwind.FluxIsentropicUpwind}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.flux\_isentropic\_upwind.}\sphinxbfcode{FluxIsentropicUpwind}}{\emph{grid}, \emph{moist\_on}}{}
Class which inherits {\hyperref[\detokenize{api:dycore.flux_isentropic.FluxIsentropic}]{\sphinxcrossref{\sphinxcode{FluxIsentropic}}}} to implement the upwind scheme to compute
the numerical fluxes for the governing equations expressed in conservative form using isentropic coordinates.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.nb}]{\sphinxcrossref{\sphinxstyleliteralstrong{nb}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.flux\_isentropic\_upwind.FluxIsentropicUpwind method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_upwind.FluxIsentropicUpwind.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{moist\_on}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_compute\_horizontal\_fluxes() (dycore.flux\_isentropic\_upwind.FluxIsentropicUpwind method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_upwind.FluxIsentropicUpwind._compute_horizontal_fluxes}}\pysiglinewithargsret{\sphinxbfcode{\_compute\_horizontal\_fluxes}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{s\_now}, \emph{u\_now}, \emph{v\_now}, \emph{mtg\_now}, \emph{U\_now}, \emph{V\_now}, \emph{Qv\_now}, \emph{Qc\_now}, \emph{Qr\_now}}{}
Method computing the \sphinxcode{gridtools.Equation}s\_now representing the upwind \(x\)- and \(y\)-fluxes for all
the conservative prognostic variables. The :class:{\color{red}\bfseries{}{}`}gridtools.Equation{}`s\_now are then set as instance attributes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{s\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{u\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{v\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{mtg\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential.

\item {} 
\sphinxstyleliteralstrong{U\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{V\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{Qv\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of water vapour.

\item {} 
\sphinxstyleliteralstrong{Qc\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of cloud water.

\item {} 
\sphinxstyleliteralstrong{Qr\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of precipitation water.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_compute\_vertical\_fluxes() (dycore.flux\_isentropic\_upwind.FluxIsentropicUpwind method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_upwind.FluxIsentropicUpwind._compute_vertical_fluxes}}\pysiglinewithargsret{\sphinxbfcode{\_compute\_vertical\_fluxes}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{w}, \emph{s\_now}, \emph{s\_prv}, \emph{U\_now}, \emph{U\_prv}, \emph{V\_now}, \emph{V\_prv}, \emph{Qv\_now}, \emph{Qv\_prv}, \emph{Qc\_now}, \emph{Qc\_prv}, \emph{Qr\_now}, \emph{Qr\_prv}}{}
Method computing the \sphinxcode{gridtools.Equation}s\_now representing the upwind \(z\)-flux for all the conservative
model variables. The :class:{\color{red}\bfseries{}{}`}gridtools.Equation{}`s\_now are then set as instance attributes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{w} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the vertical velocity, i.e., the change over time of potential temperature.

\item {} 
\sphinxstyleliteralstrong{s\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density.

\item {} 
\sphinxstyleliteralstrong{s\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density, i.e., the isentropic density stepped
disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{U\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{U\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(x\)-momentum, i.e., the \(x\)-momentum stepped
disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{V\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{V\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(y\)-momentum, i.e., the \(y\)-momentum stepped
disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{Qv\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{Qv\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of water vapor,
i.e., the isentropic density of water vapor stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{Qc\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of cloud water.

\item {} 
\sphinxstyleliteralstrong{Qc\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of cloud water,
i.e., the isentropic density of cloud water stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{Qr\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of precipitation water.

\item {} 
\sphinxstyleliteralstrong{Qr\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of precipitation water,
i.e., the isentropic density of precipitation water stepped disregarding the vertical advection.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_upwind\_flux\_x() (dycore.flux\_isentropic\_upwind.FluxIsentropicUpwind method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_upwind.FluxIsentropicUpwind._get_upwind_flux_x}}\pysiglinewithargsret{\sphinxbfcode{\_get\_upwind\_flux\_x}}{\emph{i}, \emph{j}, \emph{k}, \emph{u}, \emph{phi}}{}
Get the \sphinxcode{gridtools.Equation} representing the upwind flux in \(x\)-direction for a generic
prognostic variable \(\phi\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{u} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the field \(\phi\).

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the upwind flux in \(x\)-direction for \(\phi\).

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_upwind\_flux\_y() (dycore.flux\_isentropic\_upwind.FluxIsentropicUpwind method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_upwind.FluxIsentropicUpwind._get_upwind_flux_y}}\pysiglinewithargsret{\sphinxbfcode{\_get\_upwind\_flux\_y}}{\emph{i}, \emph{j}, \emph{k}, \emph{v}, \emph{phi}}{}
Get the \sphinxcode{gridtools.Equation} representing the upwind flux in \(y\)-direction for a generic
prognostic variable \(\phi\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{v} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the field \(\phi\).

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the upwind flux in \(y\)-direction for \(\phi\).

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_upwind\_flux\_z() (dycore.flux\_isentropic\_upwind.FluxIsentropicUpwind method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_upwind.FluxIsentropicUpwind._get_upwind_flux_z}}\pysiglinewithargsret{\sphinxbfcode{\_get\_upwind\_flux\_z}}{\emph{i}, \emph{j}, \emph{k}, \emph{w\_mid}, \emph{phi}}{}
Get the \sphinxcode{gridtools.Equation} representing the upwind flux in \(z\)-direction for a generic
prognostic variable \(\phi\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{w\_mid} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the vertical velocity, i.e., the change over time in
potential temperature, at the model half levels.

\item {} 
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the field \(\phi\).

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the upwind flux in \(z\)-direction for \(\phi\).

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{FluxIsentropicCentered (class in dycore.flux\_isentropic\_centered)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_centered.FluxIsentropicCentered}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.flux\_isentropic\_centered.}\sphinxbfcode{FluxIsentropicCentered}}{\emph{grid}, \emph{moist\_on}}{}
Class which inherits {\hyperref[\detokenize{api:dycore.flux_isentropic.FluxIsentropic}]{\sphinxcrossref{\sphinxcode{FluxIsentropic}}}} to implement a centered scheme to compute
the numerical fluxes for the governing equations expressed in conservative form using isentropic coordinates.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.nb}]{\sphinxcrossref{\sphinxstyleliteralstrong{nb}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.flux\_isentropic\_centered.FluxIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_centered.FluxIsentropicCentered.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{moist\_on}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_compute\_horizontal\_fluxes() (dycore.flux\_isentropic\_centered.FluxIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_centered.FluxIsentropicCentered._compute_horizontal_fluxes}}\pysiglinewithargsret{\sphinxbfcode{\_compute\_horizontal\_fluxes}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{s\_now}, \emph{u\_now}, \emph{v\_now}, \emph{mtg\_now}, \emph{U\_now}, \emph{V\_now}, \emph{Qv\_now}, \emph{Qc\_now}, \emph{Qr\_now}}{}
Method computing the \sphinxcode{gridtools.Equation}s\_now representing the centered \(x\)- and \(y\)-fluxes for all
the conservative prognostic variables. The :class:{\color{red}\bfseries{}{}`}gridtools.Equation{}`s\_now are then set as instance attributes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{s\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{u\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{v\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{mtg\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential.

\item {} 
\sphinxstyleliteralstrong{U\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{V\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{Qv\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of water vapour.

\item {} 
\sphinxstyleliteralstrong{Qc\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of cloud water.

\item {} 
\sphinxstyleliteralstrong{Qr\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of precipitation water.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_compute\_vertical\_fluxes() (dycore.flux\_isentropic\_centered.FluxIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_centered.FluxIsentropicCentered._compute_vertical_fluxes}}\pysiglinewithargsret{\sphinxbfcode{\_compute\_vertical\_fluxes}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{w}, \emph{s\_now}, \emph{s\_prv}, \emph{U\_now}, \emph{U\_prv}, \emph{V\_now}, \emph{V\_prv}, \emph{Qv\_now}, \emph{Qv\_prv}, \emph{Qc\_now}, \emph{Qc\_prv}, \emph{Qr\_now}, \emph{Qr\_prv}}{}
Method computing the \sphinxcode{gridtools.Equation}s\_now representing the centered \(z\)-flux for all the conservative
model variables. The :class:{\color{red}\bfseries{}{}`}gridtools.Equation{}`s\_now are then set as instance attributes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{w} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the vertical velocity, i.e., the change over time of potential temperature.

\item {} 
\sphinxstyleliteralstrong{s\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density.

\item {} 
\sphinxstyleliteralstrong{s\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density, i.e., the isentropic density stepped
disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{U\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{U\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(x\)-momentum, i.e., the \(x\)-momentum stepped
disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{V\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{V\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(y\)-momentum, i.e., the \(y\)-momentum stepped
disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{Qv\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{Qv\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of water vapor,
i.e., the isentropic density of water vapor stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{Qc\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of cloud water.

\item {} 
\sphinxstyleliteralstrong{Qc\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of cloud water,
i.e., the isentropic density of cloud water stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{Qr\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of precipitation water.

\item {} 
\sphinxstyleliteralstrong{Qr\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of precipitation water,
i.e., the isentropic density of precipitation water stepped disregarding the vertical advection.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_centered\_flux\_x() (dycore.flux\_isentropic\_centered.FluxIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_centered.FluxIsentropicCentered._get_centered_flux_x}}\pysiglinewithargsret{\sphinxbfcode{\_get\_centered\_flux\_x}}{\emph{i}, \emph{j}, \emph{k}, \emph{u}, \emph{phi}}{}
Get the \sphinxcode{gridtools.Equation} representing the centered flux in \(x\)-direction for a generic
prognostic variable \(\phi\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{u} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the field \(\phi\).

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the centered flux in \(x\)-direction for \(\phi\).

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_centered\_flux\_y() (dycore.flux\_isentropic\_centered.FluxIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_centered.FluxIsentropicCentered._get_centered_flux_y}}\pysiglinewithargsret{\sphinxbfcode{\_get\_centered\_flux\_y}}{\emph{i}, \emph{j}, \emph{k}, \emph{v}, \emph{phi}}{}
Get the \sphinxcode{gridtools.Equation} representing the centered flux in \(y\)-direction for a generic
prognostic variable \(\phi\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{v} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the field \(\phi\).

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the centered flux in \(y\)-direction for \(\phi\).

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_centered\_flux\_z() (dycore.flux\_isentropic\_centered.FluxIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_centered.FluxIsentropicCentered._get_centered_flux_z}}\pysiglinewithargsret{\sphinxbfcode{\_get\_centered\_flux\_z}}{\emph{i}, \emph{j}, \emph{k}, \emph{w\_mid}, \emph{phi\_now}}{}
Get the \sphinxcode{gridtools.Equation} representing the centered flux in \(z\)-direction for a generic
prognostic variable \(\phi\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{w\_mid} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the vertical velocity, i.e., the change over time in
potential temperature, at the model half levels.

\item {} 
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the field \(\phi\).

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the centered flux in \(z\)-direction for \(\phi\).

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{FluxIsentropicMacCormack (class in dycore.flux\_isentropic\_maccormack)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.flux\_isentropic\_maccormack.}\sphinxbfcode{FluxIsentropicMacCormack}}{\emph{grid}, \emph{moist\_on}}{}
Class which inherits {\hyperref[\detokenize{api:dycore.flux_isentropic.FluxIsentropic}]{\sphinxcrossref{\sphinxcode{FluxIsentropic}}}} to implement the MacCormack scheme to compute
the numerical fluxes for the governing equations expressed in conservative form using isentropic coordinates.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.nb}]{\sphinxcrossref{\sphinxstyleliteralstrong{nb}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{moist\_on}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_compute\_horizontal\_fluxes() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._compute_horizontal_fluxes}}\pysiglinewithargsret{\sphinxbfcode{\_compute\_horizontal\_fluxes}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{s\_now}, \emph{u\_now}, \emph{v\_now}, \emph{mtg\_now}, \emph{U\_now}, \emph{V\_now}, \emph{Qv\_now}, \emph{Qc\_now}, \emph{Qr\_now}}{}
Method computing the \sphinxcode{gridtools.Equation}s\_now representing the MacCormack \(x\)- and \(y\)-fluxes for all
the conservative prognostic variables. The :class:{\color{red}\bfseries{}{}`}gridtools.Equation{}`s\_now are then set as instance attributes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{s\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{u\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{v\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{mtg\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential.

\item {} 
\sphinxstyleliteralstrong{U\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{V\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{Qv\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of water vapour.

\item {} 
\sphinxstyleliteralstrong{Qc\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of cloud water.

\item {} 
\sphinxstyleliteralstrong{Qr\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of precipitation water.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_compute\_vertical\_fluxes() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._compute_vertical_fluxes}}\pysiglinewithargsret{\sphinxbfcode{\_compute\_vertical\_fluxes}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{w}, \emph{s\_now}, \emph{s\_prv}, \emph{U\_now}, \emph{U\_prv}, \emph{V\_now}, \emph{V\_prv}, \emph{Qv\_now}, \emph{Qv\_prv}, \emph{Qc\_now}, \emph{Qc\_prv}, \emph{Qr\_now}, \emph{Qr\_prv}}{}
Method computing the \sphinxcode{gridtools.Equation}s\_now representing the MacCormack \(z\)-flux for all the conservative
model variables. The :class:{\color{red}\bfseries{}{}`}gridtools.Equation{}`s\_now are then set as instance attributes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{w} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the vertical velocity, i.e., the change over time of potential temperature.

\item {} 
\sphinxstyleliteralstrong{s\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density.

\item {} 
\sphinxstyleliteralstrong{s\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density, i.e., the isentropic density stepped
disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{U\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{U\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(x\)-momentum, i.e., the \(x\)-momentum stepped
disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{V\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{V\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(y\)-momentum, i.e., the \(y\)-momentum stepped
disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{Qv\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{Qv\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of water vapor,
i.e., the isentropic density of water vapor stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{Qc\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of cloud water.

\item {} 
\sphinxstyleliteralstrong{Qc\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of cloud water,
i.e., the isentropic density of cloud water stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{Qr\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of precipitation water.

\item {} 
\sphinxstyleliteralstrong{Qr\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of precipitation water,
i.e., the isentropic density of precipitation water stepped disregarding the vertical advection.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_maccormack\_flux\_x() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_flux_x}}\pysiglinewithargsret{\sphinxbfcode{\_get\_maccormack\_flux\_x}}{\emph{i}, \emph{j}, \emph{k}, \emph{u\_now\_unstg}, \emph{phi\_now}, \emph{u\_prd\_unstg}, \emph{phi\_prd}}{}
Get the \sphinxcode{gridtools.Equation} representing the MacCormack flux in \(x\)-direction for a
generic prognostic variable \(\phi\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{u\_now\_unstg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the unstaggered \(x\)-velocity at the current time.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the field \(\phi\) at the current time.

\item {} 
\sphinxstyleliteralstrong{u\_prd\_unstg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the predicted value for the unstaggered \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{phi\_prd} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the predicted value for the field \(\phi\).

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the MacCormack flux in \(x\)-direction for \(\phi\).

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_maccormack\_flux\_x\_density() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_flux_x_density}}\pysiglinewithargsret{\sphinxbfcode{\_get\_maccormack\_flux\_x\_density}}{\emph{i}, \emph{j}, \emph{k}, \emph{U\_now}, \emph{U\_prd}}{}
Get the \sphinxcode{gridtools.Equation} representing the MacCormack flux in \(x\)-direction for the
isentropic density.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{U\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-momentum at the current time.

\item {} 
\sphinxstyleliteralstrong{U\_prd} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the predicted value for the \(x\)-momentum.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the MacCormack flux in \(x\)-direction for the isentropic density.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_maccormack\_flux\_y() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_flux_y}}\pysiglinewithargsret{\sphinxbfcode{\_get\_maccormack\_flux\_y}}{\emph{i}, \emph{j}, \emph{k}, \emph{v\_now\_unstg}, \emph{phi\_now}, \emph{v\_prd\_unstg}, \emph{phi\_prd}}{}
Get the \sphinxcode{gridtools.Equation} representing the MacCormack flux in \(y\)-direction for a
generic prognostic variable \(\phi\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{v\_now\_unstg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the unstaggered \(y\)-velocity at the current time.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the field \(\phi\) at the current time.

\item {} 
\sphinxstyleliteralstrong{v\_prd\_unstg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the predicted value for the unstaggered \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{phi\_prd} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the predicted value for the field \(\phi\).

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the MacCormack flux in \(y\)-direction for \(\phi\).

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_maccormack\_flux\_y\_density() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_flux_y_density}}\pysiglinewithargsret{\sphinxbfcode{\_get\_maccormack\_flux\_y\_density}}{\emph{i}, \emph{j}, \emph{k}, \emph{V\_now}, \emph{V\_prd}}{}
Get the \sphinxcode{gridtools.Equation} representing the MacCormack flux in \(y\)-direction for the
isentropic density.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{V\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-momentum at the current time.

\item {} 
\sphinxstyleliteralstrong{V\_prd} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the predicted value for the \(y\)-momentum.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the MacCormack flux in \(y\)-direction for the isentropic density.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_maccormack\_flux\_z() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_flux_z}}\pysiglinewithargsret{\sphinxbfcode{\_get\_maccormack\_flux\_z}}{\emph{i}, \emph{j}, \emph{k}, \emph{w}, \emph{phi\_now}, \emph{phi\_prv}, \emph{phi\_prd}}{}
Get the \sphinxcode{gridtools.Equation} representing the MacCormack flux in \(z\)-direction for a
generic prognostic variable \(\phi\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{w} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the vertical velocity, i.e., the change over time in potential temperature.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the field \(\phi\) at current time.

\item {} 
\sphinxstyleliteralstrong{phi\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional value for \(\phi\), i.e., \(\phi\) stepped disregarding
the vertical advection.

\item {} 
\sphinxstyleliteralstrong{phi\_prd} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the predicted value for the field \(\phi\).

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the MacCormack flux in \(z\)-direction for \(\phi\).

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_maccormack\_horizontal\_predicted\_value\_constituent() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_horizontal_predicted_value_constituent}}\pysiglinewithargsret{\sphinxbfcode{\_get\_maccormack\_horizontal\_predicted\_value\_constituent}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{u\_now\_unstg}, \emph{v\_now\_unstg}, \emph{Q\_now}}{}
Get the \sphinxcode{gridtools.Equation} representing the predicted value for the isentropic density of a generic
water constituent \(Q\), computed without taking the vertical advection into account.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{u\_now\_unstg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the unstaggered \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{v\_now\_unstg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the unstaggered \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{Q\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of a generic water constituent \(Q\).

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the predicted value for \(Q\).

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_maccormack\_horizontal\_predicted\_value\_density() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_horizontal_predicted_value_density}}\pysiglinewithargsret{\sphinxbfcode{\_get\_maccormack\_horizontal\_predicted\_value\_density}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{s\_now}, \emph{U\_now}, \emph{V\_now}}{}
Get the \sphinxcode{gridtools.Equation} representing the predicted value for the isentropic density,
computed without taking the vertical advection into account.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{s\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{U\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{V\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-momentum.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the predicted value for the isentropic density.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_maccormack\_horizontal\_predicted\_value\_momentum\_x() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_horizontal_predicted_value_momentum_x}}\pysiglinewithargsret{\sphinxbfcode{\_get\_maccormack\_horizontal\_predicted\_value\_momentum\_x}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{s\_now}, \emph{u\_now\_unstg}, \emph{v\_now\_unstg}, \emph{mtg\_now}, \emph{U\_now}}{}
Get the \sphinxcode{gridtools.Equation} representing the predicted value for the \(x\)-momentum,
computed without taking the vertical advection into account.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{s\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{u\_now\_unstg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the unstaggered \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{v\_now\_unstg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the unstaggered \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{mtg\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential.

\item {} 
\sphinxstyleliteralstrong{U\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-momentum.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the predicted value for the \(x\)-momentum.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_maccormack\_horizontal\_predicted\_value\_momentum\_y() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_horizontal_predicted_value_momentum_y}}\pysiglinewithargsret{\sphinxbfcode{\_get\_maccormack\_horizontal\_predicted\_value\_momentum\_y}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{s\_now}, \emph{u\_now\_unstg}, \emph{v\_now\_unstg}, \emph{mtg\_now}, \emph{V\_now}}{}
Get the \sphinxcode{gridtools.Equation} representing the predicted value for the \(y\)-momentum,
computed without taking the vertical advection into account.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{s\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{u\_now\_unstg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the unstaggered \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{v\_now\_unstg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the unstaggered \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{mtg\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential.

\item {} 
\sphinxstyleliteralstrong{V\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-momentum.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the predicted value for the \(y\)-momentum.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_maccormack\_vertical\_predicted\_value() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_vertical_predicted_value}}\pysiglinewithargsret{\sphinxbfcode{\_get\_maccormack\_vertical\_predicted\_value}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{w}, \emph{phi\_now}, \emph{phi\_prv}}{}
Get the \sphinxcode{gridtools.Equation} representing the predicted value for a generic conservative prognostic
variable \(\phi\), computed taking only the vertical advection into account.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{w} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the vertical velocity, i.e., the change over time in potential temperature.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the field \(\phi\) at current time.

\item {} 
\sphinxstyleliteralstrong{phi\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional value for \(\phi\), i.e., \(\phi\) stepped
disregarding the vertical advection.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the predicted value for \(\phi\).

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_velocity() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_velocity}}\pysiglinewithargsret{\sphinxbfcode{\_get\_velocity}}{\emph{i}, \emph{j}, \emph{k}, \emph{s}, \emph{mnt}}{}
Get the \sphinxcode{gridtools.Equation} representing an unstaggered velocity component.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{mnt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing either the \(x\)- or the \(y\)-momentum.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the diagnosed unstaggered velocity component.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{Prognostics}
\label{\detokenize{api:prognostics}}\index{PrognosticIsentropic (class in dycore.prognostic\_isentropic)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.prognostic\_isentropic.}\sphinxbfcode{PrognosticIsentropic}}{\emph{flux\_scheme}, \emph{grid}, \emph{moist\_on}, \emph{backend}}{}
Abstract base class whose derived classes implement different schemes to carry out the prognostic steps of
the three-dimensional moist isentropic dynamical core. The conservative form of the governing equations is used.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{ni} (\sphinxstyleliteralemphasis{int}) \textendash{} Extent of the computational domain in the \(x\)-direction.

\item {} 
\sphinxstyleliteralstrong{nj} (\sphinxstyleliteralemphasis{int}) \textendash{} Extent of the computational domain in the \(y\)-direction.

\item {} 
\sphinxstyleliteralstrong{nk} (\sphinxstyleliteralemphasis{int}) \textendash{} Extent of the computational domain in the \(z\)-direction.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.prognostic\_isentropic.PrognosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{flux\_scheme}, \emph{grid}, \emph{moist\_on}, \emph{backend}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{flux\_scheme} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the flux scheme to use. Either:
\begin{itemize}
\item {} 
’upwind’, for the upwind flux;

\item {} 
’centered’, for a second-order centered flux;

\item {} 
’maccormack’, for the MacCormack flux.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py’s stencils.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_allocate\_inputs() (dycore.prognostic\_isentropic.PrognosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic._stencil_stepping_by_coupling_physics_with_dynamics_allocate_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_allocate\_inputs}}{\emph{s}}{}
Allocate the attributes which serve as inputs to the GT4Py’s stencil which step the solution
by coupling physics with dynamics, i.e., accounting for the change over time in potential temperature.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{s} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the isentropic density.

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_allocate\_outputs() (dycore.prognostic\_isentropic.PrognosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic._stencil_stepping_by_coupling_physics_with_dynamics_allocate_outputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_allocate\_outputs}}{\emph{s}}{}
Allocate the Numpy arrays which will store the solution updated by coupling physics with dynamics.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{s} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the the isentropic density.

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_defs() (dycore.prognostic\_isentropic.PrognosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic._stencil_stepping_by_coupling_physics_with_dynamics_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_defs}}{\emph{dt}, \emph{w}, \emph{s\_now}, \emph{s\_prv}, \emph{U\_now}, \emph{U\_prv}, \emph{V\_now}, \emph{V\_prv}, \emph{Qv\_now=None}, \emph{Qv\_prv=None}, \emph{Qc\_now=None}, \emph{Qc\_prv=None}, \emph{Qr\_now=None}, \emph{Qr\_prv=None}}{}
GT4Py’s stencil stepping the solution by coupling physics with dynamics, i.e., by accounting for the
change over time in potential temperature.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{w} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the vertical velocity, i.e., the change over time in potential temperature.

\item {} 
\sphinxstyleliteralstrong{s\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density.

\item {} 
\sphinxstyleliteralstrong{s\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density.

\item {} 
\sphinxstyleliteralstrong{U\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{U\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{V\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{V\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{Qv\_now} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{Qv\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{Qc\_now} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{Qc\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{Qr\_now} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of precipitation water.

\item {} 
\sphinxstyleliteralstrong{Qr\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{s\_new} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the updated isentropic density.

\item {} 
\sphinxstylestrong{U\_new} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the updated \(x\)-momentum.

\item {} 
\sphinxstylestrong{V\_new} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the updated \(y\)-momentum.

\item {} 
\sphinxstylestrong{Qv\_new} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the updated isentropic density of water vapor.

\item {} 
\sphinxstylestrong{Qc\_new} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the updated isentropic density of cloud liquid water.

\item {} 
\sphinxstylestrong{Qr\_new} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the updated isentropic density of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_initialize() (dycore.prognostic\_isentropic.PrognosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic._stencil_stepping_by_coupling_physics_with_dynamics_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_initialize}}{\emph{s}}{}
Initialize the GT4Py’s stencil in charge of stepping the solution by coupling physics with dynamics,
i.e., by accounting for the change over time in potential temperature.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{s} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the isentropic density.

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_set\_inputs() (dycore.prognostic\_isentropic.PrognosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic._stencil_stepping_by_coupling_physics_with_dynamics_set_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_set\_inputs}}{\emph{dt}, \emph{w}, \emph{s\_now}, \emph{s\_prv}, \emph{U\_now}, \emph{U\_prv}, \emph{V\_now}, \emph{V\_prv}, \emph{Qv\_now=None}, \emph{Qv\_prv=None}, \emph{Qc\_now=None}, \emph{Qc\_prv=None}, \emph{Qr\_now=None}, \emph{Qr\_prv=None}}{}
Update the attributes which serve as inputs to the GT4Py’s stencil which steps the solution
by resolving the vertical advection, i.e., by accounting for the change over time in potential temperature.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} A \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{w} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the vertical velocity, i.e., the change over time in potential temperature.

\item {} 
\sphinxstyleliteralstrong{s\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the current isentropic density.

\item {} 
\sphinxstyleliteralstrong{s\_prv} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the provisional isentropic density.

\item {} 
\sphinxstyleliteralstrong{U\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the current \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{U\_prv} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the provisional \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{V\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the current \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{V\_prv} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the provisional \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{Qv\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the current isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{Qv\_prv} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the provisional isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{Qc\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the current isentropic density of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{Qc\_prv} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the provisional isentropic density of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{Qr\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the current isentropic density of precipitation water.

\item {} 
\sphinxstyleliteralstrong{Qr\_prv} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the provisional isentropic density of precipitation water.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_allocate\_inputs() (dycore.prognostic\_isentropic.PrognosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic._stencils_stepping_by_neglecting_vertical_advection_allocate_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_allocate\_inputs}}{\emph{s\_}, \emph{u\_}, \emph{v\_}}{}
Allocate the attributes which serve as inputs to the GT4Py’s stencils which step the solution
disregarding the vertical advection.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{s} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the isentropic density at current time.

\item {} 
\sphinxstyleliteralstrong{u} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the \(x\)-velocity at current time.

\item {} 
\sphinxstyleliteralstrong{v} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the \(y\)-velocity at current time.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_allocate\_outputs() (dycore.prognostic\_isentropic.PrognosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic._stencils_stepping_by_neglecting_vertical_advection_allocate_outputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_allocate\_outputs}}{\emph{s\_}}{}
Allocate the Numpy arrays which will store the solution updated by neglecting the vertical advection.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{s} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the isentropic density.

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_set\_inputs() (dycore.prognostic\_isentropic.PrognosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic._stencils_stepping_by_neglecting_vertical_advection_set_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_set\_inputs}}{\emph{dt}, \emph{s\_}, \emph{u\_}, \emph{v\_}, \emph{mtg\_}, \emph{U\_}, \emph{V\_}, \emph{Qv\_}, \emph{Qc\_}, \emph{Qr\_}}{}
Update the attributes which serve as inputs to the GT4Py’s stencils which step the solution
disregarding the vertical advection.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} A \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{s} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the isentropic density
at current time.

\item {} 
\sphinxstyleliteralstrong{u} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the \(x\)-velocity
at current time.

\item {} 
\sphinxstyleliteralstrong{v} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the \(y\)-velocity
at current time.

\item {} 
\sphinxstyleliteralstrong{p} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the pressure at current time.

\item {} 
\sphinxstyleliteralstrong{mtg} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the Montgomery potential
at current time.

\item {} 
\sphinxstyleliteralstrong{U} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the \(x\)-momentum
at current time.

\item {} 
\sphinxstyleliteralstrong{V} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the \(y\)-momentum
at current time.

\item {} 
\sphinxstyleliteralstrong{Qv} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the isentropic density
of water vapour at current time.

\item {} 
\sphinxstyleliteralstrong{Qc} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the isentropic density
of cloud water at current time.

\item {} 
\sphinxstyleliteralstrong{Qr} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the isentropic density
of precipitation water at current time.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{boundary (dycore.prognostic\_isentropic.PrognosticIsentropic attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.boundary}}\pysigline{\sphinxbfcode{boundary}}
Get the attribute implementing the horizontal boundary conditions.
If this is set to \sphinxcode{None}, a \sphinxcode{ValueError} is thrown.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
Instance of the derived class of {\hyperref[\detokenize{api:dycore.horizontal_boundary.HorizontalBoundary}]{\sphinxcrossref{\sphinxcode{HorizontalBoundary}}}} implementing
the horizontal boundary conditions.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{diagnostic (dycore.prognostic\_isentropic.PrognosticIsentropic attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.diagnostic}}\pysigline{\sphinxbfcode{diagnostic}}
Get the attribute implementing the diagnostic step of the three-dimensional moist isentropic dynamical core.
If this is set to \sphinxcode{None}, a \sphinxcode{ValueError} is thrown.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
{\hyperref[\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic}]{\sphinxcrossref{\sphinxcode{DiagnosticIsentropic}}}} carrying out the diagnostic step of the
three-dimensional moist isentropic dynamical core.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{factory() (dycore.prognostic\_isentropic.PrognosticIsentropic static method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.factory}}\pysiglinewithargsret{\sphinxbfcode{static }\sphinxbfcode{factory}}{\emph{time\_scheme}, \emph{flux\_scheme}, \emph{grid}, \emph{moist\_on}, \emph{backend}}{}
Static method returning an instace of the derived class implementing the time stepping scheme specified
by \sphinxcode{time\_scheme}, using the flux scheme specified by \sphinxcode{flux\_scheme}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{time\_scheme} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the time stepping method to implement. Either:
\begin{itemize}
\item {} 
’forward\_euler’, for the forward Euler scheme;

\item {} 
’centered’, for a centered scheme.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{flux\_scheme} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the scheme to use. Either:
\begin{itemize}
\item {} 
’upwind’, for the upwind flux;

\item {} 
’centered’, for a second-order centered flux;

\item {} 
’maccormack’, for the MacCormack flux.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Mode} specifying the backend for the GT4Py’s stencils.

\end{itemize}

\item[{Returns}] \leavevmode
An instace of the derived class implementing the scheme specified by \sphinxcode{scheme}.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{nb (dycore.prognostic\_isentropic.PrognosticIsentropic attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.nb}}\pysigline{\sphinxbfcode{nb}}
Get the number of boundary layers.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
The number of boundary layers.

\item[{Return type}] \leavevmode
int

\end{description}\end{quote}

\end{fulllineitems}

\index{step\_coupling\_physics\_with\_dynamics() (dycore.prognostic\_isentropic.PrognosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.step_coupling_physics_with_dynamics}}\pysiglinewithargsret{\sphinxbfcode{step\_coupling\_physics\_with\_dynamics}}{\emph{dt}, \emph{state\_now}, \emph{state\_prv}, \emph{state\_old=None}, \emph{diagnostics=None}}{}
Method advancing the conservative, prognostic model variables one time step forward by coupling physics with
dynamics, i.e., by accounting for the change over time in potential temperature.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
water\_vapor\_isentropic\_density (unstaggered, optional);

\item {} 
cloud\_liquid\_water\_isentropic\_density (unstaggered, optional);

\item {} 
precipitation\_water\_isentropic\_density (unstaggered, optional).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{state\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the provisional state, i.e.,
the state stepped taking only the horizontal derivatives into account.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
water\_vapor\_isentropic\_density (unstaggered, optional);

\item {} 
cloud\_liquid\_water\_isentropic\_density (unstaggered, optional);

\item {} 
precipitation\_water\_isentropic\_density (unstaggered, optional).

\end{itemize}

This may be the output of {\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.step_neglecting_vertical_advection}]{\sphinxcrossref{\sphinxcode{step\_neglecting\_vertical\_advection()}}}}.


\item {} 
\sphinxstyleliteralstrong{diagnostics} (\sphinxtitleref{obj}, optional) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} collecting the following variables:
\begin{itemize}
\item {} 
change\_over\_time\_in\_air\_potential\_temperature (unstaggered).

\end{itemize}


\end{itemize}

\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} containing the updated prognostic variables, i.e.,
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
water\_vapor\_isentropic\_density (unstaggered, optional);

\item {} 
cloud\_liquid\_water\_isentropic\_density (unstaggered, optional);

\item {} 
precipitation\_water\_isentropic\_density (unstaggered, optional).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{step\_neglecting\_vertical\_advection() (dycore.prognostic\_isentropic.PrognosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.step_neglecting_vertical_advection}}\pysiglinewithargsret{\sphinxbfcode{step\_neglecting\_vertical\_advection}}{\emph{dt}, \emph{state}, \emph{state\_old=None}, \emph{diagnostics=None}}{}
Method advancing the conservative, prognostic model variables one time step forward.
Only horizontal derivates are considered; possible vertical derivatives are disregarded.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
air\_pressure (\(z\)-staggered);

\item {} 
montgomery\_potential (isentropic);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{state\_old} (\sphinxtitleref{obj}, optional) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the old state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{diagnostics} (\sphinxtitleref{obj}, optional) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} possibly collecting useful diagnostics.

\end{itemize}

\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} containing the updated prognostic variables, i.e.,
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
water\_vapor\_isentropic\_density (unstaggered, optional);

\item {} 
cloud\_liquid\_water\_isentropic\_density (unstaggered, optional);

\item {} 
precipitation\_water\_isentropic\_density (unstaggered, optional).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{PrognosticIsentropicForwardEuler (class in dycore.prognostic\_isentropic\_forward\_euler)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.prognostic\_isentropic\_forward\_euler.}\sphinxbfcode{PrognosticIsentropicForwardEuler}}{\emph{flux\_scheme}, \emph{grid}, \emph{moist\_on}, \emph{backend}}{}
This class inherits {\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic}]{\sphinxcrossref{\sphinxcode{PrognosticIsentropic}}}} to implement
the forward Euler scheme carrying out the prognostic step of the three-dimensional moist isentropic dynamical core.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
{\hyperref[\detokenize{api:parameterizations.adjustment.Adjustment.time_levels}]{\sphinxcrossref{\sphinxstyleliteralstrong{time\_levels}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of time levels the scheme relies on.

\item {} 
\sphinxstyleliteralstrong{steps} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of steps the scheme entails.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.prognostic\_isentropic\_forward\_euler.PrognosticIsentropicForwardEuler method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{flux\_scheme}, \emph{grid}, \emph{moist\_on}, \emph{backend}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{flux\_scheme} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the flux scheme to use. Either:
\begin{itemize}
\item {} 
’upwind’, for the upwind flux;

\item {} 
’centered’, for a second-order centered flux;

\item {} 
’maccormack’, for the MacCormack flux.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT\$Py’s stencils.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
To instantiate an object of this class, one should prefer the static method
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.factory}]{\sphinxcrossref{\sphinxcode{factory()}}}} of
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic}]{\sphinxcrossref{\sphinxcode{PrognosticIsentropic}}}}.
\end{sphinxadmonition}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_defs() (dycore.prognostic\_isentropic\_forward\_euler.PrognosticIsentropicForwardEuler method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler._stencil_stepping_by_coupling_physics_with_dynamics_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_defs}}{\emph{dt}, \emph{s\_now}, \emph{U\_now}, \emph{V\_now}, \emph{s\_prv}, \emph{U\_prv}, \emph{V\_prv}, \emph{Qv\_now=None}, \emph{Qc\_now=None}, \emph{Qr\_now=None}, \emph{Qv\_prv=None}, \emph{Qc\_prv=None}, \emph{Qr\_prv=None}}{}
GT4Py’s stencil stepping the solution by coupling physics with dynamics, i.e., by accounting for the
change over time in potential temperature.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{s\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density.

\item {} 
\sphinxstyleliteralstrong{U\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{V\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{s\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density.

\item {} 
\sphinxstyleliteralstrong{U\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{V\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{Qv\_now} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{Qc\_now} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{Qr\_now} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of precipitation water.

\item {} 
\sphinxstyleliteralstrong{Qv\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{Qc\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{Qr\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{s\_new} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the updated isentropic density.

\item {} 
\sphinxstylestrong{U\_new} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the updated \(x\)-momentum.

\item {} 
\sphinxstylestrong{V\_new} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the updated \(y\)-momentum.

\item {} 
\sphinxstylestrong{Qv\_new} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the updated isentropic density of water vapor.

\item {} 
\sphinxstylestrong{Qc\_new} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the updated isentropic density of cloud liquid water.

\item {} 
\sphinxstylestrong{Qr\_new} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the updated isentropic density of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_neglecting\_vertical\_advection\_first\_defs() (dycore.prognostic\_isentropic\_forward\_euler.PrognosticIsentropicForwardEuler method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler._stencil_stepping_by_neglecting_vertical_advection_first_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_neglecting\_vertical\_advection\_first\_defs}}{\emph{dt}, \emph{in\_s}, \emph{in\_u}, \emph{in\_v}, \emph{in\_mtg}, \emph{in\_U}, \emph{in\_V}, \emph{in\_Qv=None}, \emph{in\_Qc=None}, \emph{in\_Qr=None}}{}
GT4Py’s stencil stepping the isentropic density and the water constituents via the forward Euler scheme.
Further, it computes provisional values for the momentums, i.e., it updates the momentums disregarding
the forcing terms involving the Montgomery potential.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_u} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-velocity at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_v} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-velocity at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_mtg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_U} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-momentum at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_V} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-momentum at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_Qv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the mass of water vapour at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_Qc} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the mass of cloud water at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_Qr} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the mass of precipitation water at the current time.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_s} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped isentropic density.

\item {} 
\sphinxstylestrong{out\_U} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(x\)-momentum.

\item {} 
\sphinxstylestrong{out\_V} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(y\)-momentum.

\item {} 
\sphinxstylestrong{out\_Qv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped mass of water vapour.

\item {} 
\sphinxstylestrong{out\_Qc} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped mass of cloud water.

\item {} 
\sphinxstylestrong{out\_Qr} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped mass of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_neglecting\_vertical\_advection\_second\_defs() (dycore.prognostic\_isentropic\_forward\_euler.PrognosticIsentropicForwardEuler method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler._stencil_stepping_by_neglecting_vertical_advection_second_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_neglecting\_vertical\_advection\_second\_defs}}{\emph{dt}, \emph{in\_s}, \emph{in\_mtg}, \emph{in\_U}, \emph{in\_V}}{}
GT4Py’s stencil stepping the momentums via a one-time-level scheme.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_mtg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential diagnosed from the stepped isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_U} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_V} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(y\)-momentum.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_U} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped \(x\)-momentum.

\item {} 
\sphinxstylestrong{out\_V} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped \(y\)-momentum.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_allocate\_temporaries() (dycore.prognostic\_isentropic\_forward\_euler.PrognosticIsentropicForwardEuler method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler._stencils_stepping_by_neglecting_vertical_advection_allocate_temporaries}}\pysiglinewithargsret{\sphinxbfcode{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_allocate\_temporaries}}{\emph{s\_}}{}
Allocate the Numpy arrays which will store temporary fields.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{s} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the isentropic density
at current time.

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_initialize() (dycore.prognostic\_isentropic\_forward\_euler.PrognosticIsentropicForwardEuler method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler._stencils_stepping_by_neglecting_vertical_advection_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_initialize}}{\emph{s\_}, \emph{u\_}, \emph{v\_}}{}
Initialize the GT4Py’s stencils implementing the forward Euler scheme.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{s} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the isentropic density
at current time.

\item {} 
\sphinxstyleliteralstrong{u} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the \(x\)-velocity
at current time.

\item {} 
\sphinxstyleliteralstrong{v} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the \(y\)-velocity
at current time.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{step\_neglecting\_vertical\_advection() (dycore.prognostic\_isentropic\_forward\_euler.PrognosticIsentropicForwardEuler method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler.step_neglecting_vertical_advection}}\pysiglinewithargsret{\sphinxbfcode{step\_neglecting\_vertical\_advection}}{\emph{dt}, \emph{state}, \emph{state\_old=None}, \emph{diagnostics=None}}{}
Method advancing the conservative, prognostic model variables one time step forward via the forward Euler method.
Only horizontal derivates are considered; possible vertical derivatives are disregarded.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
air\_pressure (\(z\)-staggered);

\item {} 
montgomery\_potential (isentropic);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{state\_old} (\sphinxtitleref{obj}, optional) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the old state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{diagnostics} (\sphinxtitleref{obj}, optional) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} possibly collecting useful diagnostics.

\end{itemize}

\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} containing the updated prognostic variables, i.e.,
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
water\_vapor\_isentropic\_density (unstaggered, optional);

\item {} 
cloud\_liquid\_water\_isentropic\_density (unstaggered, optional);

\item {} 
precipitation\_water\_isentropic\_density (unstaggered, optional).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{PrognosticIsentropicCentered (class in dycore.prognostic\_isentropic\_centered)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.prognostic\_isentropic\_centered.}\sphinxbfcode{PrognosticIsentropicCentered}}{\emph{flux\_scheme}, \emph{grid}, \emph{moist\_on}, \emph{backend}}{}
This class inherits {\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic}]{\sphinxcrossref{\sphinxcode{PrognosticIsentropic}}}} to implement
a centered time-integration scheme to carry out the prognostic step of the three-dimensional
moist isentropic dynamical core.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{ni} (\sphinxstyleliteralemphasis{int}) \textendash{} Extent of the computational domain in the \(x\)-direction.

\item {} 
\sphinxstyleliteralstrong{nj} (\sphinxstyleliteralemphasis{int}) \textendash{} Extent of the computational domain in the \(y\)-direction.

\item {} 
\sphinxstyleliteralstrong{nk} (\sphinxstyleliteralemphasis{int}) \textendash{} Extent of the computational domain in the \(z\)-direction.

\item {} 
{\hyperref[\detokenize{api:parameterizations.adjustment.Adjustment.time_levels}]{\sphinxcrossref{\sphinxstyleliteralstrong{time\_levels}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of time levels the scheme relies on.

\item {} 
\sphinxstyleliteralstrong{steps} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of steps the scheme entails.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.prognostic\_isentropic\_centered.PrognosticIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{flux\_scheme}, \emph{grid}, \emph{moist\_on}, \emph{backend}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{flux\_scheme} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the flux scheme to use. Either:
\begin{itemize}
\item {} 
’upwind’, for the upwind flux;

\item {} 
’centered’, for a second-order centered flux;

\item {} 
’maccormack’, for the MacCormack flux.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py’s stencils.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
To instantiate an object of this class, one should prefer the static method
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.factory}]{\sphinxcrossref{\sphinxcode{factory()}}}} of
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic}]{\sphinxcrossref{\sphinxcode{PrognosticIsentropic}}}}.
\end{sphinxadmonition}

\end{fulllineitems}

\index{\_set\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_inputs() (dycore.prognostic\_isentropic\_centered.PrognosticIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered._set_stencils_stepping_by_neglecting_vertical_advection_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_set\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_inputs}}{\emph{dt}, \emph{s\_}, \emph{u\_}, \emph{v\_}, \emph{mtg\_}, \emph{U\_}, \emph{V\_}, \emph{Qv\_}, \emph{Qc\_}, \emph{Qr\_}, \emph{s\_old\_}, \emph{U\_old\_}, \emph{V\_old\_}, \emph{Qv\_old\_}, \emph{Qc\_old\_}, \emph{Qr\_old\_}}{}
Update the attributes which serve as inputs to the GT4Py’s stencil.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} A \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{s} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the isentropic density
at current time.

\item {} 
\sphinxstyleliteralstrong{u} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the \(x\)-velocity
at current time.

\item {} 
\sphinxstyleliteralstrong{v} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the \(y\)-velocity
at current time.

\item {} 
\sphinxstyleliteralstrong{mtg} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the Montgomery potential
at current time.

\item {} 
\sphinxstyleliteralstrong{U} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the \(x\)-momentum
at current time.

\item {} 
\sphinxstyleliteralstrong{V} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the \(y\)-momentum
at current time.

\item {} 
\sphinxstyleliteralstrong{Qv} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the mass of water vapour
at current time.

\item {} 
\sphinxstyleliteralstrong{Qc} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the mass of cloud water
at current time.

\item {} 
\sphinxstyleliteralstrong{Qr} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the mass of precipitation water
at current time.

\item {} 
\sphinxstyleliteralstrong{s\_old} (\sphinxtitleref{array\_like}, optional) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the isentropic density
at the previous time level.

\item {} 
\sphinxstyleliteralstrong{U\_old} (\sphinxtitleref{array\_like}, optional) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the \(x\)-momentum
at the previous time level.

\item {} 
\sphinxstyleliteralstrong{V\_old} (\sphinxtitleref{array\_like}, optional) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the \(y\)-momentum
at the previous time level.

\item {} 
\sphinxstyleliteralstrong{Qv\_old} (\sphinxtitleref{array\_like}, optional) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the mass of water vapour
at the previous time level.

\item {} 
\sphinxstyleliteralstrong{Qc\_old} (\sphinxtitleref{array\_like}, optional) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the mass of cloud water
at the previous time level.

\item {} 
\sphinxstyleliteralstrong{Qr\_old} (\sphinxtitleref{array\_like}, optional) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the mass of precipitation water
at the previous time level.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_defs() (dycore.prognostic\_isentropic\_centered.PrognosticIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered._stencil_stepping_by_coupling_physics_with_dynamics_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_defs}}{\emph{dt}, \emph{s\_now}, \emph{U\_now}, \emph{V\_now}, \emph{s\_prv}, \emph{U\_prv}, \emph{V\_prv}, \emph{Qv\_now=None}, \emph{Qc\_now=None}, \emph{Qr\_now=None}, \emph{Qv\_prv=None}, \emph{Qc\_prv=None}, \emph{Qr\_prv=None}}{}
GT4Py’s stencil stepping the solution by coupling physics with dynamics, i.e., by accounting for the
change over time in potential temperature.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{s\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density.

\item {} 
\sphinxstyleliteralstrong{U\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{V\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{s\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density.

\item {} 
\sphinxstyleliteralstrong{U\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{V\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{Qv\_now} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{Qc\_now} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{Qr\_now} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of precipitation water.

\item {} 
\sphinxstyleliteralstrong{Qv\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{Qc\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{Qr\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{s\_new} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the updated isentropic density.

\item {} 
\sphinxstylestrong{U\_new} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the updated \(x\)-momentum.

\item {} 
\sphinxstylestrong{V\_new} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the updated \(y\)-momentum.

\item {} 
\sphinxstylestrong{Qv\_new} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the updated isentropic density of water vapor.

\item {} 
\sphinxstylestrong{Qc\_new} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the updated isentropic density of cloud liquid water.

\item {} 
\sphinxstylestrong{Qr\_new} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the updated isentropic density of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_neglecting\_vertical\_advection\_defs() (dycore.prognostic\_isentropic\_centered.PrognosticIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered._stencil_stepping_by_neglecting_vertical_advection_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_neglecting\_vertical\_advection\_defs}}{\emph{dt}, \emph{in\_s}, \emph{in\_u}, \emph{in\_v}, \emph{in\_mtg}, \emph{in\_U}, \emph{in\_V}, \emph{old\_s}, \emph{old\_U}, \emph{old\_V}, \emph{in\_Qv=None}, \emph{in\_Qc=None}, \emph{in\_Qr=None}, \emph{old\_Qv=None}, \emph{old\_Qc=None}, \emph{old\_Qr=None}}{}
GT4Py’s stencil implementing the centered time-integration scheme.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_u} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-velocity at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_v} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-velocity at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_mtg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_U} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-momentum at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_V} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-momentum at the current time.

\item {} 
\sphinxstyleliteralstrong{old\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density at the previous time level.

\item {} 
\sphinxstyleliteralstrong{old\_U} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-momentum at the previous time level.

\item {} 
\sphinxstyleliteralstrong{old\_V} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-momentum at the previous time level.

\item {} 
\sphinxstyleliteralstrong{in\_Qv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the mass of water vapour at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_Qc} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the mass of cloud water at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_Qr} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the mass of precipitation water at the current time.

\item {} 
\sphinxstyleliteralstrong{old\_Qv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the mass of water vapour at the previous time level.

\item {} 
\sphinxstyleliteralstrong{old\_Qc} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the mass of cloud water at the previous time level.

\item {} 
\sphinxstyleliteralstrong{old\_Qr} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the mass of precipitation water at the previous time level.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_s} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped isentropic density.

\item {} 
\sphinxstylestrong{out\_U} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped \(x\)-momentum.

\item {} 
\sphinxstylestrong{out\_V} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped \(y\)-momentum.

\item {} 
\sphinxstylestrong{out\_Qv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped mass of water vapour.

\item {} 
\sphinxstylestrong{out\_Qc} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped mass of cloud water.

\item {} 
\sphinxstylestrong{out\_Qr} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped mass of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_neglecting\_vertical\_advection\_initialize() (dycore.prognostic\_isentropic\_centered.PrognosticIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered._stencil_stepping_by_neglecting_vertical_advection_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_neglecting\_vertical\_advection\_initialize}}{\emph{s\_}, \emph{u\_}, \emph{v\_}}{}
Initialize the GT4Py’s stencil implementing the centered time-integration scheme.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{s} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the isentropic density at current time.

\item {} 
\sphinxstyleliteralstrong{u} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the \(x\)-velocity at current time.

\item {} 
\sphinxstyleliteralstrong{v} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the \(y\)-velocity at current time.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_allocate\_inputs() (dycore.prognostic\_isentropic\_centered.PrognosticIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered._stencils_stepping_by_neglecting_vertical_advection_allocate_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_allocate\_inputs}}{\emph{s\_}, \emph{u\_}, \emph{v\_}}{}
Allocate the attributes which will serve as inputs to the GT4Py’s stencil.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{s} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the isentropic density at current time.

\item {} 
\sphinxstyleliteralstrong{u} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the \(x\)-velocity at current time.

\item {} 
\sphinxstyleliteralstrong{v} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain for the \(y\)-velocity at current time.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{step\_neglecting\_vertical\_advection() (dycore.prognostic\_isentropic\_centered.PrognosticIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered.step_neglecting_vertical_advection}}\pysiglinewithargsret{\sphinxbfcode{step\_neglecting\_vertical\_advection}}{\emph{dt}, \emph{state}, \emph{state\_old=None}, \emph{diagnostics=None}}{}
Method advancing the conservative, prognostic model variables one time step forward via a centered time-integration scheme.
Only horizontal derivates are considered; possible vertical derivatives are disregarded.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
air\_pressure (\(z\)-staggered);

\item {} 
montgomery\_potential (isentropic);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{state\_old} (\sphinxtitleref{obj}, optional) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the old state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{diagnostics} (\sphinxtitleref{obj}, optional) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} possibly collecting useful diagnostics.

\end{itemize}

\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} containing the updated prognostic variables, i.e.,
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
water\_vapor\_isentropic\_density (unstaggered, optional);

\item {} 
cloud\_liquid\_water\_isentropic\_density (unstaggered, optional);

\item {} 
precipitation\_water\_isentropic\_density (unstaggered, optional).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{Wave absorber}
\label{\detokenize{api:wave-absorber}}\index{VerticalDamping (class in dycore.vertical\_damping)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.vertical_damping.VerticalDamping}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.vertical\_damping.}\sphinxbfcode{VerticalDamping}}{\emph{grid}, \emph{damp\_depth}, \emph{damp\_max}, \emph{backend}}{}
Abstract base class whose derived classes implement different vertical damping, i.e., wave absorbing, techniques.
\index{\_\_init\_\_() (dycore.vertical\_damping.VerticalDamping method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.vertical_damping.VerticalDamping.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{damp\_depth}, \emph{damp\_max}, \emph{backend}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{damp\_depth} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical layers in the damping region.

\item {} 
\sphinxstyleliteralstrong{damp\_max} (\sphinxstyleliteralemphasis{float}) \textendash{} Maximum value for the damping coefficient.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py’s stencils implementing the dynamical core.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.vertical\_damping.VerticalDamping method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.vertical_damping.VerticalDamping.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{dt}, \emph{phi\_now}, \emph{phi\_new}, \emph{phi\_ref}}{}
Apply vertical damping to a generic field \(\phi\).
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field \(\phi\) at the current time level.

\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field \(\phi\) at the next time level, on
which the absorber will be applied.

\item {} 
\sphinxstyleliteralstrong{phi\_ref} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing a reference value for \(\phi\).

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the damped field \(\phi\).

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{factory() (dycore.vertical\_damping.VerticalDamping static method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.vertical_damping.VerticalDamping.factory}}\pysiglinewithargsret{\sphinxbfcode{static }\sphinxbfcode{factory}}{\emph{damp\_type}, \emph{grid}, \emph{damp\_depth}, \emph{damp\_max}, \emph{backend}}{}
Static method which returns an instance of the derived class implementing the damping method
specified by \sphinxcode{damp\_type}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{damp\_type} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the damper to implement. Either:
\begin{itemize}
\item {} 
’rayleigh’, for a Rayleigh damper.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{damp\_depth} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical layers in the damping region. Default is 15.

\item {} 
\sphinxstyleliteralstrong{damp\_max} (\sphinxstyleliteralemphasis{float}) \textendash{} Maximum value for the damping coefficient. Default is 0.0002.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py’s stencils implementing the dynamical core.

\end{itemize}

\item[{Returns}] \leavevmode
An instance of the derived class implementing the damping method specified by \sphinxcode{damp\_type}.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{VerticalDampingRayleigh (class in dycore.vertical\_damping)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.vertical_damping.VerticalDampingRayleigh}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.vertical\_damping.}\sphinxbfcode{VerticalDampingRayleigh}}{\emph{grid}, \emph{damp\_depth}, \emph{damp\_max}, \emph{backend}}{}
This class inherits {\hyperref[\detokenize{api:dycore.vertical_damping.VerticalDamping}]{\sphinxcrossref{\sphinxcode{VerticalDamping}}}} to implement a Rayleigh absorber.
\index{\_\_init\_\_() (dycore.vertical\_damping.VerticalDampingRayleigh method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.vertical_damping.VerticalDampingRayleigh.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{damp\_depth}, \emph{damp\_max}, \emph{backend}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{damp\_depth} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical layers in the damping region.

\item {} 
\sphinxstyleliteralstrong{damp\_max} (\sphinxstyleliteralemphasis{float}) \textendash{} Maximum value for the damping coefficient.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py’s stencils implementing the dynamical core.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_defs() (dycore.vertical\_damping.VerticalDampingRayleigh method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.vertical_damping.VerticalDampingRayleigh._stencil_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_defs}}{\emph{dt}, \emph{phi\_now}, \emph{phi\_new}, \emph{phi\_ref}, \emph{R}}{}
The GT4Py’s stencil applying Rayleigh vertical damping.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{ibj}) \textendash{} \sphinxcode{gridtools.Equation} representing the field \(\phi\) at the current time level.

\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the field \(\phi\) at the next time level, on
which the absorber will be applied.

\item {} 
\sphinxstyleliteralstrong{phi\_ref} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing a reference value for \(\phi\).

\item {} 
\sphinxstyleliteralstrong{R} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the damping coefficient.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the damped field \(\phi\).

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_initialize() (dycore.vertical\_damping.VerticalDampingRayleigh method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.vertical_damping.VerticalDampingRayleigh._stencil_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_initialize}}{\emph{phi\_now}}{}
Initialize the GT4Py’s stencil applying Rayleigh vertical damping.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field \(\phi\) at the current time level.

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_set\_inputs() (dycore.vertical\_damping.VerticalDampingRayleigh method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.vertical_damping.VerticalDampingRayleigh._stencil_set_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_set\_inputs}}{\emph{dt}, \emph{phi\_now}, \emph{phi\_new}, \emph{phi\_ref}}{}
Update the attributes which stores the stencil’s input fields.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field \(\phi\) at the current time level.

\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field \(\phi\) at the next time level, on
which the absorber will be applied.

\item {} 
\sphinxstyleliteralstrong{phi\_ref} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing a reference value for \(\phi\).

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.vertical\_damping.VerticalDampingRayleigh method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.vertical_damping.VerticalDampingRayleigh.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{dt}, \emph{phi\_now}, \emph{phi\_new}, \emph{phi\_ref}}{}
Apply vertical damping to a generic field \(\phi\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field \(\phi\) at the current time level.

\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field \(\phi\) at the next time level, on
which the absorber will be applied.

\item {} 
\sphinxstyleliteralstrong{phi\_ref} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing a reference value for \(\phi\).

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the damped field \(\phi\).

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\section{Grids}
\label{\detokenize{api:grids}}

\subsection{Two-dimensional grids}
\label{\detokenize{api:two-dimensional-grids}}\index{GridXY (class in grids.grid\_xy)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xy.GridXY}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{grids.grid\_xy.}\sphinxbfcode{GridXY}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_y}, \emph{ny}, \emph{units\_x='degrees\_east'}, \emph{dims\_x='longitude'}, \emph{units\_y='degrees\_north'}, \emph{dims\_y='latitude'}}{}
Rectangular and regular two-dimensional grid embedded in a reference system whose coordinates are,
in the order, \(x\) and \(y\). No assumption is made on the nature of the coordinates. For
instance, \(x\) may be the longitude, in which case \(x \equiv \lambda\), and \(y\) may
be the latitude, in which case \(y \equiv \phi\).
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.x}]{\sphinxcrossref{\sphinxstyleliteralstrong{x}}}} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(x\) main levels.

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.x_half_levels}]{\sphinxcrossref{\sphinxstyleliteralstrong{x\_half\_levels}}}} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(x\) half levels.

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.nx}]{\sphinxcrossref{\sphinxstyleliteralstrong{nx}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points along \(x\).

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.dx}]{\sphinxcrossref{\sphinxstyleliteralstrong{dx}}}} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(x\)-spacing.

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.y}]{\sphinxcrossref{\sphinxstyleliteralstrong{y}}}} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(y\) main levels.

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.y_half_levels}]{\sphinxcrossref{\sphinxstyleliteralstrong{y\_half\_levels}}}} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(y\) half levels.

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.ny}]{\sphinxcrossref{\sphinxstyleliteralstrong{ny}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points along \(y\).

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.dy}]{\sphinxcrossref{\sphinxstyleliteralstrong{dy}}}} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(y\)-spacing.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (grids.grid\_xy.GridXY method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xy.GridXY.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_y}, \emph{ny}, \emph{units\_x='degrees\_east'}, \emph{dims\_x='longitude'}, \emph{units\_y='degrees\_north'}, \emph{dims\_y='latitude'}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{domain\_x} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((x_{start}, ~ x_{stop})\).

\item {} 
\sphinxstyleliteralstrong{nx} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points along \(x\).

\item {} 
\sphinxstyleliteralstrong{domain\_y} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((y_{start}, ~ y_{stop})\).

\item {} 
\sphinxstyleliteralstrong{ny} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points along \(y\).

\item {} 
\sphinxstyleliteralstrong{units\_x} (\sphinxtitleref{str}, optional) \textendash{} Units for the \(x\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{dims\_x} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(x\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{units\_y} (\sphinxtitleref{str}, optional) \textendash{} Units for the \(y\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{dims\_y} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(y\)-coordinate.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
Axes labels should use the \sphinxhref{http://cfconventions.org}{CF Conventions}.
\end{sphinxadmonition}

\end{fulllineitems}


\end{fulllineitems}

\index{GridXZ (class in grids.grid\_xz)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xz.GridXZ}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{grids.grid\_xz.}\sphinxbfcode{GridXZ}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='m'}, \emph{dims\_x='x'}, \emph{units\_z='m'}, \emph{dims\_z='z'}, \emph{z\_interface=None}, \emph{topo\_type='terrain\_flat'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Rectangular and regular two-dimensional grid embedded in a reference system whose coordinates are
\begin{itemize}
\item {} 
the horizontal coordinate \(x\);

\item {} 
the vertical (terrain-following) coordinate \(z\).

\end{itemize}

The vertical coordinate \(z\) may be formulated to define a hybrid terrain-following coordinate system
with terrain-following coordinate lines between the surface terrain-height and \(z = z_F\), where
\(z\)-coordinate lines change back to flat horizontal lines. However, no assumption is made on the actual
nature of \(z\) which may be either pressure-based or height-based.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.x}]{\sphinxcrossref{\sphinxstyleliteralstrong{x}}}} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(x\)-axis.

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.nx}]{\sphinxcrossref{\sphinxstyleliteralstrong{nx}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points along \(x\).

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.dx}]{\sphinxcrossref{\sphinxstyleliteralstrong{dx}}}} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(x\)-spacing.

\item {} 
\sphinxstyleliteralstrong{z} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(z\)-main levels.

\item {} 
\sphinxstyleliteralstrong{z\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(z\)-half levels.

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{dz} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(z\)-spacing.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} The interface coordinate \(z_F\).

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
For the sake of compliancy with the \sphinxhref{http://www.cosmo-model.org}{COSMO model}, the vertical grid points are
ordered from the top of the domain to the surface.
\end{sphinxadmonition}
\index{\_\_init\_\_() (grids.grid\_xz.GridXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xz.GridXZ.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='m'}, \emph{dims\_x='x'}, \emph{units\_z='m'}, \emph{dims\_z='z'}, \emph{z\_interface=None}, \emph{topo\_type='terrain\_flat'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{domain\_x} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((x_{left}, ~ x_{right})\).

\item {} 
\sphinxstyleliteralstrong{nx} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points in the \(x\)-direction.

\item {} 
\sphinxstyleliteralstrong{domain\_z} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((z_{top}, ~ z_{surface})\).

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{units\_x} (\sphinxtitleref{str}, optional) \textendash{} 
Units for the \(x\)-coordinate. Must be compliant with the \sphinxhref{http://cfconventions.org}{CF Conventions}
(see also {\hyperref[\detokenize{api:grids.axis.Axis.__init__}]{\sphinxcrossref{\sphinxcode{grids.axis.Axis.\_\_init\_\_()}}}}).


\item {} 
\sphinxstyleliteralstrong{dims\_x} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(x\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{units\_z} (\sphinxtitleref{str}, optional) \textendash{} 
Units for the \(z\)-coordinate. Must be compliant with the \sphinxhref{http://cfconventions.org}{CF Conventions}
(see also {\hyperref[\detokenize{api:grids.axis.Axis.__init__}]{\sphinxcrossref{\sphinxcode{grids.axis.Axis.\_\_init\_\_()}}}}).


\item {} 
\sphinxstyleliteralstrong{dims\_z} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(z\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxtitleref{float}, optional) \textendash{} Interface value \(z_F\). If not specified, it is assumed that \(z_F = z_T\), with \(z_T\) the
value of \(z\) at the top of the domain. In other words, a fully terrain-following coordinate system is
supposed.

\item {} 
\sphinxstyleliteralstrong{topo\_type} (\sphinxtitleref{str}, optional) \textendash{} Topography type. See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}} for further details.

\item {} 
\sphinxstyleliteralstrong{topo\_time} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{datetime.timedelta} representing the simulation time after which the topography should stop
increasing. Default is 0, corresponding to a time-invariant terrain surface-height. See
{\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}} for further details.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode
\sphinxstyleliteralstrong{kwargs} \textendash{} Keyword arguments to be forwarded to the constructor of {\hyperref[\detokenize{api:grids.topography.Topography1d}]{\sphinxcrossref{\sphinxcode{Topography1d}}}}.

\end{description}\end{quote}

\end{fulllineitems}

\index{topography\_height (grids.grid\_xz.GridXZ attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xz.GridXZ.topography_height}}\pysigline{\sphinxbfcode{topography\_height}}
Get the topography (i.e., terrain-surface) height.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
One-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the topography height.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{update\_topography() (grids.grid\_xz.GridXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xz.GridXZ.update_topography}}\pysiglinewithargsret{\sphinxbfcode{update\_topography}}{\emph{time}}{}
Update the (time-dependent) topography.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the elapsed simulation time.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{Sigma2d (class in grids.sigma)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sigma.Sigma2d}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{grids.sigma.}\sphinxbfcode{Sigma2d}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='m'}, \emph{dims\_x='x'}, \emph{z\_interface=None}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
This class inherits {\hyperref[\detokenize{api:grids.grid_xz.GridXZ}]{\sphinxcrossref{\sphinxcode{GridXZ}}}} to represent a rectangular and regular
two-dimensional grid embedded in a reference system whose coordinates are
\begin{itemize}
\item {} 
the horizontal coordinate \(x\);

\item {} 
the pressure-based terrain-following coordinate \(\sigma = p / p_{SL}\),                  where \(p\) is the pressure and \(p_{SL}\) the pressure at the sea level.

\end{itemize}

The vertical coordinate \(\sigma\) may be formulated to define a hybrid terrain-following coordinate system
with terrain-following coordinate lines between the surface terrain-height and \(\sigma = \sigma_F\), where
\(\sigma\)-coordinate lines change back to flat horizontal lines.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.x}]{\sphinxcrossref{\sphinxstyleliteralstrong{x}}}} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(x\)-axis.

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.nx}]{\sphinxcrossref{\sphinxstyleliteralstrong{nx}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points along \(x\).

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.dx}]{\sphinxcrossref{\sphinxstyleliteralstrong{dx}}}} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(x\)-spacing.

\item {} 
\sphinxstyleliteralstrong{z} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(\sigma\)-main levels.

\item {} 
\sphinxstyleliteralstrong{z\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(\sigma\)-half levels.

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{dz} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(\sigma\)-spacing.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} The interface coordinate \(\sigma_F\).

\item {} 
\sphinxstyleliteralstrong{height} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the geometric height of the main levels.

\item {} 
\sphinxstyleliteralstrong{height\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the geometric height of the half levels.

\item {} 
\sphinxstyleliteralstrong{height\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} Geometric height corresponding to \(\sigma = \sigma_F\).

\item {} 
\sphinxstyleliteralstrong{reference\_pressure} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the reference pressure at the main levels.

\item {} 
\sphinxstyleliteralstrong{reference\_pressure\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the reference pressure at the half levels.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (grids.sigma.Sigma2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sigma.Sigma2d.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='m'}, \emph{dims\_x='x'}, \emph{z\_interface=None}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{domain\_x} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((x_{left}, ~ x_{right})\).

\item {} 
\sphinxstyleliteralstrong{nx} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points in the \(x\)-direction.

\item {} 
\sphinxstyleliteralstrong{domain\_z} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((\sigma_{top}, ~ \sigma_{surface})\).

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{units\_x} (\sphinxtitleref{str}, optional) \textendash{} 
Units for the \(x\)-coordinate. Must be compliant with the \sphinxhref{http://cfconventions.org}{CF Conventions}
(see also {\hyperref[\detokenize{api:grids.axis.Axis.__init__}]{\sphinxcrossref{\sphinxcode{grids.axis.Axis.\_\_init\_\_()}}}}).


\item {} 
\sphinxstyleliteralstrong{dims\_x} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(x\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxtitleref{float}, optional) \textendash{} Interface value \(\sigma_F\). If not specified, it is assumed that \(\sigma_F = \sigma_T\),
with \(\sigma_T\) the value of \(\sigma\) at the top of the domain. In other words, a fully
terrain-following coordinate system is supposed.

\item {} 
\sphinxstyleliteralstrong{topo\_type} (\sphinxtitleref{str}, optional) \textendash{} Topography type. Default is ‘flat\_terrain’. See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}} for further details.

\item {} 
\sphinxstyleliteralstrong{topo\_time} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{datetime.timedelta} representing the simulation time after which the topography should stop
increasing. Default is 0, corresponding to a time-invariant terrain surface-height. See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}}
for further details.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to be forwarded to the constructor of {\hyperref[\detokenize{api:grids.topography.Topography1d}]{\sphinxcrossref{\sphinxcode{Topography1d}}}}.

\end{description}\end{quote}

\end{fulllineitems}

\index{\_update\_metric\_terms() (grids.sigma.Sigma2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sigma.Sigma2d._update_metric_terms}}\pysiglinewithargsret{\sphinxbfcode{\_update\_metric\_terms}}{}{}
Update the class by computing the metric terms, i.e., the geometric height and the reference pressure,
at both half and main levels. In doing this, a logarithmic vertical profile of reference pressure is assumed.
This method should be called every time the topography is updated or changed.

\end{fulllineitems}

\index{plot() (grids.sigma.Sigma2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sigma.Sigma2d.plot}}\pysiglinewithargsret{\sphinxbfcode{plot}}{\emph{**kwargs}}{}
Plot the grid half levels using \sphinxhref{https://matplotlib.org/2.1.1/api/\_as\_gen/matplotlib.pyplot.html\#module-matplotlib.pyplot}{\sphinxcode{matplotlib.pyplot}}’s utilities.
\begin{quote}\begin{description}
\item[{Keyword Arguments}] \leavevmode
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to be forwarded to \sphinxhref{https://matplotlib.org/2.1.1/api/\_as\_gen/matplotlib.pyplot.subplots.html\#matplotlib.pyplot.subplots}{\sphinxcode{matplotlib.pyplot.subplots()}}.

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
For the sake of compliancy with the notation employed by \sphinxhref{http://www.cosmo-model.org}{COSMO},
the vertical geometric height is denoted by \(z\).
\end{sphinxadmonition}

\end{fulllineitems}

\index{update\_topography() (grids.sigma.Sigma2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sigma.Sigma2d.update_topography}}\pysiglinewithargsret{\sphinxbfcode{update\_topography}}{\emph{time}}{}
Update the (time-dependent) topography. In turn, the metric terms are re-computed.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the elapsed simulation time.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{GalChen2d (class in grids.gal\_chen)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.gal_chen.GalChen2d}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{grids.gal\_chen.}\sphinxbfcode{GalChen2d}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='m'}, \emph{dims\_x='x'}, \emph{z\_interface=None}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
This class inherits \sphinxcode{GridXZ} to represent a rectangular and regular two-dimensional
grid embedded in a reference system whose coordinates are
\begin{itemize}
\item {} 
the horizontal coordinate \(x\);

\item {} 
the height-based Gal-Chen terrain-following coordinate \(\mu\).

\end{itemize}

The vertical coordinate \(\mu\) may be formulated to define a hybrid terrain-following coordinate system
with terrain-following coordinate lines between the surface terrain-height and \(\mu = \mu_F\), where
\(\mu\)-coordinate lines change back to flat horizontal lines.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.x}]{\sphinxcrossref{\sphinxstyleliteralstrong{x}}}} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} object representing the \(x\)-axis.

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.nx}]{\sphinxcrossref{\sphinxstyleliteralstrong{nx}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points along \(x\).

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.dx}]{\sphinxcrossref{\sphinxstyleliteralstrong{dx}}}} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(x\)-spacing.

\item {} 
\sphinxstyleliteralstrong{z} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(\mu\)-main levels.

\item {} 
\sphinxstyleliteralstrong{z\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(\mu\)-half levels.

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{dz} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(\mu\)-spacing.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} The interface coordinate \(\mu_F\).

\item {} 
\sphinxstyleliteralstrong{height} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the geometric height of the main levels.

\item {} 
\sphinxstyleliteralstrong{height\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the geometric height of the half levels.

\item {} 
\sphinxstyleliteralstrong{height\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} Geometric height corresponding to \(\mu = \mu_F\).

\item {} 
\sphinxstyleliteralstrong{reference\_pressure} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the reference pressure at the main levels.

\item {} 
\sphinxstyleliteralstrong{reference\_pressure\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the reference pressure at the half levels.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (grids.gal\_chen.GalChen2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.gal_chen.GalChen2d.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='m'}, \emph{dims\_x='x'}, \emph{z\_interface=None}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{domain\_x} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((x_{left}, ~ x_{right})\).

\item {} 
\sphinxstyleliteralstrong{nx} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points in the \(x\)-direction.

\item {} 
\sphinxstyleliteralstrong{domain\_z} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((\mu_{top}, ~ \mu_{surface})\).

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{units\_x} (\sphinxtitleref{str}, optional) \textendash{} 
Units for the \(x\)-coordinate. Must be compliant with the \sphinxhref{http://cfconventions.org}{CF Conventions}
(see also {\hyperref[\detokenize{api:grids.axis.Axis.__init__}]{\sphinxcrossref{\sphinxcode{grids.axis.Axis.\_\_init\_\_()}}}}).


\item {} 
\sphinxstyleliteralstrong{dims\_x} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(x\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxtitleref{float}, optional) \textendash{} Interface value \(\mu_F\). If not specified, it is assumed that \(\mu_F = \mu_T\), with \(\mu_T\)
the value of \(\mu\) at the top of the domain. In other words, a fully terrain-following coordinate system
is supposed.

\item {} 
\sphinxstyleliteralstrong{topo\_type} (\sphinxtitleref{str}, optional) \textendash{} Topography type. Default is ‘flat\_terrain’. See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}} for further details.

\item {} 
\sphinxstyleliteralstrong{topo\_time} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{datetime.timedelta} representing the simulation time after which the topography should stop increasing.
Default is 0, corresponding to a time-invariant terrain surface-height. See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}} for further
details.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to be forwarded to the constructor of {\hyperref[\detokenize{api:grids.topography.Topography1d}]{\sphinxcrossref{\sphinxcode{Topography1d}}}}.

\end{description}\end{quote}

\end{fulllineitems}

\index{\_update\_metric\_terms() (grids.gal\_chen.GalChen2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.gal_chen.GalChen2d._update_metric_terms}}\pysiglinewithargsret{\sphinxbfcode{\_update\_metric\_terms}}{}{}
Update the class by computing the metric terms, i.e., the geometric height and the reference pressure,
at both half and main levels. In doing this, a logarithmic vertical profile of reference pressure is assumed.
This method should be called every time the topography is updated or changed.

\end{fulllineitems}

\index{plot() (grids.gal\_chen.GalChen2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.gal_chen.GalChen2d.plot}}\pysiglinewithargsret{\sphinxbfcode{plot}}{\emph{**kwargs}}{}
Plot the grid half levels using \sphinxhref{https://matplotlib.org/2.1.1/api/\_as\_gen/matplotlib.pyplot.html\#module-matplotlib.pyplot}{\sphinxcode{matplotlib.pyplot}}’s utilities.
\begin{quote}\begin{description}
\item[{Keyword Arguments}] \leavevmode
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to be forwarded to \sphinxhref{https://matplotlib.org/2.1.1/api/\_as\_gen/matplotlib.pyplot.subplots.html\#matplotlib.pyplot.subplots}{\sphinxcode{matplotlib.pyplot.subplots()}}.

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
For the sake of compliancy with the notation employed by \sphinxhref{http://www.cosmo-model.org}{COSMO},
the vertical geometric height is denoted by \(z\).
\end{sphinxadmonition}

\end{fulllineitems}

\index{update\_topography() (grids.gal\_chen.GalChen2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.gal_chen.GalChen2d.update_topography}}\pysiglinewithargsret{\sphinxbfcode{update\_topography}}{\emph{time}}{}
Update the (time-dependent) topography. In turn, the metric terms are re-computed.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the elapsed simulation time.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{SLEVE2d (class in grids.sleve)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sleve.SLEVE2d}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{grids.sleve.}\sphinxbfcode{SLEVE2d}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='m'}, \emph{dims\_x='x'}, \emph{z\_interface=None}, \emph{N=100}, \emph{s1=8000.0}, \emph{s2=5000.0}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
This class inherits {\hyperref[\detokenize{api:grids.grid_xz.GridXZ}]{\sphinxcrossref{\sphinxcode{GridXZ}}}} to represent a rectangular and regular two-dimensional
grid embedded in a reference system whose coordinates are
\begin{itemize}
\item {} 
the horizontal coordinate \(x\);

\item {} 
the height-based SLEVE terrain-following coordinate \(\mu\).

\end{itemize}

The vertical coordinate \(\mu\) may be formulated to define a hybrid terrain-following coordinate system
with terrain-following coordinate lines between the surface terrain-height and \(\mu = \mu_F\), where
\(\mu\)-coordinate lines change back to flat horizontal lines.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.x}]{\sphinxcrossref{\sphinxstyleliteralstrong{x}}}} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(x\)-axis.

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.nx}]{\sphinxcrossref{\sphinxstyleliteralstrong{nx}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points along \(x\).

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.dx}]{\sphinxcrossref{\sphinxstyleliteralstrong{dx}}}} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(x\)-spacing.

\item {} 
\sphinxstyleliteralstrong{z} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(\mu\)-main levels.

\item {} 
\sphinxstyleliteralstrong{z\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(\mu\)-half levels.

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{dz} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(\mu\)-spacing.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} The interface coordinate \(\mu_F\).

\item {} 
\sphinxstyleliteralstrong{height} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the geometric height of the main levels.

\item {} 
\sphinxstyleliteralstrong{height\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the geometric height of the half levels.

\item {} 
\sphinxstyleliteralstrong{height\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} Geometric height corresponding to \(\mu = \mu_F\).

\item {} 
\sphinxstyleliteralstrong{reference\_pressure} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the reference pressure at the main levels.

\item {} 
\sphinxstyleliteralstrong{reference\_pressure\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the reference pressure at the half levels.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (grids.sleve.SLEVE2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sleve.SLEVE2d.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='m'}, \emph{dims\_x='x'}, \emph{z\_interface=None}, \emph{N=100}, \emph{s1=8000.0}, \emph{s2=5000.0}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{domain\_x} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((x_{left}, ~ x_{right})\).

\item {} 
\sphinxstyleliteralstrong{nx} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points in the \(x\)-direction.

\item {} 
\sphinxstyleliteralstrong{domain\_z} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((\mu_{top}, ~ \mu_{surface})\).

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{units\_x} (\sphinxtitleref{str}, optional) \textendash{} 
Units for the \(x\)-coordinate. Must be compliant with the \sphinxhref{http://cfconventions.org}{CF Conventions}
(see also {\hyperref[\detokenize{api:grids.axis.Axis.__init__}]{\sphinxcrossref{\sphinxcode{grids.axis.Axis.\_\_init\_\_()}}}}).


\item {} 
\sphinxstyleliteralstrong{dims\_x} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(x\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxtitleref{float}, optional) \textendash{} Interface value \(\mu_F\). If not specified, it is assumed that \(\mu_F = \mu_T\), with
\(\mu_T\) the value of \(\mu\) at the top of the domain. In other words, a fully terrain-following
coordinate system is supposed.

\item {} 
\sphinxstyleliteralstrong{N} (\sphinxtitleref{int}, optional) \textendash{} Number of filter iterations performed to extract the large-scale component of the surface terrain-height.
Defaults to 100.

\item {} 
\sphinxstyleliteralstrong{s1} (\sphinxtitleref{float}, optional) \textendash{} Large-scale decay constant. Defaults to \(8000 ~ m\).

\item {} 
\sphinxstyleliteralstrong{s2} (\sphinxtitleref{float}, optional) \textendash{} Small-scale decay constant. Defaults to \(5000 ~ m\).

\item {} 
\sphinxstyleliteralstrong{topo\_type} (\sphinxtitleref{str}, optional) \textendash{} Topography type. Defaults to ‘flat\_terrain’. See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}} for further details.

\item {} 
\sphinxstyleliteralstrong{topo\_time} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{datetime.timedelta} representing the simulation time after which the topography should stop
increasing. Default is 0, corresponding to a time-invariant terrain surface-height. See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}}
for further details.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to be forwarded to the constructor of {\hyperref[\detokenize{api:grids.topography.Topography1d}]{\sphinxcrossref{\sphinxcode{Topography1d}}}}.

\end{description}\end{quote}

\end{fulllineitems}

\index{\_update\_metric\_terms() (grids.sleve.SLEVE2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sleve.SLEVE2d._update_metric_terms}}\pysiglinewithargsret{\sphinxbfcode{\_update\_metric\_terms}}{}{}
Update the class by computing the metric terms, i.e., the geometric height and the reference pressure,
at both half and main levels. In doing this, a logarithmic vertical profile of reference pressure is assumed.
This method should be called every time the topography is updated or changed.

\end{fulllineitems}

\index{plot() (grids.sleve.SLEVE2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sleve.SLEVE2d.plot}}\pysiglinewithargsret{\sphinxbfcode{plot}}{\emph{**kwargs}}{}
Plot the grid half levels using \sphinxhref{https://matplotlib.org/2.1.1/api/\_as\_gen/matplotlib.pyplot.html\#module-matplotlib.pyplot}{\sphinxcode{matplotlib.pyplot}}’s utilities.
\begin{quote}\begin{description}
\item[{Keyword Arguments}] \leavevmode
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to be forwarded to \sphinxhref{https://matplotlib.org/2.1.1/api/\_as\_gen/matplotlib.pyplot.subplots.html\#matplotlib.pyplot.subplots}{\sphinxcode{matplotlib.pyplot.subplots()}}.

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
For the sake of compliancy with the notation employed by \sphinxhref{http://www.cosmo-model.org}{COSMO},
the vertical geometric height is denoted by \(z\).
\end{sphinxadmonition}

\end{fulllineitems}

\index{update\_topography() (grids.sleve.SLEVE2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sleve.SLEVE2d.update_topography}}\pysiglinewithargsret{\sphinxbfcode{update\_topography}}{\emph{time}}{}
Update the (time-dependent) topography. In turn, the metric terms are re-computed.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the elasped simulation time.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{Three-dimensional grids}
\label{\detokenize{api:three-dimensional-grids}}\index{GridXYZ (class in grids.grid\_xyz)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xyz.GridXYZ}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{grids.grid\_xyz.}\sphinxbfcode{GridXYZ}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_y}, \emph{ny}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='degrees\_east'}, \emph{dims\_x='longitude'}, \emph{units\_y='degrees\_north'}, \emph{dims\_y='latitude'}, \emph{units\_z='m'}, \emph{dims\_z='z'}, \emph{z\_interface=None}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Rectangular and regular three-dimensional grid embedded in a reference system whose coordinates are
\begin{itemize}
\item {} 
the first horizontal coordinate \(x\);

\item {} 
the second horizontal coordinate \(y\);

\item {} 
the vertical (terrain-following) coordinate \(z\).

\end{itemize}

The vertical coordinate \(z\) may be formulated to define a hybrid terrain-following coordinate system
with terrain-following coordinate lines between the surface terrain-height and \(z = z_F\), where
\(z\)-coordinate lines change back to flat horizontal lines. However, no assumption is made on the actual
nature of \(z\) which may be either pressure-based or height-based.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{xy\_grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxtitleref{\textasciitilde{}grids.grid\_xy.GridXY} representing the horizontal grid..

\item {} 
\sphinxstyleliteralstrong{z} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(z\)-main levels.

\item {} 
\sphinxstyleliteralstrong{z\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(z\)-half levels.

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{dz} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(z\)-spacing.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} The interface coordinate \(z_F\).

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
For the sake of compliancy with the \sphinxhref{http://cosmo-model.org}{COSMO model}, the vertical grid points are ordered
from the top of the domain to the surface.
\end{sphinxadmonition}
\index{\_\_init\_\_() (grids.grid\_xyz.GridXYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xyz.GridXYZ.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_y}, \emph{ny}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='degrees\_east'}, \emph{dims\_x='longitude'}, \emph{units\_y='degrees\_north'}, \emph{dims\_y='latitude'}, \emph{units\_z='m'}, \emph{dims\_z='z'}, \emph{z\_interface=None}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{domain\_x} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((x_{start}, ~ x_{stop})\).

\item {} 
\sphinxstyleliteralstrong{nx} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points in the \(x\)-direction.

\item {} 
\sphinxstyleliteralstrong{domain\_y} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((y_{start}, ~ y_{stop})\).

\item {} 
\sphinxstyleliteralstrong{ny} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points in the \(y\)-direction.

\item {} 
\sphinxstyleliteralstrong{domain\_z} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((z_{top}, ~ z_{surface})\).

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{units\_x} (\sphinxtitleref{str}, optional) \textendash{} 
Units for the \(x\)-coordinate. Must be compliant with the \sphinxhref{cfconventions.org}{CF Conventions}.


\item {} 
\sphinxstyleliteralstrong{dims\_x} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(x\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{units\_y} (\sphinxtitleref{str}, optional) \textendash{} 
Units for the \(y\)-coordinate. Must be compliant with the \sphinxhref{cfconventions.org}{CF Conventions}.


\item {} 
\sphinxstyleliteralstrong{dims\_y} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(y\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{units\_z} (\sphinxtitleref{str}, optional) \textendash{} 
Units for the \(z\)-coordinate. Must be compliant with the \sphinxhref{cfconventions.org}{CF Conventions}.


\item {} 
\sphinxstyleliteralstrong{dims\_z} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(z\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxtitleref{float}, optional) \textendash{} Interface value \(z_F\). If not specified, it is assumed that \(z_F = z_T\), with \(z_T\)
the value of \(z\) at the top of the domain. In other words, a fully terrain-following coordinate
system is supposed.

\item {} 
\sphinxstyleliteralstrong{topo\_type} (\sphinxtitleref{str}, optional) \textendash{} Topography type. Default is ‘flat\_terrain’. See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}} for further details.

\item {} 
\sphinxstyleliteralstrong{topo\_time} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{datetime.timedelta} representing the simulation time after which the topography should stop
increasing. Default is 0, corresponding to a time-invariant terrain surface-height. See
{\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}} for further details.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode
\sphinxstyleliteralstrong{kwargs} \textendash{} Keyword arguments to be forwarded to the constructor of {\hyperref[\detokenize{api:grids.topography.Topography2d}]{\sphinxcrossref{\sphinxcode{Topography2d}}}}.

\end{description}\end{quote}

\end{fulllineitems}

\index{dx (grids.grid\_xyz.GridXYZ attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xyz.GridXYZ.dx}}\pysigline{\sphinxbfcode{dx}}
Get the \(x\)-spacing.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
The \(x\)-spacing.

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{dy (grids.grid\_xyz.GridXYZ attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xyz.GridXYZ.dy}}\pysigline{\sphinxbfcode{dy}}
Get the \(y\)-spacing.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
The \(y\)-spacing.

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{nx (grids.grid\_xyz.GridXYZ attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xyz.GridXYZ.nx}}\pysigline{\sphinxbfcode{nx}}
Get the number of grid points in the \(x\)-direction.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
Number of grid points in the \(x\)-direction.

\item[{Return type}] \leavevmode
int

\end{description}\end{quote}

\end{fulllineitems}

\index{ny (grids.grid\_xyz.GridXYZ attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xyz.GridXYZ.ny}}\pysigline{\sphinxbfcode{ny}}
Get the number of grid points in the \(y\)-direction.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
Number of grid points in the \(y\)-direction.

\item[{Return type}] \leavevmode
int

\end{description}\end{quote}

\end{fulllineitems}

\index{topography\_height (grids.grid\_xyz.GridXYZ attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xyz.GridXYZ.topography_height}}\pysigline{\sphinxbfcode{topography\_height}}
Get the topography (i.e., terrain-surface) height.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the topography height.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{update\_topography() (grids.grid\_xyz.GridXYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xyz.GridXYZ.update_topography}}\pysiglinewithargsret{\sphinxbfcode{update\_topography}}{\emph{time}}{}
Update the (time-dependent) topography.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the elapsed simulation time.

\end{description}\end{quote}

\end{fulllineitems}

\index{x (grids.grid\_xyz.GridXYZ attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xyz.GridXYZ.x}}\pysigline{\sphinxbfcode{x}}
Get the \(x\)-axis.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
{\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(x\)-axis.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{x\_half\_levels (grids.grid\_xyz.GridXYZ attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xyz.GridXYZ.x_half_levels}}\pysigline{\sphinxbfcode{x\_half\_levels}}
Get the \(x\)-half levels.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
{\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(x\)-half levels.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{y (grids.grid\_xyz.GridXYZ attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xyz.GridXYZ.y}}\pysigline{\sphinxbfcode{y}}
Get the \(y\)-axis.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
{\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(y\)-axis.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{y\_half\_levels (grids.grid\_xyz.GridXYZ attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xyz.GridXYZ.y_half_levels}}\pysigline{\sphinxbfcode{y\_half\_levels}}
Get the \(y\)-half levels.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
{\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(y\)-half levels.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{Sigma3d (class in grids.sigma)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sigma.Sigma3d}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{grids.sigma.}\sphinxbfcode{Sigma3d}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_y}, \emph{ny}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='degrees\_east'}, \emph{dims\_x='longitude'}, \emph{units\_y='degrees\_north'}, \emph{dims\_y='latitude'}, \emph{z\_interface=None}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
This class inherits {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} to represent a rectangular and regular computational grid
embedded in a three-dimensional terrain-following reference system, whose coordinates are:
\begin{itemize}
\item {} 
first horizontal coordinate \(x\), e.g., the longitude;

\item {} 
second horizontal coordinate \(y\), e.g., the latitude;

\item {} 
the pressure-based terrain-following coordinate \(\sigma = p / p_{SL}\),                  where \(p\) is the pressure and \(p_{SL}\) the pressure at the sea level.

\end{itemize}

The vertical coordinate \(\sigma\) may be formulated to define a hybrid terrain-following coordinate system
with terrain-following coordinate lines between the surface terrain-height and \(\sigma = \sigma_F\), where
\(\sigma\)-coordinate lines change back to flat horizontal lines.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{xy\_grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xy.GridXY}]{\sphinxcrossref{\sphinxcode{GridXY}}}} representing the horizontal grid.

\item {} 
\sphinxstyleliteralstrong{z} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(\sigma\)-main levels.

\item {} 
\sphinxstyleliteralstrong{z\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(\sigma\)-half levels.

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{dz} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(\sigma\)-spacing.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} The interface coordinate \(\sigma_F\).

\item {} 
\sphinxstyleliteralstrong{height} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the geometric height of the main levels.

\item {} 
\sphinxstyleliteralstrong{height\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the geometric height of the half levels.

\item {} 
\sphinxstyleliteralstrong{height\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} Geometric height corresponding to \(\sigma = \sigma_F\).

\item {} 
\sphinxstyleliteralstrong{reference\_pressure} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} storing the reference pressure at the main levels.

\item {} 
\sphinxstyleliteralstrong{reference\_pressure\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} storing the reference pressure at the half levels.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (grids.sigma.Sigma3d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sigma.Sigma3d.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_y}, \emph{ny}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='degrees\_east'}, \emph{dims\_x='longitude'}, \emph{units\_y='degrees\_north'}, \emph{dims\_y='latitude'}, \emph{z\_interface=None}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{domain\_x} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((x_{left}, ~ x_{right})\).

\item {} 
\sphinxstyleliteralstrong{nx} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points in the \(x\)-direction.

\item {} 
\sphinxstyleliteralstrong{domain\_y} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((y_{left}, ~ y_{right})\).

\item {} 
\sphinxstyleliteralstrong{ny} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points in the \(y\)-direction.

\item {} 
\sphinxstyleliteralstrong{domain\_z} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((\sigma_{top}, ~ \sigma_{surface})\).

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{units\_x} (\sphinxtitleref{str}, optional) \textendash{} 
Units for the \(x\)-coordinate. Must be compliant with the \sphinxhref{http://cfconventions.org}{CF Conventions}
(see also {\hyperref[\detokenize{api:grids.axis.Axis.__init__}]{\sphinxcrossref{\sphinxcode{grids.axis.Axis.\_\_init\_\_()}}}}).


\item {} 
\sphinxstyleliteralstrong{dims\_x} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(x\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{units\_y} (\sphinxtitleref{str}, optional) \textendash{} 
Units for the \(y\)-coordinate. Must be compliant with the \sphinxhref{http://cfconventions.org}{CF Conventions}
(see also {\hyperref[\detokenize{api:grids.axis.Axis.__init__}]{\sphinxcrossref{\sphinxcode{grids.axis.Axis.\_\_init\_\_()}}}}).


\item {} 
\sphinxstyleliteralstrong{dims\_y} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(y\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxtitleref{float}, optional) \textendash{} Interface value \(\sigma_F\). If not specified, it is assumed that \(\sigma_F = \sigma_T\),
with \(\sigma_T\) the value of  \(\sigma\) at the top of the domain. In other words, a fully
terrain-following coordinate system is supposed.

\item {} 
\sphinxstyleliteralstrong{topo\_type} (\sphinxtitleref{str}, optional) \textendash{} Topography type. Default is ‘flat\_terrain’. See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}} for further details.

\item {} 
\sphinxstyleliteralstrong{topo\_time} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{datetime.timedelta} representing the simulation time after which the topography should stop
increasing. Default is 0, corresponding to a time-invariant terrain surface-height.
See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}} for further details.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to be forwarded to the constructor of {\hyperref[\detokenize{api:grids.topography.Topography2d}]{\sphinxcrossref{\sphinxcode{Topography2d}}}}.

\end{description}\end{quote}

\end{fulllineitems}

\index{\_update\_metric\_terms() (grids.sigma.Sigma3d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sigma.Sigma3d._update_metric_terms}}\pysiglinewithargsret{\sphinxbfcode{\_update\_metric\_terms}}{}{}
Update the class by computing the metric terms, i.e., the geometric height and the reference pressure,
at both half and main levels. In doing this, a logarithmic vertical profile of reference pressure is assumed.
This method should be called every time the topography is updated or changed.

\end{fulllineitems}

\index{update\_topography() (grids.sigma.Sigma3d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sigma.Sigma3d.update_topography}}\pysiglinewithargsret{\sphinxbfcode{update\_topography}}{\emph{time}}{}
Update the (time-dependent) topography. In turn, the metric terms are re-computed.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the elapsed simulation time.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{GalChen3d (class in grids.gal\_chen)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.gal_chen.GalChen3d}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{grids.gal\_chen.}\sphinxbfcode{GalChen3d}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_y}, \emph{ny}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='degrees\_east'}, \emph{dims\_x='longitude'}, \emph{units\_y='degrees\_north'}, \emph{dims\_y='latitude'}, \emph{z\_interface=None}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
This class inherits {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} to represent a rectangular and regular computational grid
embedded in a three-dimensional terrain-following reference system, whose coordinates are:
\begin{itemize}
\item {} 
first horizontal coordinate \(x\), e.g., the longitude;

\item {} 
second horizontal coordinate \(y\), e.g., the latitude;

\item {} 
the Gal-Chen terrain-following coordinate \(\mu\).

\end{itemize}

The vertical coordinate \(\mu\) may be formulated to define a hybrid terrain-following coordinate system
with terrain-following coordinate lines between the surface terrain-height and \(\mu = \mu_F\), where
\(\mu\)-coordinate lines change back to flat horizontal lines.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{xy\_grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xy.GridXY}]{\sphinxcrossref{\sphinxcode{GridXY}}}} representing the horizontal grid.

\item {} 
\sphinxstyleliteralstrong{z} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(z\)-main levels.

\item {} 
\sphinxstyleliteralstrong{z\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(z\)-half levels.

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{dz} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(z\)-spacing.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} The interface coordinate \(z_F\).

\item {} 
\sphinxstyleliteralstrong{height} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the geometric height of the main levels.

\item {} 
\sphinxstyleliteralstrong{height\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the geometric height of the half levels.

\item {} 
\sphinxstyleliteralstrong{height\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} Geometric height corresponding to \(\mu = \mu_F\).

\item {} 
\sphinxstyleliteralstrong{reference\_pressure} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the reference pressure at the main levels.

\item {} 
\sphinxstyleliteralstrong{reference\_pressure\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the reference pressure at the half levels.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (grids.gal\_chen.GalChen3d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.gal_chen.GalChen3d.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_y}, \emph{ny}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='degrees\_east'}, \emph{dims\_x='longitude'}, \emph{units\_y='degrees\_north'}, \emph{dims\_y='latitude'}, \emph{z\_interface=None}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{domain\_x} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((x_{left}, ~ x_{right})\).

\item {} 
\sphinxstyleliteralstrong{nx} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points in the \(x\)-direction.

\item {} 
\sphinxstyleliteralstrong{domain\_y} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((y_{left}, ~ y_{right})\).

\item {} 
\sphinxstyleliteralstrong{ny} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points in the \(y\)-direction.

\item {} 
\sphinxstyleliteralstrong{domain\_z} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((\mu_{top}, ~ \mu_{surface})\).

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{units\_x} (\sphinxtitleref{str}, optional) \textendash{} 
Units for the \(x\)-coordinate. Must be compliant with the \sphinxhref{http://cfconventions.org}{CF Conventions}
(see also {\hyperref[\detokenize{api:grids.axis.Axis.__init__}]{\sphinxcrossref{\sphinxcode{grids.axis.Axis.\_\_init\_\_()}}}}).


\item {} 
\sphinxstyleliteralstrong{dims\_x} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(x\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{str}\sphinxstyleliteralstrong{, }\sphinxstyleliteralstrong{optional} (\sphinxstyleliteralemphasis{units\_y}) \textendash{} 
Units for the \(y\)-coordinate. Must be compliant with the \sphinxhref{http://cfconventions.org}{CF Conventions}
(see also {\hyperref[\detokenize{api:grids.axis.Axis.__init__}]{\sphinxcrossref{\sphinxcode{grids.axis.Axis.\_\_init\_\_()}}}}).


\item {} 
\sphinxstyleliteralstrong{dims\_y} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(y\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxtitleref{float}, optional) \textendash{} Interface value \(zmu_F = \mu_F\). If not specified, it is assumed that \(\mu_F = \mu_T\), with
\(\mu_T\) the value of \(\mu\) at the top of the domain. In other words, a fully terrain-following
coordinate nsystem is supposed.

\item {} 
\sphinxstyleliteralstrong{topo\_type} (\sphinxtitleref{str}, optional) \textendash{} Topography type. Default is ‘flat\_terrain’. See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}} for further details.

\item {} 
\sphinxstyleliteralstrong{topo\_time} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{datetime.timedelta} representing the simulation time after which the topography should stop increasing.
Default is 0, corresponding to a time-invariant terrain surface-height. See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}} for further
details.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to be forwarded to the constructor of {\hyperref[\detokenize{api:grids.topography.Topography2d}]{\sphinxcrossref{\sphinxcode{Topography2d}}}}.

\end{description}\end{quote}

\end{fulllineitems}

\index{\_update\_metric\_terms() (grids.gal\_chen.GalChen3d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.gal_chen.GalChen3d._update_metric_terms}}\pysiglinewithargsret{\sphinxbfcode{\_update\_metric\_terms}}{}{}
Update the class by computing the metric terms, i.e., the geometric height and the reference pressure,
at both half and main levels. In doing this, a logarithmic vertical profile of reference pressure is assumed.
This method should be called every time the topography is updated or changed.

\end{fulllineitems}

\index{update\_topography() (grids.gal\_chen.GalChen3d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.gal_chen.GalChen3d.update_topography}}\pysiglinewithargsret{\sphinxbfcode{update\_topography}}{\emph{time}}{}
Update the (time-dependent) topography. In turn, the metric terms are re-computed.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the elapsed simulation time.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{SLEVE3d (class in grids.sleve)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sleve.SLEVE3d}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{grids.sleve.}\sphinxbfcode{SLEVE3d}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_y}, \emph{ny}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='degrees\_east'}, \emph{dims\_x='longitude'}, \emph{units\_y='degrees\_north'}, \emph{dims\_y='latitude'}, \emph{z\_interface=None}, \emph{N=100}, \emph{s1=8000.0}, \emph{s2=5000.0}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
This class inherits {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} to represent a rectangular and regular computational grid
embedded in a three-dimensional terrain-following reference system, whose coordinates are:
\begin{itemize}
\item {} 
first horizontal coordinate \(x\), e.g., the longitude;

\item {} 
second horizontal coordinate \(y\), e.g., the latitude;

\item {} 
the SLEVE terrain-following coordinate \(\mu\).

\end{itemize}

The vertical coordinate \(\mu\) may be formulated to define a hybrid terrain-following coordinate system
with terrain-following coordinate lines between the surface terrain-height and \(\mu = \mu_F\), where
\(\mu\)-coordinate lines change back to flat horizontal lines.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{xy\_grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xy.GridXY}]{\sphinxcrossref{\sphinxcode{GridXY}}}} representing the horizontal grid.

\item {} 
\sphinxstyleliteralstrong{z} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(z\)-main levels.

\item {} 
\sphinxstyleliteralstrong{z\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(z\)-half levels.

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{dz} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(z\)-spacing.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} The interface coordinate \(z_F\).

\item {} 
\sphinxstyleliteralstrong{height} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the geometric height of the main levels.

\item {} 
\sphinxstyleliteralstrong{height\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the geometric height of the half levels.

\item {} 
\sphinxstyleliteralstrong{height\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} Geometric height corresponding to \(\mu = \mu_F\).

\item {} 
\sphinxstyleliteralstrong{reference\_pressure} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the reference pressure at the main levels.

\item {} 
\sphinxstyleliteralstrong{reference\_pressure\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the reference pressure at the half levels.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (grids.sleve.SLEVE3d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sleve.SLEVE3d.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_y}, \emph{ny}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='degrees\_east'}, \emph{dims\_x='longitude'}, \emph{units\_y='degrees\_north'}, \emph{dims\_y='latitude'}, \emph{z\_interface=None}, \emph{N=100}, \emph{s1=8000.0}, \emph{s2=5000.0}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{domain\_x} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((x_{left}, ~ x_{right})\).

\item {} 
\sphinxstyleliteralstrong{nx} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points in the \(x\)-direction.

\item {} 
\sphinxstyleliteralstrong{domain\_y} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((y_{left}, ~ y_{right})\).

\item {} 
\sphinxstyleliteralstrong{ny} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points in the \(y\)-direction.

\item {} 
\sphinxstyleliteralstrong{domain\_z} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((\mu_{top}, ~ \mu_{surface})\).

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{units\_x} (\sphinxtitleref{str}, optional) \textendash{} 
Units for the \(x\)-coordinate. Must be compliant with the \sphinxhref{http://cfconventions.org}{CF Conventions}
(see also {\hyperref[\detokenize{api:grids.axis.Axis.__init__}]{\sphinxcrossref{\sphinxcode{grids.axis.Axis.\_\_init\_\_()}}}}).


\item {} 
\sphinxstyleliteralstrong{dims\_x} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(x\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{units\_y} (\sphinxtitleref{str}, optional) \textendash{} 
Units for the \(y\)-coordinate. Must be compliant with the \sphinxhref{http://cfconventions.org}{CF Conventions}
(see also {\hyperref[\detokenize{api:grids.axis.Axis.__init__}]{\sphinxcrossref{\sphinxcode{grids.axis.Axis.\_\_init\_\_()}}}}).


\item {} 
\sphinxstyleliteralstrong{dims\_y} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(y\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxtitleref{float}, optional) \textendash{} Interface value \(zmu_F = \mu_F\). If not specified, it is assumed that \(\mu_F = \mu_T\), with
\(\mu_T\) the value of \(\mu\) at the top of the domain. In other words, a fully terrain-following
coordinate nsystem is supposed.

\item {} 
\sphinxstyleliteralstrong{N} (\sphinxtitleref{int}, optional) \textendash{} Number of filter iterations performed to determine the large-scale component of the surface terrain-height.
Defaults to 100.

\item {} 
\sphinxstyleliteralstrong{s1} (\sphinxtitleref{float}, optional) \textendash{} Large-scale decay constant. Defaults to \(8000 ~ m\).

\item {} 
\sphinxstyleliteralstrong{s2} (\sphinxtitleref{float}, optional) \textendash{} Small-scale decay constant. Defaults to \(5000 ~ m\).

\item {} 
\sphinxstyleliteralstrong{topo\_type} (\sphinxtitleref{str}, optional) \textendash{} Topography type. Defaults to ‘flat\_terrain’. See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}} for further details.

\item {} 
\sphinxstyleliteralstrong{topo\_time} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{datetime.timedelta} representing the simulation time after which the topography should stop
increasing. Default is 0, corresponding to a time-invariant terrain surface-height. See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}}
for further details.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to be forwarded to the constructor of {\hyperref[\detokenize{api:grids.topography.Topography2d}]{\sphinxcrossref{\sphinxcode{Topography2d}}}}.

\end{description}\end{quote}

\end{fulllineitems}

\index{\_update\_metric\_terms() (grids.sleve.SLEVE3d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sleve.SLEVE3d._update_metric_terms}}\pysiglinewithargsret{\sphinxbfcode{\_update\_metric\_terms}}{}{}
Update the class by computing the metric terms, i.e., the geometric height and the reference pressure,
at both half and main levels. In doing this, a logarithmic vertical profile of reference pressure is assumed.
This method should be called every time the topography is updated or changed.

\end{fulllineitems}

\index{update\_topography() (grids.sleve.SLEVE3d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sleve.SLEVE3d.update_topography}}\pysiglinewithargsret{\sphinxbfcode{update\_topography}}{\emph{time}}{}
Update the (time-dependent) topography. In turn, the metric terms are re-computed.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the elapsed simulation time.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\section{Model}
\label{\detokenize{api:model}}\index{Model (class in model)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:model.Model}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{model.}\sphinxbfcode{Model}}{\emph{dynamical\_core}, \emph{diagnostics={[}{]}}}{}
This class is intended to represent and run a generic climate or meteorological numerical model.
\index{\_\_call\_\_() (model.Model method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:model.Model.__call__}}\pysiglinewithargsret{\sphinxbfcode{\_\_call\_\_}}{\emph{dt}, \emph{simulation\_time}, \emph{state}, \emph{save\_iterations={[}{]}}}{}
Call operator integrating the model forward in time.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{simulation\_time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the simulation time.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} The initial state, as an instance of {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{save\_freq} (\sphinxtitleref{tuple}, optional) \textendash{} The iterations at which the state should be saved. Default is empty, meaning that only the initial and
final states are saved.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{state\_out} (\sphinxstyleemphasis{obj}) \textendash{} The final state, of the same class of \sphinxcode{state}.

\item {} 
\sphinxstylestrong{state\_save} (\sphinxstyleemphasis{obj}) \textendash{} The sequence of saved states, of the same class of \sphinxcode{state}.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_init\_\_() (model.Model method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:model.Model.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{dynamical\_core}, \emph{diagnostics={[}{]}}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dynamical\_core} (\sphinxstyleliteralemphasis{obj}) \textendash{} An instance of {\hyperref[\detokenize{api:dycore.dycore.DynamicalCore}]{\sphinxcrossref{\sphinxcode{DynamicalCore}}}} or one of its derived classes, implementing a dynamical core.

\item {} 
\sphinxstyleliteralstrong{diagnostics} (\sphinxtitleref{list}, optional) \textendash{} List of diagnostics. Default is empty.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\section{Namelist}
\label{\detokenize{api:namelist}}\label{\detokenize{api:module-namelist}}\index{namelist (module)}
Configuration and global variables used throughout the package.
\begin{description}
\item[{Physical constants:}] \leavevmode\begin{itemize}
\item {} 
\sphinxcode{namelist.p\_ref}: Reference pressure ({[}\(Pa\){]}).

\item {} 
\sphinxcode{namelist.p\_sl}: Reference pressure at sea level ({[}\(Pa\){]}).

\item {} 
\sphinxcode{namelist.T\_sl}: Reference temperature at sea level ({[}\(K\){]}).

\item {} 
\sphinxcode{namelist.beta}: Rate of increase in reference temperature with the logarithm           of reference pressure ({[}\(K ~ Pa^{-1}\){]}).

\item {} 
\sphinxcode{namelist.Rd}: Gas constant for dry airi ({[}\(J ~ K^{-1} ~ Kg^{-1}\){]}).

\item {} 
\sphinxcode{namelist.Rv}: Gas constant for water vapor ({[}\(J ~ K^{-1} ~ Kg^{-1}\){]}).

\item {} 
\sphinxcode{namelist.cp}: Specific heat of dry air at constant pressure ({[}\(J ~ K^{-1} ~ Kg^{-1}\){]}).

\item {} 
\sphinxcode{namelist.g}: Mean gravitational acceleration ({[}\(m ~ s^{-2}\){]}).

\end{itemize}

\item[{Grid settings:}] \leavevmode\begin{itemize}
\item {} 
\sphinxcode{namelist.domain\_x}: Tuple storing the boundaries of the domain in the \(x\)-direction              in the form (\(x_{west}\), \(x_{east}\)).

\item {} 
\sphinxcode{namelist.nx}: Number of grid points in the \(x\)-direction.

\item {} 
\sphinxcode{namelist.domain\_y}: Tuple storing the boundaries of the domain in the \(y\)-direction              in the form (\(y_{south}\), \(y_{north}\)).

\item {} 
\sphinxcode{namelist.ny}: Number of grid points in the \(y\)-direction.

\item {} 
\sphinxcode{namelist.domain\_z}: Tuple storing the boundaries of the domain in the \(z\)-direction              in the form (\(z_{top}\), \(z_{bottom}\)).

\item {} 
\sphinxcode{namelist.nz}: Number of grid points in the \(z\)-direction.

\item {} 
\sphinxcode{namelist.z\_interface}: For a hybrid coordinate system, interface level at which terrain-following              \(z\)-coordinate lines get back to horizontal lines.

\item {} 
\sphinxcode{namelist.topo\_type}: Topography type. Available options are:
\begin{itemize}
\item {} 
‘flat\_terrain’;

\item {} 
‘gaussian’;

\item {} 
‘schaer’;

\item {} 
‘user\_defined’.

\end{itemize}

\item {} 
\sphinxcode{namelist.topo\_time}: \sphinxcode{datetime.timedelta} object representing the elapsed simulation time                               after which the topography should stop increasing.

\item {} 
\sphinxcode{namelist.topo\_max\_height}: When \sphinxcode{topo\_type} is ‘gaussian’, maximum mountain height ({[}\(m\){]}).

\item {} 
\sphinxcode{namelist.topo\_width\_x}: When \sphinxcode{topo\_type} is ‘gaussian’, mountain half-width in \(x\)-direction             ({[}\(m\){]}).

\item {} 
\sphinxcode{namelist.topo\_width\_y}: When \sphinxcode{topo\_type} is ‘gaussian’, mountain half-width in \(y\)-direction             ({[}\(m\){]}).

\item {} 
\sphinxcode{namelist.topo\_str}: When \sphinxcode{topo\_type} is ‘user\_defined’, terrain profile expression in the              independent variables \(x\) and \(y\). Must be fully C++-compliant.

\item {} 
\sphinxcode{namelist.topo\_kwargs}: Dictionary storing \sphinxcode{topo\_max\_height}, \sphinxcode{topo\_width\_x},           \sphinxcode{topo\_width\_y} and \sphinxcode{topo\_str}.

\end{itemize}

\item[{Model settings:}] \leavevmode\begin{itemize}
\item {} 
\sphinxcode{namelist.model\_name}: Name of the model to implement. Available options are:
\begin{itemize}
\item {} 
‘isentropic’, for the isentropic model.

\end{itemize}

\item {} 
\sphinxcode{namelist.moist\_on}: \sphinxcode{True} if water constituents should be taken into account, \sphinxcode{False} otherwise.

\item {} 
\sphinxcode{namelist.horizontal\_boundary\_type}: Horizontal boundary conditions. Available options are:
\begin{itemize}
\item {} 
‘periodic’, for periodic boundary conditions;

\item {} 
‘relaxed’, for relaxed boundary conditions.

\end{itemize}

\end{itemize}

\item[{Numerical settings:}] \leavevmode\begin{itemize}
\item {} 
\sphinxcode{namelist.time\_scheme}: Time integration scheme to implement. Available options are:
\begin{itemize}
\item {} 
‘forward\_euler’, for the forward Euler scheme;

\item {} 
‘centered’, for a centered time-integration scheme.

\end{itemize}

\item {} 
\sphinxcode{namelist.flux\_scheme}: Numerical flux to use. Available options are:
\begin{itemize}
\item {} 
‘upwind’, for the upwind scheme;

\item {} 
‘centered’, for a second-order centered scheme;

\item {} 
‘maccormack’, for the MacCormack scheme.

\end{itemize}

\item {} 
\sphinxcode{namelist.damp\_on}: \sphinxcode{True} if (explicit) vertical damping should be applied, \sphinxcode{False} otherwise.             Note that when vertical damping is switched off, the numerical diffusion is monotonically increased towards             the top of the model, so to act as a diffusive wave absorber.

\item {} 
\sphinxcode{namelist.damp\_type}: Type of vertical damping to apply. Available options are:
\begin{itemize}
\item {} 
‘rayleigh’, for Rayleigh vertical damping.

\end{itemize}

\item {} 
\sphinxcode{namelist.damp\_depth}: Number of levels (either main levels or half levels) in the absorbing region.

\item {} 
\sphinxcode{namelist.damp\_max}: Maximum value which should be assumed by the damping coefficient.

\item {} 
\sphinxcode{namelist.smooth\_on}: \sphinxcode{True} to enable numerical horizontal smoothing, \sphinxcode{False} otherwise.

\item {} 
\sphinxcode{namelist.smooth\_type}: Type of smoothing technique to implement. Available options are:
\begin{itemize}
\item {} 
‘first\_order’, for first-order smoothing;

\item {} 
‘second\_order’, for second-order smoothing.

\end{itemize}

\item {} 
\sphinxcode{namelist.smooth\_depth}: Number of levels (either main levels or half levels) in the smoothing absorbing region.

\item {} 
\sphinxcode{namelist.smooth\_coeff}: The smoothing coefficient.

\item {} 
\sphinxcode{namelist.smooth\_coeff\_max}: Maximum value for the smoothing coefficient when smoothing vertical damping is enabled.

\item {} 
\sphinxcode{namelist.smooth\_moist\_on}: \sphinxcode{True} to enable numerical horizontal smoothing on the moisture constituents,                 \sphinxcode{False} otherwise.

\item {} 
\sphinxcode{namelist.smooth\_moist\_type}: Type of smoothing technique to apply on the moisture constituents. Available options are:
\begin{itemize}
\item {} 
‘first\_order’, for first-order smoothing;

\item {} 
‘second\_order’, for second-order smoothing.

\end{itemize}

\item {} 
\sphinxcode{namelist.smooth\_moist\_depth}: Number of levels (either main levels or half levels) in the smoothing absorbing region           for the moisture constituents.

\item {} 
\sphinxcode{namelist.smooth\_coeff\_moist}: The smoothing coefficient for the moisture components.

\item {} 
\sphinxcode{namelist.smooth\_coeff\_moist\_max}: Maximum value for the smoothing coefficient for the moisture components when                 smoothing vertical damping is enabled.

\end{itemize}

\item[{Microphysics settings:}] \leavevmode\begin{itemize}
\item {} 
\sphinxcode{namelist.coupling\_physics\_dynamics\_on}: \sphinxcode{True} to couple physics with dynamics, i.e., to take the change over             time in potential temperature, \sphinxcode{False} otherwise.

\item {} 
\sphinxcode{namelist.sedimentation\_on}: \sphinxcode{True} to account for rain sedimentation, \sphinxcode{False} otherwise.

\end{itemize}

\item[{Simulation settings:}] \leavevmode\begin{itemize}
\item {} 
\sphinxcode{namelist.dt}: \sphinxcode{datetime.timedelta} object representing the timestep.

\item {} 
\sphinxcode{namelist.initial\_time}: \sphinxcode{datetime.datetime} representing the initial simulation time.

\item {} 
\sphinxcode{namelist.simulation\_time}: \sphinxcode{datetime.timedelta} object representing the simulation time.

\item {} 
\sphinxcode{namelist.initial\_state\_type}: Integer identifying the initial state. See the documentation for the method              \sphinxcode{get\_initial\_state()} of               \sphinxcode{DycoreIsentropic}.

\item {} 
\sphinxcode{namelist.x\_velocity\_initial}: The initial, uniform \(x\)-velocity ({[}\(m s^{-1}\){]}).

\item {} 
\sphinxcode{namelist.y\_velocity\_initial}: The initial, uniform \(y\)-velocity ({[}\(m s^{-1}\){]}).

\item {} 
\sphinxcode{namelist.brunt\_vaisala\_initial}: The initial, uniform Brunt-Vaisala frequency.

\item {} 
\sphinxcode{namelist.temperature\_initial}: The initial, uniform temperature ({[}\(K\){]}).

\item {} 
\sphinxcode{namelist.initial\_state\_kwargs}: Dictionary storing \sphinxcode{x\_velocity\_initial},               \sphinxcode{y\_velocity\_initial}, \sphinxcode{brunt\_vaisala\_initial} and \sphinxcode{temperature\_initial}.

\item {} 
\sphinxcode{namelist.backend}: GT4Py’s backend to use. Available options are:
\begin{itemize}
\item {} 
\sphinxcode{gridtools.mode.NUMPY}: Numpy (i.e., vectorized) backend.

\end{itemize}

\item {} 
\sphinxcode{namelist.save\_iterations}: List of the iterations at which the state should be saved.

\item {} 
\sphinxcode{namelist.save\_dest}: Path to the location where results should be saved.

\item {} 
\sphinxcode{namelist.tol}: Tolerance used to compare floats (see \sphinxcode{utils}).

\item {} 
\sphinxcode{namelist.datatype}: Datatype for \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}}. Either \sphinxcode{np.float32} or \sphinxcode{np.float64}.

\end{itemize}

\end{description}


\section{Parameterizations}
\label{\detokenize{api:parameterizations}}\index{Adjustment (class in parameterizations.adjustment)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment.Adjustment}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{parameterizations.adjustment.}\sphinxbfcode{Adjustment}}{\emph{grid}}{}
Abstract base class whose derived classes implement different ajustment schemes.

\begin{sphinxadmonition}{note}{Note:}
All the derived classes should be model-agnostic.
\end{sphinxadmonition}
\index{\_\_call\_\_() (parameterizations.adjustment.Adjustment method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment.Adjustment.__call__}}\pysiglinewithargsret{\sphinxbfcode{\_\_call\_\_}}{\emph{dt}, \emph{state}}{}
Entry-point method applying the parameterization scheme.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the timestep.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes representing the current state.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{state\_new} (\sphinxstyleemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing the output, adjusted state.

\item {} 
\sphinxstylestrong{diagnostics} (\sphinxstyleemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing possible output diagnostics.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_init\_\_() (parameterizations.adjustment.Adjustment method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment.Adjustment.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\end{description}\end{quote}

\end{fulllineitems}

\index{time\_levels (parameterizations.adjustment.Adjustment attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment.Adjustment.time_levels}}\pysigline{\sphinxbfcode{time\_levels}}
Get the attribute representing the number of time levels the dynamical core relies on.
If this is set to \sphinxcode{None}, a \sphinxcode{ValueError} is thrown.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
The number of time levels the dynamical core relies on.

\item[{Return type}] \leavevmode
int

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{Tendency (class in parameterizations.tendency)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.tendency.Tendency}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{parameterizations.tendency.}\sphinxbfcode{Tendency}}{\emph{grid}}{}
Abstract base class whose derived classes implement different parameterization schemes, providing tendencies.

\begin{sphinxadmonition}{note}{Note:}
All the derived classes should be model-agnostic.
\end{sphinxadmonition}
\index{\_\_call\_\_() (parameterizations.tendency.Tendency method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.tendency.Tendency.__call__}}\pysiglinewithargsret{\sphinxbfcode{\_\_call\_\_}}{\emph{dt}, \emph{state}}{}
Entry-point method applying the parameterization scheme.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the timestep.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes representing the current state.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{tendencies} (\sphinxstyleemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing the output tendencies.

\item {} 
\sphinxstylestrong{diagnostics} (\sphinxstyleemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing possible output diagnostics.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_init\_\_() (parameterizations.tendency.Tendency method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.tendency.Tendency.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{Microphysics}
\label{\detokenize{api:microphysics}}\index{AdjustmentMicrophysics (class in parameterizations.adjustment\_microphysics)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics.AdjustmentMicrophysics}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{parameterizations.adjustment\_microphysics.}\sphinxbfcode{AdjustmentMicrophysics}}{\emph{grid}, \emph{rain\_evaporation\_on}, \emph{backend}}{}
Abstract base class whose derived classes implement different parameterization schemes carrying out
microphysical adjustments. The model variables which get adjusted are:
\begin{itemize}
\item {} 
the mass fraction of water vapor;

\item {} 
the mass fraction of cloud liquid water;

\item {} 
the mass fraction of precipitation water.

\end{itemize}

The class also computes the following diagnostics:
\begin{itemize}
\item {} 
the raindrop fall speed ({[}\(m \, s^{-1}\){]}).

\end{itemize}
\index{\_\_init\_\_() (parameterizations.adjustment\_microphysics.AdjustmentMicrophysics method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics.AdjustmentMicrophysics.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{rain\_evaporation\_on}, \emph{backend}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{rain\_evaporation\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the evaporation of raindrops should be taken into account, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py’s stencils.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_raindrop\_fall\_velocity\_defs() (parameterizations.adjustment\_microphysics.AdjustmentMicrophysics method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics.AdjustmentMicrophysics._stencil_raindrop_fall_velocity_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_raindrop\_fall\_velocity\_defs}}{\emph{in\_rho}, \emph{in\_rho\_s}, \emph{in\_qr}}{}
GT4Py’s stencil providing auxiliary quantitites required to compute the raindrop velocity.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_rho} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the density.

\item {} 
\sphinxstyleliteralstrong{in\_rho\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the surface density.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_prod} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the product between air density and mass fraction of precipitation water,
in units of {[}\(g ~ cm^{-3}\){]}.

\item {} 
\sphinxstylestrong{out\_prod} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the ration between surface air density and air density.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_raindrop\_fall\_velocity\_initialize() (parameterizations.adjustment\_microphysics.AdjustmentMicrophysics method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics.AdjustmentMicrophysics._stencil_raindrop_fall_velocity_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_raindrop\_fall\_velocity\_initialize}}{}{}
Initialize the GT4Py’s stencil providing auxiliary quantitites required to compute the raindrop velocity.

\end{fulllineitems}

\index{\_stencil\_raindrop\_fall\_velocity\_set\_inputs() (parameterizations.adjustment\_microphysics.AdjustmentMicrophysics method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics.AdjustmentMicrophysics._stencil_raindrop_fall_velocity_set_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_raindrop\_fall\_velocity\_set\_inputs}}{\emph{rho}, \emph{qr}}{}
Set the Numpy arrays which serve as inputs to the GT4Py’s stencil providing auxiliary quantitites required to
compute the raindrop velocity.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{rho} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the density.

\item {} 
\sphinxstyleliteralstrong{qr} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the mass fraction of precipitation water.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{factory() (parameterizations.adjustment\_microphysics.AdjustmentMicrophysics static method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics.AdjustmentMicrophysics.factory}}\pysiglinewithargsret{\sphinxbfcode{static }\sphinxbfcode{factory}}{\emph{micro\_scheme}, \emph{grid}, \emph{rain\_evaporation\_on}, \emph{backend}, \emph{**kwargs}}{}
Static method returning an instance of the derived class implementing the microphysics scheme
specified by \sphinxcode{micro\_scheme}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{micro\_scheme} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the microphysics parameterization scheme to implement. Either:
\begin{itemize}
\item {} 
’kessler’, for the Kessler scheme.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{rain\_evaporation\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the evaporation of raindrops should be taken into account, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py’s stencils.

\item {} 
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to be forwarded to the derived class.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_raindrop\_fall\_velocity() (parameterizations.adjustment\_microphysics.AdjustmentMicrophysics method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics.AdjustmentMicrophysics.get_raindrop_fall_velocity}}\pysiglinewithargsret{\sphinxbfcode{get\_raindrop\_fall\_velocity}}{\emph{state}}{}
Get the raindrop fall velocity.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_density (unstaggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}


\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the raindrop fall velocity.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{AdjustmentMicrophysicsKessler (class in parameterizations.adjustment\_microphysics)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics.AdjustmentMicrophysicsKessler}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{parameterizations.adjustment\_microphysics.}\sphinxbfcode{AdjustmentMicrophysicsKessler}}{\emph{grid}, \emph{rain\_evaporation\_on}, \emph{backend}, \emph{a=0.5}, \emph{k1=0.001}, \emph{k2=2.2}}{}
This class inherits {\hyperref[\detokenize{api:parameterizations.adjustment_microphysics.AdjustmentMicrophysics}]{\sphinxcrossref{\sphinxcode{AdjustmentMicrophysics}}}}
to implement the Kessler scheme.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{a} (\sphinxstyleliteralemphasis{float}) \textendash{} Autoconversion threshold, in units of {[}\(g ~ kg^{-1}\){]}.

\item {} 
\sphinxstyleliteralstrong{k1} (\sphinxstyleliteralemphasis{float}) \textendash{} Rate of autoconversion, in units of {[}\(s^{-1}\){]}.

\item {} 
\sphinxstyleliteralstrong{k2} (\sphinxstyleliteralemphasis{float}) \textendash{} Rate of autoaccretion, in units of {[}\(s^{-1}\){]}.

\end{itemize}

\end{description}\end{quote}
\index{\_\_call\_\_() (parameterizations.adjustment\_microphysics.AdjustmentMicrophysicsKessler method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics.AdjustmentMicrophysicsKessler.__call__}}\pysiglinewithargsret{\sphinxbfcode{\_\_call\_\_}}{\emph{dt}, \emph{state}}{}
Entry-point method performing microphysics adjustments and computing microphysics diagnostics.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the timestep.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_density (unstaggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}


\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{state\_new} (\sphinxstyleemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes representing the adjusted state.
This contains the same variables contained in the input state, with the following variables being update:
\begin{itemize}
\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}

\item {} 
\sphinxstylestrong{diagnostics} (\sphinxstyleemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing the following fields:
\begin{itemize}
\item {} 
change\_over\_time\_in\_air\_potential\_temperature (unstaggered).

\end{itemize}

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_init\_\_() (parameterizations.adjustment\_microphysics.AdjustmentMicrophysicsKessler method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics.AdjustmentMicrophysicsKessler.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{rain\_evaporation\_on}, \emph{backend}, \emph{a=0.5}, \emph{k1=0.001}, \emph{k2=2.2}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{rain\_evaporation\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the evaporation of raindrops should be taken into account, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py’s stencils.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{a} (\sphinxstyleliteralemphasis{float}) \textendash{} Autoconversion threshold, in units of {[}\(g ~ kg^{-1}\){]}. Default is \(0.5 ~ g ~ kg^{-1}\).

\item {} 
\sphinxstyleliteralstrong{k1} (\sphinxstyleliteralemphasis{float}) \textendash{} Rate of autoconversion, in units of {[}\(s^{-1}\){]}. Default is \(0.001 ~ s^{-1}\).

\item {} 
\sphinxstyleliteralstrong{k2} (\sphinxstyleliteralemphasis{float}) \textendash{} Rate of autoaccretion, in units of {[}\(s^{-1}\){]}. Default is \(2.2 ~ s^{-1}\).

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
To instantiate this class, one should prefer the static method
{\hyperref[\detokenize{api:parameterizations.adjustment_microphysics.AdjustmentMicrophysics.factory}]{\sphinxcrossref{\sphinxcode{factory()}}}} of
{\hyperref[\detokenize{api:parameterizations.adjustment_microphysics.AdjustmentMicrophysics}]{\sphinxcrossref{\sphinxcode{AdjustmentMicrophysics}}}}.
\end{sphinxadmonition}

\end{fulllineitems}

\index{\_stencil\_adjust\_initialize() (parameterizations.adjustment\_microphysics.AdjustmentMicrophysicsKessler method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics.AdjustmentMicrophysicsKessler._stencil_adjust_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_adjust\_initialize}}{}{}
Initialize the GT4Py’s stencil adjusting the solution and computing the change over time in potential temperature.

\end{fulllineitems}

\index{\_stencil\_adjust\_set\_inputs() (parameterizations.adjustment\_microphysics.AdjustmentMicrophysicsKessler method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics.AdjustmentMicrophysicsKessler._stencil_adjust_set_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_adjust\_set\_inputs}}{\emph{qv}, \emph{qc}, \emph{qr}, \emph{Ar}, \emph{Cr}}{}
Update the Numpy arrays which serve as inputs to the GT4Py’s stencil computing auxiliary quantities
required by the Kessler scheme.

\end{fulllineitems}

\index{\_stencil\_auxiliary\_defs() (parameterizations.adjustment\_microphysics.AdjustmentMicrophysicsKessler method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics.AdjustmentMicrophysicsKessler._stencil_auxiliary_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_auxiliary\_defs}}{\emph{in\_rho}, \emph{in\_p}, \emph{in\_ps}, \emph{in\_qv}, \emph{in\_qc}, \emph{in\_qr}}{}
GT4Py’s stencil computing auxiliary quantities required by the Kessler scheme.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_rho} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the air density.

\item {} 
\sphinxstyleliteralstrong{in\_p} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the pressure.

\item {} 
\sphinxstyleliteralstrong{in\_ps} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the saturation vapor pressure.

\item {} 
\sphinxstyleliteralstrong{in\_qv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_qc} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_qvs} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the saturation mass fraction of water vapor.

\item {} 
\sphinxstylestrong{out\_Ar} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the source term accounting for the contribution of autoconversion to
the development of rain.

\item {} 
\sphinxstylestrong{aux\_Cr} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the product between the rate of accretion and the mass fraction of
cloud liquid water.
This is required to compute the source term accounting for the contribution of accretion to the growth of rain.

\item {} 
\sphinxstylestrong{aux\_Er\_1} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the inverse of air density, expressed in {[}\(g ~ cm^{-3}\){]}.
This is required to compute the source term accounting for the evaporation of rain.

\item {} 
\sphinxstylestrong{aux\_Er\_2} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the ratio between the mass fraction of water vapor and the saturation
mass fraction of water vapor.
This is required to compute the source term accounting for the evaporation of rain.

\item {} 
\sphinxstylestrong{aux\_Er\_3} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the product between air density, expressed in {[}\(g ~ cm^{-3}\){]},
and the mass fraction of precipitation water.
This is required to compute the source term accounting for the evaporation of rain.

\item {} 
\sphinxstylestrong{aux\_Er\_4} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the product between the pressure, expressed in {[}\(mbar\){]}, and the
saturation mass fraction of water vapor.
This is required to compute the source term accounting for the evaporation of rain.

\end{itemize}


\end{description}\end{quote}
\paragraph{References}

Doms, G., et al. (2015). \sphinxstyleemphasis{A description of the nonhydrostatic regional COSMO-model. Part II: Physical parameterization.}                        Retrieved from {\color{red}\bfseries{}{}`www.cosmo-model.org{}`\_}.
Mielikainen, J., B. Huang, J. Wang, H. L. A. Huang, and M. D. Goldberg. (2013). \sphinxstyleemphasis{Compute Unified Device Architecture                    (CUDA)-based parallelization of WRF Kessler cloud microphysics scheme}. Computer \& Geosciences, 52:292-299.

\end{fulllineitems}

\index{\_stencil\_auxiliary\_initialize() (parameterizations.adjustment\_microphysics.AdjustmentMicrophysicsKessler method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics.AdjustmentMicrophysicsKessler._stencil_auxiliary_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_auxiliary\_initialize}}{}{}
Initialize the GT4Py’s stencil providing auxiliary quantitites required by the Kessler scheme.

\end{fulllineitems}

\index{\_stencil\_auxiliary\_set\_inputs() (parameterizations.adjustment\_microphysics.AdjustmentMicrophysicsKessler method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics.AdjustmentMicrophysicsKessler._stencil_auxiliary_set_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_auxiliary\_set\_inputs}}{\emph{rho}, \emph{p}, \emph{ps}, \emph{qv}, \emph{qc}, \emph{qr}}{}
Update the Numpy arrays which serve as inputs to the GT4Py’s stencil computing auxiliary quantities
required by the Kessler scheme.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{rho} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the air density.

\item {} 
\sphinxstyleliteralstrong{p} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the pressure.

\item {} 
\sphinxstyleliteralstrong{ps} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the saturation vapor pressure.

\item {} 
\sphinxstyleliteralstrong{qv} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the mass fraction of water vapor.

\item {} 
\sphinxstyleliteralstrong{qc} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the mass fraction of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{qr} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the mass fraction of precipitation water.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\section{Storages}
\label{\detokenize{api:storages}}\index{GridData (class in storages.grid\_data)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.grid_data.GridData}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{storages.grid\_data.}\sphinxbfcode{GridData}}{\emph{time}, \emph{grid}, \emph{**kwargs}}{}
Class storing and handling time-dependent variables defined on a grid. Ideally, this class should be used to
represent the state, or a sequence of states at different time levels, of a \sphinxstyleemphasis{generic} climate or meteorological model.
The model variables, in the shape of \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}}s, are passed to the constructor as keyword arguments.
After conversion to \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}}s, the variables are packed in a dictionary whose keys are the input keywords.
The class attribute \sphinxcode{units} lists, for any admissible keyword, the units in which the associated field should
be expressed. Any variable can be accessed via the accessor operator by specifying the corresponding
keyword. Other methods are provided to update the state, or to create a sequence of states (useful for animation purposes).
This class is designed to be as general as possible. Hence, it is not endowed with any method whose
implementation depends on the variables actually stored by the class. This kind of methods might be provided by some
derived classes, each one representing the state of a \sphinxstyleemphasis{specific} model.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.datetime} representing the time instant at which the variables are defined.

\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\end{itemize}

\end{description}\end{quote}
\index{\_\_getitem\_\_() (storages.grid\_data.GridData method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.grid_data.GridData.__getitem__}}\pysiglinewithargsret{\sphinxbfcode{\_\_getitem\_\_}}{\emph{key}}{}
Get a shallow copy of a gridded variable.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{key} (\sphinxstyleliteralemphasis{str}) \textendash{} The name of the variable to return.

\item[{Returns}] \leavevmode
Shallow copy of the \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the variable, or \sphinxcode{None} if the variable is not found.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_init\_\_() (storages.grid\_data.GridData method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.grid_data.GridData.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{time}, \emph{grid}, \emph{**kwargs}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.datetime} representing the time instant at which the variables are defined.

\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{**kwargs} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing a gridded variable.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{add() (storages.grid\_data.GridData method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.grid_data.GridData.add}}\pysiglinewithargsret{\sphinxbfcode{add}}{\emph{**kwargs}}{}
Add a list of variables, passed as keyword arguments.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.datetime} representing the time instant at which the variables are defined.

\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{**kwargs} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing a gridded variable.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{append() (storages.grid\_data.GridData method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.grid_data.GridData.append}}\pysiglinewithargsret{\sphinxbfcode{append}}{\emph{other}}{}
Append a new state to the sequence of states.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{other} (\sphinxstyleliteralemphasis{obj}) \textendash{} Another {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} (or a derived class), whose \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}}s
will be concatenated along the temporal axis to the corresponding ones in the current object.

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
\sphinxcode{other} is supposed to contain exactly the same variables stored by the current object.
\end{sphinxadmonition}

\end{fulllineitems}

\index{get\_max() (storages.grid\_data.GridData method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.grid_data.GridData.get_max}}\pysiglinewithargsret{\sphinxbfcode{get\_max}}{\emph{key}}{}
Get the maximum value of a variable.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{key} (\sphinxstyleliteralemphasis{str}) \textendash{} The name of the variable.

\item[{Returns}] \leavevmode
The maximum value of the variable of interest.

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_min() (storages.grid\_data.GridData method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.grid_data.GridData.get_min}}\pysiglinewithargsret{\sphinxbfcode{get\_min}}{\emph{key}}{}
Get the minimum value of a variable.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{key} (\sphinxstyleliteralemphasis{str}) \textendash{} The name of the variable.

\item[{Returns}] \leavevmode
The minimum value of the variable of interest.

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{pop() (storages.grid\_data.GridData method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.grid_data.GridData.pop}}\pysiglinewithargsret{\sphinxbfcode{pop}}{\emph{key}}{}
Get a shallow copy of a gridded variable, then remove it from the dictionary.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{key} (\sphinxstyleliteralemphasis{str}) \textendash{} The name of the variable to return and remove.

\item[{Returns}] \leavevmode
Shallow copy of the \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the variable, or \sphinxcode{None} if the variable is not found.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{update() (storages.grid\_data.GridData method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.grid_data.GridData.update}}\pysiglinewithargsret{\sphinxbfcode{update}}{\emph{other}}{}
Sync the current object with another {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} (or a derived class).
This implies that, for each variable stored in the input object:
\begin{itemize}
\item {} 
if the current object contains a variable with the same name, that variable is updated;

\item {} 
if the current object does not contain any variable with the same name, a new variable is added to the current object.

\end{itemize}

Note that after the update, the stored variables might not be defined at the same time level.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{other} (\sphinxstyleliteralemphasis{obj}) \textendash{} Another {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} (or a derived class) with which the current object will be synced.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{StateIsentropic (class in storages.state\_isentropic)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.state_isentropic.StateIsentropic}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{storages.state\_isentropic.}\sphinxbfcode{StateIsentropic}}{\emph{time}, \emph{grid}, \emph{**kwargs}}{}
This class inherits {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} to represent the state of the three-dimensional
(moist) isentropic model. The stored variables might be:
\begin{itemize}
\item {} 
air\_density (unstaggered);

\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
air\_pressure (\(z\)-staggered);

\item {} 
exner\_function (\(z\)-staggered);

\item {} 
montgomery\_potential (unstaggered);

\item {} 
height (\(z\)-staggered);

\item {} 
air\_temperature (unstaggered);

\item {} 
mass\_fraction\_water\_vapor\_in\_air (unstaggered);

\item {} 
water\_vapor\_isentropic\_density (unstaggered);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
cloud\_liquid\_water\_isentropic\_density (unstaggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered);

\item {} 
precipitation\_water\_isentropic\_density (unstaggered).

\end{itemize}

\begin{sphinxadmonition}{note}{Note:}
At any point, an instance of this class may or may not contain all the listed model variables. Indeed, variables
might be added gradually, according to user’s needs.
\end{sphinxadmonition}
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\end{description}\end{quote}
\index{\_\_init\_\_() (storages.state\_isentropic.StateIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.state_isentropic.StateIsentropic.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{time}, \emph{grid}, \emph{**kwargs}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time instant at which the state is defined.

\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{air\_density} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the density.

\item {} 
\sphinxstyleliteralstrong{air\_isentropic\_density} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{x\_velocity} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{y\_velocity} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{x\_momentum\_isentropic} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the (isentropic) \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{y\_momentum\_isentropic} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the (isentropic) \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{air\_pressure} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the pressure.

\item {} 
\sphinxstyleliteralstrong{exner\_function} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the Exner function.

\item {} 
\sphinxstyleliteralstrong{montgomery\_potential} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the Montgomery potential.

\item {} 
\sphinxstyleliteralstrong{height} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the geometrical height of the half-levels.

\item {} 
\sphinxstyleliteralstrong{air\_temperature} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the temperature.

\item {} 
\sphinxstyleliteralstrong{mass\_fraction\_of\_water\_vapor\_in\_air} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the mass fraction of water vapor.

\item {} 
\sphinxstyleliteralstrong{water\_vapor\_isentropic\_density} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{mass\_fraction\_of\_cloud\_liquid\_water\_in\_air} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the mass fraction of cloud water.

\item {} 
\sphinxstyleliteralstrong{cloud\_liquid\_water\_isentropic\_density} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the isentropic density of cloud water.

\item {} 
\sphinxstyleliteralstrong{mass\_fraction\_of\_precipitation\_water\_in\_air} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the mass fraction of precipitation water.

\item {} 
\sphinxstyleliteralstrong{precipitation\_water\_isentropic\_density} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the isentropic density of precipitation water.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{contour\_xz() (storages.state\_isentropic.StateIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.state_isentropic.StateIsentropic.contour_xz}}\pysiglinewithargsret{\sphinxbfcode{contour\_xz}}{\emph{field\_to\_plot}, \emph{y\_level}, \emph{time\_level}, \emph{**kwargs}}{}
Generate a contour plot of a field at the cross-section \(y = \bar{y}\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{field\_to\_plot} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the field to plot. This might be:
\begin{itemize}
\item {} 
the name of a variable stored in the current object;

\item {} \begin{description}
\item[{’x\_velocity\_unstaggered\_perturbation’, for the discrepancy of the \(x\)-velocity with respect to}] \leavevmode
the initial condition; the current object must contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density;

\item {} 
x\_momentum\_isentropic;

\end{itemize}

\end{description}

\item {} \begin{description}
\item[{’vertical\_velocity’, for the vertical velocity; only for steady-state flows; the current object must contain}] \leavevmode
the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density;

\item {} 
x\_momentum\_isentropic;

\item {} 
height.

\end{itemize}

\end{description}

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{y\_level} (\sphinxstyleliteralemphasis{int}) \textendash{} Index corresponding to the \(y\)-level identifying the cross-section to plot.

\item {} 
\sphinxstyleliteralstrong{time\_level} (\sphinxstyleliteralemphasis{int}) \textendash{} The index corresponding to the time level to plot.

\item {} 
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to specify different plotting settings.
See {\hyperref[\detokenize{api:utils.utils_plot.contour_xz}]{\sphinxcrossref{\sphinxcode{utils.utils\_plot.contour\_xz()}}}} for the complete list.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{contourf\_xy() (storages.state\_isentropic.StateIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.state_isentropic.StateIsentropic.contourf_xy}}\pysiglinewithargsret{\sphinxbfcode{contourf\_xy}}{\emph{field\_to\_plot}, \emph{z\_level}, \emph{time\_level}, \emph{**kwargs}}{}
Generate a contourf plot of a field at the level \(\theta = \bar{\theta}\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{field\_to\_plot} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the field to plot. This might be:
\begin{itemize}
\item {} 
the name of a variable stored in the current object;

\item {} 
’horizontal\_velocity’, for the horizontal velocity; the current object must contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density;

\item {} 
x\_momentum\_isentropic;

\item {} 
y\_momentum\_isentropic.

\end{itemize}

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{z\_level} (\sphinxstyleliteralemphasis{int}) \textendash{} Index corresponding to the \(\theta\)-level identifying the cross-section to plot.

\item {} 
\sphinxstyleliteralstrong{time\_level} (\sphinxstyleliteralemphasis{int}) \textendash{} The index corresponding to the time level to plot.

\item {} 
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to specify different plotting settings.
See {\hyperref[\detokenize{api:utils.utils_plot.contourf_xy}]{\sphinxcrossref{\sphinxcode{utils.utils\_plot.contourf\_xy()}}}} for the complete list.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{contourf\_xz() (storages.state\_isentropic.StateIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.state_isentropic.StateIsentropic.contourf_xz}}\pysiglinewithargsret{\sphinxbfcode{contourf\_xz}}{\emph{field\_to\_plot}, \emph{y\_level}, \emph{time\_level}, \emph{**kwargs}}{}
Generate a contourf plot of a field at the cross-section \(y = \bar{y}\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{field\_to\_plot} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the field to plot. This might be:
\begin{itemize}
\item {} 
the name of a variable stored in the current object;

\item {} \begin{description}
\item[{’x\_velocity\_unstaggered\_perturbation’, for the discrepancy of the \(x\)-velocity with respect to}] \leavevmode
the initial condition; the current object must contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density;

\item {} 
x\_momentum\_isentropic;

\end{itemize}

\end{description}

\item {} \begin{description}
\item[{’vertical\_velocity’, for the vertical velocity; only for steady-state flows; the current object must contain}] \leavevmode
the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density;

\item {} 
x\_momentum\_isentropic;

\item {} 
height.

\end{itemize}

\end{description}

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{y\_level} (\sphinxstyleliteralemphasis{int}) \textendash{} Index corresponding to the \(y\)-level identifying the cross-section to plot.

\item {} 
\sphinxstyleliteralstrong{time\_level} (\sphinxstyleliteralemphasis{int}) \textendash{} The index corresponding to the time level to plot.

\item {} 
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to specify different plotting settings.
See {\hyperref[\detokenize{api:utils.utils_plot.contour_xz}]{\sphinxcrossref{\sphinxcode{utils.utils\_plot.contour\_xz()}}}} for the complete list.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_cfl() (storages.state\_isentropic.StateIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.state_isentropic.StateIsentropic.get_cfl}}\pysiglinewithargsret{\sphinxbfcode{get\_cfl}}{\emph{dt}}{}
Compute the CFL number.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item[{Returns}] \leavevmode
The CFL number.

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
If the CFL number exceeds the unity, i.e., if the CFL condition is violated, the method throws a warning.
\end{sphinxadmonition}

\end{fulllineitems}

\index{quiver\_xy() (storages.state\_isentropic.StateIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.state_isentropic.StateIsentropic.quiver_xy}}\pysiglinewithargsret{\sphinxbfcode{quiver\_xy}}{\emph{field\_to\_plot}, \emph{z\_level}, \emph{time\_level}, \emph{**kwargs}}{}
Generate a quiver plot of a vector field at the level \(\theta = \bar{\theta}\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{field\_to\_plot} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the field to plot. This might be:
\begin{itemize}
\item {} 
’horizontal\_velocity’, for the horizontal velocity; the current object must contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density;

\item {} 
x\_momentum\_isentropic;

\item {} 
y\_momentum\_isentropic.

\end{itemize}

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{z\_level} (\sphinxstyleliteralemphasis{int}) \textendash{} Index corresponding to the \(\theta\)-level identifying the cross-section to plot.

\item {} 
\sphinxstyleliteralstrong{time\_level} (\sphinxstyleliteralemphasis{int}) \textendash{} The index corresponding to the time level to plot.

\item {} 
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to specify different plotting settings.
See {\hyperref[\detokenize{api:utils.utils_plot.quiver_xy}]{\sphinxcrossref{\sphinxcode{utils.utils\_plot.quiver\_xy()}}}} for the complete list.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\section{Topography}
\label{\detokenize{api:module-grids.topography}}\label{\detokenize{api:topography}}\index{grids.topography (module)}
Classes representing one- and two-dimensional topographies, possibly time-dependent.
Indeed, although clearly not physical, a terrain surface (slowly) growing in the early stages
of a simulation may help to retrieve numerical stability, as it prevents steep gradients
in the first few iterations.

Letting \(h_s = h_s(x)\) be a one-dimensional topography, with \(x \in [a,b]\),
the user may choose among:
\begin{itemize}
\item {} 
a flat terrain, i.e., \(h_s(x) \equiv 0\);

\item {} 
a Gaussian-shaped mountain, i.e.,
\begin{quote}
\begin{equation*}
\begin{split}h_s(x) = h_{max} \exp{\left[ - \left( \frac{x - c}{\sigma_x} \right)^2 \right]},\end{split}
\end{equation*}\end{quote}

where \(c = 0.5 (a + b)\).

\end{itemize}

For the two-dimensional case, letting \(h_s = h_s(x,y)\) be the topography, with
\(x \in [a_x,b_x]\) and \(y \in [a_y,b_y]\), the following profiles are provided:
\begin{itemize}
\item {} 
flat terrain, i.e., \(h_s(x,y) \equiv 0\);

\item {} 
Gaussian shaped-mountain, i.e.
\begin{quote}
\begin{equation*}
\begin{split}h_s(x,y) = h_{max} \exp{\left[ - \left( \frac{x - c_x}{\sigma_x} \right)^2 - \left( \frac{y - c_y}{\sigma_y} \right)^2 \right]} ,\end{split}
\end{equation*}\end{quote}

where \(c_x = 0.5 (a_x + b_x)\) and \(c_y = 0.5 (a_y + b_y)\);

\item {} 
modified Gaussian-shaped mountain proposed by Schaer and Durran (1997),
\begin{quote}
\begin{equation*}
\begin{split}h_s(x,y) = \frac{h_{max}}{\left[ 1 + \left( \frac{x}{\sigma_x} \right)^2 + \left( \frac{y}{\sigma_y} \right)^2 \right]^{3/2}}.\end{split}
\end{equation*}\end{quote}

\end{itemize}

Yet, user-defined profiles are supported as well, provided that they admit an analytical expression.
This is passed to the class as a string, which is then parsed in C++ via \sphinxhref{http://cython.org}{Cython}
(see \sphinxcode{parser\_1d} and \sphinxcode{parser\_2d}). Hence, the string itself must be
fully C++-compliant.
\paragraph{References}

Schaer, C., and Durran, D. R. (1997). \sphinxstyleemphasis{Vortex formation and vortex shedding in continuosly stratified flows     past isolated topography}. Journal of Atmospheric Sciences, 54:534-554.
\index{Topography1d (class in grids.topography)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.topography.Topography1d}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{grids.topography.}\sphinxbfcode{Topography1d}}{\emph{x}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Class representing a one-dimensional topography.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{topo} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the topography (in meters).

\item {} 
\sphinxstyleliteralstrong{topo\_type} (\sphinxstyleliteralemphasis{str}) \textendash{} 
Topography type. Either:
\begin{itemize}
\item {} 
’flat\_terrain’;

\item {} 
’gaussian’;

\item {} 
’user\_defined’.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{topo\_time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} object representing the elapsed simulation time after which the topography
should stop increasing.

\item {} 
\sphinxstyleliteralstrong{topo\_fact} (\sphinxstyleliteralemphasis{float}) \textendash{} Topography factor. It runs in between 0 (at the beginning of the simulation) and 1 (once the simulation
has been run for \sphinxcode{topo\_time}).

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (grids.topography.Topography1d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.topography.Topography1d.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{x}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{x} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the underlying horizontal axis.

\item {} 
\sphinxstyleliteralstrong{topo\_type} (\sphinxtitleref{str}, optional) \textendash{} 
Topography type. Either:
\begin{itemize}
\item {} 
’flat\_terrain’ (default);

\item {} 
’gaussian’;

\item {} 
’user\_defined’.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{topo\_time} (\sphinxstyleliteralemphasis{obj}) \textendash{} class:\sphinxtitleref{datetime.timedelta} representing the elapsed simulation time after which the topography
should stop increasing. Default is 0, corresponding to a time-invariant terrain surface-height.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{topo\_max\_height} (\sphinxstyleliteralemphasis{float}) \textendash{} When \sphinxcode{topo\_type} is ‘gaussian’, maximum mountain height (in meters). Default is 500.

\item {} 
\sphinxstyleliteralstrong{topo\_width\_x} (\sphinxstyleliteralemphasis{float}) \textendash{} When \sphinxcode{topo\_type} is ‘gaussian’, mountain half-width (in meters). Default is 10000.

\item {} 
\sphinxstyleliteralstrong{topo\_str} (\sphinxstyleliteralemphasis{str}) \textendash{} When \sphinxcode{topo\_type} is ‘user\_defined’, terrain profile expression in the independent variable \(x\).
Must be fully C++-compliant.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{update() (grids.topography.Topography1d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.topography.Topography1d.update}}\pysiglinewithargsret{\sphinxbfcode{update}}{\emph{time}}{}
Update topography at current simulation time.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the elapsed simulation time.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{Topography2d (class in grids.topography)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.topography.Topography2d}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{grids.topography.}\sphinxbfcode{Topography2d}}{\emph{grid}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Class representing a two-dimensional topography.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{topo} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the topography (in meters).

\item {} 
\sphinxstyleliteralstrong{topo\_type} (\sphinxstyleliteralemphasis{str}) \textendash{} 
Topography type. Either:
\begin{itemize}
\item {} 
’flat\_terrain’;

\item {} 
’gaussian’;

\item {} 
’schaer’;

\item {} 
’user\_defined’.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{topo\_time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the elapsed simulation time after which the topography
should stop increasing.

\item {} 
\sphinxstyleliteralstrong{topo\_fact} (\sphinxstyleliteralemphasis{float}) \textendash{} Topography factor. It runs in between 0 (at the beginning of the simulation) and 1 (once the simulation
has been run for \sphinxcode{topo\_time}).

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (grids.topography.Topography2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.topography.Topography2d.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xy.GridXY}]{\sphinxcrossref{\sphinxcode{GridXY}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{topo\_type} (\sphinxtitleref{str}, optional) \textendash{} 
Topography type. Either:
\begin{itemize}
\item {} 
’flat\_terrain’ (default);

\item {} 
’gaussian’;

\item {} 
’schaer’;

\item {} 
’user\_defined’.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{topo\_time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the elapsed simulation time after which the topography
should stop increasing. Default is 0, corresponding to a time-invariant terrain surface-height.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{topo\_max\_height} (\sphinxstyleliteralemphasis{float}) \textendash{} When \sphinxcode{topo\_type} is either ‘gaussian’ or ‘schaer’, maximum mountain height (in meters).
Default is 500.

\item {} 
\sphinxstyleliteralstrong{topo\_width\_x} (\sphinxstyleliteralemphasis{float}) \textendash{} When \sphinxcode{topo\_type} is either ‘gaussian’ or ‘schaer’, mountain half-width in \(x\)-direction
(in meters). Default is 10000.

\item {} 
\sphinxstyleliteralstrong{topo\_width\_y} (\sphinxstyleliteralemphasis{float}) \textendash{} When \sphinxcode{topo\_type} is either ‘gaussian’ or ‘schaer’, mountain half-width in \(y\)-direction
(in meters). Default is 10000.

\item {} 
\sphinxstyleliteralstrong{topo\_str} (\sphinxstyleliteralemphasis{str}) \textendash{} When \sphinxcode{topo\_type} is ‘user\_defined’, terrain profile expression in the independent variables
\(x\) and \(y\). Must be fully C++-compliant.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{plot() (grids.topography.Topography2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.topography.Topography2d.plot}}\pysiglinewithargsret{\sphinxbfcode{plot}}{\emph{grid}, \emph{**kwargs}}{}
Plot the topography using the \sphinxhref{https://matplotlib.org/tutorials/toolkits/mplot3d.html}{mplot3d toolkit}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xy.GridXY}]{\sphinxcrossref{\sphinxcode{GridXY}}}} representing the underlying grid.

\item[{Keyword Arguments}] \leavevmode
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to be forwarded to \sphinxhref{https://matplotlib.org/2.1.1/api/\_as\_gen/matplotlib.pyplot.figure.html\#matplotlib.pyplot.figure}{\sphinxcode{matplotlib.pyplot.figure()}}.

\end{description}\end{quote}

\end{fulllineitems}

\index{update() (grids.topography.Topography2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.topography.Topography2d.update}}\pysiglinewithargsret{\sphinxbfcode{update}}{\emph{time}}{}
Update topography at current simulation time.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the elapsed simulation time.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{Parsers}
\label{\detokenize{api:parsers}}\index{Parser1d (class in grids.parser.parser\_1d)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.parser.parser_1d.Parser1d}}\pysigline{\sphinxbfcode{class }\sphinxcode{grids.parser.parser\_1d.}\sphinxbfcode{Parser1d}}
Cython wrapper for the C++ class \sphinxcode{parser\_1d\_cpp}.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode
\sphinxstyleliteralstrong{parser} (\sphinxstyleliteralemphasis{obj}) \textendash{} Pointer to a \sphinxcode{parser\_1d\_cpp} object.

\end{description}\end{quote}
\index{evaluate() (grids.parser.parser\_1d.Parser1d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.parser.parser_1d.Parser1d.evaluate}}\pysiglinewithargsret{\sphinxbfcode{evaluate}}{}{}
Evaluate the expression.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} of the evaluations.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{Parser2d (class in grids.parser.parser\_2d)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.parser.parser_2d.Parser2d}}\pysigline{\sphinxbfcode{class }\sphinxcode{grids.parser.parser\_2d.}\sphinxbfcode{Parser2d}}
Cython wrapper for the C++ class \sphinxcode{parser\_2d\_cpp}.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode
\sphinxstyleliteralstrong{parser} (\sphinxstyleliteralemphasis{obj}) \textendash{} Pointer to a \sphinxcode{parser\_2d\_cpp} object.

\end{description}\end{quote}
\index{evaluate() (grids.parser.parser\_2d.Parser2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.parser.parser_2d.Parser2d.evaluate}}\pysiglinewithargsret{\sphinxbfcode{evaluate}}{}{}
Evaluate the expression.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} of the evaluations.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\section{Utilities}
\label{\detokenize{api:utilities}}\label{\detokenize{api:module-utils.utils}}\index{utils.utils (module)}
Some useful utilities.
\index{\_get\_prefix() (in module utils.utils)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:utils.utils._get_prefix}}\pysiglinewithargsret{\sphinxcode{utils.utils.}\sphinxbfcode{\_get\_prefix}}{\emph{units}}{}
Extract the prefix from the units name.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{units} (\sphinxstyleliteralemphasis{str}) \textendash{} The units.

\item[{Returns}] \leavevmode
The prefix.

\item[{Return type}] \leavevmode
str

\end{description}\end{quote}

\end{fulllineitems}

\index{convert\_datetime64\_to\_datetime() (in module utils.utils)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:utils.utils.convert_datetime64_to_datetime}}\pysiglinewithargsret{\sphinxcode{utils.utils.}\sphinxbfcode{convert\_datetime64\_to\_datetime}}{\emph{time}}{}
Convert \sphinxcode{numpy.datetime64} to \sphinxcode{datetime.datetime}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} The \sphinxcode{numpy.datetime64} object to convert.

\item[{Returns}] \leavevmode
The converted \sphinxcode{datetime.datetime} object.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}
\paragraph{References}

\sphinxurl{https://stackoverflow.com/questions/13703720/converting-between-datetime-timestamp-and-datetime64}.

\end{fulllineitems}

\index{equal\_to() (in module utils.utils)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:utils.utils.equal_to}}\pysiglinewithargsret{\sphinxcode{utils.utils.}\sphinxbfcode{equal\_to}}{\emph{a}, \emph{b}, \emph{tol=None}}{}
Compare floating point numbers (or arrays of floating point numbers), properly accounting for round-off errors.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{a} (\sphinxtitleref{float} or \sphinxtitleref{array\_like}) \textendash{} Left-hand side.

\item {} 
\sphinxstyleliteralstrong{b} (\sphinxtitleref{float} or \sphinxtitleref{array\_like}) \textendash{} Right-hand side.

\item {} 
\sphinxstyleliteralstrong{tol} (\sphinxtitleref{float}, optional) \textendash{} Tolerance.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{True} if \sphinxcode{a} is equal to \sphinxcode{b} up to \sphinxcode{tol}, \sphinxcode{False} otherwise.

\item[{Return type}] \leavevmode
bool

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_factor() (in module utils.utils)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:utils.utils.get_factor}}\pysiglinewithargsret{\sphinxcode{utils.utils.}\sphinxbfcode{get\_factor}}{\emph{units}}{}
Convert units prefix to the corresponding factor.
For the conversion, the \sphinxhref{http://cfconventions.org/}{CF Conventions} are used.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{units} (\sphinxstyleliteralemphasis{str}) \textendash{} The units.

\item[{Returns}] \leavevmode
The factor.

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{greater\_or\_equal\_than() (in module utils.utils)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:utils.utils.greater_or_equal_than}}\pysiglinewithargsret{\sphinxcode{utils.utils.}\sphinxbfcode{greater\_or\_equal\_than}}{\emph{a}, \emph{b}, \emph{tol=None}}{}
Compare floating point numbers (or arrays of floating point numbers), properly accounting for round-off errors.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{a} (\sphinxtitleref{float} or \sphinxtitleref{array\_like}) \textendash{} Left-hand side.

\item {} 
\sphinxstyleliteralstrong{b} (\sphinxtitleref{float} or \sphinxtitleref{array\_like}) \textendash{} Right-hand side.

\item {} 
\sphinxstyleliteralstrong{tol} (\sphinxtitleref{float}, optional) \textendash{} Tolerance.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{True} if \sphinxcode{a} is greater than or equal to \sphinxcode{b} up to \sphinxcode{tol}, \sphinxcode{False} otherwise.

\item[{Return type}] \leavevmode
bool

\end{description}\end{quote}

\end{fulllineitems}

\index{greater\_than() (in module utils.utils)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:utils.utils.greater_than}}\pysiglinewithargsret{\sphinxcode{utils.utils.}\sphinxbfcode{greater\_than}}{\emph{a}, \emph{b}, \emph{tol=None}}{}
Compare floating point numbers (or arrays of floating point numbers), properly accounting for round-off errors.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{a} (\sphinxtitleref{float} or \sphinxtitleref{array\_like}) \textendash{} Left-hand side.

\item {} 
\sphinxstyleliteralstrong{b} (\sphinxtitleref{float} or \sphinxtitleref{array\_like}) \textendash{} Right-hand side.

\item {} 
\sphinxstyleliteralstrong{tol} (\sphinxtitleref{float}, optional) \textendash{} Tolerance.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{True} if \sphinxcode{a} is greater than \sphinxcode{b} up to \sphinxcode{tol}, \sphinxcode{False} otherwise.

\item[{Return type}] \leavevmode
bool

\end{description}\end{quote}

\end{fulllineitems}

\index{set\_namelist() (in module utils.utils)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:utils.utils.set_namelist}}\pysiglinewithargsret{\sphinxcode{utils.utils.}\sphinxbfcode{set\_namelist}}{\emph{user\_namelist=None}}{}
Place the user-defined namelist module in the Python search path.
This is achieved by physically copying the content of the user-provided module into TASMANIA\_ROOT/namelist.py.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{user\_namelist} (\sphinxstyleliteralemphasis{str}) \textendash{} Path to the user-defined namelist. If not specified, the default namelist TASMANIA\_ROOT/\_namelist.py is used.

\end{description}\end{quote}

\end{fulllineitems}

\index{smaller\_or\_equal\_than() (in module utils.utils)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:utils.utils.smaller_or_equal_than}}\pysiglinewithargsret{\sphinxcode{utils.utils.}\sphinxbfcode{smaller\_or\_equal\_than}}{\emph{a}, \emph{b}, \emph{tol=None}}{}
Compare floating point numbers (or arrays of floating point numbers), properly accounting for round-off errors.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{a} (\sphinxtitleref{float} or \sphinxtitleref{array\_like}) \textendash{} Left-hand side.

\item {} 
\sphinxstyleliteralstrong{b} (\sphinxtitleref{float} or \sphinxtitleref{array\_like}) \textendash{} Right-hand side.

\item {} 
\sphinxstyleliteralstrong{tol} (\sphinxtitleref{float}, optional) \textendash{} Tolerance.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{True} if \sphinxcode{a} is smaller than or equal to \sphinxcode{b} up to \sphinxcode{tol}, \sphinxcode{False} otherwise.

\item[{Return type}] \leavevmode
bool

\end{description}\end{quote}

\end{fulllineitems}

\index{smaller\_than() (in module utils.utils)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:utils.utils.smaller_than}}\pysiglinewithargsret{\sphinxcode{utils.utils.}\sphinxbfcode{smaller\_than}}{\emph{a}, \emph{b}, \emph{tol=None}}{}
Compare floating point numbers (or arrays of floating point numbers), properly accounting for round-off errors.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{a} (\sphinxtitleref{float} or \sphinxtitleref{array\_like}) \textendash{} Left-hand side.

\item {} 
\sphinxstyleliteralstrong{b} (\sphinxtitleref{float} or \sphinxtitleref{array\_like}) \textendash{} Right-hand side.

\item {} 
\sphinxstyleliteralstrong{tol} (\sphinxtitleref{float}, optional) \textendash{} Tolerance.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{True} if \sphinxcode{a} is smaller than \sphinxcode{b} up to \sphinxcode{tol}, \sphinxcode{False} otherwise.

\item[{Return type}] \leavevmode
bool

\end{description}\end{quote}

\end{fulllineitems}



\subsection{Meteo utilities}
\label{\detokenize{api:meteo-utilities}}\label{\detokenize{api:module-utils.utils_meteo}}\index{utils.utils\_meteo (module)}
Meteo-oriented utilities.
\index{apply\_goff\_gratch\_formula() (in module utils.utils\_meteo)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:utils.utils_meteo.apply_goff_gratch_formula}}\pysiglinewithargsret{\sphinxcode{utils.utils\_meteo.}\sphinxbfcode{apply\_goff\_gratch\_formula}}{\emph{T}}{}
Compute the saturation vapor pressure over water at a given temperature, relying upon the Goff-Gratch formula.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{T} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the temperature ({[}\(K\){]}).

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the saturation water vapor pressure ({[}\(Pa\){]}).

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}
\paragraph{References}

Goff, J. A., and S. Gratch. (1946). \sphinxtitleref{Low-pressure properties of water from -160 to 212 F}.              Transactions of the American Society of Heating and Ventilating Engineers, 95-122.

\end{fulllineitems}

\index{apply\_teten\_formula() (in module utils.utils\_meteo)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:utils.utils_meteo.apply_teten_formula}}\pysiglinewithargsret{\sphinxcode{utils.utils\_meteo.}\sphinxbfcode{apply\_teten\_formula}}{\emph{T}}{}
Compute the saturation vapor pressure over water at a given temperature, relying upon the Teten’s formula.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{T} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the temperature ({[}\(K\){]}).

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the saturation water vapor pressure ({[}\(Pa\){]}).

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{convert\_relative\_humidity\_to\_water\_vapor() (in module utils.utils\_meteo)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:utils.utils_meteo.convert_relative_humidity_to_water_vapor}}\pysiglinewithargsret{\sphinxcode{utils.utils\_meteo.}\sphinxbfcode{convert\_relative\_humidity\_to\_water\_vapor}}{\emph{method}, \emph{p}, \emph{T}, \emph{rh}}{}
Convert relative humidity to water vapor mixing ratio.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{method} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the formula to be used to compute the saturation water vapor pressure. Either:
\begin{itemize}
\item {} 
’teten’, for the Teten’s formula;

\item {} 
’goff\_gratch’, for the Goff-Gratch formula.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{p} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the pressure ({[}\(Pa\){]}).

\item {} 
\sphinxstyleliteralstrong{T} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the temperature ({[}\(K\){]}).

\item {} 
\sphinxstyleliteralstrong{rh} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the relative humidity ({[}\(-\){]}).

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the fraction of water vapor ({[}\(g \, g^{-1}\){]}).

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}
\paragraph{References}

Vaisala, O. (2013). \sphinxtitleref{Humidity conversion formulas: Calculation formulas for humidity}. Retrieved from           \sphinxurl{https://www.vaisala.com}.

\end{fulllineitems}

\index{get\_isentropic\_isothermal\_analytical\_solution() (in module utils.utils\_meteo)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:utils.utils_meteo.get_isentropic_isothermal_analytical_solution}}\pysiglinewithargsret{\sphinxcode{utils.utils\_meteo.}\sphinxbfcode{get\_isentropic\_isothermal\_analytical\_solution}}{\emph{grid}, \emph{x\_velocity\_initial}, \emph{temperature}, \emph{mountain\_height}, \emph{mountain\_width}, \emph{x\_staggered=True}, \emph{z\_staggered=False}}{}
Get the analytical expression of a two-dimensional, hydrostatic, isentropic and isothermal flow over an isolated
\sphinxtitleref{Switch of Agnesi} mountain.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid. It must consist of only one points in \(y\)-direction.

\item {} 
\sphinxstyleliteralstrong{x\_velocity\_initial} (\sphinxstyleliteralemphasis{float}) \textendash{} The initial \(x\)-velocity, in units of {[}\(m \, s^{-1}\){]}.

\item {} 
\sphinxstyleliteralstrong{temperature} (\sphinxstyleliteralemphasis{float}) \textendash{} The temperature, in units of {[}\(K\){]}.

\item {} 
\sphinxstyleliteralstrong{mountain\_height} (\sphinxstyleliteralemphasis{float}) \textendash{} The maximum mountain height, in units of {[}\(m\){]}.

\item {} 
\sphinxstyleliteralstrong{mountain\_width} (\sphinxstyleliteralemphasis{float}) \textendash{} The mountain half-width at half-height, in units of {[}\(m\){]}.

\item {} 
\sphinxstyleliteralstrong{x\_staggered} (\sphinxtitleref{bool}, optional) \textendash{} \sphinxcode{True} if the solution should be staggered in the \(x\)-direction, \sphinxcode{False} otherwise.
Default is \sphinxcode{True}.

\item {} 
\sphinxstyleliteralstrong{z\_staggered} (\sphinxtitleref{bool}, optional) \textendash{} \sphinxcode{True} if the solution should be staggered in the vertical direction, \sphinxcode{False} otherwise.
Default is \sphinxcode{False}.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{u} (\sphinxstyleemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the \(x\)-velocity.

\item {} 
\sphinxstylestrong{w} (\sphinxstyleemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the vertical velocity.

\end{itemize}


\end{description}\end{quote}
\paragraph{References}

Durran, D. R. (1981). \sphinxtitleref{The effects of moisture on mountain lee waves}.          Doctoral dissertation, Massachussets Institute of Technology.

\end{fulllineitems}



\subsection{Plotting utilities}
\label{\detokenize{api:plotting-utilities}}\label{\detokenize{api:module-utils.utils_plot}}\index{utils.utils\_plot (module)}
Plotting utilities.
\index{contour\_xz() (in module utils.utils\_plot)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:utils.utils_plot.contour_xz}}\pysiglinewithargsret{\sphinxcode{utils.utils\_plot.}\sphinxbfcode{contour\_xz}}{\emph{grid}, \emph{height}, \emph{field}, \emph{**kwargs}}{}
Generate a \(xz\)-contour of a gridded field.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of \(~grids.grid_xyz.GridXYZ\) or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{height} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the height of the vertical coordinate isolines.

\item {} 
\sphinxstyleliteralstrong{field} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to plot.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{show} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the plot should be showed, \sphinxcode{False} otherwise. Default is \sphinxcode{True}.

\item {} 
\sphinxstyleliteralstrong{destination} (\sphinxstyleliteralemphasis{str}) \textendash{} String specify the path to the location where the plot will be saved. Default is \sphinxcode{None}, meaning that the plot
will not be saved. Note that the plot may be saved only if \sphinxcode{show} is set to \sphinxcode{False}.

\item {} 
\sphinxstyleliteralstrong{fontsize} (\sphinxstyleliteralemphasis{int}) \textendash{} The fontsize to be used. Default is 12.

\item {} 
\sphinxstyleliteralstrong{figsize} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the figure size. Default is {[}8,8{]}.

\item {} 
\sphinxstyleliteralstrong{title} (\sphinxstyleliteralemphasis{str}) \textendash{} The figure title. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{x\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the \(x\)-axis. Default is ‘\textless{}axis\_dimension\textgreater{} {[}\textless{}axis\_units\textgreater{}{]}’.

\item {} 
\sphinxstyleliteralstrong{x\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the \(x\)-axis. Default is 1.

\item {} 
\sphinxstyleliteralstrong{x\_lim} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the interval of the \(x\)-axis to visualize. By default, the entire domain is shown.

\item {} 
\sphinxstyleliteralstrong{z\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the \(z\)-axis. Default is ‘\textless{}axis\_dimension\textgreater{} {[}\textless{}axis\_units\textgreater{}{]}’.

\item {} 
\sphinxstyleliteralstrong{z\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the \(z\)-axis. Default is 1.

\item {} 
\sphinxstyleliteralstrong{z\_lim} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the interval of the \(z\)-axis to visualize. By default, the entire domain is shown.

\item {} 
\sphinxstyleliteralstrong{field\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the field. Default is 1.

\item {} 
\sphinxstyleliteralstrong{plot\_height} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} to plot the height of the vertical coordinate isolines, \sphinxcode{False} otherwise. Default is \sphinxcode{True}.

\item {} 
\sphinxstyleliteralstrong{text} (\sphinxstyleliteralemphasis{str}) \textendash{} Text to be added to the figure as anchored text. By default, no extra text is shown.

\item {} 
\sphinxstyleliteralstrong{text\_loc} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the location where the text box should be placed. Default is ‘upper right’;
please see \sphinxhref{https://matplotlib.org/2.1.1/api/offsetbox\_api.html\#matplotlib.offsetbox.AnchoredText}{\sphinxcode{matplotlib.offsetbox.AnchoredText}} for all the available options.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{contourf\_xy() (in module utils.utils\_plot)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:utils.utils_plot.contourf_xy}}\pysiglinewithargsret{\sphinxcode{utils.utils\_plot.}\sphinxbfcode{contourf\_xy}}{\emph{grid}, \emph{field}, \emph{**kwargs}}{}
Generate a \(xy\)-contourf of a gridded field.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of \(~grids.grid_xyz.GridXYZ\) or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{topography} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} One-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the underlying topography.

\item {} 
\sphinxstyleliteralstrong{height} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the height of the vertical coordinate isolines.

\item {} 
\sphinxstyleliteralstrong{field} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to plot.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{show} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the plot should be showed, \sphinxcode{False} otherwise. Default is \sphinxcode{True}.

\item {} 
\sphinxstyleliteralstrong{destination} (\sphinxstyleliteralemphasis{str}) \textendash{} String specify the path to the location where the plot will be saved. Default is \sphinxcode{None}, meaning that the plot
will not be saved. Note that the plot may be saved only if \sphinxcode{show} is set to \sphinxcode{False}.

\item {} 
\sphinxstyleliteralstrong{fontsize} (\sphinxstyleliteralemphasis{int}) \textendash{} The fontsize to be used. Default is 12.

\item {} 
\sphinxstyleliteralstrong{figsize} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the figure size. Default is {[}8,8{]}.

\item {} 
\sphinxstyleliteralstrong{title} (\sphinxstyleliteralemphasis{str}) \textendash{} The figure title. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{x\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the \(x\)-axis. Default is ‘\textless{}axis\_dimension\textgreater{} {[}\textless{}axis\_units\textgreater{}{]}’.

\item {} 
\sphinxstyleliteralstrong{x\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the \(x\)-axis. Default is 1.

\item {} 
\sphinxstyleliteralstrong{x\_lim} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the interval of the \(x\)-axis to visualize. By default, the entire domain is shown.

\item {} 
\sphinxstyleliteralstrong{y\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the \(y\)-axis. Default is ‘\textless{}axis\_dimension\textgreater{} {[}\textless{}axis\_units\textgreater{}{]}’.

\item {} 
\sphinxstyleliteralstrong{y\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the \(y\)-axis. Default is 1.

\item {} 
\sphinxstyleliteralstrong{y\_lim} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the interval of the \(y\)-axis to visualize. By default, the entire domain is shown.

\item {} 
\sphinxstyleliteralstrong{field\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the field. Default is 1.

\item {} 
\sphinxstyleliteralstrong{cmap\_name} (\sphinxstyleliteralemphasis{str}) \textendash{} Name of the Matplotlib’s color map to be used. All the color maps provided by Matplotlib, as well as the corresponding inverted
versions, are available.

\item {} 
\sphinxstyleliteralstrong{cbar\_levels} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of levels for the color bar. Default is 14.

\item {} 
\sphinxstyleliteralstrong{cbar\_ticks\_step} (\sphinxstyleliteralemphasis{int}) \textendash{} Distance between two consecutive labelled ticks of the color bar. Default is 1, i.e., all ticks are displayed with the
corresponding label.

\item {} 
\sphinxstyleliteralstrong{cbar\_center} (\sphinxstyleliteralemphasis{float}) \textendash{} Center of the range covered by the color bar. By default, the color bar cover the spectrum identified by the minimum
and the maximum assumed by the field.

\item {} 
\sphinxstyleliteralstrong{cbar\_half-width} (\sphinxstyleliteralemphasis{float}) \textendash{} Half-width of the range covered by the color bar. By default, the color bar cover the spectrum identified by the minimum
and the maximum assumed by the field.

\item {} 
\sphinxstyleliteralstrong{cbar\_x\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the horizontal axis of the color bar. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{cbar\_y\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the vertical axis of the color bar. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{cbar\_orientation} (\sphinxstyleliteralemphasis{str}) \textendash{} Orientation of the color bar. Either ‘vertical’ (default) or ‘horizontal’.

\item {} 
\sphinxstyleliteralstrong{text} (\sphinxstyleliteralemphasis{str}) \textendash{} Text to be added to the figure as anchored text. By default, no extra text is shown.

\item {} 
\sphinxstyleliteralstrong{text\_loc} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the location where the text box should be placed. Default is ‘upper right’;
please see \sphinxhref{https://matplotlib.org/2.1.1/api/offsetbox\_api.html\#matplotlib.offsetbox.AnchoredText}{\sphinxcode{matplotlib.offsetbox.AnchoredText}} for all the available options.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{contourf\_xz() (in module utils.utils\_plot)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:utils.utils_plot.contourf_xz}}\pysiglinewithargsret{\sphinxcode{utils.utils\_plot.}\sphinxbfcode{contourf\_xz}}{\emph{grid}, \emph{topography}, \emph{height}, \emph{field}, \emph{**kwargs}}{}
Generate a \(xz\)-contourf of a gridded field.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of \(~grids.grid_xyz.GridXYZ\) or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{topography} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} One-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the underlying topography.

\item {} 
\sphinxstyleliteralstrong{height} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the height of the vertical coordinate isolines.

\item {} 
\sphinxstyleliteralstrong{field} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to plot.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{show} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the plot should be showed, \sphinxcode{False} otherwise. Default is \sphinxcode{True}.

\item {} 
\sphinxstyleliteralstrong{destination} (\sphinxstyleliteralemphasis{str}) \textendash{} String specify the path to the location where the plot will be saved. Default is \sphinxcode{None}, meaning that the plot
will not be saved. Note that the plot may be saved only if \sphinxcode{show} is set to \sphinxcode{False}.

\item {} 
\sphinxstyleliteralstrong{fontsize} (\sphinxstyleliteralemphasis{int}) \textendash{} The fontsize to be used. Default is 12.

\item {} 
\sphinxstyleliteralstrong{figsize} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the figure size. Default is {[}8,8{]}.

\item {} 
\sphinxstyleliteralstrong{title} (\sphinxstyleliteralemphasis{str}) \textendash{} The figure title. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{x\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the \(x\)-axis. Default is ‘\textless{}axis\_dimension\textgreater{} {[}\textless{}axis\_units\textgreater{}{]}’.

\item {} 
\sphinxstyleliteralstrong{x\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the \(x\)-axis. Default is 1.

\item {} 
\sphinxstyleliteralstrong{x\_lim} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the interval of the \(x\)-axis to visualize. By default, the entire domain is shown.

\item {} 
\sphinxstyleliteralstrong{z\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the \(z\)-axis. Default is ‘\textless{}axis\_dimension\textgreater{} {[}\textless{}axis\_units\textgreater{}{]}’.

\item {} 
\sphinxstyleliteralstrong{z\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the \(z\)-axis. Default is 1.

\item {} 
\sphinxstyleliteralstrong{z\_lim} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the interval of the \(z\)-axis to visualize. By default, the entire domain is shown.

\item {} 
\sphinxstyleliteralstrong{field\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the field. Default is 1.

\item {} 
\sphinxstyleliteralstrong{plot\_height} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} to plot the height of the vertical coordinate isolines, \sphinxcode{False} otherwise. Default is \sphinxcode{True}.

\item {} 
\sphinxstyleliteralstrong{cmap\_name} (\sphinxstyleliteralemphasis{str}) \textendash{} Name of the Matplotlib’s color map to be used. All the color maps provided by Matplotlib, as well as the corresponding inverted
versions, are available.

\item {} 
\sphinxstyleliteralstrong{cbar\_levels} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of levels for the color bar. Default is 14.

\item {} 
\sphinxstyleliteralstrong{cbar\_ticks\_step} (\sphinxstyleliteralemphasis{int}) \textendash{} Distance between two consecutive labelled ticks of the color bar. Default is 1, i.e., all ticks are displayed with the
corresponding label.

\item {} 
\sphinxstyleliteralstrong{cbar\_center} (\sphinxstyleliteralemphasis{float}) \textendash{} Center of the range covered by the color bar. By default, the color bar cover the spectrum identified by the minimum
and the maximum assumed by the field.

\item {} 
\sphinxstyleliteralstrong{cbar\_half-width} (\sphinxstyleliteralemphasis{float}) \textendash{} Half-width of the range covered by the color bar. By default, the color bar cover the spectrum identified by the minimum
and the maximum assumed by the field.

\item {} 
\sphinxstyleliteralstrong{cbar\_x\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the horizontal axis of the color bar. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{cbar\_y\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the vertical axis of the color bar. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{cbar\_orientation} (\sphinxstyleliteralemphasis{str}) \textendash{} Orientation of the color bar. Either ‘vertical’ (default) or ‘horizontal’.

\item {} 
\sphinxstyleliteralstrong{text} (\sphinxstyleliteralemphasis{str}) \textendash{} Text to be added to the figure as anchored text. By default, no extra text is shown.

\item {} 
\sphinxstyleliteralstrong{text\_loc} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the location where the text box should be placed. Default is ‘upper right’;
please see \sphinxhref{https://matplotlib.org/2.1.1/api/offsetbox\_api.html\#matplotlib.offsetbox.AnchoredText}{\sphinxcode{matplotlib.offsetbox.AnchoredText}} for all the available options.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{quiver\_xy() (in module utils.utils\_plot)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:utils.utils_plot.quiver_xy}}\pysiglinewithargsret{\sphinxcode{utils.utils\_plot.}\sphinxbfcode{quiver\_xy}}{\emph{grid}, \emph{vx}, \emph{vy}, \emph{scalar=None}, \emph{**kwargs}}{}
Generate a \(xy\)-quiver plot of a gridded vectorial field.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of \(~grids.grid_xyz.GridXYZ\) or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{vx} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the \(x\)-component of the field to plot.

\item {} 
\sphinxstyleliteralstrong{vy} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the \(y\)-component of the field to plot.

\item {} 
\sphinxstyleliteralstrong{scalar} (\sphinxtitleref{array\_like}, optional) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing a scalar field associated with the vectorial field.
The arrows will be colored based on the corresponding scalar value. If not specified, the arrows will be colored
based on their magnitude.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{show} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the plot should be showed, \sphinxcode{False} otherwise. Default is \sphinxcode{True}.

\item {} 
\sphinxstyleliteralstrong{destination} (\sphinxstyleliteralemphasis{str}) \textendash{} String specify the path to the location where the plot will be saved. Default is \sphinxcode{None}, meaning that the plot
will not be saved. Note that the plot may be saved only if \sphinxcode{show} is set to \sphinxcode{False}.

\item {} 
\sphinxstyleliteralstrong{fontsize} (\sphinxstyleliteralemphasis{int}) \textendash{} The fontsize to be used. Default is 12.

\item {} 
\sphinxstyleliteralstrong{figsize} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the figure size. Default is {[}8,8{]}.

\item {} 
\sphinxstyleliteralstrong{title} (\sphinxstyleliteralemphasis{str}) \textendash{} The figure title. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{x\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the \(x\)-axis. Default is ‘\textless{}axis\_dimension\textgreater{} {[}\textless{}axis\_units\textgreater{}{]}’.

\item {} 
\sphinxstyleliteralstrong{x\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the \(x\)-axis. Default is 1.

\item {} 
\sphinxstyleliteralstrong{x\_lim} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the interval of the \(x\)-axis to visualize. By default, the entire domain is shown.

\item {} 
\sphinxstyleliteralstrong{x\_step} (\sphinxstyleliteralemphasis{int}) \textendash{} Distance between the \(x\)-indeces of any pair of plotted points consecutive in the \(x\)-direction.
Default is 2, i.e., only half of the points will be drawn.

\item {} 
\sphinxstyleliteralstrong{y\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the \(y\)-axis. Default is ‘\textless{}axis\_dimension\textgreater{} {[}\textless{}axis\_units\textgreater{}{]}’.

\item {} 
\sphinxstyleliteralstrong{y\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the \(y\)-axis. Default is 1.

\item {} 
\sphinxstyleliteralstrong{y\_lim} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the interval of the \(y\)-axis to visualize. By default, the entire domain is shown.

\item {} 
\sphinxstyleliteralstrong{y\_step} (\sphinxstyleliteralemphasis{int}) \textendash{} Distance between the \(y\)-indeces of any pair of plotted points consecutive along the \(y\)-direction.
Default is 2, i.e., only half of the points will be drawn.

\item {} 
\sphinxstyleliteralstrong{field\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the field. Default is 1.

\item {} 
\sphinxstyleliteralstrong{cmap\_name} (\sphinxstyleliteralemphasis{str}) \textendash{} Name of the Matplotlib’s color map to be used. All the color maps provided by Matplotlib, as well as the corresponding inverted
versions, are available. If not specified, no color map will be used, and the arrows will draw black.

\item {} 
\sphinxstyleliteralstrong{cbar\_levels} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of levels for the color bar. Default is 14.

\item {} 
\sphinxstyleliteralstrong{cbar\_ticks\_step} (\sphinxstyleliteralemphasis{int}) \textendash{} Distance between two consecutive labelled ticks of the color bar. Default is 1, i.e., all ticks are displayed with the
corresponding label.

\item {} 
\sphinxstyleliteralstrong{cbar\_center} (\sphinxstyleliteralemphasis{float}) \textendash{} Center of the range covered by the color bar. By default, the color bar cover the spectrum identified by the minimum
and the maximum assumed by the field.

\item {} 
\sphinxstyleliteralstrong{cbar\_half-width} (\sphinxstyleliteralemphasis{float}) \textendash{} Half-width of the range covered by the color bar. By default, the color bar cover the spectrum identified by the minimum
and the maximum assumed by the field.

\item {} 
\sphinxstyleliteralstrong{cbar\_x\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the horizontal axis of the color bar. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{cbar\_y\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the vertical axis of the color bar. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{cbar\_orientation} (\sphinxstyleliteralemphasis{str}) \textendash{} Orientation of the color bar. Either ‘vertical’ (default) or ‘horizontal’.

\item {} 
\sphinxstyleliteralstrong{text} (\sphinxstyleliteralemphasis{str}) \textendash{} Text to be added to the figure as anchored text. By default, no extra text is shown.

\item {} 
\sphinxstyleliteralstrong{text\_loc} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the location where the text box should be placed. Default is ‘upper right’;
please see \sphinxhref{https://matplotlib.org/2.1.1/api/offsetbox\_api.html\#matplotlib.offsetbox.AnchoredText}{\sphinxcode{matplotlib.offsetbox.AnchoredText}} for all the available options.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{reverse\_colormap() (in module utils.utils\_plot)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:utils.utils_plot.reverse_colormap}}\pysiglinewithargsret{\sphinxcode{utils.utils\_plot.}\sphinxbfcode{reverse\_colormap}}{\emph{cmap}, \emph{name=None}}{}
Reverse a Matplotlib colormap.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{cmap} (\sphinxstyleliteralemphasis{obj}) \textendash{} The \sphinxhref{https://matplotlib.org/2.1.1/api/\_as\_gen/matplotlib.colors.LinearSegmentedColormap.html\#matplotlib.colors.LinearSegmentedColormap}{\sphinxcode{matplotlib.colors.LinearSegmentedColormap}} to invert.

\item {} 
\sphinxstyleliteralstrong{name} (\sphinxtitleref{str}, optional) \textendash{} The name of the reversed colormap. By default, this is obtained by appending ‘\_r’ to the name of the input colormap.

\end{itemize}

\item[{Returns}] \leavevmode
The reversed \sphinxhref{https://matplotlib.org/2.1.1/api/\_as\_gen/matplotlib.colors.LinearSegmentedColormap.html\#matplotlib.colors.LinearSegmentedColormap}{\sphinxcode{matplotlib.colors.LinearSegmentedColormap}}.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}
\paragraph{References}

\sphinxurl{https://stackoverflow.com/questions/3279560/invert-colormap-in-matplotlib}.

\end{fulllineitems}



\chapter{Indices and tables}
\label{\detokenize{index:indices-and-tables}}\begin{itemize}
\item {} 
\DUrole{xref,std,std-ref}{genindex}

\item {} 
\DUrole{xref,std,std-ref}{modindex}

\item {} 
\DUrole{xref,std,std-ref}{search}

\end{itemize}


\renewcommand{\indexname}{Python Module Index}
\begin{sphinxtheindex}
\def\bigletter#1{{\Large\sffamily#1}\nopagebreak\vspace{1mm}}
\bigletter{g}
\item {\sphinxstyleindexentry{grids.topography}}\sphinxstyleindexpageref{api:\detokenize{module-grids.topography}}
\indexspace
\bigletter{n}
\item {\sphinxstyleindexentry{namelist}}\sphinxstyleindexpageref{api:\detokenize{module-namelist}}
\indexspace
\bigletter{u}
\item {\sphinxstyleindexentry{utils.utils}}\sphinxstyleindexpageref{api:\detokenize{module-utils.utils}}
\item {\sphinxstyleindexentry{utils.utils\_meteo}}\sphinxstyleindexpageref{api:\detokenize{module-utils.utils_meteo}}
\item {\sphinxstyleindexentry{utils.utils\_plot}}\sphinxstyleindexpageref{api:\detokenize{module-utils.utils_plot}}
\end{sphinxtheindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}
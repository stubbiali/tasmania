%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax

\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
 \ifdefined\DeclareUnicodeCharacterAsOptional
  \DeclareUnicodeCharacter{"00A0}{\nobreakspace}
  \DeclareUnicodeCharacter{"2500}{\sphinxunichar{2500}}
  \DeclareUnicodeCharacter{"2502}{\sphinxunichar{2502}}
  \DeclareUnicodeCharacter{"2514}{\sphinxunichar{2514}}
  \DeclareUnicodeCharacter{"251C}{\sphinxunichar{251C}}
  \DeclareUnicodeCharacter{"2572}{\textbackslash}
 \else
  \DeclareUnicodeCharacter{00A0}{\nobreakspace}
  \DeclareUnicodeCharacter{2500}{\sphinxunichar{2500}}
  \DeclareUnicodeCharacter{2502}{\sphinxunichar{2502}}
  \DeclareUnicodeCharacter{2514}{\sphinxunichar{2514}}
  \DeclareUnicodeCharacter{251C}{\sphinxunichar{251C}}
  \DeclareUnicodeCharacter{2572}{\textbackslash}
 \fi
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}
\usepackage{times}
\usepackage[Bjarne]{fncychap}
\usepackage[dontkeepoldnames]{sphinx}

\usepackage{geometry}

% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}
\addto\captionsenglish{\renewcommand{\contentsname}{Contents:}}

\addto\captionsenglish{\renewcommand{\figurename}{Fig.}}
\addto\captionsenglish{\renewcommand{\tablename}{Table}}
\addto\captionsenglish{\renewcommand{\literalblockname}{Listing}}

\addto\captionsenglish{\renewcommand{\literalblockcontinuedname}{continued from previous page}}
\addto\captionsenglish{\renewcommand{\literalblockcontinuesname}{continues on next page}}

\addto\extrasenglish{\def\pageautorefname{page}}

\setcounter{tocdepth}{1}



\title{gt4ess Documentation}
\date{May 15, 2018}
\release{0.1.0}
\author{Stefano Ubbiali}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{Release}
\makeindex

\begin{document}

\maketitle
\sphinxtableofcontents
\phantomsection\label{\detokenize{index::doc}}



\chapter{API Documentation}
\label{\detokenize{api::doc}}\label{\detokenize{api:api-documentation}}\label{\detokenize{api:welcome-to-gt4ess-s-documentation}}

\section{Axis}
\label{\detokenize{api:axis}}\index{Axis (class in grids.axis)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.axis.Axis}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{grids.axis.}\sphinxbfcode{Axis}}{\emph{coords}, \emph{dims}, \emph{attrs=None}}{}
Class representing a one-dimensional axis. The class API is designed to be similar to
that provided by \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}}.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{coords} (\sphinxstyleliteralemphasis{list}) \textendash{} One-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} storing axis coordinates, wrapped within a list.

\item {} 
\sphinxstyleliteralstrong{values} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} One-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} storing axis coordinates. This attrribute is semantically identical
to \sphinxcode{coords} and it is introduced only for the sake of compliancy with \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}}’s API.

\item {} 
\sphinxstyleliteralstrong{dims} (\sphinxstyleliteralemphasis{str}) \textendash{} Axis dimension, i.e., label.

\item {} 
\sphinxstyleliteralstrong{attrs} (\sphinxstyleliteralemphasis{dict}) \textendash{} Axis attributes, e.g., the units.

\end{itemize}

\end{description}\end{quote}
\index{\_\_getitem\_\_() (grids.axis.Axis method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.axis.Axis.__getitem__}}\pysiglinewithargsret{\sphinxbfcode{\_\_getitem\_\_}}{\emph{i}}{}
Get direct access to the coordinate vector.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{i} (\sphinxtitleref{int} or {\color{red}\bfseries{}{}`}array\_like) \textendash{} The index, or a sequence of indices.

\item[{Returns}] \leavevmode
The coordinate(s).

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_init\_\_() (grids.axis.Axis method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.axis.Axis.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{coords}, \emph{dims}, \emph{attrs=None}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{coords} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} One-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the axis values.

\item {} 
\sphinxstyleliteralstrong{dims} (\sphinxstyleliteralemphasis{str}) \textendash{} Axis label.

\item {} 
\sphinxstyleliteralstrong{attrs} (\sphinxtitleref{dict}, optional) \textendash{} 
Axis attributes. This may be used to specify, e.g., the units, which, following the
\sphinxhref{http://cfconventions.org}{CF Conventions}, may be either:
\begin{itemize}
\item {} 
’m’ (meters) or multiples, for height-based coordinates;

\item {} 
’Pa’ (Pascal) or multiples, for pressure-based coordinates;

\item {} 
’K’ (Kelvin), for temperature-based coordinates;

\item {} 
’degrees\_east’, for longitude;

\item {} 
’degrees\_north’, for latitude.

\end{itemize}


\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_check\_arguments() (grids.axis.Axis method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.axis.Axis._check_arguments}}\pysiglinewithargsret{\sphinxbfcode{\_check\_arguments}}{\emph{coords}, \emph{attr}}{}
Convert user-specified units to base units, e.g., km \textendash{}\textgreater{} m, hPa \textendash{}\textgreater{} Pa.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{coords} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} One-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the axis values.

\item {} 
\sphinxstyleliteralstrong{attrs} (\sphinxstyleliteralemphasis{dict}) \textendash{} 
Axis attributes. This may be used to specify, e.g., the units, which, following the
\sphinxhref{http://cfconventions.org}{CF Conventions}, may be either:
\begin{itemize}
\item {} 
’m’ (meters) or multiples, for height-based coordinates;

\item {} 
’Pa’ (Pascal) or multiples, for pressure-based coordinates;

\item {} 
’K’ (Kelvin), for temperature-based coordinates;

\item {} 
’degrees\_east’, for longitude;

\item {} 
’degrees\_north’, for latitude.

\end{itemize}


\end{itemize}

\item[{Returns}] \leavevmode
The axis coordinates expressed in base units.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\section{Dynamics}
\label{\detokenize{api:dynamics}}

\subsection{Diagnostics}
\label{\detokenize{api:diagnostics}}\index{DiagnosticIsentropic (class in dycore.diagnostic\_isentropic)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.diagnostic\_isentropic.}\sphinxbfcode{DiagnosticIsentropic}}{\emph{grid}, \emph{moist\_on}, \emph{backend}}{}
Class implementing the diagnostic steps of the three-dimensional moist isentropic dynamical core
using GT4Py stencils.
\index{\_\_init\_\_() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{moist\_on}, \emph{backend}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py stencils.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_clipping\_defs() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_clipping_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_clipping\_defs}}{\emph{in\_qv}, \emph{in\_qc}, \emph{in\_qr}}{}
GT4Py stencil clipping (i.e., setting to zero the negative values of) the mass fraction of each water constituent.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_qv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the diagnosed mass fraction of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_qc} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the diagnosed mass fraction of cloud water.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the diagnosed mass fraction of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_qv} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the clipped mass fraction of water vapor.

\item {} 
\sphinxstylestrong{out\_qc} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the clipped mass fraction of cloud water.

\item {} 
\sphinxstylestrong{out\_qr} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the clipped mass fraction of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_diagnosing\_air\_density\_defs() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_air_density_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_air\_density\_defs}}{\emph{in\_theta}, \emph{in\_s}, \emph{in\_h}}{}
GT4Py stencil diagnosing the density.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_theta} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the vertical half levels.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_h} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the geometric height at the half-levels.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the diagnosed density.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_diagnosing\_air\_density\_initialize() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_air_density_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_air\_density\_initialize}}{}{}
Initialize the GT4Py stencil in charge of diagnosing the density.

\end{fulllineitems}

\index{\_stencil\_diagnosing\_air\_density\_set\_inputs() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_air_density_set_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_air\_density\_set\_inputs}}{\emph{s}, \emph{h}}{}
Update the private instance attributes which serve as inputs to the GT4Py stencil which diagnoses the density.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{s} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} with shape (\sphinxcode{nx}, \sphinxcode{ny}, \sphinxcode{nz}) representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{h} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} with shape (\sphinxcode{nx}, \sphinxcode{ny}, \sphinxcode{nz+1}) representing the height of the half-levels.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_diagnosing\_air\_pressure\_defs() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_air_pressure_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_air\_pressure\_defs}}{\emph{in\_s}, \emph{in\_p}}{}
GT4Py stencil diagnosing the pressure.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_p} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the pressure.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the diagnosed pressure.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_diagnosing\_air\_pressure\_initialize() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_air_pressure_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_air\_pressure\_initialize}}{}{}
Initialize the GT4Py stencil in charge of diagnosing the pressure.

\end{fulllineitems}

\index{\_stencil\_diagnosing\_air\_pressure\_set\_inputs() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_air_pressure_set_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_air\_pressure\_set\_inputs}}{\emph{s}}{}
Update the private instance attributes which serve as inputs to the GT4Py stencil which diagnoses the pressure.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{s} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} with shape (\sphinxcode{nx}, \sphinxcode{ny}, \sphinxcode{nz}) representing the isentropic density.

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_diagnosing\_height\_defs() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_height_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_height\_defs}}{\emph{in\_theta}, \emph{in\_exn}, \emph{in\_p}, \emph{in\_h}}{}
GT4Py stencil diagnosing the geometric height of the isentropes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_theta} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the vertical half levels.

\item {} 
\sphinxstyleliteralstrong{in\_exn} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Exner function.

\item {} 
\sphinxstyleliteralstrong{in\_p} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the pressure.

\item {} 
\sphinxstyleliteralstrong{in\_h} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the geometric height of the isentropes.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the diagnosed geometric height of the isentropes.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_diagnosing\_height\_initialize() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_height_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_height\_initialize}}{}{}
Initialize the GT4Py stencil in charge of diagnosing the geometric height of the half-level isentropes.

\end{fulllineitems}

\index{\_stencil\_diagnosing\_mass\_fraction\_of\_water\_constituents\_in\_air\_defs() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_mass_fraction_of_water_constituents_in_air_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_mass\_fraction\_of\_water\_constituents\_in\_air\_defs}}{\emph{in\_s}, \emph{in\_Qv}, \emph{in\_Qc}, \emph{in\_Qr}}{}
GT4Py stencil diagnosing the mass fraction of each water constituent.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_U} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_V} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_Qv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_Qc} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of cloud water.

\item {} 
\sphinxstyleliteralstrong{in\_Qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_qv} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the diagnosed mass fraction of water vapor.

\item {} 
\sphinxstylestrong{out\_qc} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the diagnosed mass fraction of cloud water.

\item {} 
\sphinxstylestrong{out\_qr} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the diagnosed mass fraction of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_diagnosing\_mass\_fraction\_of\_water\_constituents\_in\_air\_initialize() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_mass_fraction_of_water_constituents_in_air_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_mass\_fraction\_of\_water\_constituents\_in\_air\_initialize}}{}{}
Initialize the GT4Py stencil in charge of diagnosing the mass fraction of each water constituent.

\end{fulllineitems}

\index{\_stencil\_diagnosing\_mass\_fraction\_of\_water\_constituents\_in\_air\_set\_inputs() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_mass_fraction_of_water_constituents_in_air_set_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_mass\_fraction\_of\_water\_constituents\_in\_air\_set\_inputs}}{\emph{s}, \emph{Qv}, \emph{Qc}, \emph{Qr}}{}
Update the private instance attributes which serve as inputs to the GT4Py stencil which diagnose
the mass fraction of each water constituent.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{s} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} with shape (\sphinxcode{nx}, \sphinxcode{ny}, \sphinxcode{nz}) representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{Qv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{Qc} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of cloud water.

\item {} 
\sphinxstyleliteralstrong{Qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of precipitation water.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_diagnosing\_montgomery\_defs() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_montgomery_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_montgomery\_defs}}{\emph{in\_exn}, \emph{in\_mtg}}{}
GT4Py stencil diagnosing the Exner function.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_exn} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Exner function.

\item {} 
\sphinxstyleliteralstrong{in\_mtg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the diagnosed Montgomery potential.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_diagnosing\_montgomery\_initialize() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_montgomery_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_montgomery\_initialize}}{}{}
Initialize the GT4Py stencil in charge of diagnosing the Montgomery potential.

\end{fulllineitems}

\index{\_stencil\_diagnosing\_velocity\_x\_defs() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_velocity_x_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_velocity\_x\_defs}}{\emph{in\_s}, \emph{in\_U}}{}
GT4Py stencil diagnosing the \(x\)-component of the velocity.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_U} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-momentum.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the diagnosed \(x\)-velocity.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_diagnosing\_velocity\_x\_initialize() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_velocity_x_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_velocity\_x\_initialize}}{}{}
Initialize the GT4Py stencil in charge of diagnosing the \(x\)-component of the velocity.

\end{fulllineitems}

\index{\_stencil\_diagnosing\_velocity\_y\_defs() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_velocity_y_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_velocity\_y\_defs}}{\emph{in\_s}, \emph{in\_V}}{}
GT4Py stencil diagnosing the \(y\)-component of the velocity.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_V} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-momentum.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the diagnosed \(y\)-velocity.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_diagnosing\_velocity\_y\_initialize() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_velocity_y_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_velocity\_y\_initialize}}{}{}
Initialize the GT4Py stencil in charge of diagnosing the \(y\)-component of the velocity.

\end{fulllineitems}

\index{\_stencil\_diagnosing\_water\_constituents\_isentropic\_density\_defs() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_water_constituents_isentropic_density_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_water\_constituents\_isentropic\_density\_defs}}{\emph{in\_s}, \emph{in\_qv}, \emph{in\_qc}, \emph{in\_qr}}{}
GT4Py stencil diagnosing the isentropic density of each water constituent, i.e.,
\(Q_v\), \(Q_c\) and \(Q_r\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_qv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_qc} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of cloud water.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_Qv} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the diagnosed \(Qv\).

\item {} 
\sphinxstylestrong{out\_Qc} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the diagnosed \(Qc\).

\item {} 
\sphinxstylestrong{out\_Qr} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the diagnosed \(Qr\).

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_diagnosing\_water\_constituents\_isentropic\_density\_initialize() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_water_constituents_isentropic_density_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_water\_constituents\_isentropic\_density\_initialize}}{}{}
Initialize the GT4Py stencil in charge of diagnosing the isentropic density of each water constituent.

\end{fulllineitems}

\index{\_stencil\_diagnosing\_water\_constituents\_isentropic\_density\_set\_inputs() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencil_diagnosing_water_constituents_isentropic_density_set_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_diagnosing\_water\_constituents\_isentropic\_density\_set\_inputs}}{\emph{s}, \emph{qv}, \emph{qc}, \emph{qr}}{}
Update the private instance attributes which serve as inputs to the GT4Py stencil which diagnoses
the isentropic density of each water constituent.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{s} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} with shape (\sphinxcode{nx}, \sphinxcode{ny}, \sphinxcode{nz}) representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{qv} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} with shape (\sphinxcode{nx}, \sphinxcode{ny}, \sphinxcode{nz}) representing the mass fraction of
water vapor.

\item {} 
\sphinxstyleliteralstrong{qc} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} with shape (\sphinxcode{nx}, \sphinxcode{ny}, \sphinxcode{nz}) representing the mass fraction of
cloud water.

\item {} 
\sphinxstyleliteralstrong{qr} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} with shape (\sphinxcode{nx}, \sphinxcode{ny}, \sphinxcode{nz}) representing the mass fraction of
precipitation water.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencils\_diagnosing\_velocity\_set\_inputs() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic._stencils_diagnosing_velocity_set_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencils\_diagnosing\_velocity\_set\_inputs}}{\emph{s}, \emph{U}, \emph{V}}{}
Update the private instance attributes which serve as inputs to the GT4Py stencils which diagnose
the velocity components.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{s} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} with shape (\sphinxcode{nx}, \sphinxcode{ny}, \sphinxcode{nz}) representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{U} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} with shape (\sphinxcode{nx}, \sphinxcode{ny}, \sphinxcode{nz}) representing the \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{V} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} with shape (\sphinxcode{nx}, \sphinxcode{ny}, \sphinxcode{nz}) representing the \(y\)-velocity.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{diagnostic (dycore.diagnostic\_isentropic.DiagnosticIsentropic attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic.diagnostic}}\pysigline{\sphinxbfcode{diagnostic}}
Get the attribute implementing the diagnostic step of the three-dimensional moist isentropic dynamical core.
If this is set to \sphinxcode{None}, a \sphinxcode{ValueError} is thrown.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
{\hyperref[\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic}]{\sphinxcrossref{\sphinxcode{DiagnosticIsentropic}}}} carrying out the diagnostic step of the
three-dimensional moist isentropic dynamical core.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_air\_density() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic.get_air_density}}\pysiglinewithargsret{\sphinxbfcode{get\_air\_density}}{\emph{state}}{}
Diagnosis of the density.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes containing the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
height or height\_on\_interface\_levels (\(z\)-staggered).

\end{itemize}


\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} collecting the diagnosed variables, namely:
\begin{itemize}
\item {} 
air\_density (unstaggered).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_air\_temperature() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic.get_air_temperature}}\pysiglinewithargsret{\sphinxbfcode{get\_air\_temperature}}{\emph{state}}{}
Diagnosis of the temperature.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes containing the following variables:
\begin{itemize}
\item {} 
exner\_function or exner\_function\_on\_interface\_levels (\(z\)-staggered).

\end{itemize}


\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} collecting the diagnosed variables, namely:
\begin{itemize}
\item {} 
air\_temperature (unstaggered).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_diagnostic\_variables() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic.get_diagnostic_variables}}\pysiglinewithargsret{\sphinxbfcode{get\_diagnostic\_variables}}{\emph{state}, \emph{pt}}{}
Diagnosis of the pressure, the Exner function, the Montgomery potential, and the geometric height of the half-levels.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes containing the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{pt} (\sphinxstyleliteralemphasis{float}) \textendash{} Pressure value at the top of the domain.

\end{itemize}

\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} collecting the diagnosed variables, namely:
\begin{itemize}
\item {} 
air\_pressure\_on\_interface\_levels (\(z\)-staggered);

\item {} 
exner\_function\_on\_interface\_levels (\(z\)-staggered);

\item {} 
montgomery\_potential (unstaggered);

\item {} 
height\_on\_interface\_levels (\(z\)-staggered).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_height() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic.get_height}}\pysiglinewithargsret{\sphinxbfcode{get\_height}}{\emph{state}, \emph{pt}}{}
Diagnosis of the geometric height of the half-levels.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes containing the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{pt} (\sphinxstyleliteralemphasis{float}) \textendash{} Pressure value at the top of the domain.

\end{itemize}

\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} collecting the diagnosed variables, namely:
\begin{itemize}
\item {} 
height\_on\_interface\_levels (\(z\)-staggered).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_mass\_fraction\_of\_water\_constituents\_in\_air() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic.get_mass_fraction_of_water_constituents_in_air}}\pysiglinewithargsret{\sphinxbfcode{get\_mass\_fraction\_of\_water\_constituents\_in\_air}}{\emph{state}}{}
Diagnosis of the mass fraction of each water constituents, i.e., \(q_v\), \(q_c\) and \(q_r\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes containing the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
water\_vapor\_isentropic\_density (unstaggered);

\item {} 
cloud\_liquid\_water\_isentropic\_density (unstaggered);

\item {} 
precipitation\_water\_isentropic\_density (unstaggered).

\end{itemize}


\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} collecting the diagnosed variables, namely:
\begin{itemize}
\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_velocity\_components() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic.get_velocity_components}}\pysiglinewithargsret{\sphinxbfcode{get\_velocity\_components}}{\emph{state}, \emph{state\_old=None}}{}
Diagnosis of the velocity components \(u\) and \(v\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes containing the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{state\_old} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes containing the following variables,
defined at the previous time level:
\begin{itemize}
\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
y\_velocity (\(y\)-staggered).

\end{itemize}


\end{itemize}

\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} collecting the diagnosed variables, namely:
\begin{itemize}
\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
y\_velocity (\(y\)-staggered).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The first and last rows (respectively, columns) of the staggered \(x\)-velocity (resp., \(y\)-velocity)
are set only if the state at the previous time level is provided.
\end{sphinxadmonition}

\end{fulllineitems}

\index{get\_water\_constituents\_isentropic\_density() (dycore.diagnostic\_isentropic.DiagnosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic.get_water_constituents_isentropic_density}}\pysiglinewithargsret{\sphinxbfcode{get\_water\_constituents\_isentropic\_density}}{\emph{state}}{}
Diagnosis of the isentropic density of each water constituent, i.e., \(Q_v\), \(Q_c\) and \(Q_v\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes containing the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}


\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} collecting the diagnosed variables, namely:
\begin{itemize}
\item {} 
water\_vapor\_isentropic\_density (unstaggered);

\item {} 
cloud\_liquid\_water\_isentropic\_density (unstaggered);

\item {} 
precipitation\_water\_isentropic\_density (unstaggered).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{Dynamical cores}
\label{\detokenize{api:dynamical-cores}}\index{DynamicalCore (class in dycore.dycore)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore.DynamicalCore}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.dycore.}\sphinxbfcode{DynamicalCore}}{\emph{grid}, \emph{moist\_on}}{}
Abstract base class whose derived classes implement different dynamical cores.
The class inherits \sphinxcode{sympl.TimeStepper}.
\index{\_\_call\_\_() (dycore.dycore.DynamicalCore method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore.DynamicalCore.__call__}}\pysiglinewithargsret{\sphinxbfcode{\_\_call\_\_}}{\emph{dt}, \emph{state}, \emph{tendencies=None}, \emph{diagnostics=None}}{}
Call operator advancing the input state one step forward.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} object representing the time step.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} The current state, as an instance of {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{tendencies} (\sphinxtitleref{obj}, optional) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing tendencies. Default is \sphinxcode{None}.

\item {} 
\sphinxstyleliteralstrong{diagnostics} (\sphinxtitleref{obj}, optional) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing diagnostics. Default is \sphinxcode{None}.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{state\_new} (\sphinxstyleemphasis{obj}) \textendash{} The state at the next time level. This is of the same class of \sphinxcode{state}.

\item {} 
\sphinxstylestrong{diagnostics\_out} (\sphinxstyleemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing output diagnostics.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_init\_\_() (dycore.dycore.DynamicalCore method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore.DynamicalCore.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{moist\_on}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{factory() (dycore.dycore.DynamicalCore static method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore.DynamicalCore.factory}}\pysiglinewithargsret{\sphinxbfcode{static }\sphinxbfcode{factory}}{\emph{model}, \emph{*args}, \emph{**kwargs}}{}
Static method returning an instance of the derived class implementing the dynamical core specified by \sphinxcode{model}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{model} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the dynamical core to implement. Either:
\begin{itemize}
\item {} \begin{description}
\item[{’isentropic\_conservative’, for the isentropic dynamical core based on the conservative form of}] \leavevmode
the governing equations;

\end{description}

\item {} \begin{description}
\item[{’isentropic\_nonconservative’, for the isentropic dynamical core based on the nonconservative form of}] \leavevmode
the governing equations.

\end{description}

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{*args} \textendash{} Positional arguments to forward to the derived class.

\item {} 
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to forward to the derived class.

\end{itemize}

\item[{Returns}] \leavevmode
Instance of the derived class implementing the specified model.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{fast\_tendency\_parameterizations (dycore.dycore.DynamicalCore attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore.DynamicalCore.fast_tendency_parameterizations}}\pysigline{\sphinxbfcode{fast\_tendency\_parameterizations}}
Get the list of parameterizations calculating fast-varying tendencies.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
List containing instances of derived classes of
\sphinxcode{FastTendency} which are in charge of
calculating fast-varying tendencies.

\item[{Return type}] \leavevmode
list

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_initial\_state() (dycore.dycore.DynamicalCore method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore.DynamicalCore.get_initial_state}}\pysiglinewithargsret{\sphinxbfcode{get\_initial\_state}}{\emph{*args}}{}
Get the initial state.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{*args} \textendash{} The arguments depend on the specific dynamical core which the derived class implements.

\item[{Returns}] \leavevmode
The initial state, as an instance of {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{microphysics (dycore.dycore.DynamicalCore attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore.DynamicalCore.microphysics}}\pysigline{\sphinxbfcode{microphysics}}
Get the attribute in charge of calculating the raindrop fall velocity.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
Instance of a derived class of either
\sphinxcode{SlowTendencyMicrophysics},
\sphinxcode{FastTendencyMicrophysics},
or \sphinxcode{AdjustmentMicrophysics} in
charge of calculating the raindrop fall velocity.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{time\_levels (dycore.dycore.DynamicalCore attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore.DynamicalCore.time_levels}}\pysigline{\sphinxbfcode{time\_levels}}
Get the number of time leves the dynamical core relies on.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
The number of time levels needed by the dynamical core.

\item[{Return type}] \leavevmode
int

\end{description}\end{quote}

\end{fulllineitems}

\index{update\_topography() (dycore.dycore.DynamicalCore method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore.DynamicalCore.update_topography}}\pysiglinewithargsret{\sphinxbfcode{update\_topography}}{\emph{time}}{}
Update the underlying (time-dependent) topography.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the elapsed simulation time.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{DynamicalCoreIsentropic (class in dycore.dycore\_isentropic)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore_isentropic.DynamicalCoreIsentropic}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.dycore\_isentropic.}\sphinxbfcode{DynamicalCoreIsentropic}}{\emph{time\_scheme}, \emph{flux\_scheme}, \emph{horizontal\_boundary\_type}, \emph{grid}, \emph{moist\_on}, \emph{backend}, \emph{damp\_on=True}, \emph{damp\_type='rayleigh'}, \emph{damp\_depth=15}, \emph{damp\_max=0.0002}, \emph{smooth\_on=True}, \emph{smooth\_type='first\_order'}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.24}, \emph{smooth\_moist\_on=False}, \emph{smooth\_moist\_type='first\_order'}, \emph{smooth\_moist\_damp\_depth=10}, \emph{smooth\_moist\_coeff=0.03}, \emph{smooth\_moist\_coeff\_max=0.24}, \emph{physics\_dynamics\_coupling\_on=False}, \emph{sedimentation\_on=False}, \emph{sedimentation\_flux\_type='first\_order\_upwind'}, \emph{sedimentation\_substeps=2}}{}
This class inherits \sphinxcode{DynamicalCore} to implement the three-dimensional
(moist) isentropic dynamical core relying upon GT4Py stencils. The class offers different numerical
schemes to carry out the prognostic step of the dynamical core, and supports different types of
lateral boundary conditions. The conservative form of the governing equations is used.
\index{\_\_call\_\_() (dycore.dycore\_isentropic.DynamicalCoreIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore_isentropic.DynamicalCoreIsentropic.__call__}}\pysiglinewithargsret{\sphinxbfcode{\_\_call\_\_}}{\emph{dt}, \emph{state}, \emph{tendencies=None}, \emph{diagnostics=None}}{}
Call operator advancing the state variables one step forward.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
air\_pressure or air\_pressure\_on\_interface\_levels (\(z\)-staggered);

\item {} 
montgomery\_potential (unstaggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{tendencies} (\sphinxtitleref{obj}, optional) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing tendencies, namely:
\begin{itemize}
\item {} 
tendency\_of\_air\_potential\_temperature (unstaggered);

\item {} 
tendency\_of\_mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered);

\item {} 
tendency\_of\_mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
tendency\_of\_mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}

Default is obj:\sphinxtitleref{None}.


\item {} 
\sphinxstyleliteralstrong{diagnostics} (\sphinxtitleref{obj}, optional) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing diagnostics, namely:
\begin{itemize}
\item {} 
accumulated\_precipitation (unstaggered).

\end{itemize}

Default is \sphinxcode{None}.


\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{state\_new} (\sphinxstyleemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the state at the next time level.
It contains the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
air\_pressure\_on\_interface\_levels (\(z\)-staggered);

\item {} 
exner\_function\_on\_interface\_levels (\(z\)-staggered);

\item {} 
montgomery\_potential (unstaggered);

\item {} 
height\_on\_interface\_levels (\(z\)-staggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered);

\item {} 
air\_density (unstaggered, only if cloud microphysics is switched on);

\item {} 
air\_temperature (unstaggered, only if cloud microphysics is switched on).

\end{itemize}

\item {} 
\sphinxstylestrong{diagnostics\_out} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{GridData} storing output diagnostics, namely:
\begin{itemize}
\item {} 
precipitation (unstaggered, only if rain sedimentation is switched on);

\item {} 
accumulated\_precipitation (unstaggered, only if rain sedimentation is switched on);

\end{itemize}

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_init\_\_() (dycore.dycore\_isentropic.DynamicalCoreIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore_isentropic.DynamicalCoreIsentropic.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{time\_scheme}, \emph{flux\_scheme}, \emph{horizontal\_boundary\_type}, \emph{grid}, \emph{moist\_on}, \emph{backend}, \emph{damp\_on=True}, \emph{damp\_type='rayleigh'}, \emph{damp\_depth=15}, \emph{damp\_max=0.0002}, \emph{smooth\_on=True}, \emph{smooth\_type='first\_order'}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.24}, \emph{smooth\_moist\_on=False}, \emph{smooth\_moist\_type='first\_order'}, \emph{smooth\_moist\_damp\_depth=10}, \emph{smooth\_moist\_coeff=0.03}, \emph{smooth\_moist\_coeff\_max=0.24}, \emph{physics\_dynamics\_coupling\_on=False}, \emph{sedimentation\_on=False}, \emph{sedimentation\_flux\_type='first\_order\_upwind'}, \emph{sedimentation\_substeps=2}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{time\_scheme} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the time stepping method to implement.
See \sphinxcode{PrognosticIsentropic} for the available options.

\item {} 
\sphinxstyleliteralstrong{flux\_scheme} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the numerical flux to use.
See \sphinxcode{FluxIsentropic} for the available options.

\item {} 
\sphinxstyleliteralstrong{horizontal\_boundary\_type} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the horizontal boundary conditions.
See \sphinxcode{HorizontalBoundary} for the available options.

\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py stencils implementing the dynamical core.

\item {} 
\sphinxstyleliteralstrong{damp\_on} (\sphinxtitleref{bool}, optional) \textendash{} \sphinxcode{True} if vertical damping is enabled, \sphinxcode{False} otherwise. Default is \sphinxcode{True}.

\item {} 
\sphinxstyleliteralstrong{damp\_type} (\sphinxtitleref{str}, optional) \textendash{} String specifying the type of vertical damping to apply. Default is ‘rayleigh’.
See \sphinxcode{VerticalDamping} for the available options.

\item {} 
\sphinxstyleliteralstrong{damp\_depth} (\sphinxtitleref{int}, optional) \textendash{} Number of vertical layers in the damping region. Default is 15.

\item {} 
\sphinxstyleliteralstrong{damp\_max} (\sphinxtitleref{float}, optional) \textendash{} Maximum value for the damping coefficient. Default is 0.0002.

\item {} 
\sphinxstyleliteralstrong{smooth\_on} (\sphinxtitleref{bool}, optional) \textendash{} \sphinxcode{True} if numerical smoothing is enabled, \sphinxcode{False} otherwise. Default is \sphinxcode{True}.

\item {} 
\sphinxstyleliteralstrong{smooth\_type} (\sphinxtitleref{str}, optional) \textendash{} String specifying the smoothing technique to implement. Default is ‘first-order’.
See \sphinxcode{HorizontalSmoothing} for the available options.

\item {} 
\sphinxstyleliteralstrong{smooth\_damp\_depth} (\sphinxtitleref{int}, optional) \textendash{} Number of vertical layers in the smoothing damping region. Default is 10.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff} (\sphinxtitleref{float}, optional) \textendash{} Smoothing coefficient. Default is 0.03.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff\_max} (\sphinxtitleref{float}, optional) \textendash{} Maximum value for the smoothing coefficient. Default is 0.24.
See \sphinxcode{HorizontalSmoothing} for further details.

\item {} 
\sphinxstyleliteralstrong{smooth\_moist\_on} (\sphinxtitleref{bool}, optional) \textendash{} \sphinxcode{True} if numerical smoothing on water constituents is enabled, \sphinxcode{False} otherwise.
Default is \sphinxcode{True}.

\item {} 
\sphinxstyleliteralstrong{smooth\_moist\_type} (\sphinxtitleref{str}, optional) \textendash{} String specifying the smoothing technique to apply to the water constituents. Default is ‘first-order’.
See \sphinxcode{HorizontalSmoothing} for the available options.

\item {} 
\sphinxstyleliteralstrong{smooth\_moist\_damp\_depth} (\sphinxtitleref{int}, optional) \textendash{} Number of vertical layers in the smoothing damping region for the water constituents. Default is 10.

\item {} 
\sphinxstyleliteralstrong{smooth\_moist\_coeff} (\sphinxtitleref{float}, optional) \textendash{} Smoothing coefficient for the water constituents. Default is 0.03.

\item {} 
\sphinxstyleliteralstrong{smooth\_moist\_coeff\_max} (\sphinxtitleref{float}, optional) \textendash{} Maximum value for the smoothing coefficient for the water constituents. Default is 0.24.
See \sphinxcode{HorizontalSmoothing} for further details.

\item {} 
\sphinxstyleliteralstrong{physics\_dynamics\_coupling\_on} (\sphinxtitleref{bool}, optional) \textendash{} \sphinxcode{True} to couple physics with dynamics, i.e., to account for the change over time in potential
temperature, \sphinxcode{False} otherwise. Default is \sphinxcode{False}.

\item {} 
\sphinxstyleliteralstrong{sedimentation\_on} (\sphinxtitleref{bool}, optional) \textendash{} \sphinxcode{True} to account for rain sedimentation, \sphinxcode{False} otherwise. Default is \sphinxcode{False}.

\item {} 
\sphinxstyleliteralstrong{sedimentation\_flux\_type} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the method used to compute the numerical sedimentation flux. Available options are:
\begin{itemize}
\item {} 
’first\_order\_upwind’, for the first-order upwind scheme;

\item {} 
’second\_order\_upwind’, for the second-order upwind scheme.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{sedimentation\_substeps} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of sub-timesteps to perform in order to integrate the sedimentation flux.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_step\_dry() (dycore.dycore\_isentropic.DynamicalCoreIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore_isentropic.DynamicalCoreIsentropic._step_dry}}\pysiglinewithargsret{\sphinxbfcode{\_step\_dry}}{\emph{dt}, \emph{state}, \emph{tendencies}, \emph{diagnostics}}{}
Method advancing the dry isentropic state by a single time step.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
air\_pressure or air\_pressure\_on\_interface\_levels (\(z\)-staggered);

\item {} 
montgomery\_potential (unstaggered);

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{tendencies} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing tendencies.
For the time being, this is not used.

\item {} 
\sphinxstyleliteralstrong{diagnostics} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing diagnostics.
For the time being, this is not used.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{state\_new} (\sphinxstyleemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the state at the next time level.
It contains the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
air\_pressure\_on\_interface\_levels (\(z\)-staggered);

\item {} 
exner\_function\_on\_interface\_levels (\(z\)-staggered);

\item {} 
montgomery\_potential (unstaggered);

\item {} 
height\_on\_interface\_levels (\(z\)-staggered).

\end{itemize}

\item {} 
\sphinxstylestrong{diagnostics\_out} (\sphinxstyleemphasis{obj}) \textendash{} Empty \sphinxcode{GridData}, as no diagnostics are computed.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_step\_moist() (dycore.dycore\_isentropic.DynamicalCoreIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore_isentropic.DynamicalCoreIsentropic._step_moist}}\pysiglinewithargsret{\sphinxbfcode{\_step\_moist}}{\emph{dt}, \emph{state}, \emph{tendencies}, \emph{diagnostics}}{}
Method advancing the moist isentropic state by a single time step.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
air\_pressure or air\_pressure\_on\_interface\_levels (\(z\)-staggered);

\item {} 
montgomery\_potential (unstaggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{tendencies} (\sphinxtitleref{obj}, optional) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing tendencies, namely:
\begin{itemize}
\item {} 
tendency\_of\_air\_potential\_temperature (unstaggered);

\item {} 
tendency\_of\_mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered);

\item {} 
tendency\_of\_mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
tendency\_of\_mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}

Default is obj:\sphinxtitleref{None}.


\item {} 
\sphinxstyleliteralstrong{diagnostics} (\sphinxtitleref{obj}, optional) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing diagnostics, namely:
\begin{itemize}
\item {} 
accumulated\_precipitation (unstaggered).

\end{itemize}

Default is \sphinxcode{None}.


\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{state\_new} (\sphinxstyleemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the state at the next time level.
It contains the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
air\_pressure\_on\_interface\_levels (\(z\)-staggered);

\item {} 
exner\_function\_on\_interface\_levels (\(z\)-staggered);

\item {} 
montgomery\_potential (unstaggered);

\item {} 
height\_on\_interface\_levels (\(z\)-staggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered);

\item {} 
air\_density (unstaggered, only if cloud microphysics is switched on);

\item {} 
air\_temperature (unstaggered, only if cloud microphysics is switched on).

\end{itemize}

\item {} 
\sphinxstylestrong{diagnostics\_out} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{GridData} collecting output diagnostics, namely:
\begin{itemize}
\item {} 
precipitation (unstaggered, only if rain sedimentation is switched on);

\item {} 
accumulated\_precipitation (unstaggered, only if rain sedimentation is switched on).

\end{itemize}

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{fast\_tendency\_parameterizations (dycore.dycore\_isentropic.DynamicalCoreIsentropic attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore_isentropic.DynamicalCoreIsentropic.fast_tendency_parameterizations}}\pysigline{\sphinxbfcode{fast\_tendency\_parameterizations}}
Get the list of parameterizations calculating fast-varying tendencies.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
List containing instances of derived classes of
\sphinxcode{FastTendency} which are in charge of
calculating fast-varying tendencies.

\item[{Return type}] \leavevmode
list

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_initial\_state() (dycore.dycore\_isentropic.DynamicalCoreIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore_isentropic.DynamicalCoreIsentropic.get_initial_state}}\pysiglinewithargsret{\sphinxbfcode{get\_initial\_state}}{\emph{initial\_time}, \emph{initial\_state\_type}, \emph{**kwargs}}{}
Get the initial state, based on the identifier \sphinxcode{initial\_state\_type}. Particularly:
\begin{itemize}
\item {} 
if \sphinxcode{initial\_state\_type == 0}:
\begin{itemize}
\item {} 
\(u(x, \, y, \, \theta, \, 0) = u_0\) and \(v(x, \, y, \, \theta, \, 0) = v_0\);

\item {} 
the Exner function, the pressure, the Montgomery potential, the height of the isentropes,                             and the isentropic density are derived from the Brunt-Vaisala frequency \(N\);

\item {} 
the mass fraction of water vapor is derived from the relative humidity, which is horizontally uniform                                 and different from zero only in a band close to the surface;

\item {} 
the mass fraction of cloud water and precipitation water is zero;

\end{itemize}

\item {} 
if \sphinxcode{initial\_state\_type == 1}:
\begin{itemize}
\item {} 
\(u(x, \, y, \, \theta, \, 0) = u_0\) and \(v(x, \, y, \, \theta, \, 0) = v_0\);

\item {} 
the Exner function, the pressure, the Montgomery potential, the height of the isentropes,                             and the isentropic density are derived from the Brunt-Vaisala frequency \(N\);

\item {} 
the mass fraction of water vapor is derived from the relative humidity, which is sinusoidal in the                            \(x\)-direction and uniform in the \(y\)-direction, and different from zero only in a band                              close to the surface;

\item {} 
the mass fraction of cloud water and precipitation water is zero.

\end{itemize}

\item {} 
if \sphinxcode{initial\_state\_type == 2}:
\begin{itemize}
\item {} 
\(u(x, \, y, \, \theta, \, 0) = u_0\) and \(v(x, \, y, \, \theta, \, 0) = v_0\);

\item {} 
\(T(x, \, y, \, \theta, \, 0) = T_0\).

\end{itemize}

\end{itemize}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{initial\_time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.datetime} representing the initial simulation time.

\item {} 
\sphinxstyleliteralstrong{case} (\sphinxstyleliteralemphasis{int}) \textendash{} Identifier.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{x\_velocity\_initial} (\sphinxstyleliteralemphasis{float}) \textendash{} The initial, uniform \(x\)-velocity \(u_0\). Default is \(10 m s^{-1}\).

\item {} 
\sphinxstyleliteralstrong{y\_velocity\_initial} (\sphinxstyleliteralemphasis{float}) \textendash{} The initial, uniform \(y\)-velocity \(v_0\). Default is \(0 m s^{-1}\).

\item {} 
\sphinxstyleliteralstrong{brunt\_vaisala\_initial} (\sphinxstyleliteralemphasis{float}) \textendash{} If \sphinxcode{initial\_state\_type == 0}, the uniform Brunt-Vaisala frequence \(N\). Default is \(0.01\).

\item {} 
\sphinxstyleliteralstrong{temperature\_initial} (\sphinxstyleliteralemphasis{float}) \textendash{} If \sphinxcode{initial\_state\_type == 1}, the uniform initial temperature \(T_0\). Default is \(250 K\).

\end{itemize}

\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the initial state.
It contains the following variables:
\begin{itemize}
\item {} 
air\_density (unstaggered);

\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
air\_pressure\_on\_interface\_levels (\(z\)-staggered);

\item {} 
exner\_function\_on\_interface\_levels (\(z\)-staggered);

\item {} 
montgomery\_potential (unstaggered);

\item {} 
height\_on\_interface\_levels (\(z\)-staggered);

\item {} 
air\_temperature (unstaggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{microphysics (dycore.dycore\_isentropic.DynamicalCoreIsentropic attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore_isentropic.DynamicalCoreIsentropic.microphysics}}\pysigline{\sphinxbfcode{microphysics}}
Get the attribute in charge of calculating the raindrop fall velocity.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
Instance of a derived class of either
\sphinxcode{SlowTendencyMicrophysics},
\sphinxcode{FastTendencyMicrophysics},
or \sphinxcode{AdjustmentMicrophysics} in
charge of calculating the raindrop fall velocity.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{time\_levels (dycore.dycore\_isentropic.DynamicalCoreIsentropic attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.dycore_isentropic.DynamicalCoreIsentropic.time_levels}}\pysigline{\sphinxbfcode{time\_levels}}
Get the number of time leves the dynamical core relies on.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
The number of time levels needed by the dynamical core.

\item[{Return type}] \leavevmode
int

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{Lateral boundary conditions}
\label{\detokenize{api:lateral-boundary-conditions}}\index{HorizontalBoundary (class in dycore.horizontal\_boundary)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.HorizontalBoundary}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_boundary.}\sphinxbfcode{HorizontalBoundary}}{\emph{grid}, \emph{nb}}{}
Abstract base class whose derived classes implement different types of horizontal boundary conditions.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{GridXYZ} or one of its derived classes representing the underlying grid.

\item {} 
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.nb}]{\sphinxcrossref{\sphinxstyleliteralstrong{nb}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.horizontal\_boundary.HorizontalBoundary method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.HorizontalBoundary.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{nb}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{nb} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.horizontal\_boundary.HorizontalBoundary method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.HorizontalBoundary.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{phi\_new}, \emph{phi\_now}}{}
Apply the boundary conditions on the field \sphinxcode{phi\_new}, possibly relying upon the solution
\sphinxcode{phi\_now} at the current time.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{factory() (dycore.horizontal\_boundary.HorizontalBoundary static method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.HorizontalBoundary.factory}}\pysiglinewithargsret{\sphinxbfcode{static }\sphinxbfcode{factory}}{\emph{horizontal\_boundary\_type}, \emph{grid}, \emph{nb}}{}
Static method which returns an instance of the derived class which implements the boundary
conditions specified by \sphinxcode{horizontal\_boundary\_type}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{horizontal\_boundary\_type} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the type of boundary conditions to apply. Either:
\begin{itemize}
\item {} 
’periodic’, for periodic boundary conditions;

\item {} 
’relaxed’, for relaxed boundary conditions;

\item {} 
’relaxed\_symmetric\_xz’, for relaxed boundary conditions for a \(xz\)-symmetric field.

\item {} 
’relaxed\_symmetric\_yz’, for relaxed boundary conditions for a \(yz\)-symmetric field.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{nb} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{itemize}

\item[{Returns}] \leavevmode
An instance of the derived class implementing the boundary conditions specified by
\sphinxcode{horizontal\_boundary\_type}.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{from\_computational\_to\_physical\_domain() (dycore.horizontal\_boundary.HorizontalBoundary method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.HorizontalBoundary.from_computational_to_physical_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_computational\_to\_physical\_domain}}{\emph{phi\_}, \emph{out\_dims}, \emph{change\_sign}}{}
Given a \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the computational domain of a stencil, return the
associated physicalm field which may (or may not) satisfy the horizontal boundary conditions.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the computational domain of a stencil.

\item {} 
\sphinxstyleliteralstrong{out\_dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the output array dimensions.

\item {} 
\sphinxstyleliteralstrong{change\_sign} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the field should change sign through the symmetry plane (if any), \sphinxcode{False} otherwise.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field defined over the physical domain.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{from\_physical\_to\_computational\_domain() (dycore.horizontal\_boundary.HorizontalBoundary method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.HorizontalBoundary.from_physical_to_computational_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_physical\_to\_computational\_domain}}{\emph{phi}}{}
Given a \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing a physical field, return the associated stencils’ computational
domain, i.e., the \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} (accomodating the boundary conditions) which will be input
to the stencils. If the physical and computational fields coincide, a shallow copy of the physical
domain is returned.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the physical field.

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The implementation should be designed to work with both staggered and unstaggared fields.
\end{sphinxadmonition}

\end{fulllineitems}

\index{get\_computational\_grid() (dycore.horizontal\_boundary.HorizontalBoundary method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.HorizontalBoundary.get_computational_grid}}\pysiglinewithargsret{\sphinxbfcode{get\_computational\_grid}}{}{}
Get the \sphinxstyleemphasis{computational} grid underlying the computational domain.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
Instance of the same class of \sphinxcode{tasmania.dycore.horizontal\_boundary.HorizontalBoundary.grid}
representing the underlying computational grid.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{set\_outermost\_layers\_x() (dycore.horizontal\_boundary.HorizontalBoundary method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.HorizontalBoundary.set_outermost_layers_x}}\pysiglinewithargsret{\sphinxbfcode{set\_outermost\_layers\_x}}{\emph{phi\_new}, \emph{phi\_now}}{}
Set the outermost layers of \sphinxcode{phi\_new} in the \(x\)-direction so to satisfy
the lateral boundary conditions. For this, possibly rely upon the field \sphinxcode{phi\_now} at the current time.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{set\_outermost\_layers\_y() (dycore.horizontal\_boundary.HorizontalBoundary method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary.HorizontalBoundary.set_outermost_layers_y}}\pysiglinewithargsret{\sphinxbfcode{set\_outermost\_layers\_y}}{\emph{phi\_new}, \emph{phi\_now}}{}
Set the outermost layers of \sphinxcode{phi\_new} in the \(y\)-direction so to satisfy
the lateral boundary conditions. For this, possibly rely upon the field \sphinxcode{phi\_now} at the current time.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{Periodic (class in dycore.horizontal\_boundary\_periodic)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_periodic.Periodic}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_boundary\_periodic.}\sphinxbfcode{Periodic}}{\emph{grid}, \emph{nb}}{}
This class inherits \sphinxcode{HorizontalBoundary} to implement horizontally
periodic boundary conditions.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{GridXYZ} or one of its derived classes representing the underlying grid.

\item {} 
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.nb}]{\sphinxcrossref{\sphinxstyleliteralstrong{nb}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.horizontal\_boundary\_periodic.Periodic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_periodic.Periodic.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{nb}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of \sphinxcode{GridXYZ} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{nb} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.horizontal\_boundary\_periodic.Periodic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_periodic.Periodic.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{phi\_new}, \emph{phi\_now=None}}{}
Apply horizontally periodic boundary conditions on \sphinxcode{phi\_new}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxtitleref{array\_like}, optional) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The argument \sphinxcode{phi\_now} is not required by the implementation, yet it is retained as optional
argument for compliancy with the class hierarchy interface.
\end{sphinxadmonition}

\end{fulllineitems}

\index{from\_computational\_to\_physical\_domain() (dycore.horizontal\_boundary\_periodic.Periodic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_periodic.Periodic.from_computational_to_physical_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_computational\_to\_physical\_domain}}{\emph{phi\_}, \emph{out\_dims=None}, \emph{change\_sign=True}}{}
Shrink the field \sphinxcode{phi\_} by removing the \sphinxcode{nb} outermost layers.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} The \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} to shrink.

\item {} 
\sphinxstyleliteralstrong{out\_dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the output array dimensions.

\item {} 
\sphinxstyleliteralstrong{change\_sign} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the field should change sign through the symmetry plane (if any), \sphinxcode{False} otherwise.

\end{itemize}

\item[{Returns}] \leavevmode
The shrunk \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}}.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The arguments \sphinxcode{out\_dims} and \sphinxcode{change\_sign} are not required by the implementation,
yet they are retained as optional arguments for compliancy with the class hierarchy interface.
\end{sphinxadmonition}

\end{fulllineitems}

\index{from\_physical\_to\_computational\_domain() (dycore.horizontal\_boundary\_periodic.Periodic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_periodic.Periodic.from_physical_to_computational_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_physical\_to\_computational\_domain}}{\emph{phi}}{}
Periodically extend the field \sphinxcode{phi} with \sphinxcode{nb} extra layers.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} The \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} to extend.

\item[{Returns}] \leavevmode
The extended \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}}.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_computational\_grid() (dycore.horizontal\_boundary\_periodic.Periodic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_periodic.Periodic.get_computational_grid}}\pysiglinewithargsret{\sphinxbfcode{get\_computational\_grid}}{}{}
Get the \sphinxstyleemphasis{computational} grid underlying the computational domain.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
Instance of the same class of \sphinxcode{grid}
representing the underlying computational grid.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{set\_outermost\_layers\_x() (dycore.horizontal\_boundary\_periodic.Periodic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_periodic.Periodic.set_outermost_layers_x}}\pysiglinewithargsret{\sphinxbfcode{set\_outermost\_layers\_x}}{\emph{phi\_new}, \emph{phi\_now=None}}{}
Set the outermost layers of \sphinxcode{phi\_new} in the \(x\)-direction so to satisfy the periodic
boundary conditions.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxtitleref{array\_like}, optional) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The argument \sphinxcode{phi\_now} is not required by the implementation, yet it is retained as optional
argument for compliancy with the class hierarchy interface.
\end{sphinxadmonition}

\end{fulllineitems}

\index{set\_outermost\_layers\_y() (dycore.horizontal\_boundary\_periodic.Periodic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_periodic.Periodic.set_outermost_layers_y}}\pysiglinewithargsret{\sphinxbfcode{set\_outermost\_layers\_y}}{\emph{phi\_new}, \emph{phi\_now=None}}{}
Set the outermost layers of \sphinxcode{phi\_new} in the \(y\)-direction so to satisfy the periodic
boundary conditions.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxtitleref{array\_like}, optional) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The argument \sphinxcode{phi\_now} is not required by the implementation, yet it is retained as optional
argument for compliancy with the class hierarchy interface.
\end{sphinxadmonition}

\end{fulllineitems}


\end{fulllineitems}

\index{PeriodicXZ (class in dycore.horizontal\_boundary\_periodic)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_periodic.PeriodicXZ}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_boundary\_periodic.}\sphinxbfcode{PeriodicXZ}}{\emph{grid}, \emph{nb}}{}
This class inherits \sphinxcode{HorizontalBoundary} to implement horizontally periodic boundary conditions for fields
defined on a computational domain consisting of only one grid point in the \(y\)-direction.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{GridXYZ} or one of its derived classes representing the underlying grid.

\item {} 
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.nb}]{\sphinxcrossref{\sphinxstyleliteralstrong{nb}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.horizontal\_boundary\_periodic.PeriodicXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_periodic.PeriodicXZ.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{nb}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{nb} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.horizontal\_boundary\_periodic.PeriodicXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_periodic.PeriodicXZ.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{phi\_new}, \emph{phi\_now=None}}{}
Apply horizontally periodic boundary conditions on \sphinxcode{phi\_new}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxtitleref{array\_like}, optional) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The argument \sphinxcode{phi\_now} is not required by the implementation, yet it is retained as optional
argument for compliancy with the class hierarchy interface.
\end{sphinxadmonition}

\end{fulllineitems}

\index{from\_computational\_to\_physical\_domain() (dycore.horizontal\_boundary\_periodic.PeriodicXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_periodic.PeriodicXZ.from_computational_to_physical_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_computational\_to\_physical\_domain}}{\emph{phi\_}, \emph{out\_dims=None}, \emph{change\_sign=True}}{}
Return the central \(xz\)-slices of the input field \sphinxcode{phi\_}, removing the \sphinxcode{nb} outermost
layers in \(y\)-direction.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} The \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} to shrink.

\item {} 
\sphinxstyleliteralstrong{out\_dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the output array dimensions.

\item {} 
\sphinxstyleliteralstrong{change\_sign} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the field should change sign through the symmetry plane (if any), \sphinxcode{False} otherwise.

\end{itemize}

\item[{Returns}] \leavevmode
The shrunk \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}}.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The arguments \sphinxcode{out\_dims} and \sphinxcode{change\_sign} are not required by the implementation,
yet they are retained as optional arguments for compliancy with the class hierarchy interface.
\end{sphinxadmonition}

\end{fulllineitems}

\index{from\_physical\_to\_computational\_domain() (dycore.horizontal\_boundary\_periodic.PeriodicXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_periodic.PeriodicXZ.from_physical_to_computational_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_physical\_to\_computational\_domain}}{\emph{phi}}{}
Periodically extend the field \sphinxcode{phi} with \sphinxcode{nb} extra layers in the \(x\)-direction,
then add \sphinxcode{nb} ghost layers in the \(y\)-direction.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} The \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} to extend.

\item[{Returns}] \leavevmode
The extended \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}}.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_computational\_grid() (dycore.horizontal\_boundary\_periodic.PeriodicXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_periodic.PeriodicXZ.get_computational_grid}}\pysiglinewithargsret{\sphinxbfcode{get\_computational\_grid}}{}{}
Get the \sphinxstyleemphasis{computational} grid underlying the computational domain.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
Instance of the same class of \sphinxcode{tasmania.dycore.horizontal\_boundary.HorizontalBoundary.grid}
representing the underlying computational grid.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{set\_outermost\_layers\_x() (dycore.horizontal\_boundary\_periodic.PeriodicXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_periodic.PeriodicXZ.set_outermost_layers_x}}\pysiglinewithargsret{\sphinxbfcode{set\_outermost\_layers\_x}}{\emph{phi\_new}, \emph{phi\_now=None}}{}
Set the outermost layers of \sphinxcode{phi\_new} in the \(x\)-direction so to satisfy the periodic
boundary conditions.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxtitleref{array\_like}, optional) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The argument \sphinxcode{phi\_now} is not required by the implementation, yet it is retained as optional
argument for compliancy with the class hierarchy interface.
\end{sphinxadmonition}

\end{fulllineitems}


\end{fulllineitems}

\index{PeriodicYZ (class in dycore.horizontal\_boundary\_periodic)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_periodic.PeriodicYZ}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_boundary\_periodic.}\sphinxbfcode{PeriodicYZ}}{\emph{grid}, \emph{nb}}{}
This class inherits \sphinxcode{HorizontalBoundary} to implement horizontally periodic boundary conditions for fields
defined on a computational domain consisting of only one grid point in the \(x\)-direction.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{GridXYZ} or one of its derived classes representing the underlying grid.

\item {} 
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.nb}]{\sphinxcrossref{\sphinxstyleliteralstrong{nb}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.horizontal\_boundary\_periodic.PeriodicYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_periodic.PeriodicYZ.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{nb}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{nb} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.horizontal\_boundary\_periodic.PeriodicYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_periodic.PeriodicYZ.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{phi\_new}, \emph{phi\_now=None}}{}
Apply horizontally periodic boundary conditions on \sphinxcode{phi\_new}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxtitleref{array\_like}, optional) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The argument \sphinxcode{phi\_now} is not required by the implementation, yet it is retained as optional
argument for compliancy with the class hierarchy interface.
\end{sphinxadmonition}

\end{fulllineitems}

\index{from\_computational\_to\_physical\_domain() (dycore.horizontal\_boundary\_periodic.PeriodicYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_periodic.PeriodicYZ.from_computational_to_physical_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_computational\_to\_physical\_domain}}{\emph{phi\_}, \emph{out\_dims=None}, \emph{change\_sign=True}}{}
Return the central \(yz\)-slices of the input field \sphinxcode{phi\_}, removing the \sphinxcode{nb} outermost
layers in \(x\)-direction.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} The \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} to shrink.

\item {} 
\sphinxstyleliteralstrong{out\_dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the output array dimensions.

\item {} 
\sphinxstyleliteralstrong{change\_sign} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the field should change sign through the symmetry plane (if any), \sphinxcode{False} otherwise.

\end{itemize}

\item[{Returns}] \leavevmode
The shrunk \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}}.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The arguments \sphinxcode{out\_dims} and \sphinxcode{change\_sign} are not required by the implementation,
yet they are retained as optional arguments for compliancy with the class hierarchy interface.
\end{sphinxadmonition}

\end{fulllineitems}

\index{from\_physical\_to\_computational\_domain() (dycore.horizontal\_boundary\_periodic.PeriodicYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_periodic.PeriodicYZ.from_physical_to_computational_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_physical\_to\_computational\_domain}}{\emph{phi}}{}
Periodically extend the field \sphinxcode{phi} with \sphinxcode{nb} extra layers in the \(y\)-direction,
then add \sphinxcode{nb} ghost layers in the \(x\)-direction.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} The \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} to extend.

\item[{Returns}] \leavevmode
The extended \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}}.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_computational\_grid() (dycore.horizontal\_boundary\_periodic.PeriodicYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_periodic.PeriodicYZ.get_computational_grid}}\pysiglinewithargsret{\sphinxbfcode{get\_computational\_grid}}{}{}
Get the \sphinxstyleemphasis{computational} grid underlying the computational domain.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
Instance of the same class of \sphinxcode{tasmania.dycore.horizontal\_boundary.HorizontalBoundary.grid}
representing the underlying computational grid.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{set\_outermost\_layers\_y() (dycore.horizontal\_boundary\_periodic.PeriodicYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_periodic.PeriodicYZ.set_outermost_layers_y}}\pysiglinewithargsret{\sphinxbfcode{set\_outermost\_layers\_y}}{\emph{phi\_new}, \emph{phi\_now=None}}{}
Set the outermost layers of \sphinxcode{phi\_new} in the \(y\)-direction so to satisfy the periodic
boundary conditions.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxtitleref{array\_like}, optional) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The argument \sphinxcode{phi\_now} is not required by the implementation, yet it is retained as optional
argument for compliancy with the class hierarchy interface.
\end{sphinxadmonition}

\end{fulllineitems}


\end{fulllineitems}

\index{Relaxed (class in dycore.horizontal\_boundary\_relaxed)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.Relaxed}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_boundary\_relaxed.}\sphinxbfcode{Relaxed}}{\emph{grid}, \emph{nb}}{}
This class inherits \sphinxcode{HorizontalBoundary} to implement horizontally
relaxed boundary conditions.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{GridXYZ} or one of its derived classes representing the underlying grid.

\item {} 
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.nb}]{\sphinxcrossref{\sphinxstyleliteralstrong{nb}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\item {} 
\sphinxstyleliteralstrong{nr} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of layers which will be affected by relaxation.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.horizontal\_boundary\_relaxed.Relaxed method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.Relaxed.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{nb}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{nb} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.horizontal\_boundary\_relaxed.Relaxed method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.Relaxed.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{phi\_new}, \emph{phi\_now}}{}
Apply relaxed lateral boundary conditions.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The Dirichlet conditions at the boundaries are assumed to be time-independent, so that they
can be inferred from the solution at current time.
\end{sphinxadmonition}

\end{fulllineitems}

\index{from\_computational\_to\_physical\_domain() (dycore.horizontal\_boundary\_relaxed.Relaxed method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.Relaxed.from_computational_to_physical_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_computational\_to\_physical\_domain}}{\emph{phi\_}, \emph{out\_dims=None}, \emph{change\_sign=True}}{}
As no extension is required to apply relaxed boundary conditions, return a shallow copy of the
input field \sphinxcode{phi\_}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} A \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}}.

\item {} 
\sphinxstyleliteralstrong{out\_dims} (\sphinxtitleref{tuple}, optional) \textendash{} Tuple of the output array dimensions.

\item {} 
\sphinxstyleliteralstrong{change\_sign} (\sphinxtitleref{bool}, optional) \textendash{} \sphinxcode{True} if the field should change sign through the symmetry plane, \sphinxcode{False} otherwise.

\end{itemize}

\item[{Returns}] \leavevmode
A shallow copy of \sphinxcode{phi\_}.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The arguments \sphinxcode{out\_dims} and \sphinxcode{change\_sign} are not required by the implementation,
yet they are retained as optional arguments for compliancy with the class hierarchy interface.
\end{sphinxadmonition}

\end{fulllineitems}

\index{from\_physical\_to\_computational\_domain() (dycore.horizontal\_boundary\_relaxed.Relaxed method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.Relaxed.from_physical_to_computational_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_physical\_to\_computational\_domain}}{\emph{phi}}{}
As no extension is required to apply relaxed boundary conditions, return a shallow copy of the
input field \sphinxcode{phi}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} A \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}}.

\item[{Returns}] \leavevmode
A shallow copy of \sphinxcode{phi}.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_computational\_grid() (dycore.horizontal\_boundary\_relaxed.Relaxed method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.Relaxed.get_computational_grid}}\pysiglinewithargsret{\sphinxbfcode{get\_computational\_grid}}{}{}
Get the \sphinxstyleemphasis{computational} grid underlying the computational domain.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
Instance of the same class of \sphinxcode{tasmania.dycore.horizontal\_boundary.HorizontalBoundary.grid}
representing the underlying computational grid.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{set\_outermost\_layers\_x() (dycore.horizontal\_boundary\_relaxed.Relaxed method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.Relaxed.set_outermost_layers_x}}\pysiglinewithargsret{\sphinxbfcode{set\_outermost\_layers\_x}}{\emph{phi\_new}, \emph{phi\_now}}{}
Set the outermost layers of \sphinxcode{phi\_new} in the \sphinxcode{x}-direction equal to the corresponding
layers of \sphinxcode{phi\_now}. In other words, apply Dirichlet conditions in \sphinxcode{x}-direction.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The Dirichlet conditions at the boundaries are assumed to be time-independent, so that they
can be inferred from the solution at current time.
\end{sphinxadmonition}

\end{fulllineitems}

\index{set\_outermost\_layers\_y() (dycore.horizontal\_boundary\_relaxed.Relaxed method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.Relaxed.set_outermost_layers_y}}\pysiglinewithargsret{\sphinxbfcode{set\_outermost\_layers\_y}}{\emph{phi\_new}, \emph{phi\_now}}{}
Set the outermost layers of \sphinxcode{phi\_new} in the \sphinxcode{y}-direction equal to the corresponding
layers of \sphinxcode{phi\_now}. In other words, apply Dirichelt conditions in \sphinxcode{y}-direction.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The Dirichlet conditions at the boundaries are assumed to be time-independent, so that they
can be inferred from the solution at current time.
\end{sphinxadmonition}

\end{fulllineitems}


\end{fulllineitems}

\index{RelaxedXZ (class in dycore.horizontal\_boundary\_relaxed)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.RelaxedXZ}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_boundary\_relaxed.}\sphinxbfcode{RelaxedXZ}}{\emph{grid}, \emph{nb}}{}
This class inherits \sphinxcode{HorizontalBoundary} to implement horizontally relaxed boundary conditions for fields defined
on a computational domain consisting of only one grid point in the \(y\)-direction.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{GridXYZ} or one of its derived classes representing the underlying grid.

\item {} 
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.nb}]{\sphinxcrossref{\sphinxstyleliteralstrong{nb}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\item {} 
\sphinxstyleliteralstrong{nr} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of layers which will be affected by relaxation.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.horizontal\_boundary\_relaxed.RelaxedXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.RelaxedXZ.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{nb}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{nb} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.horizontal\_boundary\_relaxed.RelaxedXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.RelaxedXZ.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{phi\_new}, \emph{phi\_now}}{}
Apply relaxed lateral boundary conditions along the \(x\)-axis.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The Dirichlet conditions at the boundaries are assumed to be time-independent, so that they
can be inferred from the solution at current time.
\end{sphinxadmonition}

\end{fulllineitems}

\index{from\_computational\_to\_physical\_domain() (dycore.horizontal\_boundary\_relaxed.RelaxedXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.RelaxedXZ.from_computational_to_physical_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_computational\_to\_physical\_domain}}{\emph{phi\_}, \emph{out\_dims=None}, \emph{change\_sign=True}}{}
Remove the \sphinxcode{nb} outermost \sphinxcode{xz}-slices from the input field \sphinxcode{phi\_}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} A \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}}.

\item {} 
\sphinxstyleliteralstrong{out\_dims} (\sphinxtitleref{tuple}, optional) \textendash{} Tuple of the output array dimensions.

\item {} 
\sphinxstyleliteralstrong{change\_sign} (\sphinxtitleref{bool}, optional) \textendash{} \sphinxcode{True} if the field should change sign through the symmetry plane, \sphinxcode{False} otherwise.

\end{itemize}

\item[{Returns}] \leavevmode
The central \(xz\)-slice(s) of \sphinxcode{phi\_}.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The arguments \sphinxcode{out\_dims} and \sphinxcode{change\_sign} are not required by the implementation,
yet they are retained as optional arguments for compliancy with the class hierarchy interface.
\end{sphinxadmonition}

\end{fulllineitems}

\index{from\_physical\_to\_computational\_domain() (dycore.horizontal\_boundary\_relaxed.RelaxedXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.RelaxedXZ.from_physical_to_computational_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_physical\_to\_computational\_domain}}{\emph{phi}}{}
While no extension is required to apply relaxed boundary conditions along the \(x\)-direction,
\sphinxcode{nb} ghost layers are appended in the \(y\)-direction.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} A \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}}.

\item[{Returns}] \leavevmode
A deep copy of \sphinxcode{phi}, with \sphinxcode{nb} ghost layers in the \(y\)-direction.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_computational\_grid() (dycore.horizontal\_boundary\_relaxed.RelaxedXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.RelaxedXZ.get_computational_grid}}\pysiglinewithargsret{\sphinxbfcode{get\_computational\_grid}}{}{}
Get the \sphinxstyleemphasis{computational} grid underlying the computational domain.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
Instance of the same class of \sphinxcode{tasmania.dycore.horizontal\_boundary.HorizontalBoundary.grid}
representing the underlying computational grid.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{set\_outermost\_layers\_x() (dycore.horizontal\_boundary\_relaxed.RelaxedXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.RelaxedXZ.set_outermost_layers_x}}\pysiglinewithargsret{\sphinxbfcode{set\_outermost\_layers\_x}}{\emph{phi\_new}, \emph{phi\_now}}{}
Set the outermost layers of \sphinxcode{phi\_new} in the \sphinxcode{x}-direction equal to the corresponding
layers of \sphinxcode{phi\_now}. In other words, apply Dirichlet conditions in \sphinxcode{x}-direction.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The Dirichlet conditions at the boundaries are assumed to be time-independent, so that they
can be inferred from the solution at current time.
\end{sphinxadmonition}

\end{fulllineitems}


\end{fulllineitems}

\index{RelaxedYZ (class in dycore.horizontal\_boundary\_relaxed)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.RelaxedYZ}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_boundary\_relaxed.}\sphinxbfcode{RelaxedYZ}}{\emph{grid}, \emph{nb}}{}
This class inherits \sphinxcode{HorizontalBoundary} to implement horizontally relaxed boundary conditions for fields defined
on a computational domain consisting of only one grid point in the \(x\)-direction.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{GridXYZ} or one of its derived classes representing the underlying grid.

\item {} 
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.nb}]{\sphinxcrossref{\sphinxstyleliteralstrong{nb}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\item {} 
\sphinxstyleliteralstrong{nr} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of layers which will be affected by relaxation.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.horizontal\_boundary\_relaxed.RelaxedYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.RelaxedYZ.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{nb}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{nb} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.horizontal\_boundary\_relaxed.RelaxedYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.RelaxedYZ.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{phi\_new}, \emph{phi\_now}}{}
Apply relaxed lateral boundary conditions along the \(x\)-axis.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The Dirichlet conditions at the boundaries are assumed to be time-independent, so that they
can be inferred from the solution at current time.
\end{sphinxadmonition}

\end{fulllineitems}

\index{from\_computational\_to\_physical\_domain() (dycore.horizontal\_boundary\_relaxed.RelaxedYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.RelaxedYZ.from_computational_to_physical_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_computational\_to\_physical\_domain}}{\emph{phi\_}, \emph{out\_dims=None}, \emph{change\_sign=True}}{}
Return a deep copy of the central \(yz\)-slices of the input field \sphinxcode{phi\_}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} A \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}}.

\item {} 
\sphinxstyleliteralstrong{out\_dims} (\sphinxtitleref{tuple}, optional) \textendash{} Tuple of the output array dimensions.

\item {} 
\sphinxstyleliteralstrong{change\_sign} (\sphinxtitleref{bool}, optional) \textendash{} \sphinxcode{True} if the field should change sign through the symmetry plane, \sphinxcode{False} otherwise.

\end{itemize}

\item[{Returns}] \leavevmode
The central \(yz\)-slice(s) of \sphinxcode{phi\_}.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The arguments \sphinxcode{out\_dims} and \sphinxcode{change\_sign} are not required by the implementation,
yet they are retained as optional arguments for compliancy with the class hierarchy interface.
\end{sphinxadmonition}

\end{fulllineitems}

\index{from\_physical\_to\_computational\_domain() (dycore.horizontal\_boundary\_relaxed.RelaxedYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.RelaxedYZ.from_physical_to_computational_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_physical\_to\_computational\_domain}}{\emph{phi}}{}
While no extension is required to apply relaxed boundary conditions along the \(y\)-direction,
\sphinxcode{nb} ghost layers are appended in the \(x\)-direction.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} A \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}}.

\item[{Returns}] \leavevmode
A deep copy of \sphinxcode{phi}, with \sphinxcode{nb} ghost layers along the \(y\)-layers.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_computational\_grid() (dycore.horizontal\_boundary\_relaxed.RelaxedYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.RelaxedYZ.get_computational_grid}}\pysiglinewithargsret{\sphinxbfcode{get\_computational\_grid}}{}{}
Get the \sphinxstyleemphasis{computational} grid underlying the computational domain.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
Instance of the same class of \sphinxcode{tasmania.dycore.horizontal\_boundary.HorizontalBoundary.grid}
representing the underlying computational grid.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{set\_outermost\_layers\_y() (dycore.horizontal\_boundary\_relaxed.RelaxedYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.RelaxedYZ.set_outermost_layers_y}}\pysiglinewithargsret{\sphinxbfcode{set\_outermost\_layers\_y}}{\emph{phi\_new}, \emph{phi\_now}}{}
Set the outermost layers of \sphinxcode{phi\_new} in the \sphinxcode{y}-direction equal to the corresponding
layers of \sphinxcode{phi\_now}. In other words, apply Dirichlet conditions in \sphinxcode{y}-direction.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field on which applying the boundary conditions.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field at the current time.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
The Dirichlet conditions at the boundaries are assumed to be time-independent, so that they
can be inferred from the solution at current time.
\end{sphinxadmonition}

\end{fulllineitems}


\end{fulllineitems}

\index{RelaxedSymmetricXZ (class in dycore.horizontal\_boundary\_relaxed)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.RelaxedSymmetricXZ}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_boundary\_relaxed.}\sphinxbfcode{RelaxedSymmetricXZ}}{\emph{grid}, \emph{nb}}{}
This class inherits {\hyperref[\detokenize{api:dycore.horizontal_boundary_relaxed.Relaxed}]{\sphinxcrossref{\sphinxcode{Relaxed}}}} to implement horizontally relaxed boundary conditions
for fields symmetric with respect to the \(xz\)-plane \(y = y_c = 0.5 (a_y + b_y)\),
where \(a_y\) and \(b_y\) denote the extremes of the domain in the \(y\)-direction.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{GridXYZ} or one of its derived classes representing the underlying grid.

\item {} 
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.nb}]{\sphinxcrossref{\sphinxstyleliteralstrong{nb}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\item {} 
\sphinxstyleliteralstrong{nr} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of layers which will be affected by relaxation.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.horizontal\_boundary\_relaxed.RelaxedSymmetricXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.RelaxedSymmetricXZ.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{nb}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{nb} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{from\_computational\_to\_physical\_domain() (dycore.horizontal\_boundary\_relaxed.RelaxedSymmetricXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.RelaxedSymmetricXZ.from_computational_to_physical_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_computational\_to\_physical\_domain}}{\emph{phi\_}, \emph{out\_dims}, \emph{change\_sign=False}}{}
Mirror the computational domain with respect to the \(xz\)-plane \(y = y_c\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the computational domain of a stencil.

\item {} 
\sphinxstyleliteralstrong{out\_dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the output array dimensions.

\item {} 
\sphinxstyleliteralstrong{change\_sign} (\sphinxtitleref{bool}, optional) \textendash{} \sphinxcode{True} if the field should change sign through the symmetry plane, \sphinxcode{False} otherwise.
Default is false.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field defined over the physical domain.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{from\_physical\_to\_computational\_domain() (dycore.horizontal\_boundary\_relaxed.RelaxedSymmetricXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.RelaxedSymmetricXZ.from_physical_to_computational_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_physical\_to\_computational\_domain}}{\emph{phi}}{}
Return the \(y\)-lowermost half of the domain. To accomodate symmetric conditions,
we retain (at least) \sphinxcode{nb} additional layers in the positive direction of the \(y\)-axis.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the physical field.

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_computational\_grid() (dycore.horizontal\_boundary\_relaxed.RelaxedSymmetricXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.RelaxedSymmetricXZ.get_computational_grid}}\pysiglinewithargsret{\sphinxbfcode{get\_computational\_grid}}{}{}
Get the \sphinxstyleemphasis{computational} grid underlying the computational domain.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
Instance of the same class of \sphinxcode{tasmania.dycore.horizontal\_boundary.HorizontalBoundary.grid}
representing the underlying computational grid.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{RelaxedSymmetricYZ (class in dycore.horizontal\_boundary\_relaxed)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.RelaxedSymmetricYZ}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_boundary\_relaxed.}\sphinxbfcode{RelaxedSymmetricYZ}}{\emph{grid}, \emph{nb}}{}
This class inherits {\hyperref[\detokenize{api:dycore.horizontal_boundary_relaxed.Relaxed}]{\sphinxcrossref{\sphinxcode{Relaxed}}}} to implement horizontally relaxed boundary conditions
for fields symmetric with respect to the \(yz\)-plane \(x = x_c = 0.5 (a_x + b_x)\),
where \(a_x\) and \(b_x\) denote the extremes of the domain in the \(x\)-direction.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{GridXYZ} or one of its derived classes representing the underlying grid.

\item {} 
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.nb}]{\sphinxcrossref{\sphinxstyleliteralstrong{nb}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\item {} 
\sphinxstyleliteralstrong{nr} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of layers which will be affected by relaxation.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.horizontal\_boundary\_relaxed.RelaxedSymmetricYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.RelaxedSymmetricYZ.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{nb}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{nb} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{from\_computational\_to\_physical\_domain() (dycore.horizontal\_boundary\_relaxed.RelaxedSymmetricYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.RelaxedSymmetricYZ.from_computational_to_physical_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_computational\_to\_physical\_domain}}{\emph{phi\_}, \emph{out\_dims}, \emph{change\_sign=False}}{}
Mirror the computational domain with respect to the \(yz\)-axis \(x = x_c\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the computational domain of a stencil.

\item {} 
\sphinxstyleliteralstrong{out\_dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the output array dimensions.

\item {} 
\sphinxstyleliteralstrong{change\_sign} (\sphinxtitleref{bool}, optional) \textendash{} \sphinxcode{True} if the field should change sign through the symmetry plane, \sphinxcode{False} otherwise.
Default is false.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field defined over the physical domain.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{from\_physical\_to\_computational\_domain() (dycore.horizontal\_boundary\_relaxed.RelaxedSymmetricYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.RelaxedSymmetricYZ.from_physical_to_computational_domain}}\pysiglinewithargsret{\sphinxbfcode{from\_physical\_to\_computational\_domain}}{\emph{phi}}{}
Return the \(x\)-lowermost half of the domain. To accomodate symmetric conditions,
we retain (at least) \sphinxcode{nb} additional layers in the positive direction of the \(x\)-axis.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the physical field.

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the stencils’ computational domain.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_computational\_grid() (dycore.horizontal\_boundary\_relaxed.RelaxedSymmetricYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_boundary_relaxed.RelaxedSymmetricYZ.get_computational_grid}}\pysiglinewithargsret{\sphinxbfcode{get\_computational\_grid}}{}{}
Get the \sphinxstyleemphasis{computational} grid underlying the computational domain.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
Instance of the same class of \sphinxcode{tasmania.dycore.horizontal\_boundary.HorizontalBoundary.grid}
representing the underlying computational grid.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{Horizontal smoothing}
\label{\detokenize{api:horizontal-smoothing}}\index{HorizontalSmoothing (class in dycore.horizontal\_smoothing)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothing}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_smoothing.}\sphinxbfcode{HorizontalSmoothing}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth}, \emph{smooth\_coeff}, \emph{smooth\_coeff\_max}, \emph{backend}}{}
Abstract base class whose derived classes apply horizontal numerical smoothing to a generic (prognostic)
field by means of a GT4Py stencil.
\index{\_\_init\_\_() (dycore.horizontal\_smoothing.HorizontalSmoothing method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothing.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth}, \emph{smooth\_coeff}, \emph{smooth\_coeff\_max}, \emph{backend}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the dimension of the (three-dimensional) arrays on which to apply numerical smoothing.

\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{smooth\_damp\_depth} (\sphinxstyleliteralemphasis{int}) \textendash{} Depth of the damping region, i.e., number of vertical layers in the damping region.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff} (\sphinxstyleliteralemphasis{float}) \textendash{} Value for the smoothing coefficient far from the top boundary.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff\_max} (\sphinxstyleliteralemphasis{float}) \textendash{} Maximum value for the smoothing coefficient.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py stencil implementing numerical smoothing.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.horizontal\_smoothing.HorizontalSmoothing method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothing.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{phi}}{}
Apply horizontal smoothing to a prognostic field.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to filter.

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the filtered field.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{factory() (dycore.horizontal\_smoothing.HorizontalSmoothing static method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothing.factory}}\pysiglinewithargsret{\sphinxbfcode{static }\sphinxbfcode{factory}}{\emph{smooth\_type}, \emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth}, \emph{smooth\_coeff}, \emph{smooth\_coeff\_max}, \emph{backend}}{}
Static method returning an instance of the derived class implementing the smoothing technique
specified by \sphinxcode{smooth\_type}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{smooth\_type} (\sphinxstyleliteralemphasis{string}) \textendash{} 
String specifying the smoothing technique to implement. Either:
\begin{itemize}
\item {} 
’first\_order’, for first-order numerical smoothing;

\item {} 
’second\_order’, for second-order numerical smoothing.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the dimension of the (three-dimensional) arrays on which to apply numerical smoothing.

\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{smooth\_damp\_depth} (\sphinxstyleliteralemphasis{int}) \textendash{} Depth of the damping region, i.e., number of vertical layers in the damping region.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff} (\sphinxstyleliteralemphasis{float}) \textendash{} Value for the smoothing coefficient far from the top boundary.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff\_max} (\sphinxstyleliteralemphasis{float}) \textendash{} Maximum value for the smoothing coefficient.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py stencil implementing numerical
smoothing. Default is \sphinxcode{gridtools.mode.NUMPY}.

\end{itemize}

\item[{Returns}] \leavevmode
Instance of the suitable derived class.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{HorizontalSmoothingFirstOrderXYZ (class in dycore.horizontal\_smoothing)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXYZ}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_smoothing.}\sphinxbfcode{HorizontalSmoothingFirstOrderXYZ}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.24}, \emph{backend=\textless{}Mode.NUMPY: 4\textgreater{}}}{}
This class inherits {\hyperref[\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothing}]{\sphinxcrossref{\sphinxcode{HorizontalSmoothing}}}} to apply first-order numerical smoothing to
three-dimensional fields with at least three elements in each direction.

\begin{sphinxadmonition}{note}{Note:}
An instance of this class should only be applied to fields whose dimensions match those specified at instantiation time.
Hence, one should use (at least) one instance per field shape.
\end{sphinxadmonition}
\index{\_\_init\_\_() (dycore.horizontal\_smoothing.HorizontalSmoothingFirstOrderXYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXYZ.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.24}, \emph{backend=\textless{}Mode.NUMPY: 4\textgreater{}}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the dimension of the (three-dimensional) arrays on which to apply numerical smoothing.

\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{smooth\_damp\_depth} (\sphinxtitleref{int}, optional) \textendash{} Depth of the damping region, i.e., number of vertical layers in the damping region. Default is 10.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff} (\sphinxtitleref{float}, optional) \textendash{} Value for the smoothing coefficient far from the top boundary. Default is 0.03.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff\_max} (\sphinxtitleref{float}, optional) \textendash{} Maximum value for the smoothing coefficient. For the sake of numerical stability, it should not
exceed 0.25. Default is 0.24.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py stencil implementing numerical
smoothing. Default is \sphinxcode{gridtools.mode.NUMPY}.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
To instantiate the class, please prefer the static method \sphinxcode{factor()}
of {\hyperref[\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothing}]{\sphinxcrossref{\sphinxcode{HorizontalSmoothing}}}}.
\end{sphinxadmonition}

\end{fulllineitems}

\index{\_stencil\_defs() (dycore.horizontal\_smoothing.HorizontalSmoothingFirstOrderXYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXYZ._stencil_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_defs}}{\emph{in\_phi}, \emph{gamma}}{}
The GT4Py stencil applying first-order horizontal smoothing. A centered 5-points formula is used.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the input field to filter.

\item {} 
\sphinxstyleliteralstrong{gamma} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the smoothing coefficient.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the filtered output field.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_initialize() (dycore.horizontal\_smoothing.HorizontalSmoothingFirstOrderXYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXYZ._stencil_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_initialize}}{\emph{phi}}{}
Initialize the GT4Py stencil applying horizontal smoothing.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to filter.

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.horizontal\_smoothing.HorizontalSmoothingFirstOrderXYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXYZ.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{phi}}{}
Apply first-order horizontal smoothing to a prognostic field.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to filter.

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the filtered field.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{HorizontalSmoothingFirstOrderXZ (class in dycore.horizontal\_smoothing)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXZ}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_smoothing.}\sphinxbfcode{HorizontalSmoothingFirstOrderXZ}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.49}, \emph{backend=\textless{}Mode.NUMPY: 4\textgreater{}}}{}
This class inherits {\hyperref[\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothing}]{\sphinxcrossref{\sphinxcode{HorizontalSmoothing}}}} to apply first-order numerical smoothing to
three-dimensional fields with only one element in the \(y\)-direction.

\begin{sphinxadmonition}{note}{Note:}
An instance of this class should only be applied to fields whose dimensions match those specified at instantiation time.
Hence, one should use (at least) one instance per field shape.
\end{sphinxadmonition}
\index{\_\_init\_\_() (dycore.horizontal\_smoothing.HorizontalSmoothingFirstOrderXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXZ.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.49}, \emph{backend=\textless{}Mode.NUMPY: 4\textgreater{}}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the dimension of the (three-dimensional) arrays on which to apply numerical smoothing.

\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{smooth\_damp\_depth} (\sphinxtitleref{int}, optional) \textendash{} Depth of the damping region, i.e., number of vertical layers in the damping region. Default is 10.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff} (\sphinxtitleref{float}, optional) \textendash{} Value for the smoothing coefficient far from the top boundary. Default is 0.03.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff\_max} (\sphinxtitleref{float}, optional) \textendash{} Maximum value for the smoothing coefficient. For the sake of numerical stability, it should not
exceed 0.5. Default is 0.49.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py stencil implementing numerical
smoothing. Default is \sphinxcode{gridtools.mode.NUMPY}.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_defs() (dycore.horizontal\_smoothing.HorizontalSmoothingFirstOrderXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXZ._stencil_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_defs}}{\emph{in\_phi}, \emph{gamma}}{}
The GT4Py stencil applying horizontal smoothing. A standard centered 3-points formula is used.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the input field to filter.

\item {} 
\sphinxstyleliteralstrong{gamma} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the smoothing coefficient.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the filtered output field.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_initialize() (dycore.horizontal\_smoothing.HorizontalSmoothingFirstOrderXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXZ._stencil_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_initialize}}{\emph{phi}}{}
Initialize the GT4Py stencil applying horizontal smoothing.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to filter.

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.horizontal\_smoothing.HorizontalSmoothingFirstOrderXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderXZ.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{phi}}{}
Apply first-order horizontal smoothing to a prognostic field.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to filter.

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the filtered field.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{HorizontalSmoothingFirstOrderYZ (class in dycore.horizontal\_smoothing)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderYZ}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_smoothing.}\sphinxbfcode{HorizontalSmoothingFirstOrderYZ}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.49}, \emph{backend=\textless{}Mode.NUMPY: 4\textgreater{}}}{}
This class inherits {\hyperref[\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothing}]{\sphinxcrossref{\sphinxcode{HorizontalSmoothing}}}} to apply first-order numerical smoothing to
three-dimensional fields with only one element in the \(x\)-direction.

\begin{sphinxadmonition}{note}{Note:}
An instance of this class should only be applied to fields whose dimensions match those specified at instantiation time.
Hence, one should use (at least) one instance per field shape.
\end{sphinxadmonition}
\index{\_\_init\_\_() (dycore.horizontal\_smoothing.HorizontalSmoothingFirstOrderYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderYZ.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.49}, \emph{backend=\textless{}Mode.NUMPY: 4\textgreater{}}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the dimension of the (three-dimensional) arrays on which to apply numerical smoothing.

\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{smooth\_damp\_depth} (\sphinxstyleliteralemphasis{int}) \textendash{} Depth of the damping region, i.e., number of vertical layers in the damping region. Default is 10.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff} (\sphinxstyleliteralemphasis{float}) \textendash{} Value for the smoothing coefficient far from the top boundary. Default is 0.03.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff\_max} (\sphinxstyleliteralemphasis{float}) \textendash{} Maximum value for the smoothing coefficient. For the sake of numerical stability, it should not
exceed 0.5. Default is 0.49.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py stencil implementing numerical
smoothing. Default is \sphinxcode{gridtools.mode.NUMPY}.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_defs() (dycore.horizontal\_smoothing.HorizontalSmoothingFirstOrderYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderYZ._stencil_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_defs}}{\emph{in\_phi}, \emph{gamma}}{}
The GT4Py stencil applying horizontal smoothing. A standard centered 3-points formula is used.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the input field to filter.

\item {} 
\sphinxstyleliteralstrong{gamma} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the smoothing coefficient.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the filtered output field.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_initialize() (dycore.horizontal\_smoothing.HorizontalSmoothingFirstOrderYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderYZ._stencil_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_initialize}}{\emph{phi}}{}
Initialize the GT4Py stencil applying horizontal smoothing.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to filter.

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.horizontal\_smoothing.HorizontalSmoothingFirstOrderYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingFirstOrderYZ.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{phi}}{}
Apply first-order horizontal smoothing to a prognostic field.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to filter.

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the filtered field.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{HorizontalSmoothingSecondOrderXYZ (class in dycore.horizontal\_smoothing)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXYZ}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_smoothing.}\sphinxbfcode{HorizontalSmoothingSecondOrderXYZ}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.24}, \emph{backend=\textless{}Mode.NUMPY: 4\textgreater{}}}{}
This class inherits {\hyperref[\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothing}]{\sphinxcrossref{\sphinxcode{HorizontalSmoothing}}}} to apply second-order numerical smoothing to
three-dimensional fields.

\begin{sphinxadmonition}{note}{Note:}
An instance of this class should only be applied to fields whose dimensions match those specified at instantiation time.
Hence, one should use (at least) one instance per field shape.
\end{sphinxadmonition}
\index{\_\_init\_\_() (dycore.horizontal\_smoothing.HorizontalSmoothingSecondOrderXYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXYZ.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.24}, \emph{backend=\textless{}Mode.NUMPY: 4\textgreater{}}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the dimension of the (three-dimensional) arrays on which to apply numerical smoothing.

\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{smooth\_damp\_depth} (\sphinxtitleref{int}, optional) \textendash{} Depth of the damping region, i.e., number of vertical layers in the damping region. Default is 10.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff} (\sphinxtitleref{float}, optional) \textendash{} Value for the smoothing coefficient far from the top boundary. Default is 0.03.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff\_max} (\sphinxtitleref{float}, optional) \textendash{} Maximum value for the smoothing coefficient. For the sake of numerical stability, it should not
exceed 0.25. Default is 0.24.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py stencil implementing numerical
smoothing. Default is \sphinxcode{gridtools.mode.NUMPY}.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_defs() (dycore.horizontal\_smoothing.HorizontalSmoothingSecondOrderXYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXYZ._stencil_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_defs}}{\emph{in\_phi}, \emph{gamma}}{}
The GT4Py stencil applying horizontal smoothing. A standard centered 5-points formula is used.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the input field to filter.

\item {} 
\sphinxstyleliteralstrong{gamma} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the smoothing coefficient.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the filtered output field.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_initialize() (dycore.horizontal\_smoothing.HorizontalSmoothingSecondOrderXYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXYZ._stencil_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_initialize}}{\emph{phi}}{}
Initialize the GT4Py stencil applying horizontal smoothing.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to filter.

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.horizontal\_smoothing.HorizontalSmoothingSecondOrderXYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXYZ.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{phi}}{}
Apply second-order horizontal smoothing to a prognostic field.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to filter.

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the filtered field.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{HorizontalSmoothingSecondOrderXZ (class in dycore.horizontal\_smoothing)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXZ}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_smoothing.}\sphinxbfcode{HorizontalSmoothingSecondOrderXZ}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.49}, \emph{backend=\textless{}Mode.NUMPY: 4\textgreater{}}}{}
This class inherits {\hyperref[\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothing}]{\sphinxcrossref{\sphinxcode{HorizontalSmoothing}}}} to apply second-order numerical smoothing to
three-dimensional fields with only one element in the \(y\)-direction.

\begin{sphinxadmonition}{note}{Note:}
An instance of this class should only be applied to fields whose dimensions match those specified at instantiation time.
Hence, one should use (at least) one instance per field shape.
\end{sphinxadmonition}
\index{\_\_init\_\_() (dycore.horizontal\_smoothing.HorizontalSmoothingSecondOrderXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXZ.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.49}, \emph{backend=\textless{}Mode.NUMPY: 4\textgreater{}}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the dimension of the (three-dimensional) arrays on which to apply numerical smoothing.

\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{smooth\_damp\_depth} (\sphinxtitleref{int}, optional) \textendash{} Depth of the damping region, i.e., number of vertical layers in the damping region. Default is 10.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff} (\sphinxtitleref{float}, optional) \textendash{} Value for the smoothing coefficient far from the top boundary. Default is 0.03.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff\_max} (\sphinxtitleref{float}, optional) \textendash{} Maximum value for the smoothing coefficient. For the sake of numerical stability, it should not
exceed 0.5. Default is 0.49.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py stencil implementing numerical
smoothing. Default is \sphinxcode{gridtools.mode.NUMPY}.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_defs() (dycore.horizontal\_smoothing.HorizontalSmoothingSecondOrderXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXZ._stencil_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_defs}}{\emph{in\_phi}, \emph{gamma}}{}
The GT4Py stencil applying horizontal smoothing. A standard centered 5-points formula is used.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the input field to filter.

\item {} 
\sphinxstyleliteralstrong{gamma} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the smoothing coefficient.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the filtered output field.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_initialize() (dycore.horizontal\_smoothing.HorizontalSmoothingSecondOrderXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXZ._stencil_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_initialize}}{\emph{phi}}{}
Initialize the GT4Py stencil applying horizontal smoothing.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to filter.

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.horizontal\_smoothing.HorizontalSmoothingSecondOrderXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderXZ.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{phi}}{}
Apply second-order horizontal smoothing to a prognostic field.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to filter.

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the filtered field.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{HorizontalSmoothingSecondOrderYZ (class in dycore.horizontal\_smoothing)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderYZ}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.horizontal\_smoothing.}\sphinxbfcode{HorizontalSmoothingSecondOrderYZ}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.49}, \emph{backend=\textless{}Mode.NUMPY: 4\textgreater{}}}{}
This class inherits {\hyperref[\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothing}]{\sphinxcrossref{\sphinxcode{HorizontalSmoothing}}}} to apply second-order numerical smoothing to
three-dimensional fields with only one element in the \(x\)-direction.

\begin{sphinxadmonition}{note}{Note:}
An instance of this class should only be applied to fields whose dimensions match those specified at instantiation time.
Hence, one should use (at least) one instance per field shape.
\end{sphinxadmonition}
\index{\_\_init\_\_() (dycore.horizontal\_smoothing.HorizontalSmoothingSecondOrderYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderYZ.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{dims}, \emph{grid}, \emph{smooth\_damp\_depth=10}, \emph{smooth\_coeff=0.03}, \emph{smooth\_coeff\_max=0.49}, \emph{backend=\textless{}Mode.NUMPY: 4\textgreater{}}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the dimension of the (three-dimensional) arrays on which to apply numerical smoothing.

\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{smooth\_damp\_depth} (\sphinxtitleref{int}, optional) \textendash{} Depth of the damping region, i.e., number of vertical layers in the damping region. Default is 10.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff} (\sphinxtitleref{float}, optional) \textendash{} Value for the smoothing coefficient far from the top boundary. Default is 0.03.

\item {} 
\sphinxstyleliteralstrong{smooth\_coeff\_max} (\sphinxtitleref{float}, optional) \textendash{} Maximum value for the smoothing coefficient. For the sake of numerical stability, it should not
exceed 0.5. Default is 0.49.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py stencil implementing numerical
smoothing. Default is \sphinxcode{gridtools.mode.NUMPY}.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_defs() (dycore.horizontal\_smoothing.HorizontalSmoothingSecondOrderYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderYZ._stencil_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_defs}}{\emph{in\_phi}, \emph{gamma}}{}
The GT4Py stencil applying horizontal smoothing. A standard centered 5-points formula is used.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the input field to filter.

\item {} 
\sphinxstyleliteralstrong{gamma} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the smoothing coefficient.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the filtered output field.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_initialize() (dycore.horizontal\_smoothing.HorizontalSmoothingSecondOrderYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderYZ._stencil_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_initialize}}{\emph{phi}}{}
Initialize the GT4Py stencil applying horizontal smoothing.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to filter.

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.horizontal\_smoothing.HorizontalSmoothingSecondOrderYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.horizontal_smoothing.HorizontalSmoothingSecondOrderYZ.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{phi}}{}
Apply second-order horizontal smoothing to a prognostic field.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to filter.

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the filtered field.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{Numerical fluxes}
\label{\detokenize{api:numerical-fluxes}}\index{FluxIsentropic (class in dycore.flux\_isentropic)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic.FluxIsentropic}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.flux\_isentropic.}\sphinxbfcode{FluxIsentropic}}{\emph{grid}, \emph{moist\_on}}{}
Abstract base class whose derived classes implement different schemes to compute the numerical fluxes for
the three-dimensional isentropic dynamical core. The conservative form of the governing equations is used.
\index{\_\_init\_\_() (dycore.flux\_isentropic.FluxIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic.FluxIsentropic.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{moist\_on}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_compute\_horizontal\_fluxes() (dycore.flux\_isentropic.FluxIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic.FluxIsentropic._compute_horizontal_fluxes}}\pysiglinewithargsret{\sphinxbfcode{\_compute\_horizontal\_fluxes}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{in\_s}, \emph{in\_u}, \emph{in\_v}, \emph{in\_mtg}, \emph{in\_U}, \emph{in\_V}, \emph{in\_Qv}, \emph{in\_Qc}, \emph{in\_Qr}, \emph{in\_qv\_tnd=None}, \emph{in\_qc\_tnd=None}, \emph{in\_qr\_tnd=None}}{}
Method computing the \sphinxcode{gridtools.Equation{}`\textasciitilde{}s representing the :math:{}`x}- and
\(y\)-fluxes for all the conservative prognostic variables.
The :class:{\color{red}\bfseries{}{}`}gridtools.Equation{}`\textasciitilde{}s are then set as instance attributes.
As this method is marked as abstract, the implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_u} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_v} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_mtg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential.

\item {} 
\sphinxstyleliteralstrong{in\_U} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_V} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_Qv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_Qc} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_Qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of precipitation water.

\item {} 
\sphinxstyleliteralstrong{in\_qv\_tnd} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the tendency of the mass fraction of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_qc\_tnd} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the tendency of the mass fraction of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_qr\_tnd} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the tendency of the mass fraction of precipitation water.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_compute\_vertical\_fluxes() (dycore.flux\_isentropic.FluxIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic.FluxIsentropic._compute_vertical_fluxes}}\pysiglinewithargsret{\sphinxbfcode{\_compute\_vertical\_fluxes}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{in\_w}, \emph{in\_s}, \emph{in\_s\_prv}, \emph{in\_U}, \emph{in\_U\_prv}, \emph{in\_V}, \emph{in\_V\_prv}, \emph{in\_Qv}, \emph{in\_Qv\_prv}, \emph{in\_Qc}, \emph{in\_Qc\_prv}, \emph{in\_Qr}, \emph{in\_Qr\_prv}}{}
Method computing the \sphinxcode{gridtools.Equation{}`\textasciitilde{}s representing the :math:{}`z}-flux
for all the conservative model variables. The :class:{\color{red}\bfseries{}{}`}gridtools.Equation{}`\textasciitilde{}s are then
set as instance attributes.
As this method is marked as abstract, the implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_w} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the vertical velocity,
i.e., the change over time in potential temperature.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_s\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density,
i.e., the isentropic density stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_U} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_U\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(x\)-momentum,
i.e., the \(x\)-momentum stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_V} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_V\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(y\)-momentum,
i.e., the \(y\)-momentum stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_Qv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_Qv\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of water vapor,
i.e., the isentropic density of water vapor stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_Qc} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of cloud water.

\item {} 
\sphinxstyleliteralstrong{in\_Qc\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of cloud water,
i.e., the isentropic density of cloud water stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_Qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of precipitation water.

\item {} 
\sphinxstyleliteralstrong{in\_Qr\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of precipitation water,
i.e., the isentropic density of precipitation water stepped disregarding the vertical advection.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{factory() (dycore.flux\_isentropic.FluxIsentropic static method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic.FluxIsentropic.factory}}\pysiglinewithargsret{\sphinxbfcode{static }\sphinxbfcode{factory}}{\emph{scheme}, \emph{grid}, \emph{moist\_on}}{}
Static method which returns an instance of the derived class implementing the numerical scheme
specified by \sphinxcode{scheme}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{scheme} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the numerical scheme to implement. Either:
\begin{itemize}
\item {} 
’upwind’, for the upwind scheme;

\item {} 
’centered’, for a second-order centered scheme;

\item {} 
’maccormack’, for the MacCormack scheme.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\end{itemize}

\item[{Returns}] \leavevmode
Instance of the derived class implementing the scheme specified by \sphinxcode{scheme}.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_horizontal\_fluxes() (dycore.flux\_isentropic.FluxIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic.FluxIsentropic.get_horizontal_fluxes}}\pysiglinewithargsret{\sphinxbfcode{get\_horizontal\_fluxes}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{in\_s}, \emph{in\_u}, \emph{in\_v}, \emph{in\_mtg}, \emph{in\_U}, \emph{in\_V}, \emph{in\_Qv=None}, \emph{in\_Qc=None}, \emph{in\_Qr=None}, \emph{in\_qv\_tnd=None}, \emph{in\_qc\_tnd=None}, \emph{in\_qr\_tnd=None}}{}
Method returning the \sphinxcode{gridtools.Equation{}`\textasciitilde{}s representing the :math:{}`x}- and \(y\)-fluxes
for all the conservative model variables.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_u} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_v} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_mtg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential.

\item {} 
\sphinxstyleliteralstrong{in\_U} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_V} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_Qv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_Qc} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of cloud water.

\item {} 
\sphinxstyleliteralstrong{in\_Qr} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of precipitation water.

\item {} 
\sphinxstyleliteralstrong{in\_qv\_tnd} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the tendency of the mass fraction of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_qc\_tnd} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the tendency of the mass fraction of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_qr\_tnd} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the tendency of the mass fraction of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{flux\_s\_x} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-flux for the isentropic density.

\item {} 
\sphinxstylestrong{flux\_s\_y} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-flux for the isentropic density.

\item {} 
\sphinxstylestrong{flux\_U\_x} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-flux for the \(x\)-momentum.

\item {} 
\sphinxstylestrong{flux\_U\_y} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-flux for the \(x\)-momentum.

\item {} 
\sphinxstylestrong{flux\_V\_x} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-flux for the \(y\)-momentum.

\item {} 
\sphinxstylestrong{flux\_V\_y} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-flux for the \(y\)-momentum.

\item {} 
\sphinxstylestrong{flux\_Qv\_x} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-flux for the isentropic density of water vapor.

\item {} 
\sphinxstylestrong{flux\_Qv\_y} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-flux for the isentropic density of water vapor.

\item {} 
\sphinxstylestrong{flux\_Qc\_x} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-flux for the isentropic density of cloud liquid water.

\item {} 
\sphinxstylestrong{flux\_Qc\_y} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-flux for the isentropic density of cloud liquid water.

\item {} 
\sphinxstylestrong{flux\_Qr\_x} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-flux for the isentropic density of precipitation water.

\item {} 
\sphinxstylestrong{flux\_Qr\_y} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-flux for the isentropic density of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{get\_vertical\_fluxes() (dycore.flux\_isentropic.FluxIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic.FluxIsentropic.get_vertical_fluxes}}\pysiglinewithargsret{\sphinxbfcode{get\_vertical\_fluxes}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{in\_w}, \emph{in\_s}, \emph{in\_s\_prv}, \emph{in\_U}, \emph{in\_U\_prv}, \emph{in\_V}, \emph{in\_V\_prv}, \emph{in\_Qv=None}, \emph{in\_Qv\_prv=None}, \emph{in\_Qc=None}, \emph{in\_Qc\_prv=None}, \emph{in\_Qr=None}, \emph{in\_Qr\_prv=None}}{}
Method returning the \sphinxcode{gridtools.Equation{}`\textasciitilde{}s representing the :math:{}`z}-flux for all the conservative
model variables.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_w} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the vertical velocity,
i.e., the change over time in potential temperature.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_s\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density,
i.e., the isentropic density stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_U} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_U\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(x\)-momentum,
i.e., the \(x\)-momentum stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_V} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_V\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(y\)-momentum,
i.e., the \(y\)-momentum stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_Qv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_Qv\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of water vapor,
i.e., the isentropic density of water vapor stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_Qc} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of cloud water.

\item {} 
\sphinxstyleliteralstrong{in\_Qc\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of cloud water,
i.e., the isentropic density of cloud water stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_Qr} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of precipitation water.

\item {} 
\sphinxstyleliteralstrong{in\_Qr\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of precipitation water,
i.e., the isentropic density of precipitation water stepped disregarding the vertical advection.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{flux\_s\_z} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(z\)-flux for the isentropic density.

\item {} 
\sphinxstylestrong{flux\_U\_z} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(z\)-flux for the \(x\)-momentum.

\item {} 
\sphinxstylestrong{flux\_V\_z} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(z\)-flux for the \(y\)-momentum.

\item {} 
\sphinxstylestrong{flux\_Qv\_z} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the \(z\)-flux for the isentropic density of water vapor.

\item {} 
\sphinxstylestrong{flux\_Qc\_z} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the \(z\)-flux for the isentropic density of cloud water.

\item {} 
\sphinxstylestrong{flux\_Qr\_z} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the \(z\)-flux for the isentropic density of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{FluxIsentropicUpwind (class in dycore.flux\_isentropic\_upwind)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_upwind.FluxIsentropicUpwind}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.flux\_isentropic\_upwind.}\sphinxbfcode{FluxIsentropicUpwind}}{\emph{grid}, \emph{moist\_on}}{}
Class which inherits {\hyperref[\detokenize{api:dycore.flux_isentropic.FluxIsentropic}]{\sphinxcrossref{\sphinxcode{FluxIsentropic}}}} to implement the upwind scheme to compute
the numerical fluxes for the governing equations expressed in conservative form using isentropic coordinates.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.nb}]{\sphinxcrossref{\sphinxstyleliteralstrong{nb}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\item {} 
\sphinxstyleliteralstrong{order} (\sphinxstyleliteralemphasis{int}) \textendash{} Order of accuracy.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.flux\_isentropic\_upwind.FluxIsentropicUpwind method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_upwind.FluxIsentropicUpwind.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{moist\_on}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_compute\_horizontal\_fluxes() (dycore.flux\_isentropic\_upwind.FluxIsentropicUpwind method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_upwind.FluxIsentropicUpwind._compute_horizontal_fluxes}}\pysiglinewithargsret{\sphinxbfcode{\_compute\_horizontal\_fluxes}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{in\_s}, \emph{in\_u}, \emph{in\_v}, \emph{in\_mtg}, \emph{in\_U}, \emph{in\_V}, \emph{in\_Qv}, \emph{in\_Qc}, \emph{in\_Qr}, \emph{in\_qv\_tnd=None}, \emph{in\_qc\_tnd=None}, \emph{in\_qr\_tnd=None}}{}
Method computing the \sphinxcode{gridtools.Equation{}`\textasciitilde{}s representing the upwind :math:{}`x}-
and \(y\)-fluxes for all the conservative prognostic variables.
The :class:{\color{red}\bfseries{}{}`}gridtools.Equation{}`\textasciitilde{}s are then set as instance attributes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_u} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_v} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_mtg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential.

\item {} 
\sphinxstyleliteralstrong{in\_U} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_V} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_Qv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_Qc} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of cloud water.

\item {} 
\sphinxstyleliteralstrong{in\_Qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of precipitation water.

\item {} 
\sphinxstyleliteralstrong{in\_qv\_tnd} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the tendency of the mass fraction of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_qc\_tnd} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the tendency of the mass fraction of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_qr\_tnd} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the tendency of the mass fraction of precipitation water.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
\sphinxcode{in\_qv\_tnd}, \sphinxcode{in\_qc\_tnd}, and \sphinxcode{in\_qr\_tnd} are not actually used, yet they appear
as default arguments for compliancy with the class hierarchy interface.
\end{sphinxadmonition}

\end{fulllineitems}

\index{\_compute\_vertical\_fluxes() (dycore.flux\_isentropic\_upwind.FluxIsentropicUpwind method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_upwind.FluxIsentropicUpwind._compute_vertical_fluxes}}\pysiglinewithargsret{\sphinxbfcode{\_compute\_vertical\_fluxes}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{in\_w}, \emph{in\_s}, \emph{in\_s\_prv}, \emph{in\_U}, \emph{in\_U\_prv}, \emph{in\_V}, \emph{in\_V\_prv}, \emph{in\_Qv}, \emph{in\_Qv\_prv}, \emph{in\_Qc}, \emph{in\_Qc\_prv}, \emph{in\_Qr}, \emph{in\_Qr\_prv}}{}
Method computing the \sphinxcode{gridtools.Equation{}`\textasciitilde{}s representing the upwind :math:{}`z}-flux
for all the conservative model variables.
The :class:{\color{red}\bfseries{}{}`}gridtools.Equation{}`\textasciitilde{}s are then set as instance attributes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_w} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the vertical velocity,
i.e., the change over time of potential temperature.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_s\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density,
i.e., the isentropic density stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_U} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_U\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(x\)-momentum,
i.e., the \(x\)-momentum stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_V} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_V\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(y\)-momentum,
i.e., the \(y\)-momentum stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_Qv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_Qv\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of water vapor,
i.e., the isentropic density of water vapor stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_Qc} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of cloud water.

\item {} 
\sphinxstyleliteralstrong{in\_Qc\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of cloud water,
i.e., the isentropic density of cloud water stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_Qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of precipitation water.

\item {} 
\sphinxstyleliteralstrong{in\_Qr\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of precipitation water,
i.e., the isentropic density of precipitation water stepped disregarding the vertical advection.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_upwind\_flux\_x() (dycore.flux\_isentropic\_upwind.FluxIsentropicUpwind method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_upwind.FluxIsentropicUpwind._get_upwind_flux_x}}\pysiglinewithargsret{\sphinxbfcode{\_get\_upwind\_flux\_x}}{\emph{i}, \emph{j}, \emph{k}, \emph{in\_u}, \emph{in\_phi}}{}
Get the \sphinxcode{gridtools.Equation} representing the upwind flux in \(x\)-direction
for a generic prognostic variable \(phi\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{in\_u} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the field \(phi\).

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the upwind flux in \(x\)-direction for \(phi\).

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_upwind\_flux\_y() (dycore.flux\_isentropic\_upwind.FluxIsentropicUpwind method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_upwind.FluxIsentropicUpwind._get_upwind_flux_y}}\pysiglinewithargsret{\sphinxbfcode{\_get\_upwind\_flux\_y}}{\emph{i}, \emph{j}, \emph{k}, \emph{in\_v}, \emph{in\_phi}}{}
Get the \sphinxcode{gridtools.Equation} representing the upwind flux in \(y\)-direction
for a generic prognostic variable \(phi\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{in\_v} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the field \(phi\).

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the upwind flux in \(y\)-direction for \(phi\).

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_upwind\_flux\_z() (dycore.flux\_isentropic\_upwind.FluxIsentropicUpwind method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_upwind.FluxIsentropicUpwind._get_upwind_flux_z}}\pysiglinewithargsret{\sphinxbfcode{\_get\_upwind\_flux\_z}}{\emph{i}, \emph{j}, \emph{k}, \emph{tmp\_w\_mid}, \emph{in\_phi}}{}
Get the \sphinxcode{gridtools.Equation} representing the upwind flux in \(z\)-direction
for a generic prognostic variable \(phi\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{tmp\_w\_mid} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the vertical velocity, i.e., the change over time in
potential temperature, at the model half levels.

\item {} 
\sphinxstyleliteralstrong{in\_phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the field \(phi\).

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the upwind flux in \(z\)-direction for \(phi\).

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{FluxIsentropicCentered (class in dycore.flux\_isentropic\_centered)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_centered.FluxIsentropicCentered}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.flux\_isentropic\_centered.}\sphinxbfcode{FluxIsentropicCentered}}{\emph{grid}, \emph{moist\_on}}{}
Class which inherits \sphinxcode{FluxIsentropicNonconservative} to implement a
centered scheme to compute the numerical fluxes for the prognostic model variables.
The conservative form of the governing equations, expressed using isentropic coordinates, is used.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.nb}]{\sphinxcrossref{\sphinxstyleliteralstrong{nb}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\item {} 
\sphinxstyleliteralstrong{order} (\sphinxstyleliteralemphasis{int}) \textendash{} Order of accuracy.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.flux\_isentropic\_centered.FluxIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_centered.FluxIsentropicCentered.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{moist\_on}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_compute\_horizontal\_fluxes() (dycore.flux\_isentropic\_centered.FluxIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_centered.FluxIsentropicCentered._compute_horizontal_fluxes}}\pysiglinewithargsret{\sphinxbfcode{\_compute\_horizontal\_fluxes}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{in\_s}, \emph{in\_u}, \emph{in\_v}, \emph{in\_mtg}, \emph{in\_U}, \emph{in\_V}, \emph{in\_Qv}, \emph{in\_Qc}, \emph{in\_Qr}, \emph{in\_qv\_tnd=None}, \emph{in\_qc\_tnd=None}, \emph{in\_qr\_tnd=None}}{}
Method computing the \sphinxcode{gridtools.Equation{}`\textasciitilde{}s representing the centered :math:{}`x}-
and \(y\)-fluxes for all the conservative prognostic variables.
The :class:{\color{red}\bfseries{}{}`}gridtools.Equation{}`\textasciitilde{}s are then set as instance attributes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_u} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_v} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_mtg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential.

\item {} 
\sphinxstyleliteralstrong{in\_U} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_V} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_Qv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_Qc} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_Qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of precipitation water.

\item {} 
\sphinxstyleliteralstrong{in\_qv\_tnd} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the tendency of the mass fraction of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_qc\_tnd} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the tendency of the mass fraction of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_qr\_tnd} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the tendency of the mass fraction of precipitation water.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
\sphinxcode{in\_qv\_tnd}, \sphinxcode{in\_qc\_tnd}, and \sphinxcode{in\_qr\_tnd} are not actually used, yet they appear
as default arguments for compliancy with the class hierarchy interface.
\end{sphinxadmonition}

\end{fulllineitems}

\index{\_compute\_vertical\_fluxes() (dycore.flux\_isentropic\_centered.FluxIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_centered.FluxIsentropicCentered._compute_vertical_fluxes}}\pysiglinewithargsret{\sphinxbfcode{\_compute\_vertical\_fluxes}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{in\_w}, \emph{in\_s}, \emph{in\_s\_prv}, \emph{in\_U}, \emph{in\_U\_prv}, \emph{in\_V}, \emph{in\_V\_prv}, \emph{in\_Qv}, \emph{in\_Qv\_prv}, \emph{in\_Qc}, \emph{in\_Qc\_prv}, \emph{in\_Qr}, \emph{in\_Qr\_prv}}{}
Method computing the \sphinxcode{gridtools.Equation{}`\textasciitilde{}s representing the centered :math:{}`z}-flux
for all the conservative model variables.
The :class:{\color{red}\bfseries{}{}`}gridtools.Equation{}`\textasciitilde{}s are then set as instance attributes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_w} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the vertical velocity,
i.e., the change over time of potential temperature.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_s\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density,
i.e., the isentropic density stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_U} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_U\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(x\)-momentum,
i.e., the \(x\)-momentum stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_V} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_V\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(y\)-momentum,
i.e., the \(y\)-momentum stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_Qv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_Qv\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of water vapor,
i.e., the isentropic density of water vapor stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_Qc} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of cloud water.

\item {} 
\sphinxstyleliteralstrong{in\_Qc\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of cloud water,
i.e., the isentropic density of cloud water stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_Qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of precipitation water.

\item {} 
\sphinxstyleliteralstrong{in\_Qr\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of precipitation water,
i.e., the isentropic density of precipitation water stepped disregarding the vertical advection.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_centered\_flux\_x() (dycore.flux\_isentropic\_centered.FluxIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_centered.FluxIsentropicCentered._get_centered_flux_x}}\pysiglinewithargsret{\sphinxbfcode{\_get\_centered\_flux\_x}}{\emph{i}, \emph{j}, \emph{k}, \emph{in\_u}, \emph{in\_phi}}{}
Get the \sphinxcode{gridtools.Equation} representing the centered flux in \(x\)-direction
for a generic prognostic variable \(\phi\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{in\_u} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the field \(phi\).

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the centered flux in \(x\)-direction for \(phi\).

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_centered\_flux\_y() (dycore.flux\_isentropic\_centered.FluxIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_centered.FluxIsentropicCentered._get_centered_flux_y}}\pysiglinewithargsret{\sphinxbfcode{\_get\_centered\_flux\_y}}{\emph{i}, \emph{j}, \emph{k}, \emph{v}, \emph{in\_phi}}{}
Get the \sphinxcode{gridtools.Equation} representing the centered flux in \(y\)-direction
for a generic prognostic variable \(phi\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{v} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the field \(phi\).

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the centered flux in \(y\)-direction for \(phi\).

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_centered\_flux\_z() (dycore.flux\_isentropic\_centered.FluxIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_centered.FluxIsentropicCentered._get_centered_flux_z}}\pysiglinewithargsret{\sphinxbfcode{\_get\_centered\_flux\_z}}{\emph{i}, \emph{j}, \emph{k}, \emph{tmp\_w\_mid}, \emph{in\_phi}}{}
Get the \sphinxcode{gridtools.Equation} representing the centered flux in \(z\)-direction
for a generic prognostic variable \(phi\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{tmp\_w\_mid} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the vertical velocity, i.e., the change over time in
potential temperature, at the model half levels.

\item {} 
\sphinxstyleliteralstrong{in\_phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the field \(phi\).

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the centered flux in \(z\)-direction for \(phi\).

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{FluxIsentropicMacCormack (class in dycore.flux\_isentropic\_maccormack)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.flux\_isentropic\_maccormack.}\sphinxbfcode{FluxIsentropicMacCormack}}{\emph{grid}, \emph{moist\_on}}{}
Class which inherits {\hyperref[\detokenize{api:dycore.flux_isentropic.FluxIsentropic}]{\sphinxcrossref{\sphinxcode{FluxIsentropic}}}} to implement the MacCormack scheme to compute
the numerical fluxes for the governing equations expressed in conservative form using isentropic coordinates.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.nb}]{\sphinxcrossref{\sphinxstyleliteralstrong{nb}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\item {} 
\sphinxstyleliteralstrong{order} (\sphinxstyleliteralemphasis{int}) \textendash{} Order of accuracy.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{moist\_on}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_compute\_horizontal\_fluxes() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._compute_horizontal_fluxes}}\pysiglinewithargsret{\sphinxbfcode{\_compute\_horizontal\_fluxes}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{in\_s}, \emph{in\_u}, \emph{in\_v}, \emph{in\_mtg}, \emph{in\_U}, \emph{in\_V}, \emph{in\_Qv}, \emph{in\_Qc}, \emph{in\_Qr}, \emph{in\_qv\_tnd=None}, \emph{in\_qc\_tnd=None}, \emph{in\_qr\_tnd=None}}{}
Method computing the \sphinxcode{gridtools.Equation{}`\textasciitilde{}s representing the MacCormack :math:{}`x}-
and \(y\)-fluxes for all the conservative prognostic variables.
The :class:{\color{red}\bfseries{}{}`}gridtools.Equation{}`\textasciitilde{}s are then set as instance attributes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_u} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_v} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_mtg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential.

\item {} 
\sphinxstyleliteralstrong{in\_U} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_V} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_Qv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of water vapour.

\item {} 
\sphinxstyleliteralstrong{in\_Qc} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of cloud water.

\item {} 
\sphinxstyleliteralstrong{in\_Qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of precipitation water.

\item {} 
\sphinxstyleliteralstrong{in\_qv\_tnd} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the tendency of the mass fraction of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_qc\_tnd} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the tendency of the mass fraction of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_qr\_tnd} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the tendency of the mass fraction of precipitation water.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_compute\_vertical\_fluxes() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._compute_vertical_fluxes}}\pysiglinewithargsret{\sphinxbfcode{\_compute\_vertical\_fluxes}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{in\_w}, \emph{in\_s}, \emph{in\_s\_prv}, \emph{in\_U}, \emph{in\_U\_prv}, \emph{in\_V}, \emph{in\_V\_prv}, \emph{in\_Qv}, \emph{in\_Qv\_prv}, \emph{in\_Qc}, \emph{in\_Qc\_prv}, \emph{in\_Qr}, \emph{in\_Qr\_prv}}{}
Method computing the \sphinxcode{gridtools.Equation{}`\textasciitilde{}s representing the MacCormack :math:{}`z}-flux
for all the conservative model variables.
The :class:{\color{red}\bfseries{}{}`}gridtools.Equation{}`\textasciitilde{}s are then set as instance attributes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_w} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the vertical velocity,
i.e., the change over time of potential temperature.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_s\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density,
i.e., the isentropic density stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_U} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_U\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(x\)-momentum,
i.e., the \(x\)-momentum stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_V} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_V\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(y\)-momentum,
i.e., the \(y\)-momentum stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_Qv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_Qv\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of water vapor,
i.e., the isentropic density of water vapor stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_Qc} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of cloud water.

\item {} 
\sphinxstyleliteralstrong{in\_Qc\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of cloud water,
i.e., the isentropic density of cloud water stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_Qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of precipitation water.

\item {} 
\sphinxstyleliteralstrong{in\_Qr\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of precipitation water,
i.e., the isentropic density of precipitation water stepped disregarding the vertical advection.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_maccormack\_flux\_x() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_flux_x}}\pysiglinewithargsret{\sphinxbfcode{\_get\_maccormack\_flux\_x}}{\emph{i}, \emph{j}, \emph{k}, \emph{tmp\_u\_unstg}, \emph{in\_phi}, \emph{tmp\_u\_prd\_unstg}, \emph{tmp\_phi\_prd}}{}
Get the \sphinxcode{gridtools.Equation} representing the MacCormack flux in \(x\)-direction
for a generic prognostic variable \(\phi\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{tmp\_u\_unstg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the unstaggered \(x\)-velocity at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the field \(\phi\) at the current time.

\item {} 
\sphinxstyleliteralstrong{tmp\_u\_prd\_unstg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the predicted value for the unstaggered \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{tmp\_phi\_prd} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the predicted value for the field \(\phi\).

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the MacCormack flux in \(x\)-direction for \(\phi\).

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_maccormack\_flux\_x\_s() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_flux_x_s}}\pysiglinewithargsret{\sphinxbfcode{\_get\_maccormack\_flux\_x\_s}}{\emph{i}, \emph{j}, \emph{k}, \emph{in\_U}, \emph{tmp\_U\_prd}}{}
Get the \sphinxcode{gridtools.Equation} representing the MacCormack flux in \(x\)-direction
for the isentropic density.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{in\_U} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-momentum at the current time.

\item {} 
\sphinxstyleliteralstrong{tmp\_U\_prd} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the predicted value for the \(x\)-momentum.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the MacCormack flux in \(x\)-direction for the isentropic density.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_maccormack\_flux\_y() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_flux_y}}\pysiglinewithargsret{\sphinxbfcode{\_get\_maccormack\_flux\_y}}{\emph{i}, \emph{j}, \emph{k}, \emph{tmp\_v\_unstg}, \emph{in\_phi}, \emph{tmp\_v\_prd\_unstg}, \emph{tmp\_phi\_prd}}{}
Get the \sphinxcode{gridtools.Equation} representing the MacCormack flux in \(y\)-direction
for a generic prognostic variable \(\phi\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{tmp\_v\_unstg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the unstaggered \(y\)-velocity at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the field \(\phi\) at the current time.

\item {} 
\sphinxstyleliteralstrong{tmp\_v\_prd\_unstg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the predicted value for the unstaggered \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{tmp\_phi\_prd} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the predicted value for the field \(\phi\).

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the MacCormack flux in \(y\)-direction for \(\phi\).

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_maccormack\_flux\_y\_s() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_flux_y_s}}\pysiglinewithargsret{\sphinxbfcode{\_get\_maccormack\_flux\_y\_s}}{\emph{i}, \emph{j}, \emph{k}, \emph{in\_V}, \emph{tmp\_V\_prd}}{}
Get the \sphinxcode{gridtools.Equation} representing the MacCormack flux in \(y\)-direction
for the isentropic density.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{in\_V} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-momentum at the current time.

\item {} 
\sphinxstyleliteralstrong{tmp\_V\_prd} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the predicted value for the \(y\)-momentum.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the MacCormack flux in \(y\)-direction for the isentropic density.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_maccormack\_flux\_z() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_flux_z}}\pysiglinewithargsret{\sphinxbfcode{\_get\_maccormack\_flux\_z}}{\emph{i}, \emph{j}, \emph{k}, \emph{in\_w}, \emph{in\_phi}, \emph{in\_phi\_prv}, \emph{tmp\_phi\_prd}}{}
Get the \sphinxcode{gridtools.Equation} representing the MacCormack flux in \(z\)-direction for a
generic prognostic variable \(\phi\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{in\_w} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the vertical velocity,
i.e., the change over time in potential temperature.

\item {} 
\sphinxstyleliteralstrong{in\_phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the field \(\phi\) at current time.

\item {} 
\sphinxstyleliteralstrong{in\_phi\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional value for \(\phi\),
i.e., \(\phi\) stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{tmp\_phi\_prd} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the predicted value for the field \(\phi\).

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the MacCormack flux in \(z\)-direction for \(\phi\).

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_maccormack\_horizontal\_predicted\_value\_Q() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_horizontal_predicted_value_Q}}\pysiglinewithargsret{\sphinxbfcode{\_get\_maccormack\_horizontal\_predicted\_value\_Q}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{in\_s}, \emph{tmp\_u\_unstg}, \emph{tmp\_v\_unstg}, \emph{in\_Q}, \emph{in\_q\_tnd}}{}
Get the \sphinxcode{gridtools.Equation} representing the predicted value for the isentropic
density of a generic water constituent, computed without taking the vertical advection into account.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the air isentropic density.

\item {} 
\sphinxstyleliteralstrong{tmp\_u\_unstg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the unstaggered \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{tmp\_v\_unstg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the unstaggered \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_Q} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of a generic water constituent.

\item {} 
\sphinxstyleliteralstrong{in\_q\_tnd} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the tendency of the mass fraction of the water constituent.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the predicted value for the water constituent.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_maccormack\_horizontal\_predicted\_value\_U() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_horizontal_predicted_value_U}}\pysiglinewithargsret{\sphinxbfcode{\_get\_maccormack\_horizontal\_predicted\_value\_U}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{in\_s}, \emph{tmp\_u\_unstg}, \emph{tmp\_v\_unstg}, \emph{in\_mtg}, \emph{in\_U}}{}
Get the \sphinxcode{gridtools.Equation} representing the predicted value for the \(x\)-momentum,
computed without taking the vertical advection into account.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{tmp\_u\_unstg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the unstaggered \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{tmp\_v\_unstg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the unstaggered \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_mtg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential.

\item {} 
\sphinxstyleliteralstrong{in\_U} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-momentum.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the predicted value for the \(x\)-momentum.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_maccormack\_horizontal\_predicted\_value\_V() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_horizontal_predicted_value_V}}\pysiglinewithargsret{\sphinxbfcode{\_get\_maccormack\_horizontal\_predicted\_value\_V}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{in\_s}, \emph{tmp\_u\_unstg}, \emph{tmp\_v\_unstg}, \emph{in\_mtg}, \emph{in\_V}}{}
Get the \sphinxcode{gridtools.Equation} representing the predicted value for the \(y\)-momentum,
computed without taking the vertical advection into account.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{tmp\_u\_unstg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the unstaggered \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{tmp\_v\_unstg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the unstaggered \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_mtg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential.

\item {} 
\sphinxstyleliteralstrong{in\_V} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-momentum.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the predicted value for the \(y\)-momentum.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_maccormack\_horizontal\_predicted\_value\_s() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_horizontal_predicted_value_s}}\pysiglinewithargsret{\sphinxbfcode{\_get\_maccormack\_horizontal\_predicted\_value\_s}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{in\_s}, \emph{in\_U}, \emph{in\_V}}{}
Get the \sphinxcode{gridtools.Equation} representing the predicted value for the isentropic density,
computed without taking the vertical advection into account.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_U} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_V} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-momentum.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the predicted value for the isentropic density.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_maccormack\_vertical\_predicted\_value() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_maccormack_vertical_predicted_value}}\pysiglinewithargsret{\sphinxbfcode{\_get\_maccormack\_vertical\_predicted\_value}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{in\_w}, \emph{in\_phi}, \emph{in\_phi\_prv}}{}
Get the \sphinxcode{gridtools.Equation} representing the predicted value for a generic conservative prognostic
variable \(\phi\), computed taking only the vertical advection into account.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_w} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the vertical velocity, i.e., the change over time in potential temperature.

\item {} 
\sphinxstyleliteralstrong{in\_phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the field \(\phi\) at current time.

\item {} 
\sphinxstyleliteralstrong{in\_phi\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional value for \(\phi\), i.e., \(\phi\) stepped
disregarding the vertical advection.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the predicted value for \(\phi\).

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_velocity() (dycore.flux\_isentropic\_maccormack.FluxIsentropicMacCormack method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_maccormack.FluxIsentropicMacCormack._get_velocity}}\pysiglinewithargsret{\sphinxbfcode{\_get\_velocity}}{\emph{i}, \emph{j}, \emph{k}, \emph{s}, \emph{mnt}}{}
Get the \sphinxcode{gridtools.Equation} representing an unstaggered velocity component.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{mnt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing either the \(x\)- or the \(y\)-momentum.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the diagnosed unstaggered velocity component.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{FluxIsentropicNonconservative (class in dycore.flux\_isentropic\_nonconservative)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_nonconservative.FluxIsentropicNonconservative}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.flux\_isentropic\_nonconservative.}\sphinxbfcode{FluxIsentropicNonconservative}}{\emph{grid}, \emph{moist\_on}}{}
Abstract base class whose derived classes implement different schemes to compute the numerical fluxes for
the three-dimensional isentropic dynamical core. The nonconservative form of the governing equations is used.
\index{\_\_init\_\_() (dycore.flux\_isentropic\_nonconservative.FluxIsentropicNonconservative method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_nonconservative.FluxIsentropicNonconservative.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{moist\_on}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_compute\_horizontal\_fluxes() (dycore.flux\_isentropic\_nonconservative.FluxIsentropicNonconservative method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_nonconservative.FluxIsentropicNonconservative._compute_horizontal_fluxes}}\pysiglinewithargsret{\sphinxbfcode{\_compute\_horizontal\_fluxes}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{in\_s}, \emph{in\_u}, \emph{in\_v}, \emph{in\_mtg}, \emph{in\_qv}, \emph{in\_qc}, \emph{in\_qr}}{}
Method computing the \sphinxcode{gridtools.Equation{}`\textasciitilde{}s representing the :math:{}`x}- and \(y\)-fluxes for
all the prognostic variables. The :class:{\color{red}\bfseries{}{}`}gridtools.Equation{}`\textasciitilde{}s are then set as instance attributes.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_u} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_v} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_mtg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential.

\item {} 
\sphinxstyleliteralstrong{in\_qv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of water vapour.

\item {} 
\sphinxstyleliteralstrong{in\_qc} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of precipitation water.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_compute\_vertical\_fluxes() (dycore.flux\_isentropic\_nonconservative.FluxIsentropicNonconservative method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_nonconservative.FluxIsentropicNonconservative._compute_vertical_fluxes}}\pysiglinewithargsret{\sphinxbfcode{\_compute\_vertical\_fluxes}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{in\_w}, \emph{in\_s}, \emph{in\_s\_prv}, \emph{in\_U}, \emph{in\_U\_prv}, \emph{in\_V}, \emph{in\_V\_prv}, \emph{in\_Qv}, \emph{in\_Qv\_prv}, \emph{in\_Qc}, \emph{in\_Qc\_prv}, \emph{in\_Qr}, \emph{in\_Qr\_prv}}{}
Method computing the \sphinxcode{gridtools.Equation{}`\textasciitilde{}s representing the :math:}theta{}`-fluxes for all the
prognostic model variables. The :class:{\color{red}\bfseries{}{}`}gridtools.Equation{}`\textasciitilde{}s are then set as instance attributes.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_w} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the vertical velocity, i.e.,
the change over time of potential temperature.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_s\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density, i.e.,
the isentropic density stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_u} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_u\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(x\)-velocity, i.e.,
the \(x\)-velocity stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_v} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_v\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(y\)-velocity, i.e.,
the \(y\)-velocity stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_qv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current mass fraction of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_qv\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional mass fraction of water vapor,
i.e., the mass fraction of water vapor stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_qc} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current mass fraction of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_qc\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional mass fraction of cloud liquid water,
i.e., the mass fraction of cloud liquid water stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current mass fraction of precipitation water.

\item {} 
\sphinxstyleliteralstrong{in\_qr\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional mass fraction of precipitation water,
i.e., the mass fraction of precipitation water stepped disregarding the vertical advection.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{factory() (dycore.flux\_isentropic\_nonconservative.FluxIsentropicNonconservative static method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_nonconservative.FluxIsentropicNonconservative.factory}}\pysiglinewithargsret{\sphinxbfcode{static }\sphinxbfcode{factory}}{\emph{scheme}, \emph{grid}, \emph{moist\_on}}{}
Static method which returns an instance of the derived class implementing the numerical scheme
specified by \sphinxcode{scheme}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{scheme} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the numerical scheme to implement. Either:
\begin{itemize}
\item {} 
’centered’, for a second-order centered scheme.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\end{itemize}

\item[{Returns}] \leavevmode
Instance of the derived class implementing the scheme specified by \sphinxcode{scheme}.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_horizontal\_fluxes() (dycore.flux\_isentropic\_nonconservative.FluxIsentropicNonconservative method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_nonconservative.FluxIsentropicNonconservative.get_horizontal_fluxes}}\pysiglinewithargsret{\sphinxbfcode{get\_horizontal\_fluxes}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{in\_s}, \emph{in\_u}, \emph{in\_v}, \emph{in\_mtg}, \emph{in\_qv=None}, \emph{in\_qc=None}, \emph{in\_qr=None}}{}
Method returning the \sphinxcode{gridtools.Equation{}`\textasciitilde{}s representing the :math:{}`x}- and \(y\)-fluxes
for all the prognostic model variables.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_u} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_v} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_mtg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential.

\item {} 
\sphinxstyleliteralstrong{in\_qv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of water vapour.

\item {} 
\sphinxstyleliteralstrong{in\_qc} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{flux\_s\_x} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-flux for the isentropic density.

\item {} 
\sphinxstylestrong{flux\_s\_y} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-flux for the isentropic density.

\item {} 
\sphinxstylestrong{flux\_u\_x} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-flux for the \(x\)-velocity.

\item {} 
\sphinxstylestrong{flux\_u\_y} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-flux for the \(x\)-velocity.

\item {} 
\sphinxstylestrong{flux\_v\_x} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-flux for the \(y\)-velocity.

\item {} 
\sphinxstylestrong{flux\_v\_y} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-flux for the \(y\)-velocity.

\item {} 
\sphinxstylestrong{flux\_qv\_x} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-flux for the mass fraction of water vapor.

\item {} 
\sphinxstylestrong{flux\_qv\_y} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-flux for the mass fraction of water vapor.

\item {} 
\sphinxstylestrong{flux\_qc\_x} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-flux for the mass fraction of cloud liquid water.

\item {} 
\sphinxstylestrong{flux\_qc\_y} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-flux for the mass fraction of cloud liquid water.

\item {} 
\sphinxstylestrong{flux\_qr\_x} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-flux for the mass fraction of precipitation water.

\item {} 
\sphinxstylestrong{flux\_qr\_y} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-flux for the mass fraction of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{get\_vertical\_fluxes() (dycore.flux\_isentropic\_nonconservative.FluxIsentropicNonconservative method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_nonconservative.FluxIsentropicNonconservative.get_vertical_fluxes}}\pysiglinewithargsret{\sphinxbfcode{get\_vertical\_fluxes}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{in\_w}, \emph{in\_s}, \emph{in\_s\_prv}, \emph{in\_u}, \emph{in\_u\_prv}, \emph{in\_v}, \emph{in\_v\_prv}, \emph{in\_qv=None}, \emph{in\_qv\_prv=None}, \emph{in\_qc=None}, \emph{in\_qc\_prv=None}, \emph{in\_qr=None}, \emph{in\_qr\_prv=None}}{}
Method returning the \sphinxcode{gridtools.Equation{}`\textasciitilde{}s representing the :math:}theta{}`-flux for all
the prognostic model variables.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_w} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the vertical velocity, i.e.,
the change over time in potential temperature.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_s\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density, i.e.,
the isentropic density stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_u} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_u\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(x\)-velocity, i.e.,
the \(x\)-velocity stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_v} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_v\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(y\)-velocity, i.e.,
the \(y\)-velocity stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_qv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current mass fraction of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_qv\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional mass fraction of water vapor,
i.e., the mass fraction of water vapor stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_qc} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current mass fraction of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_qc\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional mass fraction of cloud liquid water,
i.e., the mass fraction of cloud liquid water stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current mass fraction of precipitation water.

\item {} 
\sphinxstyleliteralstrong{in\_qr\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional mass fraction of precipitation water,
i.e., the mass fraction of precipitation water stepped disregarding the vertical advection.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{flux\_s\_z} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(\theta\)-flux for the isentropic density.

\item {} 
\sphinxstylestrong{flux\_u\_z} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(\theta\)-flux for the \(x\)-velocity.

\item {} 
\sphinxstylestrong{flux\_v\_z} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(\theta\)-flux for the \(y\)-velocity.

\item {} 
\sphinxstylestrong{flux\_qv\_z} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the \(\theta\)-flux for the mass fraction of water vapor.

\item {} 
\sphinxstylestrong{flux\_qc\_z} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the \(\theta\)-flux for the mass fraction of cloud liquid water.

\item {} 
\sphinxstylestrong{flux\_qr\_z} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the \(\theta\)-flux for the mass fraction of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{FluxIsentropicNonconservativeCentered (class in dycore.flux\_isentropic\_nonconservative\_centered)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_nonconservative_centered.FluxIsentropicNonconservativeCentered}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.flux\_isentropic\_nonconservative\_centered.}\sphinxbfcode{FluxIsentropicNonconservativeCentered}}{\emph{grid}, \emph{moist\_on}}{}
Class which inherits \sphinxcode{FluxIsentropicNonconservative} to implement a
centered scheme to compute the numerical fluxes for the prognostic model variables.
The nonconservative form of the governing equations, expressed using isentropic coordinates, is used.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.nb}]{\sphinxcrossref{\sphinxstyleliteralstrong{nb}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of boundary layers.

\item {} 
\sphinxstyleliteralstrong{order} (\sphinxstyleliteralemphasis{int}) \textendash{} Order of accuracy.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.flux\_isentropic\_nonconservative\_centered.FluxIsentropicNonconservativeCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_nonconservative_centered.FluxIsentropicNonconservativeCentered.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{moist\_on}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{GridXYZ} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_compute\_horizontal\_fluxes() (dycore.flux\_isentropic\_nonconservative\_centered.FluxIsentropicNonconservativeCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_nonconservative_centered.FluxIsentropicNonconservativeCentered._compute_horizontal_fluxes}}\pysiglinewithargsret{\sphinxbfcode{\_compute\_horizontal\_fluxes}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{in\_s}, \emph{in\_u}, \emph{in\_v}, \emph{in\_mtg}, \emph{in\_qv}, \emph{in\_qc}, \emph{in\_qr}}{}
Method computing the \sphinxcode{gridtools.Equation{}`\textasciitilde{}s representing the :math:{}`x}- and \(y\)-fluxes for
all the prognostic variables. The :class:{\color{red}\bfseries{}{}`}gridtools.Equation{}`\textasciitilde{}s are then set as instance attributes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_u} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_v} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_mtg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential.

\item {} 
\sphinxstyleliteralstrong{in\_qv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of water vapour.

\item {} 
\sphinxstyleliteralstrong{in\_qc} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of precipitation water.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_compute\_vertical\_fluxes() (dycore.flux\_isentropic\_nonconservative\_centered.FluxIsentropicNonconservativeCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_nonconservative_centered.FluxIsentropicNonconservativeCentered._compute_vertical_fluxes}}\pysiglinewithargsret{\sphinxbfcode{\_compute\_vertical\_fluxes}}{\emph{i}, \emph{j}, \emph{k}, \emph{dt}, \emph{in\_w}, \emph{in\_s}, \emph{in\_s\_prv}, \emph{in\_U}, \emph{in\_U\_prv}, \emph{in\_V}, \emph{in\_V\_prv}, \emph{in\_Qv}, \emph{in\_Qv\_prv}, \emph{in\_Qc}, \emph{in\_Qc\_prv}, \emph{in\_Qr}, \emph{in\_Qr\_prv}}{}
Method computing the \sphinxcode{gridtools.Equation{}`\textasciitilde{}s representing the :math:}theta{}`-fluxes for all the
prognostic model variables. The :class:{\color{red}\bfseries{}{}`}gridtools.Equation{}`\textasciitilde{}s are then set as instance attributes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_w} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the vertical velocity, i.e.,
the change over time of potential temperature.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_s\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density, i.e.,
the isentropic density stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_u} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_u\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(x\)-velocity, i.e.,
the \(x\)-velocity stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_v} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_v\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(y\)-velocity, i.e.,
the \(y\)-velocity stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_qv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current mass fraction of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_qv\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional mass fraction of water vapor,
i.e., the mass fraction of water vapor stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_qc} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current mass fraction of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_qc\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional mass fraction of cloud liquid water,
i.e., the mass fraction of cloud liquid water stepped disregarding the vertical advection.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current mass fraction of precipitation water.

\item {} 
\sphinxstyleliteralstrong{in\_qr\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional mass fraction of precipitation water,
i.e., the mass fraction of precipitation water stepped disregarding the vertical advection.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_centered\_flux\_x\_s() (dycore.flux\_isentropic\_nonconservative\_centered.FluxIsentropicNonconservativeCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_nonconservative_centered.FluxIsentropicNonconservativeCentered._get_centered_flux_x_s}}\pysiglinewithargsret{\sphinxbfcode{\_get\_centered\_flux\_x\_s}}{\emph{i}, \emph{j}, \emph{k}, \emph{in\_u}, \emph{in\_s}}{}
Get the \(x\)-flux for the isentropic density.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{in\_u} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the \(x\)-flux for the isentropic density.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_centered\_flux\_x\_u() (dycore.flux\_isentropic\_nonconservative\_centered.FluxIsentropicNonconservativeCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_nonconservative_centered.FluxIsentropicNonconservativeCentered._get_centered_flux_x_u}}\pysiglinewithargsret{\sphinxbfcode{\_get\_centered\_flux\_x\_u}}{\emph{i}, \emph{j}, \emph{k}, \emph{in\_u}}{}
Get the \(x\)-flux for the \(x\)-velocity.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{in\_u} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-velocity.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the \(x\)-flux for the \(x\)-velocity.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_centered\_flux\_x\_unstg() (dycore.flux\_isentropic\_nonconservative\_centered.FluxIsentropicNonconservativeCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_nonconservative_centered.FluxIsentropicNonconservativeCentered._get_centered_flux_x_unstg}}\pysiglinewithargsret{\sphinxbfcode{\_get\_centered\_flux\_x\_unstg}}{\emph{i}, \emph{j}, \emph{k}, \emph{in\_phi}}{}
Get the \(x\)-flux for a generic \(x\)-unstaggered field.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{in\_phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the advected field.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the \(x\)-flux for the advected field.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_centered\_flux\_y\_s() (dycore.flux\_isentropic\_nonconservative\_centered.FluxIsentropicNonconservativeCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_nonconservative_centered.FluxIsentropicNonconservativeCentered._get_centered_flux_y_s}}\pysiglinewithargsret{\sphinxbfcode{\_get\_centered\_flux\_y\_s}}{\emph{i}, \emph{j}, \emph{k}, \emph{in\_v}, \emph{in\_s}}{}
Get the \(y\)-flux for the isentropic density.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{in\_v} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the \(y\)-flux for the isentropic density.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_centered\_flux\_y\_unstg() (dycore.flux\_isentropic\_nonconservative\_centered.FluxIsentropicNonconservativeCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_nonconservative_centered.FluxIsentropicNonconservativeCentered._get_centered_flux_y_unstg}}\pysiglinewithargsret{\sphinxbfcode{\_get\_centered\_flux\_y\_unstg}}{\emph{i}, \emph{j}, \emph{k}, \emph{in\_phi}}{}
Get the \(y\)-flux for a generic \(y\)-unstaggered field.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{in\_phi} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the advected field.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the \(y\)-flux for the advected field.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_get\_centered\_flux\_y\_v() (dycore.flux\_isentropic\_nonconservative\_centered.FluxIsentropicNonconservativeCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_isentropic_nonconservative_centered.FluxIsentropicNonconservativeCentered._get_centered_flux_y_v}}\pysiglinewithargsret{\sphinxbfcode{\_get\_centered\_flux\_y\_v}}{\emph{i}, \emph{j}, \emph{k}, \emph{in\_v}}{}
Get the \(y\)-flux for the \(y\)-velocity.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{in\_v} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-velocity.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the \(y\)-flux for the \(y\)-velocity.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{Prognostics}
\label{\detokenize{api:prognostics}}\index{PrognosticIsentropic (class in dycore.prognostic\_isentropic)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.prognostic\_isentropic.}\sphinxbfcode{PrognosticIsentropic}}{\emph{flux\_scheme}, \emph{grid}, \emph{moist\_on}, \emph{backend}, \emph{physics\_dynamics\_coupling\_on}, \emph{sedimentation\_on}, \emph{sedimentation\_flux\_type}, \emph{sedimentation\_substeps}}{}
Abstract base class whose derived classes implement different schemes to carry out the prognostic steps of
the three-dimensional moist isentropic dynamical core. The conservative form of the governing equations is used.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode
{\hyperref[\detokenize{api:dycore.dycore.DynamicalCore.fast_tendency_parameterizations}]{\sphinxcrossref{\sphinxstyleliteralstrong{fast\_tendency\_parameterizations}}}} (\sphinxstyleliteralemphasis{list}) \textendash{} List containing instances of derived classes of
\sphinxcode{FastTendency} which are in charge of
calculating fast-varying tendencies.

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.prognostic\_isentropic.PrognosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{flux\_scheme}, \emph{grid}, \emph{moist\_on}, \emph{backend}, \emph{physics\_dynamics\_coupling\_on}, \emph{sedimentation\_on}, \emph{sedimentation\_flux\_type}, \emph{sedimentation\_substeps}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{flux\_scheme} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the flux scheme to use. Either:
\begin{itemize}
\item {} 
’upwind’, for the upwind flux;

\item {} 
’centered’, for a second-order centered flux;

\item {} 
’maccormack’, for the MacCormack flux.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py stencils.

\item {} 
\sphinxstyleliteralstrong{physics\_dynamics\_coupling\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} to couple physics with dynamics, i.e., to account for the change over time in potential temperature,
\sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{sedimentation\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} to account for rain sedimentation, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{sedimentation\_flux\_type} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the method used to compute the numerical sedimentation flux. Available options are:
\begin{itemize}
\item {} 
’first\_order\_upwind’, for the first-order upwind scheme;

\item {} 
’second\_order\_upwind’, for the second-order upwind scheme.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{sedimentation\_substeps} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of sub-timesteps to perform in order to integrate the sedimentation flux.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_allocate\_inputs() (dycore.prognostic\_isentropic.PrognosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic._stencil_stepping_by_coupling_physics_with_dynamics_allocate_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_allocate\_inputs}}{}{}
Allocate the attributes which serve as inputs to the GT4Py stencil which step the solution
by coupling physics with dynamics, i.e., accounting for the change over time in potential temperature.

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_allocate\_outputs() (dycore.prognostic\_isentropic.PrognosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic._stencil_stepping_by_coupling_physics_with_dynamics_allocate_outputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_allocate\_outputs}}{}{}
Allocate the Numpy arrays which will store the solution updated by coupling physics with dynamics.

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_defs() (dycore.prognostic\_isentropic.PrognosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic._stencil_stepping_by_coupling_physics_with_dynamics_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_defs}}{\emph{dt}, \emph{in\_w}, \emph{in\_s\_now}, \emph{in\_s\_prv}, \emph{in\_U\_now}, \emph{in\_U\_prv}, \emph{in\_V\_now}, \emph{in\_V\_prv}, \emph{Qv\_now=None}, \emph{Qv\_prv=None}, \emph{Qc\_now=None}, \emph{Qc\_prv=None}, \emph{Qr\_now=None}, \emph{Qr\_prv=None}}{}
GT4Py stencil stepping the solution by coupling physics with dynamics, i.e., by accounting for the
change over time in potential temperature.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_w} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the vertical velocity, i.e., the change over time in potential temperature.

\item {} 
\sphinxstyleliteralstrong{in\_s\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_s\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_U\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_U\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_V\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_V\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_Qv\_now} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_Qv\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_Qc\_now} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_Qc\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_Qr\_now} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of precipitation water.

\item {} 
\sphinxstyleliteralstrong{in\_Qr\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_s} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the updated isentropic density.

\item {} 
\sphinxstylestrong{out\_U} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the updated \(x\)-momentum.

\item {} 
\sphinxstylestrong{out\_V} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the updated \(y\)-momentum.

\item {} 
\sphinxstylestrong{out\_Qv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the updated isentropic density of water vapor.

\item {} 
\sphinxstylestrong{out\_Qc} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the updated isentropic density of cloud liquid water.

\item {} 
\sphinxstylestrong{out\_Qr} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the updated isentropic density of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_initialize() (dycore.prognostic\_isentropic.PrognosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic._stencil_stepping_by_coupling_physics_with_dynamics_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_initialize}}{\emph{state\_now}}{}
Initialize the GT4Py stencil in charge of stepping the solution by coupling physics with dynamics,
i.e., by accounting for the change over time in potential temperature.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{state\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
\sphinxcode{StateIsentropic} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered).

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_set\_inputs() (dycore.prognostic\_isentropic.PrognosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic._stencil_stepping_by_coupling_physics_with_dynamics_set_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_set\_inputs}}{\emph{dt}, \emph{state\_now}, \emph{state\_prv}, \emph{tendencies}}{}
Update the attributes which serve as inputs to the GT4Py stencil which steps the solution
by integrating the vertical advection, i.e., by accounting for the change over time in potential temperature.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} A \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
water\_vapor\_isentropic\_density (unstaggered, optional);

\item {} 
cloud\_liquid\_water\_isentropic\_density (unstaggered, optional);

\item {} 
precipitation\_water\_isentropic\_density (unstaggered, optional).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{state\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the provisional state, i.e.,
the state stepped taking only the horizontal derivatives into account.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
water\_vapor\_isentropic\_density (unstaggered, optional);

\item {} 
cloud\_liquid\_water\_isentropic\_density (unstaggered, optional);

\item {} 
precipitation\_water\_isentropic\_density (unstaggered, optional).

\end{itemize}

This may be the output of
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.step_neglecting_vertical_advection}]{\sphinxcrossref{\sphinxcode{step\_neglecting\_vertical\_advection()}}}}.


\item {} 
\sphinxstyleliteralstrong{tendencies} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} collecting the following tendencies:
\begin{itemize}
\item {} 
tendency\_of\_air\_potential\_temperature (unstaggered).

\end{itemize}


\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_allocate\_inputs() (dycore.prognostic\_isentropic.PrognosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic._stencils_stepping_by_neglecting_vertical_advection_allocate_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_allocate\_inputs}}{\emph{mi}, \emph{mj}, \emph{tendencies}}{}
Allocate the attributes which serve as inputs to the GT4Py stencils which step the solution
disregarding the vertical advection.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{mi} (\sphinxstyleliteralemphasis{int}) \textendash{} \(x\)-extent of an input array representing an \(x\)-unstaggered field.

\item {} 
\sphinxstyleliteralstrong{mj} (\sphinxstyleliteralemphasis{int}) \textendash{} \(y\)-extent of an input array representing a \(y\)-unstaggered field.

\item {} 
\sphinxstyleliteralstrong{tendencies} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing the following tendencies:
\begin{itemize}
\item {} 
tendency\_of\_mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered);

\item {} 
tendency\_of\_mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
tendency\_of\_mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}


\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_allocate\_outputs() (dycore.prognostic\_isentropic.PrognosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic._stencils_stepping_by_neglecting_vertical_advection_allocate_outputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_allocate\_outputs}}{\emph{mi}, \emph{mj}}{}
Allocate the Numpy arrays which will store the solution updated by neglecting the vertical advection.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{mi} (\sphinxstyleliteralemphasis{int}) \textendash{} \(x\)-extent of an output array representing an \(x\)-unstaggered field.

\item {} 
\sphinxstyleliteralstrong{mj} (\sphinxstyleliteralemphasis{int}) \textendash{} \(y\)-extent of an output array representing a \(y\)-unstaggered field.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_set\_inputs() (dycore.prognostic\_isentropic.PrognosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic._stencils_stepping_by_neglecting_vertical_advection_set_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_set\_inputs}}{\emph{dt}, \emph{state}, \emph{tendencies}}{}
Update the attributes which serve as inputs to the GT4Py stencils which step the solution
disregarding the vertical advection.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} A \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
\sphinxcode{StateIsentropic} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
montgomery\_potential (isentropic);

\item {} 
water\_vapor\_isentropic\_density (unstaggered, optional);

\item {} 
cloud\_liquid\_water\_isentropic\_density (unstaggered, optional);

\item {} 
precipitation\_water\_isentropic\_density (unstaggered, optional).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{tendencies} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing the following tendencies:
\begin{itemize}
\item {} 
tendency\_of\_mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered);

\item {} 
tendency\_of\_mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
tendency\_of\_mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}


\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{boundary (dycore.prognostic\_isentropic.PrognosticIsentropic attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.boundary}}\pysigline{\sphinxbfcode{boundary}}
Get the attribute implementing the horizontal boundary conditions.
If this is set to \sphinxcode{None}, a \sphinxcode{ValueError} is thrown.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
Instance of the derived class of {\hyperref[\detokenize{api:dycore.horizontal_boundary.HorizontalBoundary}]{\sphinxcrossref{\sphinxcode{HorizontalBoundary}}}} implementing
the horizontal boundary conditions.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{diagnostic (dycore.prognostic\_isentropic.PrognosticIsentropic attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.diagnostic}}\pysigline{\sphinxbfcode{diagnostic}}
Get the attribute implementing the diagnostic step of the three-dimensional moist isentropic dynamical core.
If this is set to \sphinxcode{None}, a \sphinxcode{ValueError} is thrown.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
{\hyperref[\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic}]{\sphinxcrossref{\sphinxcode{DiagnosticIsentropic}}}} carrying out the diagnostic step of the
three-dimensional moist isentropic dynamical core.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{factory() (dycore.prognostic\_isentropic.PrognosticIsentropic static method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.factory}}\pysiglinewithargsret{\sphinxbfcode{static }\sphinxbfcode{factory}}{\emph{time\_scheme}, \emph{flux\_scheme}, \emph{grid}, \emph{moist\_on}, \emph{backend}, \emph{physics\_dynamics\_coupling\_on}, \emph{sedimentation\_on}, \emph{sedimentation\_flux\_type}, \emph{sedimentation\_substeps}}{}
Static method returning an instace of the derived class implementing the time stepping scheme specified
by \sphinxcode{time\_scheme}, using the flux scheme specified by \sphinxcode{flux\_scheme}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{time\_scheme} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the time stepping method to implement. Either:
\begin{itemize}
\item {} 
’forward\_euler’, for the forward Euler scheme;

\item {} 
’centered’, for a centered scheme.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{flux\_scheme} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the scheme to use. Either:
\begin{itemize}
\item {} 
’upwind’, for the upwind flux;

\item {} 
’centered’, for a second-order centered flux;

\item {} 
’maccormack’, for the MacCormack flux.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Mode} specifying the backend for the GT4Py stencils.

\item {} 
\sphinxstyleliteralstrong{physics\_dynamics\_coupling\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} to couple physics with dynamics, i.e., to account for the change over time in potential temperature,
\sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{sedimentation\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} to account for rain sedimentation, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{sedimentation\_flux\_type} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the method used to compute the numerical sedimentation flux. Available options are:
\begin{itemize}
\item {} 
’first\_order\_upwind’, for the first-order upwind scheme;

\item {} 
’second\_order\_upwind’, for the second-order upwind scheme.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{sedimentation\_substeps} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of sub-timesteps to perform in order to integrate the sedimentation flux.

\end{itemize}

\item[{Returns}] \leavevmode
An instace of the derived class implementing the scheme specified by \sphinxcode{scheme}.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{microphysics (dycore.prognostic\_isentropic.PrognosticIsentropic attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.microphysics}}\pysigline{\sphinxbfcode{microphysics}}
Get the attribute in charge of calculating the raindrop fall velocity.
If this is set to \sphinxcode{None}, a \sphinxcode{ValueError} is thrown.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
Instance of a derived class of either
\sphinxcode{TendencyMicrophysics} or
\sphinxcode{AdjustmentMicrophysics}
which provides the raindrop fall velocity.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{nb (dycore.prognostic\_isentropic.PrognosticIsentropic attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.nb}}\pysigline{\sphinxbfcode{nb}}
Get the number of lateral boundary layers.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
The number of lateral boundary layers.

\item[{Return type}] \leavevmode
int

\end{description}\end{quote}

\end{fulllineitems}

\index{step\_coupling\_physics\_with\_dynamics() (dycore.prognostic\_isentropic.PrognosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.step_coupling_physics_with_dynamics}}\pysiglinewithargsret{\sphinxbfcode{step\_coupling\_physics\_with\_dynamics}}{\emph{dt}, \emph{state\_now}, \emph{state\_prv}, \emph{tendencies}}{}
Method advancing the conservative, prognostic model variables one time step forward by coupling physics with
dynamics, i.e., by accounting for the change over time in potential temperature.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
water\_vapor\_isentropic\_density (unstaggered, optional);

\item {} 
cloud\_liquid\_water\_isentropic\_density (unstaggered, optional);

\item {} 
precipitation\_water\_isentropic\_density (unstaggered, optional).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{state\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the provisional state, i.e.,
the state stepped taking only the horizontal derivatives into account.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
water\_vapor\_isentropic\_density (unstaggered, optional);

\item {} 
cloud\_liquid\_water\_isentropic\_density (unstaggered, optional);

\item {} 
precipitation\_water\_isentropic\_density (unstaggered, optional).

\end{itemize}

This may be the output of
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.step_neglecting_vertical_advection}]{\sphinxcrossref{\sphinxcode{step\_neglecting\_vertical\_advection()}}}}.


\item {} 
\sphinxstyleliteralstrong{tendencies} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} collecting the following tendencies:
\begin{itemize}
\item {} 
tendency\_of\_air\_potential\_temperature (unstaggered).

\end{itemize}


\end{itemize}

\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} containing the updated prognostic variables, i.e.,
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
water\_vapor\_isentropic\_density (unstaggered, optional);

\item {} 
cloud\_liquid\_water\_isentropic\_density (unstaggered, optional);

\item {} 
precipitation\_water\_isentropic\_density (unstaggered, optional).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{step\_integrating\_sedimentation\_flux() (dycore.prognostic\_isentropic.PrognosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.step_integrating_sedimentation_flux}}\pysiglinewithargsret{\sphinxbfcode{step\_integrating\_sedimentation\_flux}}{\emph{dt}, \emph{state\_now}, \emph{state\_prv}, \emph{diagnostics=None}}{}
Method advancing the mass fraction of precipitation water by taking the sedimentation into account.
For the sake of numerical stability, a time-splitting strategy is pursued, i.e., sedimentation is resolved
using a timestep which may be smaller than that specified by the user.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
\sphinxcode{StateIsentropic} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
height or height\_on\_interface\_levels (\(z\)-staggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in air (unstaggered).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{state\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
\sphinxcode{StateIsentropic} representing the provisional state, i.e.,
the state stepped without taking the sedimentation flux into account.
It should contain the following variables:
\begin{itemize}
\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}

This may be the output of either
\sphinxcode{step\_neglecting\_vertical\_advection()} or
\sphinxcode{step\_coupling\_physics\_with\_dynamics()}.


\item {} 
\sphinxstyleliteralstrong{diagnostics} (\sphinxtitleref{obj}, optional) \textendash{} 
\sphinxcode{GridData} collecting the following diagnostics:
\begin{itemize}
\item {} 
accumulated\_precipitation (unstaggered, two-dimensional);

\item {} 
precipitation (unstaggered, two-dimensional).

\end{itemize}


\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{state\_new} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{StateIsentropic} containing the following updated variables:
\begin{itemize}
\item {} 
mass\_fraction\_of\_precipitation\_water\_in air (unstaggered).

\end{itemize}

\item {} 
\sphinxstylestrong{diagnostics\_out} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{GridData} collecting the output diagnostics, i.e.:
\begin{itemize}
\item {} 
accumulated\_precipitation (unstaggered, two-dimensional);

\item {} 
precipitation (unstaggered, two-dimensional).

\end{itemize}

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{step\_neglecting\_vertical\_advection() (dycore.prognostic\_isentropic.PrognosticIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.step_neglecting_vertical_advection}}\pysiglinewithargsret{\sphinxbfcode{step\_neglecting\_vertical\_advection}}{\emph{dt}, \emph{state}, \emph{state\_old=None}, \emph{tendencies=None}}{}
Method advancing the conservative, prognostic model variables one time step forward.
Only horizontal derivates are considered; possible vertical derivatives are disregarded.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
air\_pressure or air\_pressure\_on\_interface\_levels (\(z\)-staggered);

\item {} 
montgomery\_potential (isentropic);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{state\_old} (\sphinxtitleref{obj}, optional) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the old state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{tendencies} (\sphinxtitleref{obj}, optional) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing the following tendencies:
\begin{itemize}
\item {} 
tendency\_of\_mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered);

\item {} 
tendency\_of\_mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
tendency\_of\_mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}

Default is \sphinxcode{None}.


\end{itemize}

\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} containing the updated prognostic variables, i.e.,
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
water\_vapor\_isentropic\_density (unstaggered, optional);

\item {} 
cloud\_liquid\_water\_isentropic\_density (unstaggered, optional);

\item {} 
precipitation\_water\_isentropic\_density (unstaggered, optional).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{PrognosticIsentropicCentered (class in dycore.prognostic\_isentropic\_centered)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.prognostic\_isentropic\_centered.}\sphinxbfcode{PrognosticIsentropicCentered}}{\emph{flux\_scheme}, \emph{grid}, \emph{moist\_on}, \emph{backend}, \emph{coupling\_physics\_dynamics\_on}, \emph{sedimentation\_on}, \emph{sedimentation\_flux\_type}, \emph{sedimentation\_substeps}}{}
This class inherits {\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic}]{\sphinxcrossref{\sphinxcode{PrognosticIsentropic}}}} to implement
a centered time-integration scheme to carry out the prognostic step of the three-dimensional
moist isentropic dynamical core.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
{\hyperref[\detokenize{api:dycore.dycore.DynamicalCore.time_levels}]{\sphinxcrossref{\sphinxstyleliteralstrong{time\_levels}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of time levels the scheme relies on.

\item {} 
\sphinxstyleliteralstrong{steps} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of steps the scheme entails.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.prognostic\_isentropic\_centered.PrognosticIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{flux\_scheme}, \emph{grid}, \emph{moist\_on}, \emph{backend}, \emph{coupling\_physics\_dynamics\_on}, \emph{sedimentation\_on}, \emph{sedimentation\_flux\_type}, \emph{sedimentation\_substeps}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{flux\_scheme} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the flux scheme to use. Either:
\begin{itemize}
\item {} 
’upwind’, for the upwind flux;

\item {} 
’centered’, for a second-order centered flux;

\item {} 
’maccormack’, for the MacCormack flux.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py stencils.

\item {} 
\sphinxstyleliteralstrong{physics\_dynamics\_coupling\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} to couple physics with dynamics, i.e., to account for the change over time in potential
temperature, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{sedimentation\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} to account for rain sedimentation, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{sedimentation\_flux\_type} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the method used to compute the numerical sedimentation flux. Available options are:
\begin{itemize}
\item {} 
’first\_order\_upwind’, for the first-order upwind scheme;

\item {} 
’second\_order\_upwind’, for the second-order upwind scheme.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{sedimentation\_substeps} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of sub-timesteps to perform in order to integrate the sedimentation flux.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
To instantiate an object of this class, one should prefer the static method
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.factory}]{\sphinxcrossref{\sphinxcode{factory()}}}} of
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic}]{\sphinxcrossref{\sphinxcode{PrognosticIsentropic}}}}.
\end{sphinxadmonition}

\end{fulllineitems}

\index{\_stencil\_clipping\_mass\_fraction\_and\_diagnosing\_isentropic\_density\_of\_precipitation\_water\_defs() (dycore.prognostic\_isentropic\_centered.PrognosticIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered._stencil_clipping_mass_fraction_and_diagnosing_isentropic_density_of_precipitation_water_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_clipping\_mass\_fraction\_and\_diagnosing\_isentropic\_density\_of\_precipitation\_water\_defs}}{\emph{in\_s}, \emph{in\_qr}}{}
GT4Py stencil clipping the negative values for the mass fraction of precipitation water,
and diagnosing the isentropic density of precipitation water.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the air isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of precipitation water in air.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_qr} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the clipped mass fraction of precipitation water.

\item {} 
\sphinxstylestrong{out\_Qr} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_computing\_slow\_tendencies\_defs() (dycore.prognostic\_isentropic\_centered.PrognosticIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered._stencil_computing_slow_tendencies_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_computing\_slow\_tendencies\_defs}}{\emph{dt}, \emph{in\_s\_old}, \emph{in\_s\_prv}, \emph{in\_qr\_old}, \emph{in\_qr\_prv}}{}
GT4Py stencil computing the slow tendencies required to resolve rain sedimentation.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the large timestep.

\item {} 
\sphinxstyleliteralstrong{in\_s\_old} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the old isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_s\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_qr\_old} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the old mass fraction of precipitation water.

\item {} 
\sphinxstyleliteralstrong{in\_qr\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional mass fraction of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_s\_tnd} (\sphinxstyleemphasis{obj :}) \textendash{} \sphinxcode{gridtools.Equation} representing the slow tendency for the isentropic density.

\item {} 
\sphinxstylestrong{out\_qr\_tnd} (\sphinxstyleemphasis{obj :}) \textendash{} \sphinxcode{gridtools.Equation} representing the slow tendency for the mass fraction of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_ensuring\_vertical\_cfl\_is\_obeyed\_defs() (dycore.prognostic\_isentropic\_centered.PrognosticIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered._stencil_ensuring_vertical_cfl_is_obeyed_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_ensuring\_vertical\_cfl\_is\_obeyed\_defs}}{\emph{dts}, \emph{in\_h}, \emph{in\_vt}}{}
GT4Py stencil ensuring that the vertical CFL condition is fulfilled.
This is achieved by clipping the raindrop fall velocity field: if a cell does not satisfy the CFL constraint,
the vertical velocity at that cell is reduced so that the local CFL number equals 0.95.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dts} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the large timestep.

\item {} 
\sphinxstyleliteralstrong{in\_h} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the geometric height.

\item {} 
\sphinxstyleliteralstrong{in\_vt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the raindrop fall velocity.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the clipped raindrop fall velocity.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_defs() (dycore.prognostic\_isentropic\_centered.PrognosticIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered._stencil_stepping_by_coupling_physics_with_dynamics_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_defs}}{\emph{dt}, \emph{in\_w}, \emph{in\_s}, \emph{in\_s\_prv}, \emph{in\_U}, \emph{in\_U\_prv}, \emph{in\_V}, \emph{in\_V\_prv}, \emph{in\_Qv=None}, \emph{in\_Qv\_prv=None}, \emph{in\_Qc=None}, \emph{in\_Qc\_prv=None}, \emph{in\_Qr=None}, \emph{in\_Qr\_prv=None}}{}
GT4Py stencil stepping the solution by coupling physics with dynamics, i.e., by accounting for the
change over time in potential temperature.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_w} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the vertical velocity, i.e., the change over time in
potential temperature.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_s\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_U} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_U\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_V} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_V\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_Qv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_Qc} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_Qr} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of precipitation water.

\item {} 
\sphinxstyleliteralstrong{in\_Qv\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_Qc\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_Qr\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_s} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the updated isentropic density.

\item {} 
\sphinxstylestrong{out\_U} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the updated \(x\)-momentum.

\item {} 
\sphinxstylestrong{out\_V} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the updated \(y\)-momentum.

\item {} 
\sphinxstylestrong{out\_Qv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the updated isentropic density of water vapor.

\item {} 
\sphinxstylestrong{out\_Qc} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the updated isentropic density of cloud liquid water.

\item {} 
\sphinxstylestrong{out\_Qr} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the updated isentropic density of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_integrating\_sedimentation\_flux\_defs() (dycore.prognostic\_isentropic\_centered.PrognosticIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered._stencil_stepping_by_integrating_sedimentation_flux_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_integrating\_sedimentation\_flux\_defs}}{\emph{dts}, \emph{in\_rho}, \emph{in\_s}, \emph{in\_h}, \emph{in\_qr}, \emph{in\_vt}, \emph{in\_s\_tnd}, \emph{in\_qr\_tnd}}{}
GT4Py stencil stepping the isentropic density and the mass fraction of precipitation water
by integrating the precipitation flux.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dts} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the small timestep.

\item {} 
\sphinxstyleliteralstrong{in\_rho} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the air density.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the air isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_h} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the geometric height of the model half-levels.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the input mass fraction of precipitation water.

\item {} 
\sphinxstyleliteralstrong{in\_vt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the raindrop fall velocity.

\item {} 
\sphinxstyleliteralstrong{in\_s\_tnd} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the contribution from the slow tendencies for the isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_qr\_tnd} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the contribution from the slow tendencies for the mass fraction of
precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_s} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the output isentropic density.

\item {} 
\sphinxstylestrong{out\_qr} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the output mass fraction of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_neglecting\_vertical\_advection\_defs() (dycore.prognostic\_isentropic\_centered.PrognosticIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered._stencil_stepping_by_neglecting_vertical_advection_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_neglecting\_vertical\_advection\_defs}}{\emph{dt}, \emph{in\_s}, \emph{in\_u}, \emph{in\_v}, \emph{in\_mtg}, \emph{in\_U}, \emph{in\_V}, \emph{in\_s\_old}, \emph{in\_U\_old}, \emph{in\_V\_old}, \emph{in\_Qv=None}, \emph{in\_Qc=None}, \emph{in\_Qr=None}, \emph{in\_Qv\_old=None}, \emph{in\_Qc\_old=None}, \emph{in\_Qr\_old=None}, \emph{in\_qv\_tnd=None}, \emph{in\_qc\_tnd=None}, \emph{in\_qr\_tnd=None}}{}
GT4Py stencil implementing the centered time-integration scheme.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_u} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-velocity at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_v} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-velocity at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_mtg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_U} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-momentum at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_V} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-momentum at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_s\_old} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density at the previous time level.

\item {} 
\sphinxstyleliteralstrong{in\_U\_old} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-momentum at the previous time level.

\item {} 
\sphinxstyleliteralstrong{in\_V\_old} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-momentum at the previous time level.

\item {} 
\sphinxstyleliteralstrong{in\_Qv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of water vapour at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_Qc} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of cloud water at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_Qr} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of precipitation water at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_Qv\_old} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of water vapour at the previous time level.

\item {} 
\sphinxstyleliteralstrong{in\_Qc\_old} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of cloud water at the previous time level.

\item {} 
\sphinxstyleliteralstrong{in\_Qr\_old} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of precipitation water at the previous time level.

\item {} 
\sphinxstyleliteralstrong{in\_qv\_tnd} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the parameterized tendency of the mass fraction of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_qc\_tnd} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the parameterized tendency of the mass fraction of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_qr\_tnd} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the parameterized tendency of the mass fraction of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_s} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped isentropic density.

\item {} 
\sphinxstylestrong{out\_U} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped \(x\)-momentum.

\item {} 
\sphinxstylestrong{out\_V} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped \(y\)-momentum.

\item {} 
\sphinxstylestrong{out\_Qv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped mass of water vapour.

\item {} 
\sphinxstylestrong{out\_Qc} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped mass of cloud water.

\item {} 
\sphinxstylestrong{out\_Qr} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped mass of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_neglecting\_vertical\_advection\_initialize() (dycore.prognostic\_isentropic\_centered.PrognosticIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered._stencil_stepping_by_neglecting_vertical_advection_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_neglecting\_vertical\_advection\_initialize}}{\emph{state}, \emph{tendencies}}{}
Initialize the GT4Py stencil implementing a time-integration centered scheme to step the solution
by neglecting vertical advection.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{tendencies} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing the following tendencies:
\begin{itemize}
\item {} 
tendency\_of\_mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered);

\item {} 
tendency\_of\_mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
tendency\_of\_mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}


\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencils\_stepping\_by\_integrating\_sedimentation\_flux\_initialize() (dycore.prognostic\_isentropic\_centered.PrognosticIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered._stencils_stepping_by_integrating_sedimentation_flux_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencils\_stepping\_by\_integrating\_sedimentation\_flux\_initialize}}{}{}
Initialize the GT4Py stencils in charge of stepping the mass fraction of precipitation water by
integrating the sedimentation flux.

\end{fulllineitems}

\index{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_allocate\_inputs() (dycore.prognostic\_isentropic\_centered.PrognosticIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered._stencils_stepping_by_neglecting_vertical_advection_allocate_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_allocate\_inputs}}{\emph{mi}, \emph{mj}, \emph{tendencies}}{}
Allocate the attributes which will serve as inputs to the GT4Py stencil stepping the solution
by neglecting vertical advection.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{mi} (\sphinxstyleliteralemphasis{int}) \textendash{} \(x\)-extent of an input array representing an \(x\)-unstaggered field.

\item {} 
\sphinxstyleliteralstrong{mj} (\sphinxstyleliteralemphasis{int}) \textendash{} \(y\)-extent of an input array representing a \(y\)-unstaggered field.

\item {} 
\sphinxstyleliteralstrong{tendencies} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing the following tendencies:
\begin{itemize}
\item {} 
tendency\_of\_mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered);

\item {} 
tendency\_of\_mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
tendency\_of\_mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}


\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_set\_inputs() (dycore.prognostic\_isentropic\_centered.PrognosticIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered._stencils_stepping_by_neglecting_vertical_advection_set_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_set\_inputs}}{\emph{dt}, \emph{state}, \emph{state\_old=None}, \emph{tendencies=None}}{}
Update the attributes which serve as inputs to the GT4Py stencil stepping the solution
by neglecting vertical advection.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} A \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
montgomery\_potential (isentropic);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{state\_old} (\sphinxtitleref{obj}, optional) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the old state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{tendencies} (\sphinxtitleref{obj}, optional) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing the following tendencies:
\begin{itemize}
\item {} 
tendency\_of\_mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered);

\item {} 
tendency\_of\_mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
tendency\_of\_mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}


\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{step\_integrating\_sedimentation\_flux() (dycore.prognostic\_isentropic\_centered.PrognosticIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered.step_integrating_sedimentation_flux}}\pysiglinewithargsret{\sphinxbfcode{step\_integrating\_sedimentation\_flux}}{\emph{dt}, \emph{state\_now}, \emph{state\_prv}, \emph{diagnostics=None}}{}
Method advancing the mass fraction of precipitation water by taking the sedimentation into account.
For the sake of numerical stability, a time-splitting strategy is pursued, i.e., sedimentation is resolved
using a timestep which may be smaller than that specified by the user.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
\sphinxcode{StateIsentropic} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_density (unstaggered);

\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
air\_pressure or air\_pressure\_on\_interface\_levels (\(z\)-staggered);

\item {} 
height or height\_on\_interface\_levels (\(z\)-staggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in air (unstaggered).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{state\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
\sphinxcode{StateIsentropic} representing the provisional state, i.e.,
the state stepped without taking the sedimentation flux into account.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in air (unstaggered).

\end{itemize}

This may be the output of either
\sphinxcode{step\_neglecting\_vertical\_advection()} or
\sphinxcode{step\_coupling\_physics\_with\_dynamics()}.


\item {} 
\sphinxstyleliteralstrong{diagnostics} (\sphinxtitleref{obj}, optional) \textendash{} 
\sphinxcode{GridData} collecting the following diagnostics:
\begin{itemize}
\item {} 
accumulated\_precipitation (unstaggered, two-dimensional).

\end{itemize}


\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{state\_new} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{StateIsentropic} containing the following updated variables:
\begin{itemize}
\item {} 
mass\_fraction\_of\_precipitation\_water\_in air (unstaggered);

\item {} 
precipitation\_water\_isentropic\_density (unstaggered).

\end{itemize}

\item {} 
\sphinxstylestrong{diagnostics\_out} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{GridData} collecting the output diagnostics, i.e.:
\begin{itemize}
\item {} 
accumulated\_precipitation (unstaggered, two-dimensional);

\item {} 
precipitation (unstaggered, two-dimensional).

\end{itemize}

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{step\_neglecting\_vertical\_advection() (dycore.prognostic\_isentropic\_centered.PrognosticIsentropicCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_centered.PrognosticIsentropicCentered.step_neglecting_vertical_advection}}\pysiglinewithargsret{\sphinxbfcode{step\_neglecting\_vertical\_advection}}{\emph{dt}, \emph{state}, \emph{state\_old=None}, \emph{tendencies=None}}{}
Method advancing the conservative, prognostic model variables one time step forward via a
centered time-integration scheme. Only horizontal derivates are considered; possible vertical
derivatives are disregarded.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
air\_pressure or air\_pressure\_on\_interface\_levels (\(z\)-staggered);

\item {} 
montgomery\_potential (isentropic);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{state\_old} (\sphinxtitleref{obj}, optional) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the old state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{tendencies} (\sphinxtitleref{obj}, optional) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing the following tendencies:
\begin{itemize}
\item {} 
tendency\_of\_mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered);

\item {} 
tendency\_of\_mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
tendency\_of\_mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}

Default is \sphinxcode{None}.


\end{itemize}

\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} containing the updated prognostic variables, i.e.,
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
water\_vapor\_isentropic\_density (unstaggered, optional);

\item {} 
cloud\_liquid\_water\_isentropic\_density (unstaggered, optional);

\item {} 
precipitation\_water\_isentropic\_density (unstaggered, optional).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{PrognosticIsentropicForwardEuler (class in dycore.prognostic\_isentropic\_forward\_euler)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.prognostic\_isentropic\_forward\_euler.}\sphinxbfcode{PrognosticIsentropicForwardEuler}}{\emph{flux\_scheme}, \emph{grid}, \emph{moist\_on}, \emph{backend}, \emph{coupling\_physics\_dynamics\_on}, \emph{sedimentation\_on}, \emph{sedimentation\_flux\_type}, \emph{sedimentation\_substeps}}{}
This class inherits {\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic}]{\sphinxcrossref{\sphinxcode{PrognosticIsentropic}}}} to implement
the forward Euler scheme carrying out the prognostic step of the three-dimensional moist isentropic dynamical core.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
{\hyperref[\detokenize{api:dycore.dycore.DynamicalCore.time_levels}]{\sphinxcrossref{\sphinxstyleliteralstrong{time\_levels}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of time levels the scheme relies on.

\item {} 
\sphinxstyleliteralstrong{steps} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of steps the scheme entails.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.prognostic\_isentropic\_forward\_euler.PrognosticIsentropicForwardEuler method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{flux\_scheme}, \emph{grid}, \emph{moist\_on}, \emph{backend}, \emph{coupling\_physics\_dynamics\_on}, \emph{sedimentation\_on}, \emph{sedimentation\_flux\_type}, \emph{sedimentation\_substeps}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{flux\_scheme} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the flux scheme to use. Either:
\begin{itemize}
\item {} 
’upwind’, for the upwind flux;

\item {} 
’centered’, for a second-order centered flux;

\item {} 
’maccormack’, for the MacCormack flux.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py stencils.

\item {} 
\sphinxstyleliteralstrong{physics\_dynamics\_coupling\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} to couple physics with dynamics, i.e., to account for the change over time in potential temperature,
\sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{sedimentation\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} to account for rain sedimentation, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{sedimentation\_flux\_type} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the method used to compute the numerical sedimentation flux. Available options are:
\begin{itemize}
\item {} 
’first\_order\_upwind’, for the first-order upwind scheme;

\item {} 
’second\_order\_upwind’, for the second-order upwind scheme.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{sedimentation\_substeps} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of sub-timesteps to perform in order to integrate the sedimentation flux.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
To instantiate an object of this class, one should prefer the static method
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.factory}]{\sphinxcrossref{\sphinxcode{factory()}}}} of
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic}]{\sphinxcrossref{\sphinxcode{PrognosticIsentropic}}}}.
\end{sphinxadmonition}

\end{fulllineitems}

\index{\_stencil\_clipping\_mass\_fraction\_and\_diagnosing\_isentropic\_density\_of\_precipitation\_water\_defs() (dycore.prognostic\_isentropic\_forward\_euler.PrognosticIsentropicForwardEuler method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler._stencil_clipping_mass_fraction_and_diagnosing_isentropic_density_of_precipitation_water_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_clipping\_mass\_fraction\_and\_diagnosing\_isentropic\_density\_of\_precipitation\_water\_defs}}{\emph{in\_s}, \emph{in\_qr}}{}
GT4Py stencil clipping the negative values for the mass fraction of precipitation water,
and diagnosing the isentropic density of precipitation water.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the air isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of precipitation water in air.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_qr} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the clipped mass fraction of precipitation water.

\item {} 
\sphinxstylestrong{out\_Qr} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_computing\_slow\_tendencies\_defs() (dycore.prognostic\_isentropic\_forward\_euler.PrognosticIsentropicForwardEuler method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler._stencil_computing_slow_tendencies_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_computing\_slow\_tendencies\_defs}}{\emph{dt}, \emph{in\_s}, \emph{in\_s\_prv}, \emph{in\_qr}, \emph{in\_qr\_prv}}{}
GT4Py stencil computing the slow tendencies required to resolve rain sedimentation.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the large timestep.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_s\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current mass fraction of precipitation water.

\item {} 
\sphinxstyleliteralstrong{in\_qr\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional mass fraction of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_s\_tnd} (\sphinxstyleemphasis{obj :}) \textendash{} \sphinxcode{gridtools.Equation} representing the slow tendency for the isentropic density.

\item {} 
\sphinxstylestrong{out\_qr\_tnd} (\sphinxstyleemphasis{obj :}) \textendash{} \sphinxcode{gridtools.Equation} representing the slow tendency for the mass fraction of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_ensuring\_vertical\_cfl\_is\_obeyed\_defs() (dycore.prognostic\_isentropic\_forward\_euler.PrognosticIsentropicForwardEuler method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler._stencil_ensuring_vertical_cfl_is_obeyed_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_ensuring\_vertical\_cfl\_is\_obeyed\_defs}}{\emph{dts}, \emph{in\_h}, \emph{in\_vt}}{}
GT4Py stencil ensuring that the vertical CFL condition is fulfilled.
This is achieved by clipping the raindrop fall velocity field: if a cell does not satisfy the CFL constraint,
the vertical velocity at that cell is reduced so that the local CFL number equals 0.95.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dts} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the large timestep.

\item {} 
\sphinxstyleliteralstrong{in\_h} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the geometric height.

\item {} 
\sphinxstyleliteralstrong{in\_vt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the raindrop fall velocity.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the clipped raindrop fall velocity.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_defs() (dycore.prognostic\_isentropic\_forward\_euler.PrognosticIsentropicForwardEuler method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler._stencil_stepping_by_coupling_physics_with_dynamics_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_defs}}{\emph{dt}, \emph{in\_w}, \emph{in\_s}, \emph{in\_s\_prv}, \emph{in\_U}, \emph{in\_U\_prv}, \emph{in\_V}, \emph{in\_V\_prv}, \emph{in\_Qv=None}, \emph{in\_Qv\_prv=None}, \emph{in\_Qc=None}, \emph{in\_Qc\_prv=None}, \emph{in\_Qr=None}, \emph{in\_Qr\_prv=None}}{}
GT4Py stencil stepping the solution by coupling physics with dynamics, i.e., by accounting for the
change over time in potential temperature.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_w} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the vertical velocity, i.e., the change over time in
potential temperature.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_s\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_U} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_U\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_V} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_V\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_Qv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_Qv\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_Qc} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_Qc\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_Qr} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density of precipitation water.

\item {} 
\sphinxstyleliteralstrong{in\_Qr\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_s} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the updated isentropic density.

\item {} 
\sphinxstylestrong{out\_U} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the updated \(x\)-momentum.

\item {} 
\sphinxstylestrong{out\_V} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the updated \(y\)-momentum.

\item {} 
\sphinxstylestrong{out\_Qv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the updated isentropic density of water vapor.

\item {} 
\sphinxstylestrong{out\_Qc} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the updated isentropic density of cloud liquid water.

\item {} 
\sphinxstylestrong{out\_Qr} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the updated isentropic density of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_integrating\_sedimentation\_flux\_defs() (dycore.prognostic\_isentropic\_forward\_euler.PrognosticIsentropicForwardEuler method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler._stencil_stepping_by_integrating_sedimentation_flux_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_integrating\_sedimentation\_flux\_defs}}{\emph{dts}, \emph{in\_rho}, \emph{in\_s}, \emph{in\_h}, \emph{in\_qr}, \emph{in\_vt}, \emph{in\_s\_tnd}, \emph{in\_qr\_tnd}}{}
GT4Py stencil stepping the isentropic density and the mass fraction of precipitation water
by integrating the precipitation flux.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dts} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the small timestep.

\item {} 
\sphinxstyleliteralstrong{in\_rho} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the air density.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the air isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_h} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the geometric height of the model half-levels.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the input mass fraction of precipitation water.

\item {} 
\sphinxstyleliteralstrong{in\_vt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the raindrop fall velocity.

\item {} 
\sphinxstyleliteralstrong{in\_s\_tnd} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the contribution from the slow tendencies for the isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_qr\_tnd} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the contribution from the slow tendencies for the mass fraction of
precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_s} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the output isentropic density.

\item {} 
\sphinxstylestrong{out\_qr} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the output mass fraction of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_neglecting\_vertical\_advection\_first\_defs() (dycore.prognostic\_isentropic\_forward\_euler.PrognosticIsentropicForwardEuler method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler._stencil_stepping_by_neglecting_vertical_advection_first_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_neglecting\_vertical\_advection\_first\_defs}}{\emph{dt}, \emph{in\_s}, \emph{in\_u}, \emph{in\_v}, \emph{in\_mtg}, \emph{in\_U}, \emph{in\_V}, \emph{in\_Qv=None}, \emph{in\_Qc=None}, \emph{in\_Qr=None}, \emph{in\_qv\_tnd=None}, \emph{in\_qc\_tnd=None}, \emph{in\_qr\_tnd=None}}{}
GT4Py stencil stepping the isentropic density and the water constituents via the forward Euler scheme.
Further, it computes provisional values for the momentums, i.e., it updates the momentums disregarding
the forcing terms involving the Montgomery potential.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_u} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-velocity at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_v} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-velocity at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_mtg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_U} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-momentum at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_V} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-momentum at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_Qv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the mass of water vapour at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_Qc} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the mass of cloud water at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_Qr} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the mass of precipitation water at the current time.

\item {} 
\sphinxstyleliteralstrong{in\_qv\_tnd} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the parameterized tendency of the mass fraction of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_qc\_tnd} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the parameterized tendency of the mass fraction of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_qr\_tnd} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the parameterized tendency of the mass fraction of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_s} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped isentropic density.

\item {} 
\sphinxstylestrong{out\_U} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(x\)-momentum.

\item {} 
\sphinxstylestrong{out\_V} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(y\)-momentum.

\item {} 
\sphinxstylestrong{out\_Qv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped mass of water vapour.

\item {} 
\sphinxstylestrong{out\_Qc} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped mass of cloud water.

\item {} 
\sphinxstylestrong{out\_Qr} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped mass of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_neglecting\_vertical\_advection\_second\_defs() (dycore.prognostic\_isentropic\_forward\_euler.PrognosticIsentropicForwardEuler method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler._stencil_stepping_by_neglecting_vertical_advection_second_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_neglecting\_vertical\_advection\_second\_defs}}{\emph{dt}, \emph{in\_s}, \emph{in\_mtg}, \emph{in\_U}, \emph{in\_V}}{}
GT4Py stencil stepping the momentums via a one-time-level scheme.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_mtg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential diagnosed from the stepped isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_U} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{in\_V} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(y\)-momentum.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_U} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped \(x\)-momentum.

\item {} 
\sphinxstylestrong{out\_V} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped \(y\)-momentum.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencils\_stepping\_by\_integrating\_sedimentation\_flux\_initialize() (dycore.prognostic\_isentropic\_forward\_euler.PrognosticIsentropicForwardEuler method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler._stencils_stepping_by_integrating_sedimentation_flux_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencils\_stepping\_by\_integrating\_sedimentation\_flux\_initialize}}{}{}
Initialize the GT4Py stencils in charge of stepping the mass fraction of precipitation water by
integrating the sedimentation flux.

\end{fulllineitems}

\index{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_allocate\_temporaries() (dycore.prognostic\_isentropic\_forward\_euler.PrognosticIsentropicForwardEuler method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler._stencils_stepping_by_neglecting_vertical_advection_allocate_temporaries}}\pysiglinewithargsret{\sphinxbfcode{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_allocate\_temporaries}}{\emph{mi}, \emph{mj}}{}
Allocate the Numpy arrays which will store temporary fields to be shared between the stencils
stepping the solution by neglecting vertical advection.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{mi} (\sphinxstyleliteralemphasis{int}) \textendash{} \(x\)-extent of an input array representing an \(x\)-unstaggered field.

\item {} 
\sphinxstyleliteralstrong{mj} (\sphinxstyleliteralemphasis{int}) \textendash{} \(y\)-extent of an input array representing a \(y\)-unstaggered field.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_initialize() (dycore.prognostic\_isentropic\_forward\_euler.PrognosticIsentropicForwardEuler method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler._stencils_stepping_by_neglecting_vertical_advection_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_initialize}}{\emph{state}, \emph{tendencies}}{}
Initialize the GT4Py stencils implementing the forward Euler scheme to step the solution
by neglecting vertical advection.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered).

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{step\_integrating\_sedimentation\_flux() (dycore.prognostic\_isentropic\_forward\_euler.PrognosticIsentropicForwardEuler method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler.step_integrating_sedimentation_flux}}\pysiglinewithargsret{\sphinxbfcode{step\_integrating\_sedimentation\_flux}}{\emph{dt}, \emph{state\_now}, \emph{state\_prv}, \emph{diagnostics=None}}{}
Method advancing the mass fraction of precipitation water by taking the sedimentation into account.
For the sake of numerical stability, a time-splitting strategy is pursued, i.e., sedimentation is resolved
using a timestep which may be smaller than that specified by the user.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
\sphinxcode{StateIsentropic} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_density (unstaggered);

\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
air\_pressure or air\_pressure\_on\_interface\_levels (\(z\)-staggered);

\item {} 
height or height\_on\_interface\_levels (\(z\)-staggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in air (unstaggered).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{state\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
\sphinxcode{StateIsentropic} representing the provisional state, i.e.,
the state stepped without taking the sedimentation flux into account.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in air (unstaggered).

\end{itemize}

This may be the output of either
\sphinxcode{step\_neglecting\_vertical\_advection()} or
\sphinxcode{step\_coupling\_physics\_with\_dynamics()}.


\item {} 
\sphinxstyleliteralstrong{diagnostics} (\sphinxtitleref{obj}, optional) \textendash{} 
\sphinxcode{GridData} collecting the following diagnostics:
\begin{itemize}
\item {} 
accumulated\_precipitation (unstaggered, two-dimensional).

\end{itemize}


\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{state\_new} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{StateIsentropic} containing the following updated variables:
\begin{itemize}
\item {} 
mass\_fraction\_of\_precipitation\_water\_in air (unstaggered);

\item {} 
precipitation\_water\_isentropic\_density (unstaggered).

\end{itemize}

\item {} 
\sphinxstylestrong{diagnostics\_out} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{GridData} collecting the output diagnostics, i.e.:
\begin{itemize}
\item {} 
accumulated\_precipitation (unstaggered, two-dimensional);

\item {} 
precipitation (unstaggered, two-dimensional).

\end{itemize}

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{step\_neglecting\_vertical\_advection() (dycore.prognostic\_isentropic\_forward\_euler.PrognosticIsentropicForwardEuler method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_forward_euler.PrognosticIsentropicForwardEuler.step_neglecting_vertical_advection}}\pysiglinewithargsret{\sphinxbfcode{step\_neglecting\_vertical\_advection}}{\emph{dt}, \emph{state}, \emph{state\_old=None}, \emph{tendencies=None}}{}
Method advancing the conservative, prognostic model variables one time step forward
via the forward Euler method. Only horizontal derivates are considered; possible vertical
derivatives are disregarded.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
air\_pressure or air\_pressure\_on\_interface\_levels (\(z\)-staggered);

\item {} 
montgomery\_potential (isentropic);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{state\_old} (\sphinxtitleref{obj}, optional) \textendash{} {\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the old state.
This is not actually used, yet it appears as default argument for compliancy with
the class hierarchy interface.

\item {} 
\sphinxstyleliteralstrong{tendencies} (\sphinxtitleref{obj}, optional) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing the following tendencies:
\begin{itemize}
\item {} 
tendency\_of\_mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered);

\item {} 
tendency\_of\_mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
tendency\_of\_mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}

Default is \sphinxcode{None}.


\end{itemize}

\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} containing the updated prognostic variables, i.e.,
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
water\_vapor\_isentropic\_density (unstaggered, optional);

\item {} 
cloud\_liquid\_water\_isentropic\_density (unstaggered, optional);

\item {} 
precipitation\_water\_isentropic\_density (unstaggered, optional).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{PrognosticIsentropicNonconservative (class in dycore.prognostic\_isentropic\_nonconservative)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative.PrognosticIsentropicNonconservative}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.prognostic\_isentropic\_nonconservative.}\sphinxbfcode{PrognosticIsentropicNonconservative}}{\emph{flux\_scheme}, \emph{grid}, \emph{moist\_on}, \emph{backend}, \emph{physics\_dynamics\_coupling\_on}, \emph{sedimentation\_on}}{}
Abstract base class whose derived classes implement different schemes to carry out the
prognostic steps of the three-dimensional moist isentropic dynamical core.
The nonconservative form of the governing equations is used.
\index{\_\_init\_\_() (dycore.prognostic\_isentropic\_nonconservative.PrognosticIsentropicNonconservative method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative.PrognosticIsentropicNonconservative.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{flux\_scheme}, \emph{grid}, \emph{moist\_on}, \emph{backend}, \emph{physics\_dynamics\_coupling\_on}, \emph{sedimentation\_on}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{flux\_scheme} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the flux scheme to use. Either:
\begin{itemize}
\item {} 
’centered’, for a second-order centered flux.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py stencils.

\item {} 
\sphinxstyleliteralstrong{physics\_dynamics\_coupling\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} to couple physics with dynamics, i.e., to account for the change over time in potential temperature,
\sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{sedimentation\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} to account for rain sedimentation, \sphinxcode{False} otherwise.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_allocate\_inputs() (dycore.prognostic\_isentropic\_nonconservative.PrognosticIsentropicNonconservative method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative.PrognosticIsentropicNonconservative._stencil_stepping_by_coupling_physics_with_dynamics_allocate_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_allocate\_inputs}}{}{}
Allocate the attributes which serve as inputs to the GT4Py stencil which step the solution
by coupling physics with dynamics, i.e., accounting for the change over time in potential temperature.

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_allocate\_outputs() (dycore.prognostic\_isentropic\_nonconservative.PrognosticIsentropicNonconservative method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative.PrognosticIsentropicNonconservative._stencil_stepping_by_coupling_physics_with_dynamics_allocate_outputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_allocate\_outputs}}{}{}
Allocate the Numpy arrays which will store the solution updated by coupling physics with dynamics.

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_defs() (dycore.prognostic\_isentropic\_nonconservative.PrognosticIsentropicNonconservative method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative.PrognosticIsentropicNonconservative._stencil_stepping_by_coupling_physics_with_dynamics_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_defs}}{\emph{dt}, \emph{in\_w}, \emph{in\_s\_now}, \emph{in\_s\_prv}, \emph{in\_u\_now}, \emph{in\_u\_prv}, \emph{in\_v\_now}, \emph{in\_v\_prv}, \emph{qv\_now=None}, \emph{qv\_prv=None}, \emph{qc\_now=None}, \emph{qc\_prv=None}, \emph{qr\_now=None}, \emph{qr\_prv=None}}{}
GT4Py stencil stepping the solution by coupling physics with dynamics, i.e., by accounting for the
change over time in potential temperature.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_w} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the vertical velocity, i.e., the change over time in potential temperature.

\item {} 
\sphinxstyleliteralstrong{in\_s\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_s\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_u\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_u\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_v\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_v\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_qv\_now} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current mass fraction of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_qv\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional mass fraction of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_qc\_now} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current mass fraction of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_qc\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional mass fraction of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_qr\_now} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current mass fraction of precipitation water.

\item {} 
\sphinxstyleliteralstrong{in\_qr\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional mass fraction of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_s} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the updated isentropic density.

\item {} 
\sphinxstylestrong{out\_u} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the updated \(x\)-velocity.

\item {} 
\sphinxstylestrong{out\_v} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the updated \(y\)-velocity.

\item {} 
\sphinxstylestrong{out\_qv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the updated mass fraction of water vapor.

\item {} 
\sphinxstylestrong{out\_qc} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the updated mass fraction of cloud liquid water.

\item {} 
\sphinxstylestrong{out\_qr} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the updated mass fraction of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_initialize() (dycore.prognostic\_isentropic\_nonconservative.PrognosticIsentropicNonconservative method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative.PrognosticIsentropicNonconservative._stencil_stepping_by_coupling_physics_with_dynamics_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_initialize}}{\emph{state\_now}}{}
Initialize the GT4Py stencil in charge of stepping the solution by coupling physics with dynamics,
i.e., by accounting for the change over time in potential temperature.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{state\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
\sphinxcode{StateIsentropic} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered).

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_set\_inputs() (dycore.prognostic\_isentropic\_nonconservative.PrognosticIsentropicNonconservative method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative.PrognosticIsentropicNonconservative._stencil_stepping_by_coupling_physics_with_dynamics_set_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_set\_inputs}}{\emph{dt}, \emph{state\_now}, \emph{state\_prv}, \emph{diagnostics}}{}
Update the attributes which serve as inputs to the GT4Py stencil which steps the solution
by integrating the vertical advection, i.e., by accounting for the change over time in potential temperature.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} A \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{state\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the provisional state, i.e.,
the state stepped taking only the horizontal derivatives into account.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}

This may be the output of
{\hyperref[\detokenize{api:dycore.prognostic_isentropic_nonconservative.PrognosticIsentropicNonconservative.step_neglecting_vertical_advection}]{\sphinxcrossref{\sphinxcode{step\_neglecting\_vertical\_advection()}}}}.


\item {} 
\sphinxstyleliteralstrong{diagnostics} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} collecting the following variables:
\begin{itemize}
\item {} 
change\_over\_time\_in\_air\_potential\_temperature (unstaggered).

\end{itemize}


\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_allocate\_inputs() (dycore.prognostic\_isentropic\_nonconservative.PrognosticIsentropicNonconservative method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative.PrognosticIsentropicNonconservative._stencils_stepping_by_neglecting_vertical_advection_allocate_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_allocate\_inputs}}{\emph{mi}, \emph{mj}}{}
Allocate the attributes which serve as inputs to the GT4Py stencils which step the solution
disregarding the vertical advection.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{mi} (\sphinxstyleliteralemphasis{int}) \textendash{} \(x\)-extent of an input array representing an \(x\)-unstaggered field.

\item {} 
\sphinxstyleliteralstrong{mj} (\sphinxstyleliteralemphasis{int}) \textendash{} \(y\)-extent of an input array representing a \(y\)-unstaggered field.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_allocate\_outputs() (dycore.prognostic\_isentropic\_nonconservative.PrognosticIsentropicNonconservative method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative.PrognosticIsentropicNonconservative._stencils_stepping_by_neglecting_vertical_advection_allocate_outputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_allocate\_outputs}}{\emph{mi}, \emph{mj}}{}
Allocate the Numpy arrays which will store the solution updated by neglecting the vertical advection.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{mi} (\sphinxstyleliteralemphasis{int}) \textendash{} \(x\)-extent of an output array representing an \(x\)-unstaggered field.

\item {} 
\sphinxstyleliteralstrong{mj} (\sphinxstyleliteralemphasis{int}) \textendash{} \(y\)-extent of an output array representing a \(y\)-unstaggered field.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_set\_inputs() (dycore.prognostic\_isentropic\_nonconservative.PrognosticIsentropicNonconservative method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative.PrognosticIsentropicNonconservative._stencils_stepping_by_neglecting_vertical_advection_set_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_set\_inputs}}{\emph{dt}, \emph{state}}{}
Update the attributes which serve as inputs to the GT4Py stencils which step the solution
disregarding the vertical advection.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} A \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
\sphinxcode{StateIsentropic} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
montgomery\_potential (isentropic);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{boundary (dycore.prognostic\_isentropic\_nonconservative.PrognosticIsentropicNonconservative attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative.PrognosticIsentropicNonconservative.boundary}}\pysigline{\sphinxbfcode{boundary}}
Get the attribute implementing the horizontal boundary conditions.
If this is set to \sphinxcode{None}, a \sphinxcode{ValueError} is thrown.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
Instance of the derived class of {\hyperref[\detokenize{api:dycore.horizontal_boundary.HorizontalBoundary}]{\sphinxcrossref{\sphinxcode{HorizontalBoundary}}}} implementing
the horizontal boundary conditions.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{diagnostic (dycore.prognostic\_isentropic\_nonconservative.PrognosticIsentropicNonconservative attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative.PrognosticIsentropicNonconservative.diagnostic}}\pysigline{\sphinxbfcode{diagnostic}}
Get the attribute implementing the diagnostic steps of the three-dimensional moist isentropic dynamical core.
If this is set to \sphinxcode{None}, a \sphinxcode{ValueError} is thrown.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
{\hyperref[\detokenize{api:dycore.diagnostic_isentropic.DiagnosticIsentropic}]{\sphinxcrossref{\sphinxcode{DiagnosticIsentropic}}}} carrying out the diagnostic step of the
three-dimensional moist isentropic dynamical core.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{factory() (dycore.prognostic\_isentropic\_nonconservative.PrognosticIsentropicNonconservative static method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative.PrognosticIsentropicNonconservative.factory}}\pysiglinewithargsret{\sphinxbfcode{static }\sphinxbfcode{factory}}{\emph{time\_scheme}, \emph{flux\_scheme}, \emph{grid}, \emph{moist\_on}, \emph{backend}, \emph{physics\_dynamics\_coupling\_on}, \emph{sedimentation\_on}}{}
Static method returning an instace of the derived class implementing the time stepping scheme specified
by \sphinxcode{time\_scheme}, using the flux scheme specified by \sphinxcode{flux\_scheme}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{time\_scheme} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the time stepping method to implement. Either:
\begin{itemize}
\item {} 
’centered’, for a centered scheme.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{flux\_scheme} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the scheme to use. Either:
\begin{itemize}
\item {} 
’centered’, for a second-order centered flux.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Mode} specifying the backend for the GT4Py stencils.

\item {} 
\sphinxstyleliteralstrong{physics\_dynamics\_coupling\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} to couple physics with dynamics, i.e., to account for the change over time in potential temperature,
\sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{sedimentation\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} to account for rain sedimentation, \sphinxcode{False} otherwise.

\end{itemize}

\item[{Returns}] \leavevmode
An instace of the derived class implementing the scheme specified by \sphinxcode{scheme}.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{microphysics (dycore.prognostic\_isentropic\_nonconservative.PrognosticIsentropicNonconservative attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative.PrognosticIsentropicNonconservative.microphysics}}\pysigline{\sphinxbfcode{microphysics}}
Get the attribute taking care of microphysics.
If this is set to \sphinxcode{None}, a \sphinxcode{ValueError} is thrown.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
Instance of a derived class of either \sphinxcode{TendencyMicrophysics}
or \sphinxcode{AdjustmentMicrophysics}.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{nb (dycore.prognostic\_isentropic\_nonconservative.PrognosticIsentropicNonconservative attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative.PrognosticIsentropicNonconservative.nb}}\pysigline{\sphinxbfcode{nb}}
Get the number of lateral boundary layers.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
The number of lateral boundary layers.

\item[{Return type}] \leavevmode
int

\end{description}\end{quote}

\end{fulllineitems}

\index{step\_coupling\_physics\_with\_dynamics() (dycore.prognostic\_isentropic\_nonconservative.PrognosticIsentropicNonconservative method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative.PrognosticIsentropicNonconservative.step_coupling_physics_with_dynamics}}\pysiglinewithargsret{\sphinxbfcode{step\_coupling\_physics\_with\_dynamics}}{\emph{dt}, \emph{state\_now}, \emph{state\_prv}, \emph{diagnostics}}{}
Method advancing the prognostic model variables one time step forward by coupling physics with
dynamics, i.e., by accounting for the change over time in potential temperature.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{state\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the provisional state, i.e.,
the state stepped taking only the horizontal derivatives into account.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}

This may be the output of
{\hyperref[\detokenize{api:dycore.prognostic_isentropic_nonconservative.PrognosticIsentropicNonconservative.step_neglecting_vertical_advection}]{\sphinxcrossref{\sphinxcode{step\_neglecting\_vertical\_advection()}}}}.


\item {} 
\sphinxstyleliteralstrong{diagnostics} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} collecting the following variables:
\begin{itemize}
\item {} 
change\_over\_time\_in\_air\_potential\_temperature (unstaggered).

\end{itemize}


\end{itemize}

\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} containing the updated prognostic variables, i.e.,
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{step\_integrating\_sedimentation\_flux() (dycore.prognostic\_isentropic\_nonconservative.PrognosticIsentropicNonconservative method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative.PrognosticIsentropicNonconservative.step_integrating_sedimentation_flux}}\pysiglinewithargsret{\sphinxbfcode{step\_integrating\_sedimentation\_flux}}{\emph{dt}, \emph{state\_now}, \emph{state\_prv}, \emph{diagnostics=None}}{}
Method advancing the mass fraction of precipitation water by taking the sedimentation into account.
For the sake of numerical stability, a time-splitting strategy is pursued, i.e., the sedimentation is
integrated using a timestep which may be smaller than that specified by the user.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
\sphinxcode{StateIsentropic} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
height or height\_on\_interface\_levels (\(z\)-staggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in air (unstaggered).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{state\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
\sphinxcode{StateIsentropic} representing the provisional state, i.e.,
the state stepped without taking the sedimentation flux into account.
It should contain the following variables:
\begin{itemize}
\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}

This may be the output of either
\sphinxcode{step\_neglecting\_vertical\_advection()} or
\sphinxcode{step\_coupling\_physics\_with\_dynamics()}.


\item {} 
\sphinxstyleliteralstrong{diagnostics} (\sphinxtitleref{obj}, optional) \textendash{} 
\sphinxcode{GridData} collecting the following diagnostics:
\begin{itemize}
\item {} 
accumulated\_precipitation (unstaggered, two-dimensional);

\item {} 
precipitation (unstaggered, two-dimensional).

\end{itemize}


\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{state\_new} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{StateIsentropic} containing the following updated variables:
\begin{itemize}
\item {} 
mass\_fraction\_of\_precipitation\_water\_in air (unstaggered).

\end{itemize}

\item {} 
\sphinxstylestrong{diagnostics\_out} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{GridData} collecting the output diagnostics, i.e.:
\begin{itemize}
\item {} 
accumulated\_precipitation (unstaggered, two-dimensional);

\item {} 
precipitation (unstaggered, two-dimensional).

\end{itemize}

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{step\_neglecting\_vertical\_advection() (dycore.prognostic\_isentropic\_nonconservative.PrognosticIsentropicNonconservative method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative.PrognosticIsentropicNonconservative.step_neglecting_vertical_advection}}\pysiglinewithargsret{\sphinxbfcode{step\_neglecting\_vertical\_advection}}{\emph{dt}, \emph{state}, \emph{state\_old=None}, \emph{diagnostics=None}, \emph{tendencies=None}}{}
Method advancing the prognostic model variables one time step forward.
Only horizontal derivates are considered; possible vertical derivatives are disregarded.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
air\_pressure or air\_pressure\_on\_interface\_levels (\(z\)-staggered);

\item {} 
montgomery\_potential (isentropic);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{state\_old} (\sphinxtitleref{obj}, optional) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the old state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{diagnostics} (\sphinxtitleref{obj}, optional) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} possibly storing diagnostics.
For the time being, this is not actually used.

\item {} 
\sphinxstyleliteralstrong{tendencies} (\sphinxtitleref{obj}, optional) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} possibly storing tendencies.
For the time being, this is not actually used.

\end{itemize}

\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} containing the updated prognostic variables, i.e.,
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{PrognosticIsentropicNonconservativeCentered (class in dycore.prognostic\_isentropic\_nonconservative\_centered)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative_centered.PrognosticIsentropicNonconservativeCentered}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.prognostic\_isentropic\_nonconservative\_centered.}\sphinxbfcode{PrognosticIsentropicNonconservativeCentered}}{\emph{flux\_scheme}, \emph{grid}, \emph{moist\_on}, \emph{backend}, \emph{coupling\_physics\_dynamics\_on}, \emph{sedimentation\_on}}{}
This class inherits {\hyperref[\detokenize{api:dycore.prognostic_isentropic_nonconservative.PrognosticIsentropicNonconservative}]{\sphinxcrossref{\sphinxcode{PrognosticIsentropicNonconservative}}}}
to implement a centered time-integration scheme to carry out the prognostic step of the three-dimensional
moist isentropic dynamical core. The nonconservative form of the governing equations, expressed using isentropic
coordinates, is used.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
{\hyperref[\detokenize{api:dycore.dycore.DynamicalCore.time_levels}]{\sphinxcrossref{\sphinxstyleliteralstrong{time\_levels}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of time levels the scheme relies on.

\item {} 
\sphinxstyleliteralstrong{steps} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of steps the scheme entails.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.prognostic\_isentropic\_nonconservative\_centered.PrognosticIsentropicNonconservativeCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative_centered.PrognosticIsentropicNonconservativeCentered.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{flux\_scheme}, \emph{grid}, \emph{moist\_on}, \emph{backend}, \emph{coupling\_physics\_dynamics\_on}, \emph{sedimentation\_on}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{flux\_scheme} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the flux scheme to use. Either:
\begin{itemize}
\item {} 
’upwind’, for the upwind flux;

\item {} 
’centered’, for a second-order centered flux;

\item {} 
’maccormack’, for the MacCormack flux.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{moist\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} for a moist dynamical core, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py stencils.

\item {} 
\sphinxstyleliteralstrong{physics\_dynamics\_coupling\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} to couple physics with dynamics, i.e., to account for the change over time in potential
temperature, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{sedimentation\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} to account for rain sedimentation, \sphinxcode{False} otherwise.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
To instantiate an object of this class, one should prefer the static method
{\hyperref[\detokenize{api:dycore.prognostic_isentropic_nonconservative.PrognosticIsentropicNonconservative.factory}]{\sphinxcrossref{\sphinxcode{factory()}}}} of
{\hyperref[\detokenize{api:dycore.prognostic_isentropic_nonconservative.PrognosticIsentropicNonconservative}]{\sphinxcrossref{\sphinxcode{PrognosticIsentropicNonconservative}}}}.
\end{sphinxadmonition}

\end{fulllineitems}

\index{\_stencil\_clipping\_mass\_fraction\_and\_diagnosing\_isentropic\_density\_of\_precipitation\_water\_defs() (dycore.prognostic\_isentropic\_nonconservative\_centered.PrognosticIsentropicNonconservativeCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative_centered.PrognosticIsentropicNonconservativeCentered._stencil_clipping_mass_fraction_and_diagnosing_isentropic_density_of_precipitation_water_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_clipping\_mass\_fraction\_and\_diagnosing\_isentropic\_density\_of\_precipitation\_water\_defs}}{\emph{in\_s}, \emph{in\_qr}}{}
GT4Py stencil clipping the negative values for the mass fraction of precipitation water,
and diagnosing the isentropic density of precipitation water.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the air isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of precipitation water in air.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_qr} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the clipped mass fraction of precipitation water.

\item {} 
\sphinxstylestrong{out\_Qr} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_computing\_slow\_tendencies\_defs() (dycore.prognostic\_isentropic\_nonconservative\_centered.PrognosticIsentropicNonconservativeCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative_centered.PrognosticIsentropicNonconservativeCentered._stencil_computing_slow_tendencies_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_computing\_slow\_tendencies\_defs}}{\emph{dt}, \emph{in\_s\_old}, \emph{in\_s\_prv}, \emph{in\_qr\_old}, \emph{in\_qr\_prv}}{}
GT4Py stencil computing the slow tendencies required to resolve rain sedimentation.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the large timestep.

\item {} 
\sphinxstyleliteralstrong{in\_s\_old} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the old isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_s\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_qr\_old} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the old mass fraction of precipitation water.

\item {} 
\sphinxstyleliteralstrong{in\_qr\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional mass fraction of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_s\_tnd} (\sphinxstyleemphasis{obj :}) \textendash{} \sphinxcode{gridtools.Equation} representing the slow tendency for the isentropic density.

\item {} 
\sphinxstylestrong{out\_qr\_tnd} (\sphinxstyleemphasis{obj :}) \textendash{} \sphinxcode{gridtools.Equation} representing the slow tendency for the mass fraction of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_defs() (dycore.prognostic\_isentropic\_nonconservative\_centered.PrognosticIsentropicNonconservativeCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative_centered.PrognosticIsentropicNonconservativeCentered._stencil_stepping_by_coupling_physics_with_dynamics_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_coupling\_physics\_with\_dynamics\_defs}}{\emph{dt}, \emph{in\_w}, \emph{in\_s\_now}, \emph{in\_s\_prv}, \emph{in\_u\_now}, \emph{in\_u\_prv}, \emph{in\_v\_now}, \emph{in\_v\_prv}, \emph{qv\_now=None}, \emph{qv\_prv=None}, \emph{qc\_now=None}, \emph{qc\_prv=None}, \emph{qr\_now=None}, \emph{qr\_prv=None}}{}
GT4Py stencil stepping the solution by coupling physics with dynamics, i.e., by accounting for the
change over time in potential temperature.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_w} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the vertical velocity, i.e., the change over time in potential temperature.

\item {} 
\sphinxstyleliteralstrong{in\_s\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_s\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_u\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_u\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_v\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the current \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_v\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{in\_qv\_now} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current mass fraction of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_qv\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional mass fraction of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_qc\_now} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current mass fraction of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_qc\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional mass fraction of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_qr\_now} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the current mass fraction of precipitation water.

\item {} 
\sphinxstyleliteralstrong{in\_qr\_prv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the provisional mass fraction of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_s} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the updated isentropic density.

\item {} 
\sphinxstylestrong{out\_u} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the updated \(x\)-velocity.

\item {} 
\sphinxstylestrong{out\_v} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the updated \(y\)-velocity.

\item {} 
\sphinxstylestrong{out\_qv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the updated mass fraction of water vapor.

\item {} 
\sphinxstylestrong{out\_qc} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the updated mass fraction of cloud liquid water.

\item {} 
\sphinxstylestrong{out\_qr} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the updated mass fraction of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_integrating\_sedimentation\_flux\_defs() (dycore.prognostic\_isentropic\_nonconservative\_centered.PrognosticIsentropicNonconservativeCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative_centered.PrognosticIsentropicNonconservativeCentered._stencil_stepping_by_integrating_sedimentation_flux_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_integrating\_sedimentation\_flux\_defs}}{\emph{dts}, \emph{in\_rho}, \emph{in\_s}, \emph{in\_h}, \emph{in\_qr}, \emph{in\_vt}, \emph{in\_s\_tnd}, \emph{in\_qr\_tnd}}{}
GT4Py stencil stepping the isentropic density and the mass fraction of precipitation water
by integrating the precipitation flux.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dts} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the small timestep.

\item {} 
\sphinxstyleliteralstrong{in\_rho} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the air density.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the air isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_h} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the geometric height of the model half-levels.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the input mass fraction of precipitation water.

\item {} 
\sphinxstyleliteralstrong{in\_vt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the raindrop fall velocity.

\item {} 
\sphinxstyleliteralstrong{in\_s\_tnd} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the contribution from the slow tendencies for the isentropic density.

\item {} 
\sphinxstyleliteralstrong{in\_qr\_tnd} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the contribution from the slow tendencies for the mass fraction of
precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_s} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the output isentropic density.

\item {} 
\sphinxstylestrong{out\_qr} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the output mass fraction of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_neglecting\_vertical\_advection\_unstaggered\_defs() (dycore.prognostic\_isentropic\_nonconservative\_centered.PrognosticIsentropicNonconservativeCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative_centered.PrognosticIsentropicNonconservativeCentered._stencil_stepping_by_neglecting_vertical_advection_unstaggered_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_neglecting\_vertical\_advection\_unstaggered\_defs}}{\emph{dt}, \emph{in\_s}, \emph{in\_u}, \emph{in\_v}, \emph{in\_mtg}, \emph{in\_s\_old}, \emph{in\_qv=None}, \emph{in\_qc=None}, \emph{in\_qr=None}, \emph{in\_qv\_old=None}, \emph{in\_qc\_old=None}, \emph{in\_qr\_old=None}}{}
GT4Py stencil advancing the isentropic density and, possibly, the water constituents via a centered time-integration scheme.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density at the current time level.

\item {} 
\sphinxstyleliteralstrong{in\_u} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-velocity at the current time level.

\item {} 
\sphinxstyleliteralstrong{in\_v} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-velocity at the current time level.

\item {} 
\sphinxstyleliteralstrong{in\_s} \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential at the current time level.

\item {} 
\sphinxstyleliteralstrong{in\_s\_old} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density at the previous time level.

\item {} 
\sphinxstyleliteralstrong{in\_qv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of water vapor at the current time level.

\item {} 
\sphinxstyleliteralstrong{in\_qc} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of cloud liquid water at the current time level.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of precipitation water at the current time level.

\item {} 
\sphinxstyleliteralstrong{in\_qv\_old} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of water vapor at the previous time level.

\item {} 
\sphinxstyleliteralstrong{in\_qc\_old} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of cloud liquid water at the previous time level.

\item {} 
\sphinxstyleliteralstrong{in\_qr\_old} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of precipitation water at the previous time level.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_s} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped isentropic density.

\item {} 
\sphinxstylestrong{out\_qv} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped mass fraction of water vapour.

\item {} 
\sphinxstylestrong{out\_qc} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped mass fraction of cloud liquid water.

\item {} 
\sphinxstylestrong{out\_qr} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the stepped mass fraction of precipitation water.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_neglecting\_vertical\_advection\_velocity\_x\_defs() (dycore.prognostic\_isentropic\_nonconservative\_centered.PrognosticIsentropicNonconservativeCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative_centered.PrognosticIsentropicNonconservativeCentered._stencil_stepping_by_neglecting_vertical_advection_velocity_x_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_neglecting\_vertical\_advection\_velocity\_x\_defs}}{\emph{dt}, \emph{in\_s}, \emph{in\_u}, \emph{in\_v}, \emph{in\_mtg}, \emph{in\_u\_old}}{}
GT4Py stencil advancing the \(x\)-velocity via a centered time-integration scheme.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density at the current time level.

\item {} 
\sphinxstyleliteralstrong{in\_u} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-velocity at the current time level.

\item {} 
\sphinxstyleliteralstrong{in\_v} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-velocity at the current time level.

\item {} 
\sphinxstyleliteralstrong{in\_mtg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential at the current time level.

\item {} 
\sphinxstyleliteralstrong{in\_u\_old} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-velocity at the previous time level.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the stepped \(x\)-velocity.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_stepping\_by\_neglecting\_vertical\_advection\_velocity\_y\_defs() (dycore.prognostic\_isentropic\_nonconservative\_centered.PrognosticIsentropicNonconservativeCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative_centered.PrognosticIsentropicNonconservativeCentered._stencil_stepping_by_neglecting_vertical_advection_velocity_y_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_stepping\_by\_neglecting\_vertical\_advection\_velocity\_y\_defs}}{\emph{dt}, \emph{in\_s}, \emph{in\_u}, \emph{in\_v}, \emph{in\_mtg}, \emph{in\_v\_old}}{}
GT4Py stencil advancing the \(y\)-velocity via a centered time-integration scheme.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{in\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the isentropic density at the current time level.

\item {} 
\sphinxstyleliteralstrong{in\_u} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(x\)-velocity at the current time level.

\item {} 
\sphinxstyleliteralstrong{in\_v} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-velocity at the current time level.

\item {} 
\sphinxstyleliteralstrong{in\_mtg} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Montgomery potential at the current time level.

\item {} 
\sphinxstyleliteralstrong{in\_v\_old} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the \(y\)-velocity at the previous time level.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the stepped \(y\)-velocity.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencils\_stepping\_by\_integrating\_sedimentation\_flux\_initialize() (dycore.prognostic\_isentropic\_nonconservative\_centered.PrognosticIsentropicNonconservativeCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative_centered.PrognosticIsentropicNonconservativeCentered._stencils_stepping_by_integrating_sedimentation_flux_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencils\_stepping\_by\_integrating\_sedimentation\_flux\_initialize}}{}{}
Initialize the GT4Py stencils in charge of stepping the mass fraction of precipitation water by
integrating the sedimentation flux.

\end{fulllineitems}

\index{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_allocate\_inputs() (dycore.prognostic\_isentropic\_nonconservative\_centered.PrognosticIsentropicNonconservativeCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative_centered.PrognosticIsentropicNonconservativeCentered._stencils_stepping_by_neglecting_vertical_advection_allocate_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_allocate\_inputs}}{\emph{mi}, \emph{mj}}{}
Allocate the attributes which will serve as inputs to the GT4Py stencil stepping the solution
by neglecting vertical advection.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{mi} (\sphinxstyleliteralemphasis{int}) \textendash{} \(x\)-extent of an input array representing an \(x\)-unstaggered field.

\item {} 
\sphinxstyleliteralstrong{mj} (\sphinxstyleliteralemphasis{int}) \textendash{} \(y\)-extent of an input array representing a \(y\)-unstaggered field.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_initialize() (dycore.prognostic\_isentropic\_nonconservative\_centered.PrognosticIsentropicNonconservativeCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative_centered.PrognosticIsentropicNonconservativeCentered._stencils_stepping_by_neglecting_vertical_advection_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_initialize}}{\emph{state}}{}
Initialize the GT4Py stencils implementing a time-integration centered scheme to step the solution
by neglecting vertical advection.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered).

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_set\_inputs() (dycore.prognostic\_isentropic\_nonconservative\_centered.PrognosticIsentropicNonconservativeCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative_centered.PrognosticIsentropicNonconservativeCentered._stencils_stepping_by_neglecting_vertical_advection_set_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencils\_stepping\_by\_neglecting\_vertical\_advection\_set\_inputs}}{\emph{dt}, \emph{state}, \emph{state\_old=None}}{}
Update the attributes which serve as inputs to the GT4Py stencils stepping the solution
by neglecting vertical advection.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} A \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
montgomery\_potential (isentropic);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{state\_old} (\sphinxtitleref{obj}, optional) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the old state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{step\_integrating\_sedimentation\_flux() (dycore.prognostic\_isentropic\_nonconservative\_centered.PrognosticIsentropicNonconservativeCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative_centered.PrognosticIsentropicNonconservativeCentered.step_integrating_sedimentation_flux}}\pysiglinewithargsret{\sphinxbfcode{step\_integrating\_sedimentation\_flux}}{\emph{dt}, \emph{state\_now}, \emph{state\_prv}, \emph{diagnostics=None}}{}
Method advancing the mass fraction of precipitation water by taking the sedimentation into account.
For the sake of numerical stability, a time-splitting strategy is pursued, i.e., the sedimentation flux
is integrated using a timestep which may be smaller than that specified by the user.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state\_now} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
\sphinxcode{StateIsentropic} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_density (unstaggered);

\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
air\_pressure or air\_pressure\_on\_interface\_levels (\(z\)-staggered);

\item {} 
height or height\_on\_interface\_levels (\(z\)-staggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in air (unstaggered).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{state\_prv} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
\sphinxcode{StateIsentropic} representing the provisional state, i.e.,
the state stepped without taking the sedimentation flux into account.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_density (unstaggered);

\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
air\_pressure or air\_pressure\_on\_interface\_levels (\(z\)-staggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in air (unstaggered).

\end{itemize}

This may be the output of either
\sphinxcode{step\_neglecting\_vertical\_advection()} or
\sphinxcode{step\_coupling\_physics\_with\_dynamics()}.


\item {} 
\sphinxstyleliteralstrong{diagnostics} (\sphinxtitleref{obj}, optional) \textendash{} 
\sphinxcode{GridData} collecting the following diagnostics:
\begin{itemize}
\item {} 
accumulated\_precipitation (unstaggered, two-dimensional).

\end{itemize}


\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{state\_new} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{StateIsentropic} containing the following updated variables:
\begin{itemize}
\item {} 
mass\_fraction\_of\_precipitation\_water\_in air (unstaggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}

\item {} 
\sphinxstylestrong{diagnostics\_out} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{GridData} collecting the output diagnostics, i.e.:
\begin{itemize}
\item {} 
accumulated\_precipitation (unstaggered, two-dimensional);

\item {} 
precipitation (unstaggered, two-dimensional).

\end{itemize}

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{step\_neglecting\_vertical\_advection() (dycore.prognostic\_isentropic\_nonconservative\_centered.PrognosticIsentropicNonconservativeCentered method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.prognostic_isentropic_nonconservative_centered.PrognosticIsentropicNonconservativeCentered.step_neglecting_vertical_advection}}\pysiglinewithargsret{\sphinxbfcode{step\_neglecting\_vertical\_advection}}{\emph{dt}, \emph{state}, \emph{state\_old=None}, \emph{diagnostics=None}, \emph{tendencies=None}}{}
Method advancing the prognostic model variables one time step forward via a centered time-integration
scheme. Only horizontal derivates are considered; possible vertical derivatives are disregarded.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
air\_pressure or air\_pressure\_on\_interface\_levels (\(z\)-staggered);

\item {} 
montgomery\_potential (isentropic);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{state\_old} (\sphinxtitleref{obj}, optional) \textendash{} 
{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} representing the old state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{diagnostics} (\sphinxtitleref{obj}, optional) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} possibly storing diagnostics.
For the time being, this is not actually used.

\item {} 
\sphinxstyleliteralstrong{tendencies} (\sphinxtitleref{obj}, optional) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} possibly storing tendencies.
For the time being, this is not actually used.

\end{itemize}

\item[{Returns}] \leavevmode

{\hyperref[\detokenize{api:storages.state_isentropic.StateIsentropic}]{\sphinxcrossref{\sphinxcode{StateIsentropic}}}} containing the updated prognostic variables, i.e.,
\begin{itemize}
\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered, optional);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered, optional).

\end{itemize}


\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{Sedimentation flux}
\label{\detokenize{api:sedimentation-flux}}\index{FluxSedimentation (class in dycore.flux\_sedimentation)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_sedimentation.FluxSedimentation}}\pysigline{\sphinxbfcode{class }\sphinxcode{dycore.flux\_sedimentation.}\sphinxbfcode{FluxSedimentation}}
Abstract base class whose derived classes discretize the vertical derivative of the sedimentation flux
with different orders of accuracy.
\index{factory() (dycore.flux\_sedimentation.FluxSedimentation static method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_sedimentation.FluxSedimentation.factory}}\pysiglinewithargsret{\sphinxbfcode{static }\sphinxbfcode{factory}}{\emph{sedimentation\_flux\_type}}{}
Static method returning an instance of the derived class which discretizes the vertical derivative of
the sedimentation flux with the desired level of accuracy.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{sedimentation\_flux\_type} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the method used to compute the numerical sedimentation flux. Available options are:
\begin{itemize}
\item {} 
’first\_order\_upwind’, for the first-order upwind scheme;

\item {} 
’second\_order\_upwind’, for the second-order upwind scheme.

\end{itemize}


\item[{Returns}] \leavevmode


\item[{Return type}] \leavevmode
Instance of the derived class implementing the desired method.

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_vertical\_derivative\_of\_sedimentation\_flux() (dycore.flux\_sedimentation.FluxSedimentation method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_sedimentation.FluxSedimentation.get_vertical_derivative_of_sedimentation_flux}}\pysiglinewithargsret{\sphinxbfcode{get\_vertical\_derivative\_of\_sedimentation\_flux}}{\emph{i}, \emph{j}, \emph{k}, \emph{in\_rho}, \emph{in\_h}, \emph{in\_qr}, \emph{in\_vt}}{}
Get the vertical derivative of the sedimentation flux.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{in\_rho} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the air density.

\item {} 
\sphinxstyleliteralstrong{in\_h} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the geometric height of the model half-levels.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of precipitation water in air.

\item {} 
\sphinxstyleliteralstrong{in\_vt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the raindrop fall velocity.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the vertical derivative of the sedimentation flux.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{FluxSedimentationUpwindFirstOrder (class in dycore.flux\_sedimentation)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_sedimentation.FluxSedimentationUpwindFirstOrder}}\pysigline{\sphinxbfcode{class }\sphinxcode{dycore.flux\_sedimentation.}\sphinxbfcode{FluxSedimentationUpwindFirstOrder}}
This class inherits \sphinxcode{SedimentationFlux} to implement a standard, first-order
accurate upwind method to discretize the vertical derivative of the sedimentation flux.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.nb}]{\sphinxcrossref{\sphinxstyleliteralstrong{nb}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Extent of the stencil in the upward vertical direction.

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.flux\_sedimentation.FluxSedimentationUpwindFirstOrder method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_sedimentation.FluxSedimentationUpwindFirstOrder.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{}{}
Constructor.

\begin{sphinxadmonition}{note}{Note:}
To instantiate an object of this class, one should prefer the static method
\sphinxcode{factory()} of
\sphinxcode{SedimentationFlux}.
\end{sphinxadmonition}

\end{fulllineitems}

\index{get\_vertical\_derivative\_of\_sedimentation\_flux() (dycore.flux\_sedimentation.FluxSedimentationUpwindFirstOrder method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_sedimentation.FluxSedimentationUpwindFirstOrder.get_vertical_derivative_of_sedimentation_flux}}\pysiglinewithargsret{\sphinxbfcode{get\_vertical\_derivative\_of\_sedimentation\_flux}}{\emph{i}, \emph{j}, \emph{k}, \emph{in\_rho}, \emph{in\_h}, \emph{in\_qr}, \emph{in\_vt}}{}
Get the vertical derivative of the sedimentation flux.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{in\_rho} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the air density.

\item {} 
\sphinxstyleliteralstrong{in\_h} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the geometric height of the model half-levels.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of precipitation water in air.

\item {} 
\sphinxstyleliteralstrong{in\_vt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the raindrop fall velocity.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the vertical derivative of the sedimentation flux.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{FluxSedimentationUpwindSecondOrder (class in dycore.flux\_sedimentation)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_sedimentation.FluxSedimentationUpwindSecondOrder}}\pysigline{\sphinxbfcode{class }\sphinxcode{dycore.flux\_sedimentation.}\sphinxbfcode{FluxSedimentationUpwindSecondOrder}}
This class inherits \sphinxcode{SedimentationFlux} to implement a second-order
accurate upwind method to discretize the vertical derivative of the sedimentation flux.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode
{\hyperref[\detokenize{api:dycore.prognostic_isentropic.PrognosticIsentropic.nb}]{\sphinxcrossref{\sphinxstyleliteralstrong{nb}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Extent of the stencil in the upward vertical direction.

\end{description}\end{quote}
\index{\_\_init\_\_() (dycore.flux\_sedimentation.FluxSedimentationUpwindSecondOrder method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_sedimentation.FluxSedimentationUpwindSecondOrder.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{}{}
Constructor.

\begin{sphinxadmonition}{note}{Note:}
To instantiate an object of this class, one should prefer the static method
\sphinxcode{factory()} of
\sphinxcode{SedimentationFlux}.
\end{sphinxadmonition}

\end{fulllineitems}

\index{get\_vertical\_derivative\_of\_sedimentation\_flux() (dycore.flux\_sedimentation.FluxSedimentationUpwindSecondOrder method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.flux_sedimentation.FluxSedimentationUpwindSecondOrder.get_vertical_derivative_of_sedimentation_flux}}\pysiglinewithargsret{\sphinxbfcode{get\_vertical\_derivative\_of\_sedimentation\_flux}}{\emph{i}, \emph{j}, \emph{k}, \emph{in\_rho}, \emph{in\_h}, \emph{in\_qr}, \emph{in\_vt}}{}
Get the vertical derivative of the sedimentation flux.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{i} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(x\)-axis.

\item {} 
\sphinxstyleliteralstrong{j} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(y\)-axis.

\item {} 
\sphinxstyleliteralstrong{k} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Index} representing the index running along the \(\theta\)-axis.

\item {} 
\sphinxstyleliteralstrong{in\_rho} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the air density.

\item {} 
\sphinxstyleliteralstrong{in\_h} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the geometric height of the model half-levels.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of precipitation water in air.

\item {} 
\sphinxstyleliteralstrong{in\_vt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the raindrop fall velocity.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the vertical derivative of the sedimentation flux.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{Wave absorber}
\label{\detokenize{api:wave-absorber}}\index{VerticalDamping (class in dycore.vertical\_damping)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.vertical_damping.VerticalDamping}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.vertical\_damping.}\sphinxbfcode{VerticalDamping}}{\emph{dims}, \emph{grid}, \emph{damp\_depth}, \emph{damp\_max}, \emph{backend}}{}
Abstract base class whose derived classes implement different vertical damping, i.e., wave absorbing, techniques.
\index{\_\_init\_\_() (dycore.vertical\_damping.VerticalDamping method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.vertical_damping.VerticalDamping.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{dims}, \emph{grid}, \emph{damp\_depth}, \emph{damp\_max}, \emph{backend}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the dimension of the (three-dimensional) arrays on which to apply vertical damping.

\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{damp\_depth} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical layers in the damping region.

\item {} 
\sphinxstyleliteralstrong{damp\_max} (\sphinxstyleliteralemphasis{float}) \textendash{} Maximum value for the damping coefficient.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py stencils implementing the dynamical core.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.vertical\_damping.VerticalDamping method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.vertical_damping.VerticalDamping.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{dt}, \emph{phi\_now}, \emph{phi\_new}, \emph{phi\_ref}}{}
Apply vertical damping to a generic field \(\phi\).
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field \(\phi\) at the current time level.

\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field \(\phi\) at the next time level, on
which the absorber will be applied.

\item {} 
\sphinxstyleliteralstrong{phi\_ref} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing a reference value for \(\phi\).

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the damped field \(\phi\).

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{factory() (dycore.vertical\_damping.VerticalDamping static method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.vertical_damping.VerticalDamping.factory}}\pysiglinewithargsret{\sphinxbfcode{static }\sphinxbfcode{factory}}{\emph{damp\_type}, \emph{dims}, \emph{grid}, \emph{damp\_depth}, \emph{damp\_max}, \emph{backend}}{}
Static method which returns an instance of the derived class implementing the damping method
specified by \sphinxcode{damp\_type}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the dimension of the (three-dimensional) arrays on which to apply vertical damping.

\item {} 
\sphinxstyleliteralstrong{damp\_type} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the damper to implement. Either:
\begin{itemize}
\item {} 
’rayleigh’, for a Rayleigh damper.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{damp\_depth} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical layers in the damping region. Default is 15.

\item {} 
\sphinxstyleliteralstrong{damp\_max} (\sphinxstyleliteralemphasis{float}) \textendash{} Maximum value for the damping coefficient. Default is 0.0002.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py stencils implementing the dynamical core.

\end{itemize}

\item[{Returns}] \leavevmode
An instance of the derived class implementing the damping method specified by \sphinxcode{damp\_type}.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{VerticalDampingRayleigh (class in dycore.vertical\_damping)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.vertical_damping.VerticalDampingRayleigh}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{dycore.vertical\_damping.}\sphinxbfcode{VerticalDampingRayleigh}}{\emph{dims}, \emph{grid}, \emph{damp\_depth}, \emph{damp\_max}, \emph{backend}}{}
This class inherits {\hyperref[\detokenize{api:dycore.vertical_damping.VerticalDamping}]{\sphinxcrossref{\sphinxcode{VerticalDamping}}}} to implement a Rayleigh absorber.
\index{\_\_init\_\_() (dycore.vertical\_damping.VerticalDampingRayleigh method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.vertical_damping.VerticalDampingRayleigh.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{dims}, \emph{grid}, \emph{damp\_depth}, \emph{damp\_max}, \emph{backend}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dims} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple of the dimension of the (three-dimensional) arrays on which to apply vertical damping.

\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{damp\_depth} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical layers in the damping region.

\item {} 
\sphinxstyleliteralstrong{damp\_max} (\sphinxstyleliteralemphasis{float}) \textendash{} Maximum value for the damping coefficient.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py stencils implementing the dynamical core.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_defs() (dycore.vertical\_damping.VerticalDampingRayleigh method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.vertical_damping.VerticalDampingRayleigh._stencil_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_defs}}{\emph{dt}, \emph{phi\_now}, \emph{phi\_new}, \emph{phi\_ref}, \emph{R}}{}
The GT4Py stencil applying Rayleigh vertical damping.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Global} representing the time step.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{ibj}) \textendash{} \sphinxcode{gridtools.Equation} representing the field \(\phi\) at the current time level.

\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the field \(\phi\) at the next time level, on
which the absorber will be applied.

\item {} 
\sphinxstyleliteralstrong{phi\_ref} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing a reference value for \(\phi\).

\item {} 
\sphinxstyleliteralstrong{R} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the damping coefficient.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the damped field \(\phi\).

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_initialize() (dycore.vertical\_damping.VerticalDampingRayleigh method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.vertical_damping.VerticalDampingRayleigh._stencil_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_initialize}}{}{}
Initialize the GT4Py stencil applying Rayleigh vertical damping.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field \(\phi\) at the current time level.

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_set\_inputs() (dycore.vertical\_damping.VerticalDampingRayleigh method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.vertical_damping.VerticalDampingRayleigh._stencil_set_inputs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_set\_inputs}}{\emph{dt}, \emph{phi\_now}, \emph{phi\_new}, \emph{phi\_ref}}{}
Update the attributes which stores the stencil’s input fields.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field \(\phi\) at the current time level.

\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field \(\phi\) at the next time level, on
which the absorber will be applied.

\item {} 
\sphinxstyleliteralstrong{phi\_ref} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing a reference value for \(\phi\).

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{apply() (dycore.vertical\_damping.VerticalDampingRayleigh method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:dycore.vertical_damping.VerticalDampingRayleigh.apply}}\pysiglinewithargsret{\sphinxbfcode{apply}}{\emph{dt}, \emph{phi\_now}, \emph{phi\_new}, \emph{phi\_ref}}{}
Apply vertical damping to a generic field \(\phi\).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{phi\_now} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field \(\phi\) at the current time level.

\item {} 
\sphinxstyleliteralstrong{phi\_new} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field \(\phi\) at the next time level, on
which the absorber will be applied.

\item {} 
\sphinxstyleliteralstrong{phi\_ref} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing a reference value for \(\phi\).

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the damped field \(\phi\).

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\section{Grids}
\label{\detokenize{api:grids}}

\subsection{Two-dimensional grids}
\label{\detokenize{api:two-dimensional-grids}}\index{GridXY (class in grids.grid\_xy)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xy.GridXY}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{grids.grid\_xy.}\sphinxbfcode{GridXY}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_y}, \emph{ny}, \emph{units\_x='degrees\_east'}, \emph{dims\_x='longitude'}, \emph{units\_y='degrees\_north'}, \emph{dims\_y='latitude'}}{}
Rectangular and regular two-dimensional grid embedded in a reference system whose coordinates are,
in the order, \(x\) and \(y\). No assumption is made on the nature of the coordinates. For
instance, \(x\) may be the longitude, in which case \(x \equiv \lambda\), and \(y\) may
be the latitude, in which case \(y \equiv \phi\).
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.x}]{\sphinxcrossref{\sphinxstyleliteralstrong{x}}}} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} storing the \(x\)-coordinates of the mass points.

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.x_at_u_locations}]{\sphinxcrossref{\sphinxstyleliteralstrong{x\_at\_u\_locations}}}} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} storing the \(x\)-coordinates at the \(u\)-locations.

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.nx}]{\sphinxcrossref{\sphinxstyleliteralstrong{nx}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points along \(x\).

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.dx}]{\sphinxcrossref{\sphinxstyleliteralstrong{dx}}}} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(x\)-spacing.

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.y}]{\sphinxcrossref{\sphinxstyleliteralstrong{y}}}} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} storing the \(y\)-coordinates of the mass points.

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.y_at_v_locations}]{\sphinxcrossref{\sphinxstyleliteralstrong{y\_at\_v\_locations}}}} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} storing the \(y\)-coordinates at the \(v\)-locations.

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.ny}]{\sphinxcrossref{\sphinxstyleliteralstrong{ny}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points along \(y\).

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.dy}]{\sphinxcrossref{\sphinxstyleliteralstrong{dy}}}} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(y\)-spacing.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (grids.grid\_xy.GridXY method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xy.GridXY.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_y}, \emph{ny}, \emph{units\_x='degrees\_east'}, \emph{dims\_x='longitude'}, \emph{units\_y='degrees\_north'}, \emph{dims\_y='latitude'}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{domain\_x} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((x_{start}, ~ x_{stop})\).

\item {} 
\sphinxstyleliteralstrong{nx} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points along \(x\).

\item {} 
\sphinxstyleliteralstrong{domain\_y} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((y_{start}, ~ y_{stop})\).

\item {} 
\sphinxstyleliteralstrong{ny} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points along \(y\).

\item {} 
\sphinxstyleliteralstrong{units\_x} (\sphinxtitleref{str}, optional) \textendash{} Units for the \(x\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{dims\_x} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(x\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{units\_y} (\sphinxtitleref{str}, optional) \textendash{} Units for the \(y\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{dims\_y} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(y\)-coordinate.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
Axes labels should use the \sphinxhref{http://cfconventions.org}{CF Conventions}.
\end{sphinxadmonition}

\end{fulllineitems}


\end{fulllineitems}

\index{GridXZ (class in grids.grid\_xz)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xz.GridXZ}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{grids.grid\_xz.}\sphinxbfcode{GridXZ}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='m'}, \emph{dims\_x='x'}, \emph{units\_z='m'}, \emph{dims\_z='z'}, \emph{z\_interface=None}, \emph{topo\_type='terrain\_flat'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Rectangular and regular two-dimensional grid embedded in a reference system whose coordinates are
\begin{itemize}
\item {} 
the horizontal coordinate \(x\);

\item {} 
the vertical (terrain-following) coordinate \(z\).

\end{itemize}

The vertical coordinate \(z\) may be formulated to define a hybrid terrain-following coordinate system
with terrain-following coordinate lines between the surface terrain-height and \(z = z_F\), where
\(z\)-coordinate lines change back to flat horizontal lines. However, no assumption is made on the actual
nature of \(z\) which may be either pressure-based or height-based.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.x}]{\sphinxcrossref{\sphinxstyleliteralstrong{x}}}} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(x\)-axis.

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.nx}]{\sphinxcrossref{\sphinxstyleliteralstrong{nx}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points along \(x\).

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.dx}]{\sphinxcrossref{\sphinxstyleliteralstrong{dx}}}} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(x\)-spacing.

\item {} 
\sphinxstyleliteralstrong{z} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(z\)-main levels.

\item {} 
\sphinxstyleliteralstrong{z\_on\_interface\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(z\)-half levels.

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{dz} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(z\)-spacing.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} The interface coordinate \(z_F\).

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
For the sake of compliancy with the \sphinxhref{http://www.cosmo-model.org}{COSMO model}, the vertical grid points are
ordered from the top of the domain to the surface.
\end{sphinxadmonition}
\index{\_\_init\_\_() (grids.grid\_xz.GridXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xz.GridXZ.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='m'}, \emph{dims\_x='x'}, \emph{units\_z='m'}, \emph{dims\_z='z'}, \emph{z\_interface=None}, \emph{topo\_type='terrain\_flat'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{domain\_x} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((x_{left}, ~ x_{right})\).

\item {} 
\sphinxstyleliteralstrong{nx} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points in the \(x\)-direction.

\item {} 
\sphinxstyleliteralstrong{domain\_z} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((z_{top}, ~ z_{surface})\).

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{units\_x} (\sphinxtitleref{str}, optional) \textendash{} 
Units for the \(x\)-coordinate. Must be compliant with the \sphinxhref{http://cfconventions.org}{CF Conventions}
(see also {\hyperref[\detokenize{api:grids.axis.Axis.__init__}]{\sphinxcrossref{\sphinxcode{grids.axis.Axis.\_\_init\_\_()}}}}).


\item {} 
\sphinxstyleliteralstrong{dims\_x} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(x\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{units\_z} (\sphinxtitleref{str}, optional) \textendash{} 
Units for the \(z\)-coordinate. Must be compliant with the \sphinxhref{http://cfconventions.org}{CF Conventions}
(see also {\hyperref[\detokenize{api:grids.axis.Axis.__init__}]{\sphinxcrossref{\sphinxcode{grids.axis.Axis.\_\_init\_\_()}}}}).


\item {} 
\sphinxstyleliteralstrong{dims\_z} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(z\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxtitleref{float}, optional) \textendash{} Interface value \(z_F\). If not specified, it is assumed that \(z_F = z_T\), with \(z_T\) the
value of \(z\) at the top of the domain. In other words, a fully terrain-following coordinate system is
supposed.

\item {} 
\sphinxstyleliteralstrong{topo\_type} (\sphinxtitleref{str}, optional) \textendash{} Topography type. See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}} for further details.

\item {} 
\sphinxstyleliteralstrong{topo\_time} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{datetime.timedelta} representing the simulation time after which the topography should stop
increasing. Default is 0, corresponding to a time-invariant terrain surface-height. See
{\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}} for further details.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode
\sphinxstyleliteralstrong{kwargs} \textendash{} Keyword arguments to be forwarded to the constructor of {\hyperref[\detokenize{api:grids.topography.Topography1d}]{\sphinxcrossref{\sphinxcode{Topography1d}}}}.

\end{description}\end{quote}

\end{fulllineitems}

\index{topography\_height (grids.grid\_xz.GridXZ attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xz.GridXZ.topography_height}}\pysigline{\sphinxbfcode{topography\_height}}
Get the topography (i.e., terrain-surface) height.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
One-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the topography height.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{update\_topography() (grids.grid\_xz.GridXZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xz.GridXZ.update_topography}}\pysiglinewithargsret{\sphinxbfcode{update\_topography}}{\emph{time}}{}
Update the (time-dependent) topography.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the elapsed simulation time.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{Sigma2d (class in grids.sigma)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sigma.Sigma2d}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{grids.sigma.}\sphinxbfcode{Sigma2d}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='m'}, \emph{dims\_x='x'}, \emph{z\_interface=None}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
This class inherits {\hyperref[\detokenize{api:grids.grid_xz.GridXZ}]{\sphinxcrossref{\sphinxcode{GridXZ}}}} to represent a rectangular and regular
two-dimensional grid embedded in a reference system whose coordinates are
\begin{itemize}
\item {} 
the horizontal coordinate \(x\);

\item {} 
the pressure-based terrain-following coordinate \(\sigma = p / p_{SL}\),                  where \(p\) is the pressure and \(p_{SL}\) the pressure at the sea level.

\end{itemize}

The vertical coordinate \(\sigma\) may be formulated to define a hybrid terrain-following coordinate system
with terrain-following coordinate lines between the surface terrain-height and \(\sigma = \sigma_F\), where
\(\sigma\)-coordinate lines change back to flat horizontal lines.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.x}]{\sphinxcrossref{\sphinxstyleliteralstrong{x}}}} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(x\)-axis.

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.nx}]{\sphinxcrossref{\sphinxstyleliteralstrong{nx}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points along \(x\).

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.dx}]{\sphinxcrossref{\sphinxstyleliteralstrong{dx}}}} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(x\)-spacing.

\item {} 
\sphinxstyleliteralstrong{z} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(\sigma\)-main levels.

\item {} 
\sphinxstyleliteralstrong{z\_on\_interface\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(\sigma\)-half levels.

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{dz} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(\sigma\)-spacing.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} The interface coordinate \(\sigma_F\).

\item {} 
\sphinxstyleliteralstrong{height} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the geometric height of the main levels.

\item {} 
\sphinxstyleliteralstrong{height\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the geometric height of the half levels.

\item {} 
\sphinxstyleliteralstrong{height\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} Geometric height corresponding to \(\sigma = \sigma_F\).

\item {} 
\sphinxstyleliteralstrong{reference\_pressure} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the reference pressure at the main levels.

\item {} 
\sphinxstyleliteralstrong{reference\_pressure\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the reference pressure at the half levels.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (grids.sigma.Sigma2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sigma.Sigma2d.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='m'}, \emph{dims\_x='x'}, \emph{z\_interface=None}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{domain\_x} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((x_{left}, ~ x_{right})\).

\item {} 
\sphinxstyleliteralstrong{nx} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points in the \(x\)-direction.

\item {} 
\sphinxstyleliteralstrong{domain\_z} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((\sigma_{top}, ~ \sigma_{surface})\).

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{units\_x} (\sphinxtitleref{str}, optional) \textendash{} 
Units for the \(x\)-coordinate. Must be compliant with the \sphinxhref{http://cfconventions.org}{CF Conventions}
(see also {\hyperref[\detokenize{api:grids.axis.Axis.__init__}]{\sphinxcrossref{\sphinxcode{grids.axis.Axis.\_\_init\_\_()}}}}).


\item {} 
\sphinxstyleliteralstrong{dims\_x} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(x\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxtitleref{float}, optional) \textendash{} Interface value \(\sigma_F\). If not specified, it is assumed that \(\sigma_F = \sigma_T\),
with \(\sigma_T\) the value of \(\sigma\) at the top of the domain. In other words, a fully
terrain-following coordinate system is supposed.

\item {} 
\sphinxstyleliteralstrong{topo\_type} (\sphinxtitleref{str}, optional) \textendash{} Topography type. Default is ‘flat\_terrain’. See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}} for further details.

\item {} 
\sphinxstyleliteralstrong{topo\_time} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{datetime.timedelta} representing the simulation time after which the topography should stop
increasing. Default is 0, corresponding to a time-invariant terrain surface-height. See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}}
for further details.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to be forwarded to the constructor of {\hyperref[\detokenize{api:grids.topography.Topography1d}]{\sphinxcrossref{\sphinxcode{Topography1d}}}}.

\end{description}\end{quote}

\end{fulllineitems}

\index{\_update\_metric\_terms() (grids.sigma.Sigma2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sigma.Sigma2d._update_metric_terms}}\pysiglinewithargsret{\sphinxbfcode{\_update\_metric\_terms}}{}{}
Update the class by computing the metric terms, i.e., the geometric height and the reference pressure,
at both half and main levels. In doing this, a logarithmic vertical profile of reference pressure is assumed.
This method should be called every time the topography is updated or changed.

\end{fulllineitems}

\index{plot() (grids.sigma.Sigma2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sigma.Sigma2d.plot}}\pysiglinewithargsret{\sphinxbfcode{plot}}{\emph{**kwargs}}{}
Plot the grid half levels using \sphinxhref{https://matplotlib.org/2.1.1/api/\_as\_gen/matplotlib.pyplot.html\#module-matplotlib.pyplot}{\sphinxcode{matplotlib.pyplot}}’s utilities.
\begin{quote}\begin{description}
\item[{Keyword Arguments}] \leavevmode
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to be forwarded to \sphinxhref{https://matplotlib.org/2.1.1/api/\_as\_gen/matplotlib.pyplot.subplots.html\#matplotlib.pyplot.subplots}{\sphinxcode{matplotlib.pyplot.subplots()}}.

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
For the sake of compliancy with the notation employed by \sphinxhref{http://www.cosmo-model.org}{COSMO},
the vertical geometric height is denoted by \(z\).
\end{sphinxadmonition}

\end{fulllineitems}

\index{update\_topography() (grids.sigma.Sigma2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sigma.Sigma2d.update_topography}}\pysiglinewithargsret{\sphinxbfcode{update\_topography}}{\emph{time}}{}
Update the (time-dependent) topography. In turn, the metric terms are re-computed.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the elapsed simulation time.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{GalChen2d (class in grids.gal\_chen)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.gal_chen.GalChen2d}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{grids.gal\_chen.}\sphinxbfcode{GalChen2d}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='m'}, \emph{dims\_x='x'}, \emph{z\_interface=None}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
This class inherits \sphinxcode{GridXZ} to represent a rectangular and regular two-dimensional
grid embedded in a reference system whose coordinates are
\begin{itemize}
\item {} 
the horizontal coordinate \(x\);

\item {} 
the height-based Gal-Chen terrain-following coordinate \(\mu\).

\end{itemize}

The vertical coordinate \(\mu\) may be formulated to define a hybrid terrain-following coordinate system
with terrain-following coordinate lines between the surface terrain-height and \(\mu = \mu_F\), where
\(\mu\)-coordinate lines change back to flat horizontal lines.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.x}]{\sphinxcrossref{\sphinxstyleliteralstrong{x}}}} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} object representing the \(x\)-axis.

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.nx}]{\sphinxcrossref{\sphinxstyleliteralstrong{nx}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points along \(x\).

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.dx}]{\sphinxcrossref{\sphinxstyleliteralstrong{dx}}}} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(x\)-spacing.

\item {} 
\sphinxstyleliteralstrong{z} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(\mu\)-main levels.

\item {} 
\sphinxstyleliteralstrong{z\_on\_interface\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(\mu\)-half levels.

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{dz} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(\mu\)-spacing.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} The interface coordinate \(\mu_F\).

\item {} 
\sphinxstyleliteralstrong{height} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the geometric height of the main levels.

\item {} 
\sphinxstyleliteralstrong{height\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the geometric height of the half levels.

\item {} 
\sphinxstyleliteralstrong{height\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} Geometric height corresponding to \(\mu = \mu_F\).

\item {} 
\sphinxstyleliteralstrong{reference\_pressure} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the reference pressure at the main levels.

\item {} 
\sphinxstyleliteralstrong{reference\_pressure\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the reference pressure at the half levels.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (grids.gal\_chen.GalChen2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.gal_chen.GalChen2d.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='m'}, \emph{dims\_x='x'}, \emph{z\_interface=None}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{domain\_x} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((x_{left}, ~ x_{right})\).

\item {} 
\sphinxstyleliteralstrong{nx} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points in the \(x\)-direction.

\item {} 
\sphinxstyleliteralstrong{domain\_z} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((\mu_{top}, ~ \mu_{surface})\).

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{units\_x} (\sphinxtitleref{str}, optional) \textendash{} 
Units for the \(x\)-coordinate. Must be compliant with the \sphinxhref{http://cfconventions.org}{CF Conventions}
(see also {\hyperref[\detokenize{api:grids.axis.Axis.__init__}]{\sphinxcrossref{\sphinxcode{grids.axis.Axis.\_\_init\_\_()}}}}).


\item {} 
\sphinxstyleliteralstrong{dims\_x} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(x\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxtitleref{float}, optional) \textendash{} Interface value \(\mu_F\). If not specified, it is assumed that \(\mu_F = \mu_T\), with \(\mu_T\)
the value of \(\mu\) at the top of the domain. In other words, a fully terrain-following coordinate system
is supposed.

\item {} 
\sphinxstyleliteralstrong{topo\_type} (\sphinxtitleref{str}, optional) \textendash{} Topography type. Default is ‘flat\_terrain’. See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}} for further details.

\item {} 
\sphinxstyleliteralstrong{topo\_time} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{datetime.timedelta} representing the simulation time after which the topography should stop increasing.
Default is 0, corresponding to a time-invariant terrain surface-height. See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}} for further
details.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to be forwarded to the constructor of {\hyperref[\detokenize{api:grids.topography.Topography1d}]{\sphinxcrossref{\sphinxcode{Topography1d}}}}.

\end{description}\end{quote}

\end{fulllineitems}

\index{\_update\_metric\_terms() (grids.gal\_chen.GalChen2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.gal_chen.GalChen2d._update_metric_terms}}\pysiglinewithargsret{\sphinxbfcode{\_update\_metric\_terms}}{}{}
Update the class by computing the metric terms, i.e., the geometric height and the reference pressure,
at both half and main levels. In doing this, a logarithmic vertical profile of reference pressure is assumed.
This method should be called every time the topography is updated or changed.

\end{fulllineitems}

\index{plot() (grids.gal\_chen.GalChen2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.gal_chen.GalChen2d.plot}}\pysiglinewithargsret{\sphinxbfcode{plot}}{\emph{**kwargs}}{}
Plot the grid half levels using \sphinxhref{https://matplotlib.org/2.1.1/api/\_as\_gen/matplotlib.pyplot.html\#module-matplotlib.pyplot}{\sphinxcode{matplotlib.pyplot}}’s utilities.
\begin{quote}\begin{description}
\item[{Keyword Arguments}] \leavevmode
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to be forwarded to \sphinxhref{https://matplotlib.org/2.1.1/api/\_as\_gen/matplotlib.pyplot.subplots.html\#matplotlib.pyplot.subplots}{\sphinxcode{matplotlib.pyplot.subplots()}}.

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
For the sake of compliancy with the notation employed by \sphinxhref{http://www.cosmo-model.org}{COSMO},
the vertical geometric height is denoted by \(z\).
\end{sphinxadmonition}

\end{fulllineitems}

\index{update\_topography() (grids.gal\_chen.GalChen2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.gal_chen.GalChen2d.update_topography}}\pysiglinewithargsret{\sphinxbfcode{update\_topography}}{\emph{time}}{}
Update the (time-dependent) topography. In turn, the metric terms are re-computed.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the elapsed simulation time.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{SLEVE2d (class in grids.sleve)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sleve.SLEVE2d}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{grids.sleve.}\sphinxbfcode{SLEVE2d}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='m'}, \emph{dims\_x='x'}, \emph{z\_interface=None}, \emph{N=100}, \emph{s1=8000.0}, \emph{s2=5000.0}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
This class inherits {\hyperref[\detokenize{api:grids.grid_xz.GridXZ}]{\sphinxcrossref{\sphinxcode{GridXZ}}}} to represent a rectangular and regular two-dimensional
grid embedded in a reference system whose coordinates are
\begin{itemize}
\item {} 
the horizontal coordinate \(x\);

\item {} 
the height-based SLEVE terrain-following coordinate \(\mu\).

\end{itemize}

The vertical coordinate \(\mu\) may be formulated to define a hybrid terrain-following coordinate system
with terrain-following coordinate lines between the surface terrain-height and \(\mu = \mu_F\), where
\(\mu\)-coordinate lines change back to flat horizontal lines.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.x}]{\sphinxcrossref{\sphinxstyleliteralstrong{x}}}} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(x\)-axis.

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.nx}]{\sphinxcrossref{\sphinxstyleliteralstrong{nx}}}} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points along \(x\).

\item {} 
{\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ.dx}]{\sphinxcrossref{\sphinxstyleliteralstrong{dx}}}} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(x\)-spacing.

\item {} 
\sphinxstyleliteralstrong{z} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(\mu\)-main levels.

\item {} 
\sphinxstyleliteralstrong{z\_on\_interface\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(\mu\)-half levels.

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{dz} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(\mu\)-spacing.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} The interface coordinate \(\mu_F\).

\item {} 
\sphinxstyleliteralstrong{height} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the geometric height of the main levels.

\item {} 
\sphinxstyleliteralstrong{height\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the geometric height of the half levels.

\item {} 
\sphinxstyleliteralstrong{height\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} Geometric height corresponding to \(\mu = \mu_F\).

\item {} 
\sphinxstyleliteralstrong{reference\_pressure} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the reference pressure at the main levels.

\item {} 
\sphinxstyleliteralstrong{reference\_pressure\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the reference pressure at the half levels.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (grids.sleve.SLEVE2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sleve.SLEVE2d.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='m'}, \emph{dims\_x='x'}, \emph{z\_interface=None}, \emph{N=100}, \emph{s1=8000.0}, \emph{s2=5000.0}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{domain\_x} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((x_{left}, ~ x_{right})\).

\item {} 
\sphinxstyleliteralstrong{nx} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points in the \(x\)-direction.

\item {} 
\sphinxstyleliteralstrong{domain\_z} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((\mu_{top}, ~ \mu_{surface})\).

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{units\_x} (\sphinxtitleref{str}, optional) \textendash{} 
Units for the \(x\)-coordinate. Must be compliant with the \sphinxhref{http://cfconventions.org}{CF Conventions}
(see also {\hyperref[\detokenize{api:grids.axis.Axis.__init__}]{\sphinxcrossref{\sphinxcode{grids.axis.Axis.\_\_init\_\_()}}}}).


\item {} 
\sphinxstyleliteralstrong{dims\_x} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(x\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxtitleref{float}, optional) \textendash{} Interface value \(\mu_F\). If not specified, it is assumed that \(\mu_F = \mu_T\), with
\(\mu_T\) the value of \(\mu\) at the top of the domain. In other words, a fully terrain-following
coordinate system is supposed.

\item {} 
\sphinxstyleliteralstrong{N} (\sphinxtitleref{int}, optional) \textendash{} Number of filter iterations performed to extract the large-scale component of the surface terrain-height.
Defaults to 100.

\item {} 
\sphinxstyleliteralstrong{s1} (\sphinxtitleref{float}, optional) \textendash{} Large-scale decay constant. Defaults to \(8000 ~ m\).

\item {} 
\sphinxstyleliteralstrong{s2} (\sphinxtitleref{float}, optional) \textendash{} Small-scale decay constant. Defaults to \(5000 ~ m\).

\item {} 
\sphinxstyleliteralstrong{topo\_type} (\sphinxtitleref{str}, optional) \textendash{} Topography type. Defaults to ‘flat\_terrain’. See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}} for further details.

\item {} 
\sphinxstyleliteralstrong{topo\_time} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{datetime.timedelta} representing the simulation time after which the topography should stop
increasing. Default is 0, corresponding to a time-invariant terrain surface-height. See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}}
for further details.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to be forwarded to the constructor of {\hyperref[\detokenize{api:grids.topography.Topography1d}]{\sphinxcrossref{\sphinxcode{Topography1d}}}}.

\end{description}\end{quote}

\end{fulllineitems}

\index{\_update\_metric\_terms() (grids.sleve.SLEVE2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sleve.SLEVE2d._update_metric_terms}}\pysiglinewithargsret{\sphinxbfcode{\_update\_metric\_terms}}{}{}
Update the class by computing the metric terms, i.e., the geometric height and the reference pressure,
at both half and main levels. In doing this, a logarithmic vertical profile of reference pressure is assumed.
This method should be called every time the topography is updated or changed.

\end{fulllineitems}

\index{plot() (grids.sleve.SLEVE2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sleve.SLEVE2d.plot}}\pysiglinewithargsret{\sphinxbfcode{plot}}{\emph{**kwargs}}{}
Plot the grid half levels using \sphinxhref{https://matplotlib.org/2.1.1/api/\_as\_gen/matplotlib.pyplot.html\#module-matplotlib.pyplot}{\sphinxcode{matplotlib.pyplot}}’s utilities.
\begin{quote}\begin{description}
\item[{Keyword Arguments}] \leavevmode
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to be forwarded to \sphinxhref{https://matplotlib.org/2.1.1/api/\_as\_gen/matplotlib.pyplot.subplots.html\#matplotlib.pyplot.subplots}{\sphinxcode{matplotlib.pyplot.subplots()}}.

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
For the sake of compliancy with the notation employed by \sphinxhref{http://www.cosmo-model.org}{COSMO},
the vertical geometric height is denoted by \(z\).
\end{sphinxadmonition}

\end{fulllineitems}

\index{update\_topography() (grids.sleve.SLEVE2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sleve.SLEVE2d.update_topography}}\pysiglinewithargsret{\sphinxbfcode{update\_topography}}{\emph{time}}{}
Update the (time-dependent) topography. In turn, the metric terms are re-computed.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the elasped simulation time.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{Three-dimensional grids}
\label{\detokenize{api:three-dimensional-grids}}\index{GridXYZ (class in grids.grid\_xyz)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xyz.GridXYZ}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{grids.grid\_xyz.}\sphinxbfcode{GridXYZ}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_y}, \emph{ny}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='degrees\_east'}, \emph{dims\_x='longitude'}, \emph{units\_y='degrees\_north'}, \emph{dims\_y='latitude'}, \emph{units\_z='m'}, \emph{dims\_z='z'}, \emph{z\_interface=None}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Rectangular and regular three-dimensional grid embedded in a reference system whose coordinates are
\begin{itemize}
\item {} 
the first horizontal coordinate \(x\);

\item {} 
the second horizontal coordinate \(y\);

\item {} 
the vertical (terrain-following) coordinate \(z\).

\end{itemize}

The vertical coordinate \(z\) may be formulated to define a hybrid terrain-following coordinate system
with terrain-following coordinate lines between the surface terrain-height and \(z = z_F\), where
\(z\)-coordinate lines change back to flat horizontal lines. However, no assumption is made on the actual
nature of \(z\) which may be either pressure-based or height-based.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{xy\_grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxtitleref{\textasciitilde{}grids.grid\_xy.GridXY} representing the horizontal grid..

\item {} 
\sphinxstyleliteralstrong{z} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(z\)-main levels.

\item {} 
\sphinxstyleliteralstrong{z\_on\_interface\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(z\)-half levels.

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{dz} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(z\)-spacing.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} The interface coordinate \(z_F\).

\item {} 
{\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxstyleliteralstrong{topography}}}} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{Topography2d} representing the underlying topography.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
For the sake of compliancy with the \sphinxhref{http://cosmo-model.org}{COSMO model}, the vertical grid points are ordered
from the top of the domain to the surface.
\end{sphinxadmonition}
\index{\_\_init\_\_() (grids.grid\_xyz.GridXYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xyz.GridXYZ.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_y}, \emph{ny}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='degrees\_east'}, \emph{dims\_x='longitude'}, \emph{units\_y='degrees\_north'}, \emph{dims\_y='latitude'}, \emph{units\_z='m'}, \emph{dims\_z='z'}, \emph{z\_interface=None}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{domain\_x} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((x_{start}, ~ x_{stop})\).

\item {} 
\sphinxstyleliteralstrong{nx} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points in the \(x\)-direction.

\item {} 
\sphinxstyleliteralstrong{domain\_y} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((y_{start}, ~ y_{stop})\).

\item {} 
\sphinxstyleliteralstrong{ny} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points in the \(y\)-direction.

\item {} 
\sphinxstyleliteralstrong{domain\_z} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((z_{top}, ~ z_{surface})\).

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{units\_x} (\sphinxtitleref{str}, optional) \textendash{} 
Units for the \(x\)-coordinate. Must be compliant with the \sphinxhref{cfconventions.org}{CF Conventions}.


\item {} 
\sphinxstyleliteralstrong{dims\_x} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(x\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{units\_y} (\sphinxtitleref{str}, optional) \textendash{} 
Units for the \(y\)-coordinate. Must be compliant with the \sphinxhref{cfconventions.org}{CF Conventions}.


\item {} 
\sphinxstyleliteralstrong{dims\_y} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(y\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{units\_z} (\sphinxtitleref{str}, optional) \textendash{} 
Units for the \(z\)-coordinate. Must be compliant with the \sphinxhref{cfconventions.org}{CF Conventions}.


\item {} 
\sphinxstyleliteralstrong{dims\_z} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(z\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxtitleref{float}, optional) \textendash{} Interface value \(z_F\). If not specified, it is assumed that \(z_F = z_T\), with \(z_T\)
the value of \(z\) at the top of the domain. In other words, a fully terrain-following coordinate
system is supposed.

\item {} 
\sphinxstyleliteralstrong{topo\_type} (\sphinxtitleref{str}, optional) \textendash{} Topography type. Default is ‘flat\_terrain’. See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}} for further details.

\item {} 
\sphinxstyleliteralstrong{topo\_time} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{datetime.timedelta} representing the simulation time after which the topography should stop
increasing. Default is 0, corresponding to a time-invariant terrain surface-height. See
{\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}} for further details.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode
\sphinxstyleliteralstrong{kwargs} \textendash{} Keyword arguments to be forwarded to the constructor of {\hyperref[\detokenize{api:grids.topography.Topography2d}]{\sphinxcrossref{\sphinxcode{Topography2d}}}}.

\end{description}\end{quote}

\end{fulllineitems}

\index{dx (grids.grid\_xyz.GridXYZ attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xyz.GridXYZ.dx}}\pysigline{\sphinxbfcode{dx}}
Get the \(x\)-spacing.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
The \(x\)-spacing.

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{dy (grids.grid\_xyz.GridXYZ attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xyz.GridXYZ.dy}}\pysigline{\sphinxbfcode{dy}}
Get the \(y\)-spacing.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
The \(y\)-spacing.

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{nx (grids.grid\_xyz.GridXYZ attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xyz.GridXYZ.nx}}\pysigline{\sphinxbfcode{nx}}
Get the number of grid points in the \(x\)-direction.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
Number of grid points in the \(x\)-direction.

\item[{Return type}] \leavevmode
int

\end{description}\end{quote}

\end{fulllineitems}

\index{ny (grids.grid\_xyz.GridXYZ attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xyz.GridXYZ.ny}}\pysigline{\sphinxbfcode{ny}}
Get the number of grid points in the \(y\)-direction.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
Number of grid points in the \(y\)-direction.

\item[{Return type}] \leavevmode
int

\end{description}\end{quote}

\end{fulllineitems}

\index{topography\_height (grids.grid\_xyz.GridXYZ attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xyz.GridXYZ.topography_height}}\pysigline{\sphinxbfcode{topography\_height}}
Get the topography (i.e., terrain-surface) height.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the topography height.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{update\_topography() (grids.grid\_xyz.GridXYZ method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xyz.GridXYZ.update_topography}}\pysiglinewithargsret{\sphinxbfcode{update\_topography}}{\emph{time}}{}
Update the (time-dependent) topography.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the elapsed simulation time.

\end{description}\end{quote}

\end{fulllineitems}

\index{x (grids.grid\_xyz.GridXYZ attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xyz.GridXYZ.x}}\pysigline{\sphinxbfcode{x}}
Get the \(x\)-coordinates of the mass points.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
{\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} storing the \(x\)-coordinates of the mass points.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{x\_at\_u\_locations (grids.grid\_xyz.GridXYZ attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xyz.GridXYZ.x_at_u_locations}}\pysigline{\sphinxbfcode{x\_at\_u\_locations}}
Get the \(x\)-coordinates at the \(u\)-locations.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
{\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} storing the \(x\)-coordinates at the \(u\)-locations.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{y (grids.grid\_xyz.GridXYZ attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xyz.GridXYZ.y}}\pysigline{\sphinxbfcode{y}}
Get the \(y\)-coordinates of the mass points.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
{\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} storing the \(y\)-coordinates of the mass points.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{y\_at\_v\_locations (grids.grid\_xyz.GridXYZ attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.grid_xyz.GridXYZ.y_at_v_locations}}\pysigline{\sphinxbfcode{y\_at\_v\_locations}}
Get the \(y\)-coordinates at the \(v\)-locations.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
{\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} storing the \(y\)-coordinates at the \(v\)-locations.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{Sigma3d (class in grids.sigma)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sigma.Sigma3d}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{grids.sigma.}\sphinxbfcode{Sigma3d}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_y}, \emph{ny}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='degrees\_east'}, \emph{dims\_x='longitude'}, \emph{units\_y='degrees\_north'}, \emph{dims\_y='latitude'}, \emph{z\_interface=None}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
This class inherits {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} to represent a rectangular and regular computational grid
embedded in a three-dimensional terrain-following reference system, whose coordinates are:
\begin{itemize}
\item {} 
first horizontal coordinate \(x\), e.g., the longitude;

\item {} 
second horizontal coordinate \(y\), e.g., the latitude;

\item {} 
the pressure-based terrain-following coordinate \(\sigma = p / p_{SL}\),                  where \(p\) is the pressure and \(p_{SL}\) the pressure at the sea level.

\end{itemize}

The vertical coordinate \(\sigma\) may be formulated to define a hybrid terrain-following coordinate system
with terrain-following coordinate lines between the surface terrain-height and \(\sigma = \sigma_F\), where
\(\sigma\)-coordinate lines change back to flat horizontal lines.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{xy\_grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xy.GridXY}]{\sphinxcrossref{\sphinxcode{GridXY}}}} representing the horizontal grid.

\item {} 
\sphinxstyleliteralstrong{z} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(\sigma\)-main levels.

\item {} 
\sphinxstyleliteralstrong{z\_on\_interface\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(\sigma\)-half levels.

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{dz} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(\sigma\)-spacing.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} The interface coordinate \(\sigma_F\).

\item {} 
{\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxstyleliteralstrong{topography}}}} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{Topography2d} representing the underlying topography.

\item {} 
\sphinxstyleliteralstrong{height} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the geometric height of the main levels.

\item {} 
\sphinxstyleliteralstrong{height\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the geometric height of the half levels.

\item {} 
\sphinxstyleliteralstrong{height\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} Geometric height corresponding to \(\sigma = \sigma_F\).

\item {} 
\sphinxstyleliteralstrong{reference\_pressure} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} storing the reference pressure at the main levels.

\item {} 
\sphinxstyleliteralstrong{reference\_pressure\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} storing the reference pressure at the half levels.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (grids.sigma.Sigma3d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sigma.Sigma3d.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_y}, \emph{ny}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='degrees\_east'}, \emph{dims\_x='longitude'}, \emph{units\_y='degrees\_north'}, \emph{dims\_y='latitude'}, \emph{z\_interface=None}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{domain\_x} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((x_{left}, ~ x_{right})\).

\item {} 
\sphinxstyleliteralstrong{nx} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points in the \(x\)-direction.

\item {} 
\sphinxstyleliteralstrong{domain\_y} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((y_{left}, ~ y_{right})\).

\item {} 
\sphinxstyleliteralstrong{ny} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points in the \(y\)-direction.

\item {} 
\sphinxstyleliteralstrong{domain\_z} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((\sigma_{top}, ~ \sigma_{surface})\).

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{units\_x} (\sphinxtitleref{str}, optional) \textendash{} 
Units for the \(x\)-coordinate. Must be compliant with the \sphinxhref{http://cfconventions.org}{CF Conventions}
(see also {\hyperref[\detokenize{api:grids.axis.Axis.__init__}]{\sphinxcrossref{\sphinxcode{grids.axis.Axis.\_\_init\_\_()}}}}).


\item {} 
\sphinxstyleliteralstrong{dims\_x} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(x\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{units\_y} (\sphinxtitleref{str}, optional) \textendash{} 
Units for the \(y\)-coordinate. Must be compliant with the \sphinxhref{http://cfconventions.org}{CF Conventions}
(see also {\hyperref[\detokenize{api:grids.axis.Axis.__init__}]{\sphinxcrossref{\sphinxcode{grids.axis.Axis.\_\_init\_\_()}}}}).


\item {} 
\sphinxstyleliteralstrong{dims\_y} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(y\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxtitleref{float}, optional) \textendash{} Interface value \(\sigma_F\). If not specified, it is assumed that \(\sigma_F = \sigma_T\),
with \(\sigma_T\) the value of  \(\sigma\) at the top of the domain. In other words, a fully
terrain-following coordinate system is supposed.

\item {} 
\sphinxstyleliteralstrong{topo\_type} (\sphinxtitleref{str}, optional) \textendash{} Topography type. Default is ‘flat\_terrain’. See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}} for further details.

\item {} 
\sphinxstyleliteralstrong{topo\_time} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{datetime.timedelta} representing the simulation time after which the topography should stop
increasing. Default is 0, corresponding to a time-invariant terrain surface-height.
See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}} for further details.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to be forwarded to the constructor of {\hyperref[\detokenize{api:grids.topography.Topography2d}]{\sphinxcrossref{\sphinxcode{Topography2d}}}}.

\end{description}\end{quote}

\end{fulllineitems}

\index{\_update\_metric\_terms() (grids.sigma.Sigma3d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sigma.Sigma3d._update_metric_terms}}\pysiglinewithargsret{\sphinxbfcode{\_update\_metric\_terms}}{}{}
Update the class by computing the metric terms, i.e., the geometric height and the reference pressure,
at both half and main levels. In doing this, a logarithmic vertical profile of reference pressure is assumed.
This method should be called every time the topography is updated or changed.

\end{fulllineitems}

\index{update\_topography() (grids.sigma.Sigma3d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sigma.Sigma3d.update_topography}}\pysiglinewithargsret{\sphinxbfcode{update\_topography}}{\emph{time}}{}
Update the (time-dependent) topography. In turn, the metric terms are re-computed.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the elapsed simulation time.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{GalChen3d (class in grids.gal\_chen)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.gal_chen.GalChen3d}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{grids.gal\_chen.}\sphinxbfcode{GalChen3d}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_y}, \emph{ny}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='degrees\_east'}, \emph{dims\_x='longitude'}, \emph{units\_y='degrees\_north'}, \emph{dims\_y='latitude'}, \emph{z\_interface=None}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
This class inherits {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} to represent a rectangular and regular computational grid
embedded in a three-dimensional terrain-following reference system, whose coordinates are:
\begin{itemize}
\item {} 
first horizontal coordinate \(x\), e.g., the longitude;

\item {} 
second horizontal coordinate \(y\), e.g., the latitude;

\item {} 
the Gal-Chen terrain-following coordinate \(\mu\).

\end{itemize}

The vertical coordinate \(\mu\) may be formulated to define a hybrid terrain-following coordinate system
with terrain-following coordinate lines between the surface terrain-height and \(\mu = \mu_F\), where
\(\mu\)-coordinate lines change back to flat horizontal lines.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{xy\_grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xy.GridXY}]{\sphinxcrossref{\sphinxcode{GridXY}}}} representing the horizontal grid.

\item {} 
\sphinxstyleliteralstrong{z} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(z\)-main levels.

\item {} 
\sphinxstyleliteralstrong{z\_on\_interface\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(z\)-half levels.

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{dz} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(z\)-spacing.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} The interface coordinate \(z_F\).

\item {} 
{\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxstyleliteralstrong{topography}}}} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{Topography2d} representing the underlying topography.

\item {} 
\sphinxstyleliteralstrong{height} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the geometric height of the main levels.

\item {} 
\sphinxstyleliteralstrong{height\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the geometric height of the half levels.

\item {} 
\sphinxstyleliteralstrong{height\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} Geometric height corresponding to \(\mu = \mu_F\).

\item {} 
\sphinxstyleliteralstrong{reference\_pressure} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the reference pressure at the main levels.

\item {} 
\sphinxstyleliteralstrong{reference\_pressure\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the reference pressure at the half levels.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (grids.gal\_chen.GalChen3d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.gal_chen.GalChen3d.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_y}, \emph{ny}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='degrees\_east'}, \emph{dims\_x='longitude'}, \emph{units\_y='degrees\_north'}, \emph{dims\_y='latitude'}, \emph{z\_interface=None}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{domain\_x} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((x_{left}, ~ x_{right})\).

\item {} 
\sphinxstyleliteralstrong{nx} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points in the \(x\)-direction.

\item {} 
\sphinxstyleliteralstrong{domain\_y} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((y_{left}, ~ y_{right})\).

\item {} 
\sphinxstyleliteralstrong{ny} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points in the \(y\)-direction.

\item {} 
\sphinxstyleliteralstrong{domain\_z} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((\mu_{top}, ~ \mu_{surface})\).

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{units\_x} (\sphinxtitleref{str}, optional) \textendash{} 
Units for the \(x\)-coordinate. Must be compliant with the \sphinxhref{http://cfconventions.org}{CF Conventions}
(see also {\hyperref[\detokenize{api:grids.axis.Axis.__init__}]{\sphinxcrossref{\sphinxcode{grids.axis.Axis.\_\_init\_\_()}}}}).


\item {} 
\sphinxstyleliteralstrong{dims\_x} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(x\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{str}\sphinxstyleliteralstrong{, }\sphinxstyleliteralstrong{optional} (\sphinxstyleliteralemphasis{units\_y}) \textendash{} 
Units for the \(y\)-coordinate. Must be compliant with the \sphinxhref{http://cfconventions.org}{CF Conventions}
(see also {\hyperref[\detokenize{api:grids.axis.Axis.__init__}]{\sphinxcrossref{\sphinxcode{grids.axis.Axis.\_\_init\_\_()}}}}).


\item {} 
\sphinxstyleliteralstrong{dims\_y} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(y\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxtitleref{float}, optional) \textendash{} Interface value \(zmu_F = \mu_F\). If not specified, it is assumed that \(\mu_F = \mu_T\), with
\(\mu_T\) the value of \(\mu\) at the top of the domain. In other words, a fully terrain-following
coordinate nsystem is supposed.

\item {} 
\sphinxstyleliteralstrong{topo\_type} (\sphinxtitleref{str}, optional) \textendash{} Topography type. Default is ‘flat\_terrain’. See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}} for further details.

\item {} 
\sphinxstyleliteralstrong{topo\_time} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{datetime.timedelta} representing the simulation time after which the topography should stop increasing.
Default is 0, corresponding to a time-invariant terrain surface-height. See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}} for further
details.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to be forwarded to the constructor of {\hyperref[\detokenize{api:grids.topography.Topography2d}]{\sphinxcrossref{\sphinxcode{Topography2d}}}}.

\end{description}\end{quote}

\end{fulllineitems}

\index{\_update\_metric\_terms() (grids.gal\_chen.GalChen3d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.gal_chen.GalChen3d._update_metric_terms}}\pysiglinewithargsret{\sphinxbfcode{\_update\_metric\_terms}}{}{}
Update the class by computing the metric terms, i.e., the geometric height and the reference pressure,
at both half and main levels. In doing this, a logarithmic vertical profile of reference pressure is assumed.
This method should be called every time the topography is updated or changed.

\end{fulllineitems}

\index{update\_topography() (grids.gal\_chen.GalChen3d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.gal_chen.GalChen3d.update_topography}}\pysiglinewithargsret{\sphinxbfcode{update\_topography}}{\emph{time}}{}
Update the (time-dependent) topography. In turn, the metric terms are re-computed.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the elapsed simulation time.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{SLEVE3d (class in grids.sleve)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sleve.SLEVE3d}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{grids.sleve.}\sphinxbfcode{SLEVE3d}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_y}, \emph{ny}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='degrees\_east'}, \emph{dims\_x='longitude'}, \emph{units\_y='degrees\_north'}, \emph{dims\_y='latitude'}, \emph{z\_interface=None}, \emph{N=100}, \emph{s1=8000.0}, \emph{s2=5000.0}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
This class inherits {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} to represent a rectangular and regular computational grid
embedded in a three-dimensional terrain-following reference system, whose coordinates are:
\begin{itemize}
\item {} 
first horizontal coordinate \(x\), e.g., the longitude;

\item {} 
second horizontal coordinate \(y\), e.g., the latitude;

\item {} 
the SLEVE terrain-following coordinate \(\mu\).

\end{itemize}

The vertical coordinate \(\mu\) may be formulated to define a hybrid terrain-following coordinate system
with terrain-following coordinate lines between the surface terrain-height and \(\mu = \mu_F\), where
\(\mu\)-coordinate lines change back to flat horizontal lines.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{xy\_grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xy.GridXY}]{\sphinxcrossref{\sphinxcode{GridXY}}}} representing the horizontal grid.

\item {} 
\sphinxstyleliteralstrong{z} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(z\)-main levels.

\item {} 
\sphinxstyleliteralstrong{z\_on\_interface\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the \(z\)-half levels.

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{dz} (\sphinxstyleliteralemphasis{float}) \textendash{} The \(z\)-spacing.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} The interface coordinate \(z_F\).

\item {} 
{\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxstyleliteralstrong{topography}}}} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{Topography2d} representing the underlying topography.

\item {} 
\sphinxstyleliteralstrong{height} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the geometric height of the main levels.

\item {} 
\sphinxstyleliteralstrong{height\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the geometric height of the half levels.

\item {} 
\sphinxstyleliteralstrong{height\_interface} (\sphinxstyleliteralemphasis{float}) \textendash{} Geometric height corresponding to \(\mu = \mu_F\).

\item {} 
\sphinxstyleliteralstrong{reference\_pressure} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the reference pressure at the main levels.

\item {} 
\sphinxstyleliteralstrong{reference\_pressure\_half\_levels} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the reference pressure at the half levels.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (grids.sleve.SLEVE3d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sleve.SLEVE3d.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{domain\_x}, \emph{nx}, \emph{domain\_y}, \emph{ny}, \emph{domain\_z}, \emph{nz}, \emph{units\_x='degrees\_east'}, \emph{dims\_x='longitude'}, \emph{units\_y='degrees\_north'}, \emph{dims\_y='latitude'}, \emph{z\_interface=None}, \emph{N=100}, \emph{s1=8000.0}, \emph{s2=5000.0}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{domain\_x} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((x_{left}, ~ x_{right})\).

\item {} 
\sphinxstyleliteralstrong{nx} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points in the \(x\)-direction.

\item {} 
\sphinxstyleliteralstrong{domain\_y} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((y_{left}, ~ y_{right})\).

\item {} 
\sphinxstyleliteralstrong{ny} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of grid points in the \(y\)-direction.

\item {} 
\sphinxstyleliteralstrong{domain\_z} (\sphinxstyleliteralemphasis{tuple}) \textendash{} Tuple in the form \((\mu_{top}, ~ \mu_{surface})\).

\item {} 
\sphinxstyleliteralstrong{nz} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of vertical main levels.

\item {} 
\sphinxstyleliteralstrong{units\_x} (\sphinxtitleref{str}, optional) \textendash{} 
Units for the \(x\)-coordinate. Must be compliant with the \sphinxhref{http://cfconventions.org}{CF Conventions}
(see also {\hyperref[\detokenize{api:grids.axis.Axis.__init__}]{\sphinxcrossref{\sphinxcode{grids.axis.Axis.\_\_init\_\_()}}}}).


\item {} 
\sphinxstyleliteralstrong{dims\_x} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(x\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{units\_y} (\sphinxtitleref{str}, optional) \textendash{} 
Units for the \(y\)-coordinate. Must be compliant with the \sphinxhref{http://cfconventions.org}{CF Conventions}
(see also {\hyperref[\detokenize{api:grids.axis.Axis.__init__}]{\sphinxcrossref{\sphinxcode{grids.axis.Axis.\_\_init\_\_()}}}}).


\item {} 
\sphinxstyleliteralstrong{dims\_y} (\sphinxtitleref{str}, optional) \textendash{} Label for the \(y\)-coordinate.

\item {} 
\sphinxstyleliteralstrong{z\_interface} (\sphinxtitleref{float}, optional) \textendash{} Interface value \(zmu_F = \mu_F\). If not specified, it is assumed that \(\mu_F = \mu_T\), with
\(\mu_T\) the value of \(\mu\) at the top of the domain. In other words, a fully terrain-following
coordinate nsystem is supposed.

\item {} 
\sphinxstyleliteralstrong{N} (\sphinxtitleref{int}, optional) \textendash{} Number of filter iterations performed to determine the large-scale component of the surface terrain-height.
Defaults to 100.

\item {} 
\sphinxstyleliteralstrong{s1} (\sphinxtitleref{float}, optional) \textendash{} Large-scale decay constant. Defaults to \(8000 ~ m\).

\item {} 
\sphinxstyleliteralstrong{s2} (\sphinxtitleref{float}, optional) \textendash{} Small-scale decay constant. Defaults to \(5000 ~ m\).

\item {} 
\sphinxstyleliteralstrong{topo\_type} (\sphinxtitleref{str}, optional) \textendash{} Topography type. Defaults to ‘flat\_terrain’. See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}} for further details.

\item {} 
\sphinxstyleliteralstrong{topo\_time} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{datetime.timedelta} representing the simulation time after which the topography should stop
increasing. Default is 0, corresponding to a time-invariant terrain surface-height. See {\hyperref[\detokenize{api:module-grids.topography}]{\sphinxcrossref{\sphinxcode{grids.topography}}}}
for further details.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to be forwarded to the constructor of {\hyperref[\detokenize{api:grids.topography.Topography2d}]{\sphinxcrossref{\sphinxcode{Topography2d}}}}.

\end{description}\end{quote}

\end{fulllineitems}

\index{\_update\_metric\_terms() (grids.sleve.SLEVE3d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sleve.SLEVE3d._update_metric_terms}}\pysiglinewithargsret{\sphinxbfcode{\_update\_metric\_terms}}{}{}
Update the class by computing the metric terms, i.e., the geometric height and the reference pressure,
at both half and main levels. In doing this, a logarithmic vertical profile of reference pressure is assumed.
This method should be called every time the topography is updated or changed.

\end{fulllineitems}

\index{update\_topography() (grids.sleve.SLEVE3d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.sleve.SLEVE3d.update_topography}}\pysiglinewithargsret{\sphinxbfcode{update\_topography}}{\emph{time}}{}
Update the (time-dependent) topography. In turn, the metric terms are re-computed.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the elapsed simulation time.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\section{Model}
\label{\detokenize{api:model}}\index{Model (class in model)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:model.Model}}\pysigline{\sphinxbfcode{class }\sphinxcode{model.}\sphinxbfcode{Model}}
This class is intended to represent and run a generic climate or meteorological numerical model.
A model is made up of:
\begin{itemize}
\item {} 
a dynamical core (mandatory);

\item {} 
a set of parameterizations providing \sphinxstyleemphasis{slow-varying tendencies}, i.e., physical parameterization                       schemes which, within a timestep, are evaluated \sphinxstyleemphasis{before} the dynamical core; they are intended                  to supply the dynamical core with physical tendencies;

\item {} 
a set of parameterizations providing \sphinxstyleemphasis{fast-varying tendencies}, i.e., physical parameterization                       schemes which, within a timestep, are evaluated \sphinxstyleemphasis{within} the dynamical core; they are intended                  to supply the dynamical core with physical tendencies;

\item {} 
a set of \sphinxstyleemphasis{adjustment-performing} parameterizations, i.e., physical parametrization schemes which,                             within a timestep, are performed \sphinxstyleemphasis{after} the dynamical core; they are intended to perform physical                      adjustements on the state variables and possibly provide some diagnostics.

\end{itemize}
\index{\_\_call\_\_() (model.Model method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:model.Model.__call__}}\pysiglinewithargsret{\sphinxbfcode{\_\_call\_\_}}{\emph{dt}, \emph{simulation\_time}, \emph{state}, \emph{save\_iterations={[}{]}}}{}
Call operator integrating the model forward in time.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item {} 
\sphinxstyleliteralstrong{simulation\_time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the simulation time.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} The initial state, as an instance of {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{save\_freq} (\sphinxtitleref{tuple}, optional) \textendash{} The iterations at which the state should be saved. Default is empty, meaning that only the initial and
final states are saved.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{state\_out} (\sphinxstyleemphasis{obj}) \textendash{} The final state, of the same class of \sphinxcode{state}.

\item {} 
\sphinxstylestrong{state\_save} (\sphinxstyleemphasis{obj}) \textendash{} The sequence of saved states, of the same class of \sphinxcode{state}.

\item {} 
\sphinxstylestrong{diagnostics\_save} (\sphinxstyleemphasis{obj})

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_init\_\_() (model.Model method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:model.Model.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{}{}
Default constructor.

\end{fulllineitems}

\index{add\_adjustment\_parameterization() (model.Model method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:model.Model.add_adjustment_parameterization}}\pysiglinewithargsret{\sphinxbfcode{add\_adjustment\_parameterization}}{\emph{adjustment}}{}
Add an \sphinxstyleemphasis{adjustment-performing} parameterization to the model.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{adjustment} (\sphinxstyleliteralemphasis{obj}) \textendash{} Instance of a derived class of \sphinxcode{Adjustment}
representing an adjustment-performing parameterization.

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
In a simulation, adjustment-performing parameterizations will be executed in the same order
they have been added to the model.
\end{sphinxadmonition}

\end{fulllineitems}

\index{add\_fast\_tendency\_parameterization() (model.Model method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:model.Model.add_fast_tendency_parameterization}}\pysiglinewithargsret{\sphinxbfcode{add\_fast\_tendency\_parameterization}}{\emph{tendency}}{}
Add to the model a parameterization providing fast-varying tendencies.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{tendency} (\sphinxstyleliteralemphasis{obj}) \textendash{} Instance of a derived class of \sphinxcode{FastTendency}
representing a parameterization providing fast-varying tendencies.

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
In a simulation, parameterizations calculating fast-varying tendencies will be executed in the same
order they have been added to the model.
\end{sphinxadmonition}

\end{fulllineitems}

\index{add\_slow\_tendency\_parameterization() (model.Model method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:model.Model.add_slow_tendency_parameterization}}\pysiglinewithargsret{\sphinxbfcode{add\_slow\_tendency\_parameterization}}{\emph{tendency}}{}
Add to the model a parameterization providing slow-varying tendencies.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{tendency} (\sphinxstyleliteralemphasis{obj}) \textendash{} Instance of a derived class of \sphinxcode{SlowTendency}
representing a parameterization providing slow-varying tendencies.

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
In a simulation, parameterizations calculating slow-varying tendencies will be executed in the same
order they have been added to the model.
\end{sphinxadmonition}

\end{fulllineitems}

\index{set\_dynamical\_core() (model.Model method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:model.Model.set_dynamical_core}}\pysiglinewithargsret{\sphinxbfcode{set\_dynamical\_core}}{\emph{dycore}}{}
Set the dynamical core.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{dycore} (\sphinxstyleliteralemphasis{obj}) \textendash{} Instance of a derived class of \sphinxcode{DynamicalCore}
representing the dynamical core.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\section{Namelist}
\label{\detokenize{api:module-namelist}}\label{\detokenize{api:namelist}}\index{namelist (module)}
Configuration and global variables used throughout the package.
\begin{description}
\item[{Physical constants:}] \leavevmode\begin{itemize}
\item {} 
\sphinxcode{namelist.p\_ref}: Reference pressure ({[}\(Pa\){]}).

\item {} 
\sphinxcode{namelist.p\_sl}: Reference pressure at sea level ({[}\(Pa\){]}).

\item {} 
\sphinxcode{namelist.T\_sl}: Reference temperature at sea level ({[}\(K\){]}).

\item {} 
\sphinxcode{namelist.beta}: Rate of increase in reference temperature with the logarithm           of reference pressure ({[}\(K ~ Pa^{-1}\){]}).

\item {} 
\sphinxcode{namelist.Rd}: Gas constant for dry air ({[}\(J ~ K^{-1} ~ Kg^{-1}\){]}).

\item {} 
\sphinxcode{namelist.Rv}: Gas constant for water vapor ({[}\(J ~ K^{-1} ~ Kg^{-1}\){]}).

\item {} 
\sphinxcode{namelist.cp}: Specific heat of dry air at constant pressure ({[}\(J ~ K^{-1} ~ Kg^{-1}\){]}).

\item {} 
\sphinxcode{namelist.g}: Mean gravitational acceleration ({[}\(m ~ s^{-2}\){]}).

\item {} 
\sphinxcode{namelist.L}: Specific latent heat of condensation of water ({[}\(J ~ kg^{-1}\){]}).

\item {} 
\sphinxcode{namelist.rho\_water}: Water density ({[}\(kg ~ m^{-3}\){]}).

\end{itemize}

\item[{Grid settings:}] \leavevmode\begin{itemize}
\item {} 
\sphinxcode{namelist.domain\_x}: Tuple storing the boundaries of the domain in the          \(x\)-direction in the form (\(x_{west}\), \(x_{east}\)).

\item {} 
\sphinxcode{namelist.nx}: Number of grid points in the \(x\)-direction.

\item {} 
\sphinxcode{namelist.domain\_y}: Tuple storing the boundaries of the domain in the          \(y\)-direction in the form (\(y_{south}\), \(y_{north}\)).

\item {} 
\sphinxcode{namelist.ny}: Number of grid points in the \(y\)-direction.

\item {} 
\sphinxcode{namelist.domain\_z}: Tuple storing the boundaries of the domain in the          \(z\)-direction in the form (\(z_{top}\), \(z_{bottom}\)).

\item {} 
\sphinxcode{namelist.nz}: Number of grid points in the \(z\)-direction.

\item {} 
\sphinxcode{namelist.z\_interface}: For a hybrid coordinate system, interface level                 at which terrain-following \(z\)-coordinate lines get back to horizontal lines.

\item {} 
\sphinxcode{namelist.topo\_type}: Topography type. Available options are:
\begin{itemize}
\item {} 
‘flat\_terrain’;

\item {} 
‘gaussian’;

\item {} 
‘schaer’;

\item {} 
‘user\_defined’.

\end{itemize}

\item {} 
\sphinxcode{namelist.topo\_time}: \sphinxcode{datetime.timedelta} object representing the elapsed               simulation time after which the topography should stop increasing.

\item {} 
\sphinxcode{namelist.topo\_max\_height}: When \sphinxcode{topo\_type} is ‘gaussian’,             maximum mountain height ({[}\(m\){]}).

\item {} 
\sphinxcode{namelist.topo\_width\_x}: When \sphinxcode{topo\_type} is ‘gaussian’, mountain               half-width in \(x\)-direction ({[}\(m\){]}).

\item {} 
\sphinxcode{namelist.topo\_width\_y}: When \sphinxcode{topo\_type} is ‘gaussian’, mountain               half-width in \(y\)-direction ({[}\(m\){]}).

\item {} 
\sphinxcode{namelist.topo\_str}: When \sphinxcode{topo\_type} is ‘user\_defined’, terrain profile                expression in the independent variables \(x\) and \(y\). Must be fully C++-compliant.

\item {} 
\sphinxcode{namelist.topo\_smooth}: \sphinxcode{True} to smooth the topography out, \sphinxcode{False} otherwise.

\item {} 
\sphinxcode{namelist.topo\_kwargs}: Dictionary storing \sphinxcode{topo\_max\_height},           \sphinxcode{topo\_width\_x}, \sphinxcode{topo\_width\_y}, \sphinxcode{topo\_str},             and \sphinxcode{topo\_smooth}.

\end{itemize}

\item[{Model settings:}] \leavevmode\begin{itemize}
\item {} 
\sphinxcode{namelist.model\_name}: Name of the model to implement. Available options are:
\begin{itemize}
\item {} 
‘isentropic\_conservative’, for the isentropic model based on the conservative form                            of the governing equations;

\item {} 
‘isentropic\_nonconservative’, for the isentropic model based on the nonconservative form                              of the governing equations.

\end{itemize}

\item {} 
\sphinxcode{namelist.moist\_on}: \sphinxcode{True} if water constituents should be taken into account,           \sphinxcode{False} otherwise.

\item {} 
\sphinxcode{namelist.horizontal\_boundary\_type}: Horizontal boundary conditions. Available options are:
\begin{itemize}
\item {} 
‘periodic’, for periodic boundary conditions;

\item {} 
‘relaxed’, for relaxed boundary conditions.

\end{itemize}

\end{itemize}

\item[{Numerical settings:}] \leavevmode\begin{itemize}
\item {} 
\sphinxcode{namelist.time\_scheme}: Time integration scheme to implement. Available options are:
\begin{itemize}
\item {} 
‘forward\_euler’, for the forward Euler scheme (‘isentropic\_conservative’);

\item {} 
‘centered’, for a centered time-integration scheme (‘isentropic\_conservative’, ‘isentropic\_nonconservative’).

\end{itemize}

\item {} 
\sphinxcode{namelist.flux\_scheme}: Numerical flux to use. Available options are:
\begin{itemize}
\item {} 
‘upwind’, for the upwind scheme (‘isentropic\_conservative’);

\item {} 
‘centered’, for a second-order centered scheme (‘isentropic\_conservative’, ‘isentropic\_nonconservative’);

\item {} 
‘maccormack’, for the MacCormack scheme (‘isentropic\_conservative’).

\end{itemize}

\item {} \begin{description}
\item[{\sphinxcode{namelist.damp\_on}: \sphinxcode{True} if (explicit) vertical damping should be applied,}] \leavevmode
\sphinxcode{False} otherwise. Note that when vertical damping is switched off, the numerical diffusion               coefficient is monotonically increased towards the top of the model, so to act as a diffusive wave absorber.

\end{description}

\item {} 
\sphinxcode{namelist.damp\_type}: Type of vertical damping to apply. Available options are:
\begin{itemize}
\item {} 
‘rayleigh’, for Rayleigh vertical damping.

\end{itemize}

\item {} 
\sphinxcode{namelist.damp\_depth}: Number of levels (either main levels or half levels) in the absorbing region.

\item {} 
\sphinxcode{namelist.damp\_max}: Maximum value which should be assumed by the damping coefficient.

\item {} 
\sphinxcode{namelist.smooth\_on}: \sphinxcode{True} to enable numerical horizontal smoothing, \sphinxcode{False} otherwise.

\item {} 
\sphinxcode{namelist.smooth\_type}: Type of smoothing technique to implement. Available options are:
\begin{itemize}
\item {} 
‘first\_order’, for first-order smoothing;

\item {} 
‘second\_order’, for second-order smoothing.

\end{itemize}

\item {} 
\sphinxcode{namelist.smooth\_depth}: Number of levels (either main levels or half levels)           in the smoothing absorbing region.

\item {} 
\sphinxcode{namelist.smooth\_coeff}: The smoothing coefficient.

\item {} 
\sphinxcode{namelist.smooth\_coeff\_max}: Maximum value for the smoothing coefficient when           smoothing vertical damping is enabled.

\item {} 
\sphinxcode{namelist.smooth\_moist\_on}: \sphinxcode{True} to enable numerical horizontal smoothing               on the moisture constituents, \sphinxcode{False} otherwise.

\item {} 
\sphinxcode{namelist.smooth\_moist\_type}: Type of smoothing technique to apply on the moisture              constituents. Available options are:
\begin{itemize}
\item {} 
‘first\_order’, for first-order smoothing;

\item {} 
‘second\_order’, for second-order smoothing.

\end{itemize}

\item {} 
\sphinxcode{namelist.smooth\_moist\_depth}: Number of levels (either main levels or half levels)             in the smoothing absorbing region for the moisture constituents.

\item {} 
\sphinxcode{namelist.smooth\_coeff\_moist}: The smoothing coefficient for the moisture components.

\item {} 
\sphinxcode{namelist.smooth\_coeff\_moist\_max}: Maximum value for the smoothing coefficient for              the moisture components when smoothing vertical damping is enabled.

\end{itemize}

\item[{Microphysics settings:}] \leavevmode\begin{itemize}
\item {} 
\sphinxcode{namelist.physics\_dynamics\_coupling\_on}: \sphinxcode{True} to couple physics with dynamics,           i.e., to take the change over time in potential temperature into account, \sphinxcode{False} otherwise.

\item {} 
\sphinxcode{namelist.sedimentation\_on}: \sphinxcode{True} to account for rain sedimentation, \sphinxcode{False} otherwise.

\item {} 
\sphinxcode{namelist.sedimentation\_flux\_type}: String specifying the method used to compute the numerical          sedimentation flux. Available options are:
\begin{itemize}
\item {} 
‘first\_order\_upwind’, for the first-order upwind scheme;

\item {} 
‘second\_order\_upwind’, for the second-order upwind scheme.

\end{itemize}

\item {} 
\sphinxcode{namelist.sedimentation\_substeps}: If rain sedimentation is switched on, number of sub-timesteps                to perform in order to integrate the sedimentation flux.

\item {} 
\sphinxcode{namelist.rain\_evaporation\_on}: \sphinxcode{True} to account for rain evaporation, \sphinxcode{False} otherwise.

\item {} 
\sphinxcode{namelist.slow\_tendency\_microphysics\_on}: \sphinxcode{True} to include a parameterization scheme              providing slow-varying cloud microphysical tendencies, \sphinxcode{False} otherwise.

\item {} 
\sphinxcode{namelist.slow\_tendency\_microphysics\_type}: The name of the parameterization scheme in charge of                providing slow-varying cloud microphysical tendencies. Available options are:
\begin{itemize}
\item {} 
‘kessler\_wrf’, for the WRF version of the Kessler scheme.

\end{itemize}

\item {} 
\sphinxcode{namelist.slow\_tendency\_microphysics\_kwargs}: Keyword arguments for the parameterization scheme                 in charge of providing slow-varying cloud microphysical tendencies. Please see          \sphinxcode{slow\_tendencies} for many more details.

\item {} 
\sphinxcode{namelist.fast\_tendency\_microphysics\_on}: \sphinxcode{True} to include a parameterization scheme              providing fast-varying cloud microphysical tendencies, \sphinxcode{False} otherwise.

\item {} 
\sphinxcode{namelist.fast\_tendency\_microphysics\_type}: The name of the parameterization scheme in charge of                providing fast-varying cloud microphysical tendencies. Available options are:
\begin{itemize}
\item {} 
‘kessler\_wrf’, for the WRF version of the Kessler scheme.

\end{itemize}

\item {} 
\sphinxcode{namelist.fast\_tendency\_microphysics\_kwargs}: Keyword arguments for the parameterization scheme                 in charge of providing fast-varying cloud microphysical tendencies. Please see          \sphinxcode{fast\_tendencies} for many more details.

\item {} 
\sphinxcode{namelist.adjustment\_microphysics\_on}: \sphinxcode{True} to include a parameterization scheme                 performing cloud microphysical adjustments, \sphinxcode{False} otherwise.

\item {} 
\sphinxcode{namelist.adjustment\_microphysics\_type}: The name of the parameterization scheme in charge              of performing cloud microphysical adjustments. Available options are:
\begin{itemize}
\item {} 
‘kessler\_wrf’, for the WRF version of the Kessler scheme;

\item {} 
‘kessler\_wrf\_saturation’, for the WRF version of the Kessler scheme,                          carrying out only the saturation adjustment.

\end{itemize}

\item {} 
\sphinxcode{namelist.adjustment\_microphysics\_kwargs}: Keyword arguments for the parameterization scheme            in charge of performing cloud microphysical adjustments. Please see             \sphinxcode{adjustments} for many more details.

\end{itemize}

\item[{Simulation settings:}] \leavevmode\begin{itemize}
\item {} 
\sphinxcode{namelist.dt}: \sphinxcode{datetime.timedelta} object representing the timestep.

\item {} 
\sphinxcode{namelist.initial\_time}: \sphinxcode{datetime.datetime} representing the initial simulation time.

\item {} 
\sphinxcode{namelist.simulation\_time}: \sphinxcode{datetime.timedelta} object representing the simulation time.

\item {} 
\sphinxcode{namelist.initial\_state\_type}: Integer identifying the initial state. See the documentation for the method              \sphinxcode{get\_initial\_state()} of               \sphinxcode{DycoreIsentropic}.

\item {} 
\sphinxcode{namelist.x\_velocity\_initial}: The initial, uniform \(x\)-velocity ({[}\(m s^{-1}\){]}).

\item {} 
\sphinxcode{namelist.y\_velocity\_initial}: The initial, uniform \(y\)-velocity ({[}\(m s^{-1}\){]}).

\item {} 
\sphinxcode{namelist.brunt\_vaisala\_initial}: The initial, uniform Brunt-Vaisala frequency.

\item {} 
\sphinxcode{namelist.temperature\_initial}: The initial, uniform temperature ({[}\(K\){]}).

\item {} 
\sphinxcode{namelist.initial\_state\_kwargs}: Dictionary storing \sphinxcode{x\_velocity\_initial},               \sphinxcode{y\_velocity\_initial}, \sphinxcode{brunt\_vaisala\_initial},          and \sphinxcode{temperature\_initial}.

\item {} 
\sphinxcode{namelist.backend}: GT4Py backend to use. Available options are:
\begin{itemize}
\item {} 
\sphinxcode{gridtools.mode.NUMPY}: Numpy (i.e., vectorized) backend.

\end{itemize}

\item {} 
\sphinxcode{namelist.save\_iterations}: List of the iterations at which the state should be saved.

\item {} 
\sphinxcode{namelist.save\_dest}: Path to the location where results should be saved.

\item {} 
\sphinxcode{namelist.tol}: Tolerance used to compare floats (see \sphinxcode{utils}).

\item {} 
\sphinxcode{namelist.datatype}: Datatype for \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}}. Either \sphinxcode{np.float32} or \sphinxcode{np.float64}.

\end{itemize}

\end{description}


\section{Parameterizations}
\label{\detokenize{api:parameterizations}}\index{Adjustment (class in parameterizations.adjustments)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustments.Adjustment}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{parameterizations.adjustments.}\sphinxbfcode{Adjustment}}{\emph{grid}}{}
Abstract base class whose derived classes implement different physical adjustment schemes.
The hierarchy lays on top of \sphinxcode{sympl.Implicit}.

\begin{sphinxadmonition}{note}{Note:}
All the derived classes should be model-agnostic.
\end{sphinxadmonition}
\index{\_\_call\_\_() (parameterizations.adjustments.Adjustment method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustments.Adjustment.__call__}}\pysiglinewithargsret{\sphinxbfcode{\_\_call\_\_}}{\emph{state}, \emph{dt}}{}
Entry-point method applying the parameterization scheme.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes representing the current state.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the timestep.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{diagnostics} (\sphinxstyleemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing possible output diagnostics.

\item {} 
\sphinxstylestrong{state\_new} (\sphinxstyleemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing the output, adjusted state.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_init\_\_() (parameterizations.adjustments.Adjustment method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustments.Adjustment.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\end{description}\end{quote}

\end{fulllineitems}

\index{time\_levels (parameterizations.adjustments.Adjustment attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustments.Adjustment.time_levels}}\pysigline{\sphinxbfcode{time\_levels}}
Get the attribute representing the number of time levels the dynamical core relies on.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
The number of time levels the dynamical core relies on.

\item[{Return type}] \leavevmode
int

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{SlowTendency (class in parameterizations.slow\_tendencies)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.slow_tendencies.SlowTendency}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{parameterizations.slow\_tendencies.}\sphinxbfcode{SlowTendency}}{\emph{grid}}{}
Abstract base class whose derived classes implement different parameterization schemes
providing slow-varying tendencies. Here, \sphinxstyleemphasis{slow-varying} refers to those tendencies which
should be calculated on the largest model timestep. Hence, these classes should be ideally
called \sphinxstyleemphasis{outside} the dynamical core.

\begin{sphinxadmonition}{note}{Note:}
All the derived classes should be model-agnostic.
\end{sphinxadmonition}
\index{\_\_call\_\_() (parameterizations.slow\_tendencies.SlowTendency method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.slow_tendencies.SlowTendency.__call__}}\pysiglinewithargsret{\sphinxbfcode{\_\_call\_\_}}{\emph{state}, \emph{dt}}{}
Entry-point method applying the parameterization scheme.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{GridData} or one of its derived classes representing the current state.

\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the timestep.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{tendencies} (\sphinxstyleemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing the calculated tendencies.

\item {} 
\sphinxstylestrong{diagnostics} (\sphinxstyleemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing possible output diagnostics.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_init\_\_() (parameterizations.slow\_tendencies.SlowTendency method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.slow_tendencies.SlowTendency.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\end{description}\end{quote}

\end{fulllineitems}

\index{time\_levels (parameterizations.slow\_tendencies.SlowTendency attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.slow_tendencies.SlowTendency.time_levels}}\pysigline{\sphinxbfcode{time\_levels}}
Get the attribute representing the number of time levels the dynamical core relies on.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
The number of time levels the dynamical core relies on.

\item[{Return type}] \leavevmode
int

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{FastTendency (class in parameterizations.fast\_tendencies)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.fast_tendencies.FastTendency}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{parameterizations.fast\_tendencies.}\sphinxbfcode{FastTendency}}{\emph{grid}}{}
Abstract base class whose derived classes implement different parameterization schemes
providing fast-varying tendencies. Here, \sphinxstyleemphasis{fast-varying} refers to those tendencies which
should be calculated on the smallest model timestep. Hence, these classes should be ideally
called \sphinxstyleemphasis{within} the dynamical core.

\begin{sphinxadmonition}{note}{Note:}
All the derived classes should be model-agnostic.
\end{sphinxadmonition}
\index{\_\_call\_\_() (parameterizations.fast\_tendencies.FastTendency method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.fast_tendencies.FastTendency.__call__}}\pysiglinewithargsret{\sphinxbfcode{\_\_call\_\_}}{\emph{dt}, \emph{state}}{}
Entry-point method applying the parameterization scheme.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the timestep.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes representing the current state.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{tendencies} (\sphinxstyleemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing the output tendencies.

\item {} 
\sphinxstylestrong{diagnostics} (\sphinxstyleemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} storing possible output diagnostics.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_init\_\_() (parameterizations.fast\_tendencies.FastTendency method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.fast_tendencies.FastTendency.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\end{description}\end{quote}

\end{fulllineitems}

\index{time\_levels (parameterizations.fast\_tendencies.FastTendency attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.fast_tendencies.FastTendency.time_levels}}\pysigline{\sphinxbfcode{time\_levels}}
Get the attribute representing the number of time levels the dynamical core relies on.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
The number of time levels the dynamical core relies on.

\item[{Return type}] \leavevmode
int

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{Microphysics}
\label{\detokenize{api:microphysics}}\index{AdjustmentMicrophysics (class in parameterizations.adjustments)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustments.AdjustmentMicrophysics}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{parameterizations.adjustments.}\sphinxbfcode{AdjustmentMicrophysics}}{\emph{grid}, \emph{rain\_evaporation\_on}, \emph{backend}}{}
Abstract base class whose derived classes implement different parameterization schemes carrying out
microphysical adjustments. The model variables which get adjusted are:
\begin{itemize}
\item {} 
the mass fraction of water vapor;

\item {} 
the mass fraction of cloud liquid water;

\item {} 
the mass fraction of precipitation water.

\end{itemize}

The derived classes also compute the following diagnostics:
\begin{itemize}
\item {} 
the raindrop fall speed ({[}\(m \, s^{-1}\){]}).

\end{itemize}
\index{\_\_init\_\_() (parameterizations.adjustments.AdjustmentMicrophysics method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustments.AdjustmentMicrophysics.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{rain\_evaporation\_on}, \emph{backend}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{rain\_evaporation\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the evaporation of raindrops should be taken into account, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py stencils.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{factory() (parameterizations.adjustments.AdjustmentMicrophysics static method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustments.AdjustmentMicrophysics.factory}}\pysiglinewithargsret{\sphinxbfcode{static }\sphinxbfcode{factory}}{\emph{micro\_scheme}, \emph{grid}, \emph{rain\_evaporation\_on}, \emph{backend}, \emph{**kwargs}}{}
Static method returning an instance of the derived class implementing the microphysics scheme
specified by \sphinxcode{micro\_scheme}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{micro\_scheme} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the microphysics parameterization scheme to implement. Either:
\begin{itemize}
\item {} 
’kessler\_wrf’, for the WRF version of the Kessler scheme;

\item {} \begin{description}
\item[{’kessler\_wrf\_saturation’, for the WRF version of the Kessler scheme, performing only}] \leavevmode
the saturation adjustment.

\end{description}

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{rain\_evaporation\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the evaporation of raindrops should be taken into account, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py stencils.

\item {} 
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to be forwarded to the derived class.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_raindrop\_fall\_velocity() (parameterizations.adjustments.AdjustmentMicrophysics method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustments.AdjustmentMicrophysics.get_raindrop_fall_velocity}}\pysiglinewithargsret{\sphinxbfcode{get\_raindrop\_fall\_velocity}}{\emph{state}}{}
Get the raindrop fall velocity.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_density (unstaggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}


\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the raindrop fall velocity.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{AdjustmentMicrophysicsKesslerWRF (class in parameterizations.adjustment\_microphysics\_kessler\_wrf)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics_kessler_wrf.AdjustmentMicrophysicsKesslerWRF}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{parameterizations.adjustment\_microphysics\_kessler\_wrf.}\sphinxbfcode{AdjustmentMicrophysicsKesslerWRF}}{\emph{grid}, \emph{rain\_evaporation\_on}, \emph{backend}, \emph{a=0.5}, \emph{k1=0.001}, \emph{k2=2.2}}{}
This class inherits \sphinxcode{AdjustmentMicrophysics}
to implement the WRF version of the Kessler scheme.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{inputs} (\sphinxstyleliteralemphasis{tuple of str}) \textendash{} The variables required in the input state when the object is called.

\item {} 
\sphinxstyleliteralstrong{diagnostics} (\sphinxstyleliteralemphasis{tuple of str}) \textendash{} The diagnostic variables output by the object.

\item {} 
\sphinxstyleliteralstrong{outputs} (\sphinxstyleliteralemphasis{tuple of str}) \textendash{} The variables which gets adjusted by the object.

\item {} 
\sphinxstyleliteralstrong{input\_properties} (\sphinxstyleliteralemphasis{dict}) \textendash{} A dictionary whose keys are variables required in the state when the object is called,
and values are dictionaries which indicate ‘dims’ and ‘units’.

\item {} 
\sphinxstyleliteralstrong{diagnostic\_properties} (\sphinxstyleliteralemphasis{dict}) \textendash{} A dictionary whose keys are diagnostics output by the object,
and values are dictionaries which indicate ‘dims’ and ‘units’.

\item {} 
\sphinxstyleliteralstrong{output\_properties} (\sphinxstyleliteralemphasis{dict}) \textendash{} A dictionary whose keys are variables adjusted when the object is called,
and values are dictionaries which indicate ‘dims’ and ‘units’.

\item {} 
\sphinxstyleliteralstrong{a} (\sphinxstyleliteralemphasis{float}) \textendash{} Autoconversion threshold, in units of {[}\(g ~ kg^{-1}\){]}.

\item {} 
\sphinxstyleliteralstrong{k1} (\sphinxstyleliteralemphasis{float}) \textendash{} Rate of autoconversion, in units of {[}\(s^{-1}\){]}.

\item {} 
\sphinxstyleliteralstrong{k2} (\sphinxstyleliteralemphasis{float}) \textendash{} Rate of autoaccretion, in units of {[}\(s^{-1}\){]}.

\end{itemize}

\end{description}\end{quote}
\index{\_\_call\_\_() (parameterizations.adjustment\_microphysics\_kessler\_wrf.AdjustmentMicrophysicsKesslerWRF method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics_kessler_wrf.AdjustmentMicrophysicsKesslerWRF.__call__}}\pysiglinewithargsret{\sphinxbfcode{\_\_call\_\_}}{\emph{state}, \emph{dt}}{}
Entry-point method performing microphysics adjustments.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_density (unstaggered);

\item {} 
air\_pressure (unstaggered) or air\_pressure\_on\_interface\_levels (\(z\)-staggered);

\item {} 
exner\_function (unstaggered) or exner\_function\_on\_interface\_levels (\(z\)-staggered);

\item {} 
air\_temperature (unstaggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the timestep.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{diagnostics} (\sphinxstyleemphasis{obj}) \textendash{} Empty {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}}, as no diagnostics are computed.

\item {} 
\sphinxstylestrong{state\_new} (\sphinxstyleemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes representing the adjusted state.
It contains the following updated variables:
\begin{itemize}
\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_init\_\_() (parameterizations.adjustment\_microphysics\_kessler\_wrf.AdjustmentMicrophysicsKesslerWRF method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics_kessler_wrf.AdjustmentMicrophysicsKesslerWRF.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{rain\_evaporation\_on}, \emph{backend}, \emph{a=0.5}, \emph{k1=0.001}, \emph{k2=2.2}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{rain\_evaporation\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the evaporation of raindrops should be taken into account, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py stencils.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{a} (\sphinxstyleliteralemphasis{float}) \textendash{} Autoconversion threshold, in units of {[}\(g ~ kg^{-1}\){]}. Default is \(0.5 ~ g ~ kg^{-1}\).

\item {} 
\sphinxstyleliteralstrong{k1} (\sphinxstyleliteralemphasis{float}) \textendash{} Rate of autoconversion, in units of {[}\(s^{-1}\){]}. Default is \(0.001 ~ s^{-1}\).

\item {} 
\sphinxstyleliteralstrong{k2} (\sphinxstyleliteralemphasis{float}) \textendash{} Rate of autoaccretion, in units of {[}\(s^{-1}\){]}. Default is \(2.2 ~ s^{-1}\).

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
To instantiate this class, one should prefer the static method
\sphinxcode{factory()} of
\sphinxcode{AdjustmentMicrophysics}.
\end{sphinxadmonition}

\end{fulllineitems}

\index{\_stencil\_adjustment\_defs() (parameterizations.adjustment\_microphysics\_kessler\_wrf.AdjustmentMicrophysicsKesslerWRF method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics_kessler_wrf.AdjustmentMicrophysicsKesslerWRF._stencil_adjustment_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_adjustment\_defs}}{\emph{dt}, \emph{in\_rho}, \emph{in\_p}, \emph{in\_ps}, \emph{in\_exn}, \emph{in\_T}, \emph{in\_qv}, \emph{in\_qc}, \emph{in\_qr}}{}
GT4Py stencil carrying out the microphysical adjustments.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_rho} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the air density.

\item {} 
\sphinxstyleliteralstrong{in\_p} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the air pressure.

\item {} 
\sphinxstyleliteralstrong{in\_ps} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the saturation vapor pressure.

\item {} 
\sphinxstyleliteralstrong{in\_exn} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Exner function.

\item {} 
\sphinxstyleliteralstrong{in\_T} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the air temperature.

\item {} 
\sphinxstyleliteralstrong{in\_qv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_qc} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_qv} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the adjusted mass fraction of water vapor.

\item {} 
\sphinxstylestrong{out\_qc} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the adjusted mass fraction of cloud liquid water.

\item {} 
\sphinxstylestrong{out\_qr} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the adjusted mass fraction of precipitation water.

\end{itemize}


\end{description}\end{quote}
\paragraph{References}

Doms, G., et al. (2015). \sphinxstyleemphasis{A description of the nonhydrostatic regional COSMO-model.                     Part II: Physical parameterization.} Retrieved from {\color{red}\bfseries{}{}`http://www.cosmo-model.org{}`\_}.              Mielikainen, J., B. Huang, J. Wang, H. L. A. Huang, and M. D. Goldberg. (2013).                         \sphinxstyleemphasis{Compute Unified Device Architecture (CUDA)-based parallelization of WRF Kessler                        cloud microphysics scheme}. Computer \& Geosciences, 52:292-299.

\end{fulllineitems}

\index{\_stencil\_adjustment\_initialize() (parameterizations.adjustment\_microphysics\_kessler\_wrf.AdjustmentMicrophysicsKesslerWRF method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics_kessler_wrf.AdjustmentMicrophysicsKesslerWRF._stencil_adjustment_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_adjustment\_initialize}}{}{}
Initialize the GT4Py stencil in charge of carrying out the cloud microphysical adjustments.

\end{fulllineitems}

\index{\_stencil\_raindrop\_fall\_velocity\_defs() (parameterizations.adjustment\_microphysics\_kessler\_wrf.AdjustmentMicrophysicsKesslerWRF method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics_kessler_wrf.AdjustmentMicrophysicsKesslerWRF._stencil_raindrop_fall_velocity_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_raindrop\_fall\_velocity\_defs}}{\emph{in\_rho}, \emph{in\_rho\_s}, \emph{in\_qr}}{}
GT4Py stencil calculating the raindrop velocity.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_rho} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the density.

\item {} 
\sphinxstyleliteralstrong{in\_rho\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the surface density.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the raindrop fall velocity.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_raindrop\_fall\_velocity\_initialize() (parameterizations.adjustment\_microphysics\_kessler\_wrf.AdjustmentMicrophysicsKesslerWRF method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics_kessler_wrf.AdjustmentMicrophysicsKesslerWRF._stencil_raindrop_fall_velocity_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_raindrop\_fall\_velocity\_initialize}}{}{}
Initialize the GT4Py stencil calculating the raindrop velocity.

\end{fulllineitems}

\index{get\_raindrop\_fall\_velocity() (parameterizations.adjustment\_microphysics\_kessler\_wrf.AdjustmentMicrophysicsKesslerWRF method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics_kessler_wrf.AdjustmentMicrophysicsKesslerWRF.get_raindrop_fall_velocity}}\pysiglinewithargsret{\sphinxbfcode{get\_raindrop\_fall\_velocity}}{\emph{state}}{}
Get the raindrop fall velocity.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_density (unstaggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}


\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the raindrop fall velocity.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{AdjustmentMicrophysicsKesslerWRFSaturation (class in parameterizations.adjustment\_microphysics\_kessler\_wrf\_saturation)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics_kessler_wrf_saturation.AdjustmentMicrophysicsKesslerWRFSaturation}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{parameterizations.adjustment\_microphysics\_kessler\_wrf\_saturation.}\sphinxbfcode{AdjustmentMicrophysicsKesslerWRFSaturation}}{\emph{grid}, \emph{rain\_evaporation\_on}, \emph{backend}, \emph{**kwargs}}{}
This class inherits \sphinxcode{AdjustmentMicrophysics}
to implement the saturation adjustment as predicted by the WRF version of the Kessler scheme.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{inputs} (\sphinxstyleliteralemphasis{tuple of str}) \textendash{} The variables required in the input state when the object is called.

\item {} 
\sphinxstyleliteralstrong{diagnostics} (\sphinxstyleliteralemphasis{tuple of str}) \textendash{} The diagnostic variables output by the object.

\item {} 
\sphinxstyleliteralstrong{outputs} (\sphinxstyleliteralemphasis{tuple of str}) \textendash{} The variables which gets adjusted by the object.

\item {} 
\sphinxstyleliteralstrong{input\_properties} (\sphinxstyleliteralemphasis{dict}) \textendash{} A dictionary whose keys are variables required in the state when the object is called,
and values are dictionaries which indicate ‘dims’ and ‘units’.

\item {} 
\sphinxstyleliteralstrong{diagnostic\_properties} (\sphinxstyleliteralemphasis{dict}) \textendash{} A dictionary whose keys are diagnostics output by the object,
and values are dictionaries which indicate ‘dims’ and ‘units’.

\item {} 
\sphinxstyleliteralstrong{output\_properties} (\sphinxstyleliteralemphasis{dict}) \textendash{} A dictionary whose keys are variables adjusted when the object is called,
and values are dictionaries which indicate ‘dims’ and ‘units’.

\end{itemize}

\end{description}\end{quote}
\index{\_\_call\_\_() (parameterizations.adjustment\_microphysics\_kessler\_wrf\_saturation.AdjustmentMicrophysicsKesslerWRFSaturation method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics_kessler_wrf_saturation.AdjustmentMicrophysicsKesslerWRFSaturation.__call__}}\pysiglinewithargsret{\sphinxbfcode{\_\_call\_\_}}{\emph{state}, \emph{dt}}{}
Entry-point method performing the saturation adjustment.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_density (unstaggered);

\item {} 
air\_pressure (unstaggered) or air\_pressure\_on\_interface\_levels (\(z\)-staggered);

\item {} 
exner\_function (unstaggered) or exner\_function\_on\_interface\_levels (\(z\)-staggered);

\item {} 
air\_temperature (unstaggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the timestep.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{diagnostics} (\sphinxstyleemphasis{obj}) \textendash{} Empty {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}}, as no diagnostics are computed.

\item {} 
\sphinxstylestrong{state\_new} (\sphinxstyleemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes representing the adjusted state.
It contains the following updated variables:
\begin{itemize}
\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\end{itemize}

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_init\_\_() (parameterizations.adjustment\_microphysics\_kessler\_wrf\_saturation.AdjustmentMicrophysicsKesslerWRFSaturation method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics_kessler_wrf_saturation.AdjustmentMicrophysicsKesslerWRFSaturation.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{rain\_evaporation\_on}, \emph{backend}, \emph{**kwargs}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{rain\_evaporation\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the evaporation of raindrops should be taken into account, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py stencils.

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
To instantiate this class, one should prefer the static method
\sphinxcode{factory()} of
\sphinxcode{AdjustmentMicrophysics}.
\end{sphinxadmonition}

\end{fulllineitems}

\index{\_stencil\_adjustment\_defs() (parameterizations.adjustment\_microphysics\_kessler\_wrf\_saturation.AdjustmentMicrophysicsKesslerWRFSaturation method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics_kessler_wrf_saturation.AdjustmentMicrophysicsKesslerWRFSaturation._stencil_adjustment_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_adjustment\_defs}}{\emph{dt}, \emph{in\_p}, \emph{in\_ps}, \emph{in\_exn}, \emph{in\_T}, \emph{in\_qv}, \emph{in\_qc}}{}
GT4Py stencil carrying out the saturation adjustment.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_p} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the air pressure.

\item {} 
\sphinxstyleliteralstrong{in\_ps} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the saturation vapor pressure.

\item {} 
\sphinxstyleliteralstrong{in\_exn} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Exner function.

\item {} 
\sphinxstyleliteralstrong{in\_T} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the air temperature.

\item {} 
\sphinxstyleliteralstrong{in\_qv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_qc} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of cloud liquid water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_qv} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the adjusted mass fraction of water vapor.

\item {} 
\sphinxstylestrong{out\_qc} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the adjusted mass fraction of cloud liquid water.

\end{itemize}


\end{description}\end{quote}
\paragraph{References}

Doms, G., et al. (2015). \sphinxstyleemphasis{A description of the nonhydrostatic regional COSMO-model.                     Part II: Physical parameterization.} Retrieved from {\color{red}\bfseries{}{}`http://www.cosmo-model.org{}`\_}.              Mielikainen, J., B. Huang, J. Wang, H. L. A. Huang, and M. D. Goldberg. (2013).                         \sphinxstyleemphasis{Compute Unified Device Architecture (CUDA)-based parallelization of WRF Kessler                        cloud microphysics scheme}. Computer \& Geosciences, 52:292-299.

\end{fulllineitems}

\index{\_stencil\_adjustment\_initialize() (parameterizations.adjustment\_microphysics\_kessler\_wrf\_saturation.AdjustmentMicrophysicsKesslerWRFSaturation method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics_kessler_wrf_saturation.AdjustmentMicrophysicsKesslerWRFSaturation._stencil_adjustment_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_adjustment\_initialize}}{}{}
Initialize the GT4Py stencil in charge of carrying out the saturation adjustment.

\end{fulllineitems}

\index{\_stencil\_raindrop\_fall\_velocity\_defs() (parameterizations.adjustment\_microphysics\_kessler\_wrf\_saturation.AdjustmentMicrophysicsKesslerWRFSaturation method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics_kessler_wrf_saturation.AdjustmentMicrophysicsKesslerWRFSaturation._stencil_raindrop_fall_velocity_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_raindrop\_fall\_velocity\_defs}}{\emph{in\_rho}, \emph{in\_rho\_s}, \emph{in\_qr}}{}
GT4Py stencil calculating the raindrop velocity.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_rho} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the density.

\item {} 
\sphinxstyleliteralstrong{in\_rho\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the surface density.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the raindrop fall velocity.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_raindrop\_fall\_velocity\_initialize() (parameterizations.adjustment\_microphysics\_kessler\_wrf\_saturation.AdjustmentMicrophysicsKesslerWRFSaturation method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics_kessler_wrf_saturation.AdjustmentMicrophysicsKesslerWRFSaturation._stencil_raindrop_fall_velocity_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_raindrop\_fall\_velocity\_initialize}}{}{}
Initialize the GT4Py stencil calculating the raindrop velocity.

\end{fulllineitems}

\index{get\_raindrop\_fall\_velocity() (parameterizations.adjustment\_microphysics\_kessler\_wrf\_saturation.AdjustmentMicrophysicsKesslerWRFSaturation method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.adjustment_microphysics_kessler_wrf_saturation.AdjustmentMicrophysicsKesslerWRFSaturation.get_raindrop_fall_velocity}}\pysiglinewithargsret{\sphinxbfcode{get\_raindrop\_fall\_velocity}}{\emph{state}}{}
Get the raindrop fall velocity.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_density (unstaggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}


\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the raindrop fall velocity.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{SlowTendencyMicrophysics (class in parameterizations.slow\_tendencies)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.slow_tendencies.SlowTendencyMicrophysics}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{parameterizations.slow\_tendencies.}\sphinxbfcode{SlowTendencyMicrophysics}}{\emph{grid}, \emph{rain\_evaporation\_on}, \emph{backend}}{}
Abstract base class whose derived classes implement different parameterization schemes providing
slow-varying microphysical tendencies. The derived classes also compute the following diagnostics:
\begin{itemize}
\item {} 
the raindrop fall speed ({[}\(m \, s^{-1}\){]}).

\end{itemize}
\index{\_\_init\_\_() (parameterizations.slow\_tendencies.SlowTendencyMicrophysics method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.slow_tendencies.SlowTendencyMicrophysics.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{rain\_evaporation\_on}, \emph{backend}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{rain\_evaporation\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the evaporation of raindrops should be taken into account, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py stencils.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{factory() (parameterizations.slow\_tendencies.SlowTendencyMicrophysics static method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.slow_tendencies.SlowTendencyMicrophysics.factory}}\pysiglinewithargsret{\sphinxbfcode{static }\sphinxbfcode{factory}}{\emph{micro\_scheme}, \emph{grid}, \emph{rain\_evaporation\_on}, \emph{backend}, \emph{**kwargs}}{}
Static method returning an instance of the derived class implementing the microphysics scheme
specified by \sphinxcode{micro\_scheme}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{micro\_scheme} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the microphysics parameterization scheme to implement. Either:
\begin{itemize}
\item {} \begin{description}
\item[{’kessler\_wrf’, for the WRF version of the Kessler scheme, with the calculated tendencies which}] \leavevmode
do not include the source terms deriving from the saturation adjustment;

\end{description}

\item {} \begin{description}
\item[{’kessler\_wrf’\_saturation, for the WRF version of the Kessler scheme, with the calculated tendencies which}] \leavevmode
do include the source terms deriving from the saturation adjustment.

\end{description}

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{rain\_evaporation\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the evaporation of raindrops should be taken into account, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py stencils.

\item {} 
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to be forwarded to the derived class.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_raindrop\_fall\_velocity() (parameterizations.slow\_tendencies.SlowTendencyMicrophysics method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.slow_tendencies.SlowTendencyMicrophysics.get_raindrop_fall_velocity}}\pysiglinewithargsret{\sphinxbfcode{get\_raindrop\_fall\_velocity}}{\emph{state}}{}
Get the raindrop fall velocity.
As this method is marked as abstract, its implementation is delegated to the derived classes.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_density (unstaggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}


\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the raindrop fall velocity.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{SlowTendencyMicrophysicsKesslerWRF (class in parameterizations.slow\_tendency\_microphysics\_kessler\_wrf)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.slow_tendency_microphysics_kessler_wrf.SlowTendencyMicrophysicsKesslerWRF}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{parameterizations.slow\_tendency\_microphysics\_kessler\_wrf.}\sphinxbfcode{SlowTendencyMicrophysicsKesslerWRF}}{\emph{grid}, \emph{rain\_evaporation\_on}, \emph{backend}, \emph{a=0.5}, \emph{k1=0.001}, \emph{k2=2.2}}{}
This class inherits \sphinxcode{SlowTendencyMicrophysics}
to implement the WRF version of the Kessler scheme.

\begin{sphinxadmonition}{note}{Note:}
The calculated tendencies do not include the source terms deriving from the saturation adjustment.
\end{sphinxadmonition}
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{a} (\sphinxstyleliteralemphasis{float}) \textendash{} Autoconversion threshold, in units of {[}\(g ~ kg^{-1}\){]}.

\item {} 
\sphinxstyleliteralstrong{k1} (\sphinxstyleliteralemphasis{float}) \textendash{} Rate of autoconversion, in units of {[}\(s^{-1}\){]}.

\item {} 
\sphinxstyleliteralstrong{k2} (\sphinxstyleliteralemphasis{float}) \textendash{} Rate of autoaccretion, in units of {[}\(s^{-1}\){]}.

\end{itemize}

\end{description}\end{quote}
\index{\_\_call\_\_() (parameterizations.slow\_tendency\_microphysics\_kessler\_wrf.SlowTendencyMicrophysicsKesslerWRF method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.slow_tendency_microphysics_kessler_wrf.SlowTendencyMicrophysicsKesslerWRF.__call__}}\pysiglinewithargsret{\sphinxbfcode{\_\_call\_\_}}{\emph{dt}, \emph{state}}{}
Entry-point method computing slow-varying cloud microphysics tendencies.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the timestep.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
\sphinxcode{GridData} or one of its derived classes representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_density (unstaggered);

\item {} 
air\_pressure (unstaggered) or air\_pressure\_on\_interface\_levels (\(z\)-staggered);

\item {} 
exner\_function (unstaggered) or exner\_function\_on\_interface\_levels (\(z\)-staggered);

\item {} 
air\_temperature (unstaggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}


\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{tendencies} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{GridData} storing the following tendencies:
\begin{itemize}
\item {} 
tendency\_of\_air\_potential\_temperature (unstaggered; only if rain evaporation is switched on);

\item {} 
tendency\_of\_mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered; only if rain evaporation is switched on);

\item {} 
tendency\_of\_mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
tendency\_of\_mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}

\item {} 
\sphinxstylestrong{diagnostics} (\sphinxstyleemphasis{obj}) \textendash{} An empty \sphinxcode{GridData}, since no diagnostic is computed.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_init\_\_() (parameterizations.slow\_tendency\_microphysics\_kessler\_wrf.SlowTendencyMicrophysicsKesslerWRF method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.slow_tendency_microphysics_kessler_wrf.SlowTendencyMicrophysicsKesslerWRF.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{rain\_evaporation\_on}, \emph{backend}, \emph{a=0.5}, \emph{k1=0.001}, \emph{k2=2.2}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{rain\_evaporation\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the evaporation of raindrops should be taken into account, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py stencils.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{a} (\sphinxstyleliteralemphasis{float}) \textendash{} Autoconversion threshold, in units of {[}\(g ~ kg^{-1}\){]}. Default is \(0.5 ~ g ~ kg^{-1}\).

\item {} 
\sphinxstyleliteralstrong{k1} (\sphinxstyleliteralemphasis{float}) \textendash{} Rate of autoconversion, in units of {[}\(s^{-1}\){]}. Default is \(0.001 ~ s^{-1}\).

\item {} 
\sphinxstyleliteralstrong{k2} (\sphinxstyleliteralemphasis{float}) \textendash{} Rate of autoaccretion, in units of {[}\(s^{-1}\){]}. Default is \(2.2 ~ s^{-1}\).

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
To instantiate this class, one should prefer the static method
\sphinxcode{factory()} of
\sphinxcode{SlowTendencyMicrophysics}.
\end{sphinxadmonition}

\end{fulllineitems}

\index{\_stencil\_raindrop\_fall\_velocity\_defs() (parameterizations.slow\_tendency\_microphysics\_kessler\_wrf.SlowTendencyMicrophysicsKesslerWRF method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.slow_tendency_microphysics_kessler_wrf.SlowTendencyMicrophysicsKesslerWRF._stencil_raindrop_fall_velocity_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_raindrop\_fall\_velocity\_defs}}{\emph{in\_rho}, \emph{in\_rho\_s}, \emph{in\_qr}}{}
GT4Py stencil calculating the raindrop velocity.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_rho} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the density.

\item {} 
\sphinxstyleliteralstrong{in\_rho\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the surface density.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the raindrop fall velocity.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_raindrop\_fall\_velocity\_initialize() (parameterizations.slow\_tendency\_microphysics\_kessler\_wrf.SlowTendencyMicrophysicsKesslerWRF method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.slow_tendency_microphysics_kessler_wrf.SlowTendencyMicrophysicsKesslerWRF._stencil_raindrop_fall_velocity_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_raindrop\_fall\_velocity\_initialize}}{}{}
Initialize the GT4Py stencil calculating the raindrop velocity.

\end{fulllineitems}

\index{\_stencil\_tendency\_defs() (parameterizations.slow\_tendency\_microphysics\_kessler\_wrf.SlowTendencyMicrophysicsKesslerWRF method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.slow_tendency_microphysics_kessler_wrf.SlowTendencyMicrophysicsKesslerWRF._stencil_tendency_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_tendency\_defs}}{\emph{dt}, \emph{in\_rho}, \emph{in\_p}, \emph{in\_ps}, \emph{in\_exn}, \emph{in\_T}, \emph{in\_qv}, \emph{in\_qc}, \emph{in\_qr}}{}
GT4Py stencil calculating the cloud microphysical tendencies.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_rho} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the air density.

\item {} 
\sphinxstyleliteralstrong{in\_p} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the air pressure.

\item {} 
\sphinxstyleliteralstrong{in\_ps} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the saturation vapor pressure.

\item {} 
\sphinxstyleliteralstrong{in\_exn} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Exner function.

\item {} 
\sphinxstyleliteralstrong{in\_T} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the air temperature.

\item {} 
\sphinxstyleliteralstrong{in\_qv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_qc} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_qc\_tnd} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the tendency of the mass fraction of cloud liquid water.

\item {} 
\sphinxstylestrong{out\_qr\_tnd} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the tendency of the mass fraction of precipitation water.

\item {} 
\sphinxstylestrong{out\_w} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the change over time in potential temperature.

\item {} 
\sphinxstylestrong{out\_qv\_tnd} (\sphinxtitleref{obj}, optional) \textendash{} \sphinxcode{gridtools.Equation} representing the tendency of the mass fraction of water vapor.

\end{itemize}


\end{description}\end{quote}
\paragraph{References}

Doms, G., et al. (2015). \sphinxstyleemphasis{A description of the nonhydrostatic regional COSMO-model.                     Part II: Physical parameterization.} Retrieved from {\color{red}\bfseries{}{}`http://www.cosmo-model.org{}`\_}.              Mielikainen, J., B. Huang, J. Wang, H. L. A. Huang, and M. D. Goldberg. (2013).                         \sphinxstyleemphasis{Compute Unified Device Architecture (CUDA)-based parallelization of WRF Kessler                        cloud microphysics scheme}. Computer \& Geosciences, 52:292-299.

\end{fulllineitems}

\index{\_stencil\_tendency\_initialize() (parameterizations.slow\_tendency\_microphysics\_kessler\_wrf.SlowTendencyMicrophysicsKesslerWRF method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.slow_tendency_microphysics_kessler_wrf.SlowTendencyMicrophysicsKesslerWRF._stencil_tendency_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_tendency\_initialize}}{}{}
Initialize the GT4Py stencil in charge of calculating the cloud microphysical tendencies.

\end{fulllineitems}

\index{get\_raindrop\_fall\_velocity() (parameterizations.slow\_tendency\_microphysics\_kessler\_wrf.SlowTendencyMicrophysicsKesslerWRF method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.slow_tendency_microphysics_kessler_wrf.SlowTendencyMicrophysicsKesslerWRF.get_raindrop_fall_velocity}}\pysiglinewithargsret{\sphinxbfcode{get\_raindrop\_fall\_velocity}}{\emph{state}}{}
Get the raindrop fall velocity.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_density (unstaggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}


\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the raindrop fall velocity.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{SlowTendencyMicrophysicsKesslerWRFSaturation (class in parameterizations.slow\_tendency\_microphysics\_kessler\_wrf\_saturation)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.slow_tendency_microphysics_kessler_wrf_saturation.SlowTendencyMicrophysicsKesslerWRFSaturation}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{parameterizations.slow\_tendency\_microphysics\_kessler\_wrf\_saturation.}\sphinxbfcode{SlowTendencyMicrophysicsKesslerWRFSaturation}}{\emph{grid}, \emph{rain\_evaporation\_on}, \emph{backend}, \emph{a=0.5}, \emph{k1=0.001}, \emph{k2=2.2}}{}
This class inherits \sphinxcode{SlowTendencyMicrophysics}
to implement the WRF version of the Kessler scheme.

\begin{sphinxadmonition}{note}{Note:}
The calculated tendencies do include the source terms deriving from the saturation adjustment.
\end{sphinxadmonition}
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{a} (\sphinxstyleliteralemphasis{float}) \textendash{} Autoconversion threshold, in units of {[}\(g ~ kg^{-1}\){]}.

\item {} 
\sphinxstyleliteralstrong{k1} (\sphinxstyleliteralemphasis{float}) \textendash{} Rate of autoconversion, in units of {[}\(s^{-1}\){]}.

\item {} 
\sphinxstyleliteralstrong{k2} (\sphinxstyleliteralemphasis{float}) \textendash{} Rate of autoaccretion, in units of {[}\(s^{-1}\){]}.

\end{itemize}

\end{description}\end{quote}
\index{\_\_call\_\_() (parameterizations.slow\_tendency\_microphysics\_kessler\_wrf\_saturation.SlowTendencyMicrophysicsKesslerWRFSaturation method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.slow_tendency_microphysics_kessler_wrf_saturation.SlowTendencyMicrophysicsKesslerWRFSaturation.__call__}}\pysiglinewithargsret{\sphinxbfcode{\_\_call\_\_}}{\emph{dt}, \emph{state}}{}
Entry-point method computing slow-varying cloud microphysics tendencies.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the timestep.

\item {} 
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
\sphinxcode{GridData} or one of its derived classes representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_density (unstaggered);

\item {} 
air\_pressure (unstaggered) or air\_pressure\_on\_interface\_levels (\(z\)-staggered);

\item {} 
exner\_function (unstaggered) or exner\_function\_on\_interface\_levels (\(z\)-staggered);

\item {} 
air\_temperature (unstaggered);

\item {} 
mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}


\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{tendencies} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{GridData} storing the following tendencies:
\begin{itemize}
\item {} 
tendency\_of\_air\_potential\_temperature (unstaggered; only if rain evaporation is switched on);

\item {} 
tendency\_of\_mass\_fraction\_of\_water\_vapor\_in\_air (unstaggered; only if rain evaporation is switched on);

\item {} 
tendency\_of\_mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
tendency\_of\_mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}

\item {} 
\sphinxstylestrong{diagnostics} (\sphinxstyleemphasis{obj}) \textendash{} An empty \sphinxcode{GridData}, since no diagnostic is computed.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_init\_\_() (parameterizations.slow\_tendency\_microphysics\_kessler\_wrf\_saturation.SlowTendencyMicrophysicsKesslerWRFSaturation method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.slow_tendency_microphysics_kessler_wrf_saturation.SlowTendencyMicrophysicsKesslerWRFSaturation.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{rain\_evaporation\_on}, \emph{backend}, \emph{a=0.5}, \emph{k1=0.001}, \emph{k2=2.2}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{rain\_evaporation\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the evaporation of raindrops should be taken into account, \sphinxcode{False} otherwise.

\item {} 
\sphinxstyleliteralstrong{backend} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.mode} specifying the backend for the GT4Py stencils.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{a} (\sphinxstyleliteralemphasis{float}) \textendash{} Autoconversion threshold, in units of {[}\(g ~ kg^{-1}\){]}. Default is \(0.5 ~ g ~ kg^{-1}\).

\item {} 
\sphinxstyleliteralstrong{k1} (\sphinxstyleliteralemphasis{float}) \textendash{} Rate of autoconversion, in units of {[}\(s^{-1}\){]}. Default is \(0.001 ~ s^{-1}\).

\item {} 
\sphinxstyleliteralstrong{k2} (\sphinxstyleliteralemphasis{float}) \textendash{} Rate of autoaccretion, in units of {[}\(s^{-1}\){]}. Default is \(2.2 ~ s^{-1}\).

\end{itemize}

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
To instantiate this class, one should prefer the static method
\sphinxcode{factory()} of
\sphinxcode{SlowTendencyMicrophysics}.
\end{sphinxadmonition}

\end{fulllineitems}

\index{\_stencil\_raindrop\_fall\_velocity\_defs() (parameterizations.slow\_tendency\_microphysics\_kessler\_wrf\_saturation.SlowTendencyMicrophysicsKesslerWRFSaturation method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.slow_tendency_microphysics_kessler_wrf_saturation.SlowTendencyMicrophysicsKesslerWRFSaturation._stencil_raindrop_fall_velocity_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_raindrop\_fall\_velocity\_defs}}{\emph{in\_rho}, \emph{in\_rho\_s}, \emph{in\_qr}}{}
GT4Py stencil calculating the raindrop velocity.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_rho} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the density.

\item {} 
\sphinxstyleliteralstrong{in\_rho\_s} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the surface density.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{gridtools.Equation} representing the raindrop fall velocity.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_stencil\_raindrop\_fall\_velocity\_initialize() (parameterizations.slow\_tendency\_microphysics\_kessler\_wrf\_saturation.SlowTendencyMicrophysicsKesslerWRFSaturation method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.slow_tendency_microphysics_kessler_wrf_saturation.SlowTendencyMicrophysicsKesslerWRFSaturation._stencil_raindrop_fall_velocity_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_raindrop\_fall\_velocity\_initialize}}{}{}
Initialize the GT4Py stencil calculating the raindrop velocity.

\end{fulllineitems}

\index{\_stencil\_tendency\_defs() (parameterizations.slow\_tendency\_microphysics\_kessler\_wrf\_saturation.SlowTendencyMicrophysicsKesslerWRFSaturation method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.slow_tendency_microphysics_kessler_wrf_saturation.SlowTendencyMicrophysicsKesslerWRFSaturation._stencil_tendency_defs}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_tendency\_defs}}{\emph{dt}, \emph{in\_rho}, \emph{in\_p}, \emph{in\_ps}, \emph{in\_exn}, \emph{in\_T}, \emph{in\_qv}, \emph{in\_qc}, \emph{in\_qr}}{}
GT4Py stencil calculating the cloud microphysical tendencies.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{in\_rho} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the air density.

\item {} 
\sphinxstyleliteralstrong{in\_p} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the air pressure.

\item {} 
\sphinxstyleliteralstrong{in\_ps} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the saturation vapor pressure.

\item {} 
\sphinxstyleliteralstrong{in\_exn} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the Exner function.

\item {} 
\sphinxstyleliteralstrong{in\_T} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the air temperature.

\item {} 
\sphinxstyleliteralstrong{in\_qv} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of water vapor.

\item {} 
\sphinxstyleliteralstrong{in\_qc} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of cloud liquid water.

\item {} 
\sphinxstyleliteralstrong{in\_qr} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the mass fraction of precipitation water.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{out\_qv\_tnd} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the tendency of the mass fraction of water vapor.

\item {} 
\sphinxstylestrong{out\_qc\_tnd} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the tendency of the mass fraction of cloud liquid water.

\item {} 
\sphinxstylestrong{out\_qr\_tnd} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the tendency of the mass fraction of precipitation water.

\item {} 
\sphinxstylestrong{out\_w} (\sphinxstyleemphasis{obj}) \textendash{} \sphinxcode{gridtools.Equation} representing the change over time in potential temperature.

\end{itemize}


\end{description}\end{quote}
\paragraph{References}

Doms, G., et al. (2015). \sphinxstyleemphasis{A description of the nonhydrostatic regional COSMO-model.                     Part II: Physical parameterization.} Retrieved from {\color{red}\bfseries{}{}`http://www.cosmo-model.org{}`\_}.              Mielikainen, J., B. Huang, J. Wang, H. L. A. Huang, and M. D. Goldberg. (2013).                         \sphinxstyleemphasis{Compute Unified Device Architecture (CUDA)-based parallelization of WRF Kessler                        cloud microphysics scheme}. Computer \& Geosciences, 52:292-299.

\end{fulllineitems}

\index{\_stencil\_tendency\_initialize() (parameterizations.slow\_tendency\_microphysics\_kessler\_wrf\_saturation.SlowTendencyMicrophysicsKesslerWRFSaturation method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.slow_tendency_microphysics_kessler_wrf_saturation.SlowTendencyMicrophysicsKesslerWRFSaturation._stencil_tendency_initialize}}\pysiglinewithargsret{\sphinxbfcode{\_stencil\_tendency\_initialize}}{}{}
Initialize the GT4Py stencil in charge of calculating the cloud microphysical tendencies.

\end{fulllineitems}

\index{get\_raindrop\_fall\_velocity() (parameterizations.slow\_tendency\_microphysics\_kessler\_wrf\_saturation.SlowTendencyMicrophysicsKesslerWRFSaturation method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:parameterizations.slow_tendency_microphysics_kessler_wrf_saturation.SlowTendencyMicrophysicsKesslerWRFSaturation.get_raindrop_fall_velocity}}\pysiglinewithargsret{\sphinxbfcode{get\_raindrop\_fall\_velocity}}{\emph{state}}{}
Get the raindrop fall velocity.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{state} (\sphinxstyleliteralemphasis{obj}) \textendash{} 
{\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} or one of its derived classes representing the current state.
It should contain the following variables:
\begin{itemize}
\item {} 
air\_density (unstaggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered).

\end{itemize}


\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the raindrop fall velocity.

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\section{Storages}
\label{\detokenize{api:storages}}\index{GridData (class in storages.grid\_data)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.grid_data.GridData}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{storages.grid\_data.}\sphinxbfcode{GridData}}{\emph{time}, \emph{grid}, \emph{**kwargs}}{}
Class storing and handling time-dependent variables defined on a grid. Ideally, this class should be used to
represent the state, or a sequence of states at different time levels, of a \sphinxstyleemphasis{generic} climate or meteorological model.
The model variables, in the shape of \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}}s, are passed to the constructor as keyword arguments.
After conversion to \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}}s, the variables are packed in a dictionary whose keys are the input keywords.
The class attribute \sphinxcode{units} lists, for any admissible keyword, the units in which the associated field should
be expressed. Any variable can be accessed via the accessor operator by specifying the corresponding
keyword. Other methods are provided to update the state, or to create a sequence of states (useful for animation purposes).
This class is designed to be as general as possible. Hence, it is not endowed with any method whose
implementation depends on the variables actually stored by the class. This kind of methods might be provided by some
derived classes, each one representing the state of a \sphinxstyleemphasis{specific} model.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\end{description}\end{quote}
\index{\_\_getitem\_\_() (storages.grid\_data.GridData method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.grid_data.GridData.__getitem__}}\pysiglinewithargsret{\sphinxbfcode{\_\_getitem\_\_}}{\emph{key}}{}
Get a shallow copy of a gridded variable.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{key} (\sphinxstyleliteralemphasis{str}) \textendash{} The name of the variable to return.

\item[{Returns}] \leavevmode
Shallow copy of the \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the variable, or \sphinxcode{None} if the variable is not found.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_iadd\_\_() (storages.grid\_data.GridData method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.grid_data.GridData.__iadd__}}\pysiglinewithargsret{\sphinxbfcode{\_\_iadd\_\_}}{\emph{other}}{}
In-place addition operator. In detail:
\begin{itemize}
\item {} \begin{description}
\item[{if the incoming object contains a variable which is not contained in the current object: the variable is}] \leavevmode
deep-copied in the current object;

\end{description}

\item {} \begin{description}
\item[{if the incoming object contains a variable which is contained in the current object, but defined}] \leavevmode
at a different time level: the internal variable is set equal to the incoming one;

\end{description}

\item {} \begin{description}
\item[{if the incoming object contains a variable which is contained in the current object and both are defined}] \leavevmode
at the same time level: the internal variable is augmented by the incoming one.

\end{description}

\end{itemize}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{other} (\sphinxstyleliteralemphasis{obj}) \textendash{} Another \sphinxcode{GridData}, or one of its derived classes.

\item[{Returns}] \leavevmode
Updated version of the current object.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_init\_\_() (storages.grid\_data.GridData method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.grid_data.GridData.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{time}, \emph{grid}, \emph{**kwargs}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.datetime} representing the time instant at which the variables are defined.

\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} The underlying grid, as an instance of {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} or one of its derived classes.

\item {} 
\sphinxstyleliteralstrong{**kwargs} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing a gridded variable.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{add\_variables() (storages.grid\_data.GridData method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.grid_data.GridData.add_variables}}\pysiglinewithargsret{\sphinxbfcode{add\_variables}}{\emph{time}, \emph{**kwargs}}{}
Add a list of variables, passed as keyword arguments.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.datetime} representing the time instant at which the variables are defined.

\item {} 
\sphinxstyleliteralstrong{**kwargs} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing a gridded variable.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{animation\_profile\_x() (storages.grid\_data.GridData method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.grid_data.GridData.animation_profile_x}}\pysiglinewithargsret{\sphinxbfcode{animation\_profile\_x}}{\emph{field\_to\_plot}, \emph{y\_level}, \emph{z\_level}, \emph{destination}, \emph{**kwargs}}{}
Generate an animation showing a field along a section line orthogonal to the \(yz\)-plane.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{field\_to\_plot} (\sphinxstyleliteralemphasis{str}) \textendash{} The name of the field to plot.

\item {} 
\sphinxstyleliteralstrong{y\_level} (\sphinxstyleliteralemphasis{int}) \textendash{} \(y\)-index identifying the section line.

\item {} 
\sphinxstyleliteralstrong{z\_level} (\sphinxstyleliteralemphasis{int}) \textendash{} \(z\)-index identifying the section line.

\item {} 
\sphinxstyleliteralstrong{destination} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the path to the location where the movie will be saved.
Note that the string should include the extension as well.

\item {} 
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to specify different plotting settings.
See {\hyperref[\detokenize{api:tasmania.utils.utils_plot.animation_profile_x}]{\sphinxcrossref{\sphinxcode{tasmania.utils.utils\_plot.animation\_profile\_x()}}}} for the complete list.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{append() (storages.grid\_data.GridData method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.grid_data.GridData.append}}\pysiglinewithargsret{\sphinxbfcode{append}}{\emph{other}}{}
Append a new state to the sequence of states.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{other} (\sphinxstyleliteralemphasis{obj}) \textendash{} Another {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} (or a derived class), whose \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}}s
will be concatenated along the temporal axis to the corresponding ones in the current object.

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
\sphinxcode{other} is supposed to contain exactly the same variables stored by the current object.
\end{sphinxadmonition}

\end{fulllineitems}

\index{extend() (storages.grid\_data.GridData method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.grid_data.GridData.extend}}\pysiglinewithargsret{\sphinxbfcode{extend}}{\emph{other}}{}
Extend the current object by adding the variables stored by another object.
\paragraph{Notes}
\begin{itemize}
\item {} 
The variables are deep copied.

\item {} 
The incoming variables do not need to be defined at the same time level.

\end{itemize}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{other} (\sphinxstyleliteralemphasis{obj}) \textendash{} Another {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} (or a derived class) with which the current object will be synced.

\end{description}\end{quote}

\end{fulllineitems}

\index{extend\_and\_update() (storages.grid\_data.GridData method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.grid_data.GridData.extend_and_update}}\pysiglinewithargsret{\sphinxbfcode{extend\_and\_update}}{\emph{other}}{}
Sync the current object with another {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} (or a derived class).
This implies that, for each variable stored in the incoming object:
\begin{itemize}
\item {} 
if the current object contains a variable with the same name, that variable is updated;

\item {} 
if the current object does not contain any variable with the same name, that variable is deep copied inside                   the current object.

\end{itemize}

\begin{sphinxadmonition}{note}{Note:}
After the update, the stored variables might not be all defined at the same time level.
\end{sphinxadmonition}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{other} (\sphinxstyleliteralemphasis{obj}) \textendash{} Another {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} (or a derived class) with which the current object will be synced.

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_max() (storages.grid\_data.GridData method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.grid_data.GridData.get_max}}\pysiglinewithargsret{\sphinxbfcode{get\_max}}{\emph{key}}{}
Get the maximum value of a variable.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{key} (\sphinxstyleliteralemphasis{str}) \textendash{} The name of the variable.

\item[{Returns}] \leavevmode
The maximum value of the variable of interest.

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_min() (storages.grid\_data.GridData method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.grid_data.GridData.get_min}}\pysiglinewithargsret{\sphinxbfcode{get\_min}}{\emph{key}}{}
Get the minimum value of a variable.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{key} (\sphinxstyleliteralemphasis{str}) \textendash{} The name of the variable.

\item[{Returns}] \leavevmode
The minimum value of the variable of interest.

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{pop() (storages.grid\_data.GridData method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.grid_data.GridData.pop}}\pysiglinewithargsret{\sphinxbfcode{pop}}{\emph{key}}{}
Get a shallow copy of a gridded variable, then remove it from the dictionary.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{key} (\sphinxstyleliteralemphasis{str}) \textendash{} The name of the variable to return and remove.

\item[{Returns}] \leavevmode
Shallow copy of the \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the variable, or \sphinxcode{None} if the variable is not found.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\end{fulllineitems}

\index{time (storages.grid\_data.GridData attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.grid_data.GridData.time}}\pysigline{\sphinxbfcode{time}}
Shortcut to the time instant at which the variables are defined.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
\sphinxcode{datetime.timedelta} representing the time instant at which the variables are defined.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}

\begin{sphinxadmonition}{warning}{Warning:}
Within an instance of this class, variables are not forced to be defined at the same time level,
so the behaviour of this method might be undefined.
\end{sphinxadmonition}

\end{fulllineitems}

\index{update() (storages.grid\_data.GridData method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.grid_data.GridData.update}}\pysiglinewithargsret{\sphinxbfcode{update}}{\emph{other}}{}
Sync the current object with another {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} (or a derived class).
\paragraph{Notes}
\begin{itemize}
\item {} 
It is assumed that \sphinxstyleemphasis{all} the variables stored by the input object are present also in the current object.

\item {} 
After the update, the stored variables might not be all defined at the same time level.

\end{itemize}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{other} (\sphinxstyleliteralemphasis{obj}) \textendash{} Another {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} (or a derived class) with which the current object will be synced.

\end{description}\end{quote}

\end{fulllineitems}

\index{variable\_names (storages.grid\_data.GridData attribute)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.grid_data.GridData.variable_names}}\pysigline{\sphinxbfcode{variable\_names}}
Get the names of the stored variables.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
List of the names of the stored variables.

\item[{Return type}] \leavevmode
list

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{StateIsentropic (class in storages.state\_isentropic)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.state_isentropic.StateIsentropic}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{storages.state\_isentropic.}\sphinxbfcode{StateIsentropic}}{\emph{time}, \emph{grid}, \emph{**kwargs}}{}
This class inherits {\hyperref[\detokenize{api:storages.grid_data.GridData}]{\sphinxcrossref{\sphinxcode{GridData}}}} to represent the state of the three-dimensional
(moist) isentropic model. The stored variables might be:
\begin{itemize}
\item {} 
air\_density (unstaggered);

\item {} 
air\_isentropic\_density (unstaggered);

\item {} 
x\_velocity (\(x\)-staggered);

\item {} 
y\_velocity (\(y\)-staggered);

\item {} 
x\_momentum\_isentropic (unstaggered);

\item {} 
y\_momentum\_isentropic (unstaggered);

\item {} 
air\_pressure or air\_pressure\_on\_interface\_levels (\(z\)-staggered);

\item {} 
exner\_function or exner\_function\_on\_interface\_levels (\(z\)-staggered);

\item {} 
montgomery\_potential (unstaggered);

\item {} 
height or height\_on\_interface\_levels (\(z\)-staggered);

\item {} 
air\_temperature (unstaggered);

\item {} 
mass\_fraction\_water\_vapor\_in\_air (unstaggered);

\item {} 
water\_vapor\_isentropic\_density (unstaggered);

\item {} 
mass\_fraction\_of\_cloud\_liquid\_water\_in\_air (unstaggered);

\item {} 
cloud\_liquid\_water\_isentropic\_density (unstaggered);

\item {} 
mass\_fraction\_of\_precipitation\_water\_in\_air (unstaggered);

\item {} 
precipitation\_water\_isentropic\_density (unstaggered).

\end{itemize}

\begin{sphinxadmonition}{note}{Note:}
At any point, an instance of this class may or may not contain all the listed model variables. Indeed, variables
might be added gradually, according to user’s needs.
\end{sphinxadmonition}
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\end{description}\end{quote}
\index{\_\_init\_\_() (storages.state\_isentropic.StateIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.state_isentropic.StateIsentropic.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{time}, \emph{grid}, \emph{**kwargs}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time instant at which the state is defined.

\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{air\_density} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the density.

\item {} 
\sphinxstyleliteralstrong{air\_isentropic\_density} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the isentropic density.

\item {} 
\sphinxstyleliteralstrong{x\_velocity} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{y\_velocity} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the \(y\)-velocity.

\item {} 
\sphinxstyleliteralstrong{x\_momentum\_isentropic} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the (isentropic) \(x\)-momentum.

\item {} 
\sphinxstyleliteralstrong{y\_momentum\_isentropic} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the (isentropic) \(y\)-momentum.

\item {} 
\sphinxstyleliteralstrong{or air\_pressure\_on\_interface\_levels} (\sphinxstyleliteralemphasis{air\_pressure}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the pressure.

\item {} 
\sphinxstyleliteralstrong{or exner\_function\_on\_interface\_levels} (\sphinxstyleliteralemphasis{exner\_function}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the Exner function.

\item {} 
\sphinxstyleliteralstrong{montgomery\_potential} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the Montgomery potential.

\item {} 
\sphinxstyleliteralstrong{or height\_on\_interface\_levels} (\sphinxstyleliteralemphasis{height}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the geometrical height of the half-levels.

\item {} 
\sphinxstyleliteralstrong{air\_temperature} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the temperature.

\item {} 
\sphinxstyleliteralstrong{mass\_fraction\_of\_water\_vapor\_in\_air} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the mass fraction of water vapor.

\item {} 
\sphinxstyleliteralstrong{water\_vapor\_isentropic\_density} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the isentropic density of water vapor.

\item {} 
\sphinxstyleliteralstrong{mass\_fraction\_of\_cloud\_liquid\_water\_in\_air} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the mass fraction of cloud water.

\item {} 
\sphinxstyleliteralstrong{cloud\_liquid\_water\_isentropic\_density} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the isentropic density of cloud water.

\item {} 
\sphinxstyleliteralstrong{mass\_fraction\_of\_precipitation\_water\_in\_air} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the mass fraction of precipitation water.

\item {} 
\sphinxstyleliteralstrong{precipitation\_water\_isentropic\_density} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the isentropic density of precipitation water.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{animation\_contourf\_xz() (storages.state\_isentropic.StateIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.state_isentropic.StateIsentropic.animation_contourf_xz}}\pysiglinewithargsret{\sphinxbfcode{animation\_contourf\_xz}}{\emph{field\_to\_plot}, \emph{y\_level}, \emph{destination}, \emph{**kwargs}}{}
Generate an animation showing the time evolution of the contourfs of a field at a cross-section
parallel to the \(xz\)-plane.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{field\_to\_plot} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the field to plot. This might be:
\begin{itemize}
\item {} 
the name of a variable stored in the current object.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{y\_level} (\sphinxstyleliteralemphasis{int}) \textendash{} \(y\)-index identifying the cross-section.

\item {} 
\sphinxstyleliteralstrong{destination} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the path to the location where the movie will be saved.
Note that the string should include the extension as well.

\item {} 
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to specify different plotting settings.
See {\hyperref[\detokenize{api:tasmania.utils.utils_plot.animation_contourf_xz}]{\sphinxcrossref{\sphinxcode{tasmania.utils.utils\_plot.animation\_contourf\_xz()}}}} for the complete list.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{contour\_xz() (storages.state\_isentropic.StateIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.state_isentropic.StateIsentropic.contour_xz}}\pysiglinewithargsret{\sphinxbfcode{contour\_xz}}{\emph{field\_to\_plot}, \emph{y\_level}, \emph{time\_level}, \emph{**kwargs}}{}
Generate the contour plot of a field at a cross-section parallel to the \(xz\)-plane.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{field\_to\_plot} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the field to plot. This might be:
\begin{itemize}
\item {} 
the name of a variable stored in the current object;

\item {} \begin{description}
\item[{’x\_velocity\_unstaggered\_perturbation’, for the discrepancy of the \(x\)-velocity with respect to}] \leavevmode
the initial condition; the current object must contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density;

\item {} 
x\_momentum\_isentropic;

\end{itemize}

\end{description}

\item {} \begin{description}
\item[{’vertical\_velocity’, for the vertical velocity; only for two-dimensional steady-state flows;}] \leavevmode
the current object must contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density;

\item {} 
x\_momentum\_isentropic;

\item {} 
height or height\_on\_interface\_levels.

\end{itemize}

\end{description}

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{y\_level} (\sphinxstyleliteralemphasis{int}) \textendash{} \(y\)-index identifying the cross-section.

\item {} 
\sphinxstyleliteralstrong{time\_level} (\sphinxstyleliteralemphasis{int}) \textendash{} The time level.

\item {} 
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to specify different plotting settings.
See {\hyperref[\detokenize{api:tasmania.utils.utils_plot.contour_xz}]{\sphinxcrossref{\sphinxcode{tasmania.utils.utils\_plot.contour\_xz()}}}} for the complete list.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{contourf\_xy() (storages.state\_isentropic.StateIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.state_isentropic.StateIsentropic.contourf_xy}}\pysiglinewithargsret{\sphinxbfcode{contourf\_xy}}{\emph{field\_to\_plot}, \emph{z\_level}, \emph{time\_level}, \emph{**kwargs}}{}
Generate the contourf plot of a field at a cross-section parallel to the \(xy\)-plane.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{field\_to\_plot} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the field to plot. This might be:
\begin{itemize}
\item {} 
the name of a variable stored in the current object;

\item {} \begin{description}
\item[{’horizontal\_velocity’, for the horizontal velocity; the current object must contain the}] \leavevmode
following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density;

\item {} 
x\_momentum\_isentropic;

\item {} 
y\_momentum\_isentropic.

\end{itemize}

\end{description}

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{z\_level} (\sphinxstyleliteralemphasis{int}) \textendash{} \(z\)-index identifying the cross-section.

\item {} 
\sphinxstyleliteralstrong{time\_level} (\sphinxstyleliteralemphasis{int}) \textendash{} The time level.

\item {} 
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to specify different plotting settings.
See {\hyperref[\detokenize{api:tasmania.utils.utils_plot.contourf_xy}]{\sphinxcrossref{\sphinxcode{tasmania.utils.utils\_plot.contourf\_xy()}}}} for the complete list.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{contourf\_xz() (storages.state\_isentropic.StateIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.state_isentropic.StateIsentropic.contourf_xz}}\pysiglinewithargsret{\sphinxbfcode{contourf\_xz}}{\emph{field\_to\_plot}, \emph{y\_level}, \emph{time\_level}, \emph{**kwargs}}{}
Generate the contourf plot of a field at a cross-section parallel to the \(xz\)-plane.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{field\_to\_plot} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the field to plot. This might be:
\begin{itemize}
\item {} 
the name of a variable stored in the current object;

\item {} \begin{description}
\item[{’x\_velocity\_unstaggered\_perturbation’, for the discrepancy of the \(x\)-velocity with respect to}] \leavevmode
the initial condition; the current object must contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density;

\item {} 
x\_momentum\_isentropic;

\end{itemize}

\end{description}

\item {} \begin{description}
\item[{’vertical\_velocity’, for the vertical velocity; only for two-dimensional steady-state flows;}] \leavevmode
the current object must contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density;

\item {} 
x\_momentum\_isentropic;

\item {} 
height or height\_on\_interface\_levels.

\end{itemize}

\end{description}

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{y\_level} (\sphinxstyleliteralemphasis{int}) \textendash{} \(y\)-index identifying the cross-section.

\item {} 
\sphinxstyleliteralstrong{time\_level} (\sphinxstyleliteralemphasis{int}) \textendash{} The time level.

\item {} 
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to specify different plotting settings.
See {\hyperref[\detokenize{api:tasmania.utils.utils_plot.contourf_xz}]{\sphinxcrossref{\sphinxcode{tasmania.utils.utils\_plot.contourf\_xz()}}}} for the complete list.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_cfl() (storages.state\_isentropic.StateIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.state_isentropic.StateIsentropic.get_cfl}}\pysiglinewithargsret{\sphinxbfcode{get\_cfl}}{\emph{dt}}{}
Compute the CFL number.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{dt} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the time step.

\item[{Returns}] \leavevmode
The CFL number.

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\begin{sphinxadmonition}{note}{Note:}
If the CFL number exceeds the unity, i.e., if the CFL condition is violated, the method throws a warning.
\end{sphinxadmonition}

\end{fulllineitems}

\index{quiver\_xy() (storages.state\_isentropic.StateIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.state_isentropic.StateIsentropic.quiver_xy}}\pysiglinewithargsret{\sphinxbfcode{quiver\_xy}}{\emph{field\_to\_plot}, \emph{z\_level}, \emph{time\_level}, \emph{**kwargs}}{}
Generate the quiver plot of a vector field at a cross section parallel to the \(xy\)-plane.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{field\_to\_plot} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the field to plot. This might be:
\begin{itemize}
\item {} \begin{description}
\item[{’horizontal\_velocity’, for the horizontal velocity; the current object must contain the}] \leavevmode
following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density;

\item {} 
x\_momentum\_isentropic;

\item {} 
y\_momentum\_isentropic.

\end{itemize}

\end{description}

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{z\_level} (\sphinxstyleliteralemphasis{int}) \textendash{} \(z\)-level identifying the cross-section.

\item {} 
\sphinxstyleliteralstrong{time\_level} (\sphinxstyleliteralemphasis{int}) \textendash{} The time level.

\item {} 
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to specify different plotting settings.
See {\hyperref[\detokenize{api:tasmania.utils.utils_plot.quiver_xy}]{\sphinxcrossref{\sphinxcode{tasmania.utils.utils\_plot.quiver\_xy()}}}} for the complete list.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{quiver\_xz() (storages.state\_isentropic.StateIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.state_isentropic.StateIsentropic.quiver_xz}}\pysiglinewithargsret{\sphinxbfcode{quiver\_xz}}{\emph{field\_to\_plot}, \emph{y\_level}, \emph{time\_level}, \emph{**kwargs}}{}
Generate the quiver plot of a vector field at a cross section parallel to the \(xz\)-plane.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{field\_to\_plot} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the field to plot. This might be:
\begin{itemize}
\item {} 
’velocity’, for the velocity field; the current object must contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density;

\item {} 
x\_momentum\_isentropic;

\item {} 
height or height\_on\_interface\_levels.

\end{itemize}

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{y\_level} (\sphinxstyleliteralemphasis{int}) \textendash{} \(y\)-level identifying the cross-section.

\item {} 
\sphinxstyleliteralstrong{time\_level} (\sphinxstyleliteralemphasis{int}) \textendash{} The time level.

\item {} 
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to specify different plotting settings.
See {\hyperref[\detokenize{api:tasmania.utils.utils_plot.quiver_xz}]{\sphinxcrossref{\sphinxcode{tasmania.utils.utils\_plot.quiver\_xz()}}}} for the complete list.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{streamplot\_xz() (storages.state\_isentropic.StateIsentropic method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:storages.state_isentropic.StateIsentropic.streamplot_xz}}\pysiglinewithargsret{\sphinxbfcode{streamplot\_xz}}{\emph{y\_level}, \emph{time\_level}, \emph{**kwargs}}{}
Generate the streamplot of a two-dimensional velocity field.

\begin{sphinxadmonition}{note}{Note:}
The current object should contain the following variables:
\begin{itemize}
\item {} 
air\_isentropic\_density;

\item {} 
x\_momentum\_isentropic;

\item {} 
height or height\_on\_interface\_levels.

\end{itemize}
\end{sphinxadmonition}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{y\_level} (\sphinxstyleliteralemphasis{int}) \textendash{} \(y\)-index identifying the cross-section.

\item {} 
\sphinxstyleliteralstrong{time\_level} (\sphinxstyleliteralemphasis{int}) \textendash{} The time level.

\item {} 
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to specify different plotting settings.
See {\hyperref[\detokenize{api:tasmania.utils.utils_plot.streamplot_xz}]{\sphinxcrossref{\sphinxcode{tasmania.utils.utils\_plot.streamplot\_xz()}}}} for the complete list.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\section{Topography}
\label{\detokenize{api:topography}}\label{\detokenize{api:module-grids.topography}}\index{grids.topography (module)}
Classes representing one- and two-dimensional topographies, possibly time-dependent.
Indeed, although clearly not physical, a terrain surface (slowly) growing in the early stages
of a simulation may help to retrieve numerical stability, as it prevents steep gradients
in the first few iterations.

Letting \(h_s = h_s(x)\) be a one-dimensional topography, with \(x \in [a,b]\),
the user may choose among:
\begin{itemize}
\item {} 
a flat terrain, i.e., \(h_s(x) \equiv 0\);

\item {} 
a Gaussian-shaped mountain, i.e.,
\begin{quote}
\begin{equation*}
\begin{split}h_s(x) = h_{max} \exp{\left[ - \left( \frac{x - c}{\sigma_x} \right)^2 \right]},\end{split}
\end{equation*}\end{quote}

where \(c = 0.5 (a + b)\).

\end{itemize}

For the two-dimensional case, letting \(h_s = h_s(x,y)\) be the topography, with
\(x \in [a_x,b_x]\) and \(y \in [a_y,b_y]\), the following profiles are provided:
\begin{itemize}
\item {} 
flat terrain, i.e., \(h_s(x,y) \equiv 0\);

\item {} 
Gaussian shaped-mountain, i.e.
\begin{quote}
\begin{equation*}
\begin{split}h_s(x,y) = h_{max} \exp{\left[ - \left( \frac{x - c_x}{\sigma_x} \right)^2 - \left( \frac{y - c_y}{\sigma_y} \right)^2 \right]} ;\end{split}
\end{equation*}\end{quote}

\item {} 
modified Gaussian-shaped mountain proposed by Schaer and Durran (1997),
\begin{quote}
\begin{equation*}
\begin{split}h_s(x,y) = \frac{h_{max}}{\left[ 1 + \left( \frac{x - c_x}{\sigma_x} \right)^2 + \left( \frac{y - c_y}{\sigma_y} \right)^2 \right]^{3/2}}.\end{split}
\end{equation*}\end{quote}

\end{itemize}

Yet, user-defined profiles are supported as well, provided that they admit an analytical expression.
This is passed to the class as a string, which is then parsed in C++ via \sphinxhref{http://cython.org}{Cython}
(see \sphinxcode{parser\_1d} and \sphinxcode{parser\_2d}). Hence, the string itself must be
fully C++-compliant.
\paragraph{References}

Schaer, C., and Durran, D. R. (1997). \sphinxstyleemphasis{Vortex formation and vortex shedding in continuosly stratified flows     past isolated topography}. Journal of Atmospheric Sciences, 54:534-554.
\index{Topography1d (class in grids.topography)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.topography.Topography1d}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{grids.topography.}\sphinxbfcode{Topography1d}}{\emph{x}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Class representing a one-dimensional topography.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{topo} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the topography (in meters).

\item {} 
\sphinxstyleliteralstrong{topo\_type} (\sphinxstyleliteralemphasis{str}) \textendash{} 
Topography type. Either:
\begin{itemize}
\item {} 
’flat\_terrain’;

\item {} 
’gaussian’;

\item {} 
’user\_defined’.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{topo\_time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} object representing the elapsed simulation time after which the topography
should stop increasing.

\item {} 
\sphinxstyleliteralstrong{topo\_fact} (\sphinxstyleliteralemphasis{float}) \textendash{} Topography factor. It runs in between 0 (at the beginning of the simulation) and 1 (once the simulation
has been run for \sphinxcode{topo\_time}).

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (grids.topography.Topography1d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.topography.Topography1d.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{x}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{x} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.axis.Axis}]{\sphinxcrossref{\sphinxcode{Axis}}}} representing the underlying horizontal axis.

\item {} 
\sphinxstyleliteralstrong{topo\_type} (\sphinxtitleref{str}, optional) \textendash{} 
Topography type. Either:
\begin{itemize}
\item {} 
’flat\_terrain’ (default);

\item {} 
’gaussian’;

\item {} 
’user\_defined’.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{topo\_time} (\sphinxstyleliteralemphasis{obj}) \textendash{} class:\sphinxtitleref{datetime.timedelta} representing the elapsed simulation time after which the topography
should stop increasing. Default is 0, corresponding to a time-invariant terrain surface-height.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{topo\_max\_height} (\sphinxstyleliteralemphasis{float}) \textendash{} When \sphinxcode{topo\_type} is ‘gaussian’, maximum mountain height (in meters). Default is 500.

\item {} 
\sphinxstyleliteralstrong{topo\_width\_x} (\sphinxstyleliteralemphasis{float}) \textendash{} When \sphinxcode{topo\_type} is ‘gaussian’, mountain half-width (in meters). Default is 10000.

\item {} 
\sphinxstyleliteralstrong{topo\_str} (\sphinxstyleliteralemphasis{str}) \textendash{} When \sphinxcode{topo\_type} is ‘user\_defined’, terrain profile expression in the independent variable \(x\).
Must be fully C++-compliant.

\item {} 
\sphinxstyleliteralstrong{topo\_smooth} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} to smooth the topography out, \sphinxcode{False} otherwise. Default is \sphinxcode{False}.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{update() (grids.topography.Topography1d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.topography.Topography1d.update}}\pysiglinewithargsret{\sphinxbfcode{update}}{\emph{time}}{}
Update topography at current simulation time.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the elapsed simulation time.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{Topography2d (class in grids.topography)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.topography.Topography2d}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{grids.topography.}\sphinxbfcode{Topography2d}}{\emph{grid}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Class representing a two-dimensional topography.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{topo} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html\#xarray.DataArray}{\sphinxcode{xarray.DataArray}} representing the topography (in meters).

\item {} 
\sphinxstyleliteralstrong{topo\_type} (\sphinxstyleliteralemphasis{str}) \textendash{} 
Topography type. Either:
\begin{itemize}
\item {} 
’flat\_terrain’;

\item {} 
’gaussian’;

\item {} 
’schaer’;

\item {} 
’user\_defined’.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{topo\_time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the elapsed simulation time after which the topography
should stop increasing.

\item {} 
\sphinxstyleliteralstrong{topo\_fact} (\sphinxstyleliteralemphasis{float}) \textendash{} Topography factor. It runs in between 0 (at the beginning of the simulation) and 1 (once the simulation
has been run for \sphinxcode{topo\_time}).

\item {} 
\sphinxstyleliteralstrong{topo\_kwargs} (\sphinxstyleliteralemphasis{dict}) \textendash{} Dictionary storing all the topography settings which could be passed to the constructor as keyword arguments.

\end{itemize}

\end{description}\end{quote}
\index{\_\_init\_\_() (grids.topography.Topography2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.topography.Topography2d.__init__}}\pysiglinewithargsret{\sphinxbfcode{\_\_init\_\_}}{\emph{grid}, \emph{topo\_type='flat\_terrain'}, \emph{topo\_time=datetime.timedelta(0)}, \emph{**kwargs}}{}
Constructor.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xy.GridXY}]{\sphinxcrossref{\sphinxcode{GridXY}}}} representing the underlying grid.

\item {} 
\sphinxstyleliteralstrong{topo\_type} (\sphinxtitleref{str}, optional) \textendash{} 
Topography type. Either:
\begin{itemize}
\item {} 
’flat\_terrain’ (default);

\item {} 
’gaussian’;

\item {} 
’schaer’;

\item {} 
’user\_defined’.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{topo\_time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the elapsed simulation time after which the topography
should stop increasing. Default is 0, corresponding to a time-invariant terrain surface-height.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{topo\_max\_height} (\sphinxstyleliteralemphasis{float}) \textendash{} When \sphinxcode{topo\_type} is either ‘gaussian’ or ‘schaer’, maximum mountain height (in meters).
Default is 500.

\item {} 
\sphinxstyleliteralstrong{topo\_center\_x} (\sphinxstyleliteralemphasis{float}) \textendash{} When \sphinxcode{topo\_type} is either ‘gaussian’ or ‘schaer’, \(x\)-coordinate of the mountain center
(in meters). By default, the mountain center is placed in the center of the domain.

\item {} 
\sphinxstyleliteralstrong{topo\_center\_y} (\sphinxstyleliteralemphasis{float}) \textendash{} When \sphinxcode{topo\_type} is either ‘gaussian’ or ‘schaer’, \(y\)-coordinate of the mountain center
(in meters). By default, the mountain center is placed in the center of the domain.

\item {} 
\sphinxstyleliteralstrong{topo\_width\_x} (\sphinxstyleliteralemphasis{float}) \textendash{} When \sphinxcode{topo\_type} is either ‘gaussian’ or ‘schaer’, mountain half-width in \(x\)-direction
(in meters). Default is 10000.

\item {} 
\sphinxstyleliteralstrong{topo\_width\_y} (\sphinxstyleliteralemphasis{float}) \textendash{} When \sphinxcode{topo\_type} is either ‘gaussian’ or ‘schaer’, mountain half-width in \(y\)-direction
(in meters). Default is 10000.

\item {} 
\sphinxstyleliteralstrong{topo\_str} (\sphinxstyleliteralemphasis{str}) \textendash{} When \sphinxcode{topo\_type} is ‘user\_defined’, terrain profile expression in the independent variables
\(x\) and \(y\). Must be fully C++-compliant.

\item {} 
\sphinxstyleliteralstrong{topo\_smooth} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} to smooth the topography out, \sphinxcode{False} otherwise. Default is \sphinxcode{False}.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{plot() (grids.topography.Topography2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.topography.Topography2d.plot}}\pysiglinewithargsret{\sphinxbfcode{plot}}{\emph{grid}, \emph{**kwargs}}{}
Plot the topography using the \sphinxhref{https://matplotlib.org/tutorials/toolkits/mplot3d.html}{mplot3d toolkit}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xy.GridXY}]{\sphinxcrossref{\sphinxcode{GridXY}}}} representing the underlying grid.

\item[{Keyword Arguments}] \leavevmode
\sphinxstyleliteralstrong{**kwargs} \textendash{} Keyword arguments to be forwarded to \sphinxhref{https://matplotlib.org/2.1.1/api/\_as\_gen/matplotlib.pyplot.figure.html\#matplotlib.pyplot.figure}{\sphinxcode{matplotlib.pyplot.figure()}}.

\end{description}\end{quote}

\end{fulllineitems}

\index{update() (grids.topography.Topography2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.topography.Topography2d.update}}\pysiglinewithargsret{\sphinxbfcode{update}}{\emph{time}}{}
Update topography at current simulation time.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} \sphinxcode{datetime.timedelta} representing the elapsed simulation time.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{Parsers}
\label{\detokenize{api:parsers}}\index{Parser1d (class in grids.parser.parser\_1d)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.parser.parser_1d.Parser1d}}\pysigline{\sphinxbfcode{class }\sphinxcode{grids.parser.parser\_1d.}\sphinxbfcode{Parser1d}}
Cython wrapper for the C++ class \sphinxcode{parser\_1d\_cpp}.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode
\sphinxstyleliteralstrong{parser} (\sphinxstyleliteralemphasis{obj}) \textendash{} Pointer to a \sphinxcode{parser\_1d\_cpp} object.

\end{description}\end{quote}
\index{evaluate() (grids.parser.parser\_1d.Parser1d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.parser.parser_1d.Parser1d.evaluate}}\pysiglinewithargsret{\sphinxbfcode{evaluate}}{}{}
Evaluate the expression.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} of the evaluations.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{Parser2d (class in grids.parser.parser\_2d)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.parser.parser_2d.Parser2d}}\pysigline{\sphinxbfcode{class }\sphinxcode{grids.parser.parser\_2d.}\sphinxbfcode{Parser2d}}
Cython wrapper for the C++ class \sphinxcode{parser\_2d\_cpp}.
\begin{quote}\begin{description}
\item[{Variables}] \leavevmode
\sphinxstyleliteralstrong{parser} (\sphinxstyleliteralemphasis{obj}) \textendash{} Pointer to a \sphinxcode{parser\_2d\_cpp} object.

\end{description}\end{quote}
\index{evaluate() (grids.parser.parser\_2d.Parser2d method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:grids.parser.parser_2d.Parser2d.evaluate}}\pysiglinewithargsret{\sphinxbfcode{evaluate}}{}{}
Evaluate the expression.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} of the evaluations.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\section{Utilities}
\label{\detokenize{api:utilities}}

\subsection{General-purpose utilities}
\label{\detokenize{api:module-tasmania.set_namelist}}\label{\detokenize{api:general-purpose-utilities}}\index{tasmania.set\_namelist (module)}\index{set\_namelist() (in module tasmania.set\_namelist)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:tasmania.set_namelist.set_namelist}}\pysiglinewithargsret{\sphinxcode{tasmania.set\_namelist.}\sphinxbfcode{set\_namelist}}{\emph{user\_namelist=None}}{}
Place the user-defined namelist module in the Python search path.
This is achieved by physically copying the content of the user-provided module into TASMANIA\_ROOT/namelist.py.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{user\_namelist} (\sphinxstyleliteralemphasis{str}) \textendash{} Path to the user-defined namelist. If not specified, the default namelist TASMANIA\_ROOT/\_namelist.py is used.

\end{description}\end{quote}

\end{fulllineitems}

\phantomsection\label{\detokenize{api:module-tasmania.utils.utils}}\index{tasmania.utils.utils (module)}
Some useful utilities.
\index{\_get\_prefix() (in module tasmania.utils.utils)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:tasmania.utils.utils._get_prefix}}\pysiglinewithargsret{\sphinxcode{tasmania.utils.utils.}\sphinxbfcode{\_get\_prefix}}{\emph{units}}{}
Extract the prefix from the units name.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{units} (\sphinxstyleliteralemphasis{str}) \textendash{} The units.

\item[{Returns}] \leavevmode
The prefix.

\item[{Return type}] \leavevmode
str

\end{description}\end{quote}

\end{fulllineitems}

\index{convert\_datetime64\_to\_datetime() (in module tasmania.utils.utils)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:tasmania.utils.utils.convert_datetime64_to_datetime}}\pysiglinewithargsret{\sphinxcode{tasmania.utils.utils.}\sphinxbfcode{convert\_datetime64\_to\_datetime}}{\emph{time}}{}
Convert \sphinxcode{numpy.datetime64} to \sphinxcode{datetime.datetime}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{obj}) \textendash{} The \sphinxcode{numpy.datetime64} object to convert.

\item[{Returns}] \leavevmode
The converted \sphinxcode{datetime.datetime} object.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}
\paragraph{References}

\sphinxurl{https://stackoverflow.com/questions/13703720/converting-between-datetime-timestamp-and-datetime64}.

\end{fulllineitems}

\index{equal\_to() (in module tasmania.utils.utils)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:tasmania.utils.utils.equal_to}}\pysiglinewithargsret{\sphinxcode{tasmania.utils.utils.}\sphinxbfcode{equal\_to}}{\emph{a}, \emph{b}, \emph{tol=None}}{}
Compare floating point numbers (or arrays of floating point numbers), properly accounting for round-off errors.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{a} (\sphinxtitleref{float} or \sphinxtitleref{array\_like}) \textendash{} Left-hand side.

\item {} 
\sphinxstyleliteralstrong{b} (\sphinxtitleref{float} or \sphinxtitleref{array\_like}) \textendash{} Right-hand side.

\item {} 
\sphinxstyleliteralstrong{tol} (\sphinxtitleref{float}, optional) \textendash{} Tolerance.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{True} if \sphinxcode{a} is equal to \sphinxcode{b} up to \sphinxcode{tol}, \sphinxcode{False} otherwise.

\item[{Return type}] \leavevmode
bool

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_factor() (in module tasmania.utils.utils)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:tasmania.utils.utils.get_factor}}\pysiglinewithargsret{\sphinxcode{tasmania.utils.utils.}\sphinxbfcode{get\_factor}}{\emph{units}}{}
Convert units prefix to the corresponding factor.
For the conversion, the \sphinxhref{http://cfconventions.org/}{CF Conventions} are used.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{units} (\sphinxstyleliteralemphasis{str}) \textendash{} The units.

\item[{Returns}] \leavevmode
The factor.

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{greater\_or\_equal\_than() (in module tasmania.utils.utils)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:tasmania.utils.utils.greater_or_equal_than}}\pysiglinewithargsret{\sphinxcode{tasmania.utils.utils.}\sphinxbfcode{greater\_or\_equal\_than}}{\emph{a}, \emph{b}, \emph{tol=None}}{}
Compare floating point numbers (or arrays of floating point numbers), properly accounting for round-off errors.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{a} (\sphinxtitleref{float} or \sphinxtitleref{array\_like}) \textendash{} Left-hand side.

\item {} 
\sphinxstyleliteralstrong{b} (\sphinxtitleref{float} or \sphinxtitleref{array\_like}) \textendash{} Right-hand side.

\item {} 
\sphinxstyleliteralstrong{tol} (\sphinxtitleref{float}, optional) \textendash{} Tolerance.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{True} if \sphinxcode{a} is greater than or equal to \sphinxcode{b} up to \sphinxcode{tol}, \sphinxcode{False} otherwise.

\item[{Return type}] \leavevmode
bool

\end{description}\end{quote}

\end{fulllineitems}

\index{greater\_than() (in module tasmania.utils.utils)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:tasmania.utils.utils.greater_than}}\pysiglinewithargsret{\sphinxcode{tasmania.utils.utils.}\sphinxbfcode{greater\_than}}{\emph{a}, \emph{b}, \emph{tol=None}}{}
Compare floating point numbers (or arrays of floating point numbers), properly accounting for round-off errors.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{a} (\sphinxtitleref{float} or \sphinxtitleref{array\_like}) \textendash{} Left-hand side.

\item {} 
\sphinxstyleliteralstrong{b} (\sphinxtitleref{float} or \sphinxtitleref{array\_like}) \textendash{} Right-hand side.

\item {} 
\sphinxstyleliteralstrong{tol} (\sphinxtitleref{float}, optional) \textendash{} Tolerance.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{True} if \sphinxcode{a} is greater than \sphinxcode{b} up to \sphinxcode{tol}, \sphinxcode{False} otherwise.

\item[{Return type}] \leavevmode
bool

\end{description}\end{quote}

\end{fulllineitems}

\index{smaller\_or\_equal\_than() (in module tasmania.utils.utils)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:tasmania.utils.utils.smaller_or_equal_than}}\pysiglinewithargsret{\sphinxcode{tasmania.utils.utils.}\sphinxbfcode{smaller\_or\_equal\_than}}{\emph{a}, \emph{b}, \emph{tol=None}}{}
Compare floating point numbers (or arrays of floating point numbers), properly accounting for round-off errors.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{a} (\sphinxtitleref{float} or \sphinxtitleref{array\_like}) \textendash{} Left-hand side.

\item {} 
\sphinxstyleliteralstrong{b} (\sphinxtitleref{float} or \sphinxtitleref{array\_like}) \textendash{} Right-hand side.

\item {} 
\sphinxstyleliteralstrong{tol} (\sphinxtitleref{float}, optional) \textendash{} Tolerance.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{True} if \sphinxcode{a} is smaller than or equal to \sphinxcode{b} up to \sphinxcode{tol}, \sphinxcode{False} otherwise.

\item[{Return type}] \leavevmode
bool

\end{description}\end{quote}

\end{fulllineitems}

\index{smaller\_than() (in module tasmania.utils.utils)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:tasmania.utils.utils.smaller_than}}\pysiglinewithargsret{\sphinxcode{tasmania.utils.utils.}\sphinxbfcode{smaller\_than}}{\emph{a}, \emph{b}, \emph{tol=None}}{}
Compare floating point numbers (or arrays of floating point numbers), properly accounting for round-off errors.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{a} (\sphinxtitleref{float} or \sphinxtitleref{array\_like}) \textendash{} Left-hand side.

\item {} 
\sphinxstyleliteralstrong{b} (\sphinxtitleref{float} or \sphinxtitleref{array\_like}) \textendash{} Right-hand side.

\item {} 
\sphinxstyleliteralstrong{tol} (\sphinxtitleref{float}, optional) \textendash{} Tolerance.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxcode{True} if \sphinxcode{a} is smaller than \sphinxcode{b} up to \sphinxcode{tol}, \sphinxcode{False} otherwise.

\item[{Return type}] \leavevmode
bool

\end{description}\end{quote}

\end{fulllineitems}



\subsection{Meteo utilities}
\label{\detokenize{api:meteo-utilities}}\label{\detokenize{api:module-tasmania.utils.utils_meteo}}\index{tasmania.utils.utils\_meteo (module)}
Meteo-oriented utilities.
\index{apply\_goff\_gratch\_formula() (in module tasmania.utils.utils\_meteo)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:tasmania.utils.utils_meteo.apply_goff_gratch_formula}}\pysiglinewithargsret{\sphinxcode{tasmania.utils.utils\_meteo.}\sphinxbfcode{apply\_goff\_gratch\_formula}}{\emph{T}}{}
Compute the saturation vapor pressure over water at a given temperature, relying upon the Goff-Gratch formula.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{T} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the temperature ({[}\(K\){]}).

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the saturation water vapor pressure ({[}\(Pa\){]}).

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}
\paragraph{References}

Goff, J. A., and S. Gratch. (1946). \sphinxtitleref{Low-pressure properties of water from -160 to 212 F}.              Transactions of the American Society of Heating and Ventilating Engineers, 95-122.

\end{fulllineitems}

\index{apply\_teten\_formula() (in module tasmania.utils.utils\_meteo)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:tasmania.utils.utils_meteo.apply_teten_formula}}\pysiglinewithargsret{\sphinxcode{tasmania.utils.utils\_meteo.}\sphinxbfcode{apply\_teten\_formula}}{\emph{T}}{}
Compute the saturation vapor pressure over water at a given temperature, relying upon the Teten’s formula.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{T} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the temperature ({[}\(K\){]}).

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the saturation water vapor pressure ({[}\(Pa\){]}).

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}

\end{fulllineitems}

\index{convert\_relative\_humidity\_to\_water\_vapor() (in module tasmania.utils.utils\_meteo)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:tasmania.utils.utils_meteo.convert_relative_humidity_to_water_vapor}}\pysiglinewithargsret{\sphinxcode{tasmania.utils.utils\_meteo.}\sphinxbfcode{convert\_relative\_humidity\_to\_water\_vapor}}{\emph{method}, \emph{p}, \emph{T}, \emph{rh}}{}
Convert relative humidity to water vapor mixing ratio.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{method} (\sphinxstyleliteralemphasis{str}) \textendash{} 
String specifying the formula to be used to compute the saturation water vapor pressure. Either:
\begin{itemize}
\item {} 
’teten’, for the Teten’s formula;

\item {} 
’goff\_gratch’, for the Goff-Gratch formula.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{p} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the pressure ({[}\(Pa\){]}).

\item {} 
\sphinxstyleliteralstrong{T} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the temperature ({[}\(K\){]}).

\item {} 
\sphinxstyleliteralstrong{rh} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the relative humidity ({[}\(-\){]}).

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the fraction of water vapor ({[}\(g \, g^{-1}\){]}).

\item[{Return type}] \leavevmode
array\_like

\end{description}\end{quote}
\paragraph{References}

Vaisala, O. (2013). \sphinxtitleref{Humidity conversion formulas: Calculation formulas for humidity}. Retrieved from           \sphinxurl{https://www.vaisala.com}.

\end{fulllineitems}

\index{get\_isentropic\_isothermal\_analytical\_solution() (in module tasmania.utils.utils\_meteo)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:tasmania.utils.utils_meteo.get_isentropic_isothermal_analytical_solution}}\pysiglinewithargsret{\sphinxcode{tasmania.utils.utils\_meteo.}\sphinxbfcode{get\_isentropic\_isothermal\_analytical\_solution}}{\emph{grid}, \emph{x\_velocity\_initial}, \emph{temperature}, \emph{mountain\_height}, \emph{mountain\_width}, \emph{x\_staggered=True}, \emph{z\_staggered=False}}{}
Get the analytical expression of a two-dimensional, hydrostatic, isentropic and isothermal flow over an isolated
\sphinxtitleref{Switch of Agnesi} mountain.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{grid} (\sphinxstyleliteralemphasis{obj}) \textendash{} {\hyperref[\detokenize{api:grids.grid_xyz.GridXYZ}]{\sphinxcrossref{\sphinxcode{GridXYZ}}}} representing the underlying grid. It must consist of only one points in \(y\)-direction.

\item {} 
\sphinxstyleliteralstrong{x\_velocity\_initial} (\sphinxstyleliteralemphasis{float}) \textendash{} The initial \(x\)-velocity, in units of {[}\(m \, s^{-1}\){]}.

\item {} 
\sphinxstyleliteralstrong{temperature} (\sphinxstyleliteralemphasis{float}) \textendash{} The temperature, in units of {[}\(K\){]}.

\item {} 
\sphinxstyleliteralstrong{mountain\_height} (\sphinxstyleliteralemphasis{float}) \textendash{} The maximum mountain height, in units of {[}\(m\){]}.

\item {} 
\sphinxstyleliteralstrong{mountain\_width} (\sphinxstyleliteralemphasis{float}) \textendash{} The mountain half-width at half-height, in units of {[}\(m\){]}.

\item {} 
\sphinxstyleliteralstrong{x\_staggered} (\sphinxtitleref{bool}, optional) \textendash{} \sphinxcode{True} if the solution should be staggered in the \(x\)-direction, \sphinxcode{False} otherwise.
Default is \sphinxcode{True}.

\item {} 
\sphinxstyleliteralstrong{z\_staggered} (\sphinxtitleref{bool}, optional) \textendash{} \sphinxcode{True} if the solution should be staggered in the vertical direction, \sphinxcode{False} otherwise.
Default is \sphinxcode{False}.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
\sphinxstylestrong{u} (\sphinxstyleemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the \(x\)-velocity.

\item {} 
\sphinxstylestrong{w} (\sphinxstyleemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the vertical velocity.

\end{itemize}


\end{description}\end{quote}
\paragraph{References}

Durran, D. R. (1981). \sphinxtitleref{The effects of moisture on mountain lee waves}.          Doctoral dissertation, Massachussets Institute of Technology.

\end{fulllineitems}



\subsection{Plotting utilities}
\label{\detokenize{api:plotting-utilities}}\label{\detokenize{api:module-tasmania.utils.utils_plot}}\index{tasmania.utils.utils\_plot (module)}
Plotting utilities.
\index{\_reverse\_colormap() (in module tasmania.utils.utils\_plot)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:tasmania.utils.utils_plot._reverse_colormap}}\pysiglinewithargsret{\sphinxcode{tasmania.utils.utils\_plot.}\sphinxbfcode{\_reverse\_colormap}}{\emph{cmap}, \emph{name=None}}{}
Reverse a Matplotlib colormap.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{cmap} (\sphinxstyleliteralemphasis{obj}) \textendash{} The \sphinxhref{https://matplotlib.org/2.1.1/api/\_as\_gen/matplotlib.colors.LinearSegmentedColormap.html\#matplotlib.colors.LinearSegmentedColormap}{\sphinxcode{matplotlib.colors.LinearSegmentedColormap}} to invert.

\item {} 
\sphinxstyleliteralstrong{name} (\sphinxtitleref{str}, optional) \textendash{} The name of the reversed colormap. By default, this is obtained by appending ‘\_r’
to the name of the input colormap.

\end{itemize}

\item[{Returns}] \leavevmode
The reversed \sphinxhref{https://matplotlib.org/2.1.1/api/\_as\_gen/matplotlib.colors.LinearSegmentedColormap.html\#matplotlib.colors.LinearSegmentedColormap}{\sphinxcode{matplotlib.colors.LinearSegmentedColormap}}.

\item[{Return type}] \leavevmode
obj

\end{description}\end{quote}
\paragraph{References}

\sphinxurl{https://stackoverflow.com/questions/3279560/invert-colormap-in-matplotlib}.

\end{fulllineitems}

\index{animation\_contourf\_xz() (in module tasmania.utils.utils\_plot)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:tasmania.utils.utils_plot.animation_contourf_xz}}\pysiglinewithargsret{\sphinxcode{tasmania.utils.utils\_plot.}\sphinxbfcode{animation\_contourf\_xz}}{\emph{destination}, \emph{time}, \emph{x}, \emph{z}, \emph{field}, \emph{topography}, \emph{**kwargs}}{}
Generate an animation showing the time evolution of the contourfs of a field at a cross-section
parallel to the \(xz\)-plane.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{destination} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the path to the location where the movie will be saved.
Note that the string should include the extension as well.

\item {} 
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Array of :class:{\color{red}\bfseries{}{}`}datetime.datetime{}`\textasciitilde{}s representing the time instants of the frames.

\item {} 
\sphinxstyleliteralstrong{x} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the underlying \(x\)-grid.
This is assumed to be time-independent.

\item {} 
\sphinxstyleliteralstrong{z} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} 
Three-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the underlying \(z\)-grid.
It is assumed that:
\begin{itemize}
\item {} 
the first array axis represents \(x\);

\item {} 
the second array axis represents the vertical coordinate;

\item {} 
the third array axis represents the time.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{field} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} 
Three-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to plot.
It is assumed that:
\begin{itemize}
\item {} 
the first array axis represents \(x\);

\item {} 
the second array axis represents the vertical coordinate;

\item {} 
the third array axis represents the time.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{topography} (\sphinxtitleref{array\_like}, optional) \textendash{} 
Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the underlying topography.
It is assumed that:
\begin{itemize}
\item {} 
the first array axis represents \(x\);

\item {} 
the second array axis represents the time.

\end{itemize}


\end{itemize}

\item[{Keyword Arguments}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{fontsize} (\sphinxstyleliteralemphasis{int}) \textendash{} The fontsize to be used. Default is 12.

\item {} 
\sphinxstyleliteralstrong{figsize} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the figure size. Default is {[}8,8{]}.

\item {} 
\sphinxstyleliteralstrong{title} (\sphinxstyleliteralemphasis{str}) \textendash{} The figure title. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{x\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the \(x\)-axis. Default is ‘x’.

\item {} 
\sphinxstyleliteralstrong{x\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the \(x\)-axis. Default is 1.

\item {} 
\sphinxstyleliteralstrong{x\_lim} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the interval of the \(x\)-axis to visualize.
By default, the entire domain is shown.

\item {} 
\sphinxstyleliteralstrong{z\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the \(z\)-axis. Default is ‘z’.

\item {} 
\sphinxstyleliteralstrong{z\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the \(z\)-axis. Default is 1.

\item {} 
\sphinxstyleliteralstrong{z\_lim} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the interval of the \(z\)-axis to visualize.
By default, the entire domain is shown.

\item {} 
\sphinxstyleliteralstrong{field\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the field. Default is 1.

\item {} 
\sphinxstyleliteralstrong{draw\_z\_isolines} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} to draw the \(z\)-isolines, \sphinxcode{False} otherwise. Default is \sphinxcode{True}.

\item {} 
\sphinxstyleliteralstrong{cmap\_name} (\sphinxstyleliteralemphasis{str}) \textendash{} Name of the Matplotlib’s color map to be used. All the color maps provided by Matplotlib,
as well as the corresponding inverted versions, are available.

\item {} 
\sphinxstyleliteralstrong{cbar\_levels} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of levels for the color bar. Default is 14.

\item {} 
\sphinxstyleliteralstrong{cbar\_ticks\_step} (\sphinxstyleliteralemphasis{int}) \textendash{} Distance between two consecutive labelled ticks of the color bar. Default is 1, i.e.,
all ticks are displayed with the corresponding label.

\item {} 
\sphinxstyleliteralstrong{cbar\_center} (\sphinxstyleliteralemphasis{float}) \textendash{} Center of the range covered by the color bar. By default, the color bar covers the spectrum
ranging from the minimum to the maximum assumed by the field over time.

\item {} 
\sphinxstyleliteralstrong{cbar\_half\_width} (\sphinxstyleliteralemphasis{float}) \textendash{} Half-width of the range covered by the color bar. By default, the color bar covers the spectrum
ranging from the minimum to the maximum assumed by the field over time.

\item {} 
\sphinxstyleliteralstrong{cbar\_x\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the horizontal axis of the color bar. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{cbar\_y\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the vertical axis of the color bar. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{cbar\_orientation} (\sphinxstyleliteralemphasis{str}) \textendash{} Orientation of the color bar. Either ‘vertical’ (default) or ‘horizontal’.

\item {} 
\sphinxstyleliteralstrong{fps} (\sphinxstyleliteralemphasis{int}) \textendash{} Frames per second. Default is 15.

\item {} 
\sphinxstyleliteralstrong{text} (\sphinxstyleliteralemphasis{str}) \textendash{} Text to be added to the figure as anchored text. By default, no extra text is shown.

\item {} 
\sphinxstyleliteralstrong{text\_loc} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the location where the text box should be placed. Default is ‘upper right’;
please see \sphinxhref{https://matplotlib.org/2.1.1/api/offsetbox\_api.html\#matplotlib.offsetbox.AnchoredText}{\sphinxcode{matplotlib.offsetbox.AnchoredText}} for all the available options.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{animation\_profile\_x() (in module tasmania.utils.utils\_plot)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:tasmania.utils.utils_plot.animation_profile_x}}\pysiglinewithargsret{\sphinxcode{tasmania.utils.utils\_plot.}\sphinxbfcode{animation\_profile\_x}}{\emph{time}, \emph{x}, \emph{field}, \emph{destination}, \emph{**kwargs}}{}
Generate an animation showing the time evolution of a field along a cross line orthogonal
to the \(yz\)-plane.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Array of :class:{\color{red}\bfseries{}{}`}datetime.datetime{}`\textasciitilde{}s representing the time instants of the frames.

\item {} 
\sphinxstyleliteralstrong{x} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} One-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the underlying \(x\)-grid.

\item {} 
\sphinxstyleliteralstrong{field} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} 
Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to plot.
It is assumed that:
\begin{itemize}
\item {} 
the first array axis represents \(x\);

\item {} 
the second array axis represents the time.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{destination} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the path to the location where the movie will be saved.
Note that the string should include the extension as well.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{fontsize} (\sphinxstyleliteralemphasis{int}) \textendash{} The fontsize to be used. Default is 12.

\item {} 
\sphinxstyleliteralstrong{figsize} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the figure size. Default is {[}8,8{]}.

\item {} 
\sphinxstyleliteralstrong{title} (\sphinxstyleliteralemphasis{str}) \textendash{} The figure title. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{x\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the \(x\)-axis. Default is ‘x’.

\item {} 
\sphinxstyleliteralstrong{x\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the \(x\)-axis. Default is 1.

\item {} 
\sphinxstyleliteralstrong{x\_lim} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the interval of the \(x\)-axis to visualize.
By default, the entire domain is shown.

\item {} 
\sphinxstyleliteralstrong{y\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the \(y\)-axis. Default is ‘y’.

\item {} 
\sphinxstyleliteralstrong{y\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the field. Default is 1.

\item {} 
\sphinxstyleliteralstrong{y\_lim} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the interval of the \(y\)-axis to visualize.
By default, the entire domain is shown.

\item {} 
\sphinxstyleliteralstrong{color} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the color line. Default is ‘blue’.

\item {} 
\sphinxstyleliteralstrong{linewidth} (\sphinxstyleliteralemphasis{float}) \textendash{} The linewidth. Default is 1.

\item {} 
\sphinxstyleliteralstrong{grid\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} to draw the grid, \sphinxcode{False} otherwise. Default is \sphinxcode{True}.

\item {} 
\sphinxstyleliteralstrong{fps} (\sphinxstyleliteralemphasis{int}) \textendash{} Frames per second. Default is 15.

\item {} 
\sphinxstyleliteralstrong{text} (\sphinxstyleliteralemphasis{str}) \textendash{} Text to be added to the figure as anchored text. By default, no extra text is shown.

\item {} 
\sphinxstyleliteralstrong{text\_loc} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the location where the text box should be placed. Default is ‘upper right’;
please see \sphinxhref{https://matplotlib.org/2.1.1/api/offsetbox\_api.html\#matplotlib.offsetbox.AnchoredText}{\sphinxcode{matplotlib.offsetbox.AnchoredText}} for all the available options.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{animation\_profile\_x\_comparison() (in module tasmania.utils.utils\_plot)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:tasmania.utils.utils_plot.animation_profile_x_comparison}}\pysiglinewithargsret{\sphinxcode{tasmania.utils.utils\_plot.}\sphinxbfcode{animation\_profile\_x\_comparison}}{\emph{time}, \emph{x}, \emph{field}, \emph{destination}, \emph{**kwargs}}{}
Generate an animation showing the time evolution of one or more fields along a cross line orthogonal
to the \(yz\)-plane.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{time} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Array of :class:{\color{red}\bfseries{}{}`}datetime.datetime{}`\textasciitilde{}s representing the time instants of the frames.

\item {} 
\sphinxstyleliteralstrong{x} (\sphinxstyleliteralemphasis{list}) \textendash{} 
Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} storing the \(x\)-grids underlying each field.
It is assumed that:
\begin{itemize}
\item {} 
the fields are concatenated along the first array axis;

\item {} 
the second array axis represents \(x\).

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{field} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} 
Three-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} storing the fields to plot.
It is assumed that:
\begin{itemize}
\item {} 
the fields are concatenated along the first array axis;

\item {} 
the second array axis represents \(x\);

\item {} 
the third array axis represents the time.

\end{itemize}


\item {} 
\sphinxstyleliteralstrong{destination} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the path to the location where the movie will be saved.
Note that the string should include the extension as well.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{fontsize} (\sphinxstyleliteralemphasis{int}) \textendash{} The fontsize to be used. Default is 12.

\item {} 
\sphinxstyleliteralstrong{figsize} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the figure size. Default is {[}8,8{]}.

\item {} 
\sphinxstyleliteralstrong{title} (\sphinxstyleliteralemphasis{str}) \textendash{} The figure title. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{x\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the \(x\)-axis. Default is ‘x’.

\item {} 
\sphinxstyleliteralstrong{x\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the \(x\)-axis. Default is 1.

\item {} 
\sphinxstyleliteralstrong{x\_lim} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the interval of the \(x\)-axis to visualize.
By default, the entire domain is shown.

\item {} 
\sphinxstyleliteralstrong{y\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the \(y\)-axis. Default is ‘y’.

\item {} 
\sphinxstyleliteralstrong{y\_lim} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the interval of the \(y\)-axis to visualize.
By default, the entire domain is shown.

\item {} 
\sphinxstyleliteralstrong{field\_factor} (\sphinxstyleliteralemphasis{list}) \textendash{} List storing the scaling factor for each field. By default, all scaling factors are assumed to be 1.

\item {} 
\sphinxstyleliteralstrong{color} (\sphinxstyleliteralemphasis{list}) \textendash{} List of strings specifying the line color for each field. The default sequence of colors is: ‘blue’, ‘red’, ‘green’, ‘black’.

\item {} 
\sphinxstyleliteralstrong{linestyle} (\sphinxstyleliteralemphasis{list}) \textendash{} List of strings specifying the line style for each field. The default line style is ‘-‘.

\item {} 
\sphinxstyleliteralstrong{linewidth} (\sphinxstyleliteralemphasis{list}) \textendash{} List of floats representing the line width for each field. The default line width is 1.

\item {} 
\sphinxstyleliteralstrong{grid\_on} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} to draw the grid, \sphinxcode{False} otherwise. Default is \sphinxcode{True}.

\item {} 
\sphinxstyleliteralstrong{fps} (\sphinxstyleliteralemphasis{int}) \textendash{} Frames per second. Default is 15.

\item {} 
\sphinxstyleliteralstrong{legend} (\sphinxstyleliteralemphasis{list}) \textendash{} List gathering the legend entries for each field. Default is ‘field1’, ‘field2’, etc.

\item {} 
\sphinxstyleliteralstrong{legend\_loc} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the location where the legend box should be placed. Default is ‘best’;
please see \sphinxhref{https://matplotlib.org/2.1.1/api/\_as\_gen/matplotlib.pyplot.legend.html\#matplotlib.pyplot.legend}{\sphinxcode{matplotlib.pyplot.legend()}} for all the available options.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{contour\_xz() (in module tasmania.utils.utils\_plot)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:tasmania.utils.utils_plot.contour_xz}}\pysiglinewithargsret{\sphinxcode{tasmania.utils.utils\_plot.}\sphinxbfcode{contour\_xz}}{\emph{x}, \emph{z}, \emph{field}, \emph{topography}, \emph{**kwargs}}{}
Generate the contour plot of a gridded field at a cross-section parallel to the \(xz\)-plane.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{x} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the underlying \(x\)-grid.

\item {} 
\sphinxstyleliteralstrong{z} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the underlying \(z\)-grid.

\item {} 
\sphinxstyleliteralstrong{field} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to plot.

\item {} 
\sphinxstyleliteralstrong{topography} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} One-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the underlying topography.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{show} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the plot should be showed, \sphinxcode{False} otherwise. Default is \sphinxcode{True}.

\item {} 
\sphinxstyleliteralstrong{destination} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the path to the location where the plot will be saved. Default is \sphinxcode{None},
meaning that the plot will not be saved. Note that the plot may be saved only if \sphinxcode{show} is
set to \sphinxcode{False}.

\item {} 
\sphinxstyleliteralstrong{fontsize} (\sphinxstyleliteralemphasis{int}) \textendash{} The fontsize to be used. Default is 12.

\item {} 
\sphinxstyleliteralstrong{figsize} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the figure size. Default is {[}8,8{]}.

\item {} 
\sphinxstyleliteralstrong{title} (\sphinxstyleliteralemphasis{str}) \textendash{} The figure title. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{x\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the \(x\)-axis. Default is ‘x’.

\item {} 
\sphinxstyleliteralstrong{x\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the \(x\)-axis. Default is 1.

\item {} 
\sphinxstyleliteralstrong{x\_lim} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the interval of the \(x\)-axis to visualize.
By default, the entire domain is shown.

\item {} 
\sphinxstyleliteralstrong{z\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the \(z\)-axis. Default is ‘z’.

\item {} 
\sphinxstyleliteralstrong{z\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the \(z\)-axis. Default is 1.

\item {} 
\sphinxstyleliteralstrong{z\_lim} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the interval of the \(z\)-axis to visualize.
By default, the entire domain is shown.

\item {} 
\sphinxstyleliteralstrong{field\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the field. Default is 1.

\item {} 
\sphinxstyleliteralstrong{draw\_z\_isolines} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} to draw the \(z\)-isolines, \sphinxcode{False} otherwise. Default is \sphinxcode{True}.

\item {} 
\sphinxstyleliteralstrong{text} (\sphinxstyleliteralemphasis{str}) \textendash{} Text to be added to the figure as anchored text. By default, no extra text is shown.

\item {} 
\sphinxstyleliteralstrong{text\_loc} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the location where the text box should be placed. Default is ‘upper right’;
please see \sphinxhref{https://matplotlib.org/2.1.1/api/offsetbox\_api.html\#matplotlib.offsetbox.AnchoredText}{\sphinxcode{matplotlib.offsetbox.AnchoredText}} for all the available options.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{contourf\_xy() (in module tasmania.utils.utils\_plot)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:tasmania.utils.utils_plot.contourf_xy}}\pysiglinewithargsret{\sphinxcode{tasmania.utils.utils\_plot.}\sphinxbfcode{contourf\_xy}}{\emph{x}, \emph{y}, \emph{topography}, \emph{field}, \emph{**kwargs}}{}
Generate the contourf plot of a field at a cross-section parallel to the \(xy\)-plane.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{x} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the underlying \(x\)-grid.

\item {} 
\sphinxstyleliteralstrong{y} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the underlying \(y\)-grid.

\item {} 
\sphinxstyleliteralstrong{topography} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the underlying topography height.

\item {} 
\sphinxstyleliteralstrong{field} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to plot.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{show} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the plot should be showed, \sphinxcode{False} otherwise. Default is \sphinxcode{True}.

\item {} 
\sphinxstyleliteralstrong{destination} (\sphinxstyleliteralemphasis{str}) \textendash{} String specify the path to the location where the plot will be saved. Default is \sphinxcode{None},
meaning that the plot will not be saved. Note that the plot may be saved only if \sphinxcode{show}
is set to \sphinxcode{False}.

\item {} 
\sphinxstyleliteralstrong{fontsize} (\sphinxstyleliteralemphasis{int}) \textendash{} The fontsize to be used. Default is 12.

\item {} 
\sphinxstyleliteralstrong{figsize} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the figure size. Default is {[}8,8{]}.

\item {} 
\sphinxstyleliteralstrong{title} (\sphinxstyleliteralemphasis{str}) \textendash{} The figure title. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{x\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the \(x\)-axis. Default is ‘x’.

\item {} 
\sphinxstyleliteralstrong{x\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the \(x\)-axis. Default is 1.

\item {} 
\sphinxstyleliteralstrong{x\_lim} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the interval of the \(x\)-axis to visualize.
By default, the entire domain is shown.

\item {} 
\sphinxstyleliteralstrong{y\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the \(y\)-axis. Default is ‘y’.

\item {} 
\sphinxstyleliteralstrong{y\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the \(y\)-axis. Default is 1.

\item {} 
\sphinxstyleliteralstrong{y\_lim} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the interval of the \(y\)-axis to visualize.
By default, the entire domain is shown.

\item {} 
\sphinxstyleliteralstrong{field\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the field. Default is 1.

\item {} 
\sphinxstyleliteralstrong{cmap\_name} (\sphinxstyleliteralemphasis{str}) \textendash{} Name of the Matplotlib’s color map to be used. All the color maps provided by Matplotlib,
as well as the corresponding inverted versions, are available.

\item {} 
\sphinxstyleliteralstrong{cbar\_levels} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of levels for the color bar. Default is 14.

\item {} 
\sphinxstyleliteralstrong{cbar\_ticks\_step} (\sphinxstyleliteralemphasis{int}) \textendash{} Distance between two consecutive labelled ticks of the color bar. Default is 1, i.e.,
all ticks are displayed with the corresponding label.

\item {} 
\sphinxstyleliteralstrong{cbar\_center} (\sphinxstyleliteralemphasis{float}) \textendash{} Center of the range covered by the color bar. By default, the color bar covers the spectrum
ranging from the minimum to the maximum assumed by the field.

\item {} 
\sphinxstyleliteralstrong{cbar\_half\_width} (\sphinxstyleliteralemphasis{float}) \textendash{} Half-width of the range covered by the color bar. By default, the color bar covers the spectrum
ranging from the minimum to the maximum assumed by the field.

\item {} 
\sphinxstyleliteralstrong{cbar\_x\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the horizontal axis of the color bar. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{cbar\_y\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the vertical axis of the color bar. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{cbar\_orientation} (\sphinxstyleliteralemphasis{str}) \textendash{} Orientation of the color bar. Either ‘vertical’ (default) or ‘horizontal’.

\item {} 
\sphinxstyleliteralstrong{text} (\sphinxstyleliteralemphasis{str}) \textendash{} Text to be added to the figure as anchored text. By default, no extra text is shown.

\item {} 
\sphinxstyleliteralstrong{text\_loc} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the location where the text box should be placed. Default is ‘upper right’;
please see \sphinxhref{https://matplotlib.org/2.1.1/api/offsetbox\_api.html\#matplotlib.offsetbox.AnchoredText}{\sphinxcode{matplotlib.offsetbox.AnchoredText}} for all the available options.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{contourf\_xz() (in module tasmania.utils.utils\_plot)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:tasmania.utils.utils_plot.contourf_xz}}\pysiglinewithargsret{\sphinxcode{tasmania.utils.utils\_plot.}\sphinxbfcode{contourf\_xz}}{\emph{x}, \emph{z}, \emph{field}, \emph{topography}, \emph{**kwargs}}{}
Generate the contourf plot of a gridded field at a cross-section parallel to the \(xz\)-plane.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{x} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the underlying \(x\)-grid.

\item {} 
\sphinxstyleliteralstrong{z} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the underlying \(z\)-grid.

\item {} 
\sphinxstyleliteralstrong{field} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the field to plot.

\item {} 
\sphinxstyleliteralstrong{topography} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} One-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the underlying topography.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{show} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the plot should be showed, \sphinxcode{False} otherwise. Default is \sphinxcode{True}.

\item {} 
\sphinxstyleliteralstrong{destination} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the path to the location where the plot will be saved. Default is \sphinxcode{None},
meaning that the plot will not be saved. Note that the plot may be saved only if \sphinxcode{show}
is set to \sphinxcode{False}.

\item {} 
\sphinxstyleliteralstrong{fontsize} (\sphinxstyleliteralemphasis{int}) \textendash{} The fontsize to be used. Default is 12.

\item {} 
\sphinxstyleliteralstrong{figsize} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the figure size. Default is {[}8,8{]}.

\item {} 
\sphinxstyleliteralstrong{title} (\sphinxstyleliteralemphasis{str}) \textendash{} The figure title. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{x\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the \(x\)-axis. Default is ‘x’.

\item {} 
\sphinxstyleliteralstrong{x\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the \(x\)-axis. Default is 1.

\item {} 
\sphinxstyleliteralstrong{x\_lim} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the interval of the \(x\)-axis to visualize.
By default, the entire domain is shown.

\item {} 
\sphinxstyleliteralstrong{z\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the \(z\)-axis. Default is ‘z’.

\item {} 
\sphinxstyleliteralstrong{z\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the \(z\)-axis. Default is 1.

\item {} 
\sphinxstyleliteralstrong{z\_lim} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the interval of the \(z\)-axis to visualize.
By default, the entire domain is shown.

\item {} 
\sphinxstyleliteralstrong{field\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the field. Default is 1.

\item {} 
\sphinxstyleliteralstrong{draw\_z\_isolines} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} to draw the \(z\)-isolines, \sphinxcode{False} otherwise. Default is \sphinxcode{True}.

\item {} 
\sphinxstyleliteralstrong{cmap\_name} (\sphinxstyleliteralemphasis{str}) \textendash{} Name of the Matplotlib’s color map to be used. All the color maps provided by Matplotlib,
as well as the corresponding inverted versions, are available.

\item {} 
\sphinxstyleliteralstrong{cbar\_levels} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of levels for the color bar. Default is 14.

\item {} 
\sphinxstyleliteralstrong{cbar\_ticks\_step} (\sphinxstyleliteralemphasis{int}) \textendash{} Distance between two consecutive labelled ticks of the color bar. Default is 1, i.e.,
all ticks are displayed with the corresponding label.

\item {} 
\sphinxstyleliteralstrong{cbar\_center} (\sphinxstyleliteralemphasis{float}) \textendash{} Center of the range covered by the color bar. By default, the color bar covers the spectrum
ranging from the minimum to the maximum assumed by the field.

\item {} 
\sphinxstyleliteralstrong{cbar\_half\_width} (\sphinxstyleliteralemphasis{float}) \textendash{} Half-width of the range covered by the color bar. By default, the color bar covers the spectrum
ranging from the minimum to the maximum assumed by the field.

\item {} 
\sphinxstyleliteralstrong{cbar\_x\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the horizontal axis of the color bar. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{cbar\_y\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the vertical axis of the color bar. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{cbar\_orientation} (\sphinxstyleliteralemphasis{str}) \textendash{} Orientation of the color bar. Either ‘vertical’ (default) or ‘horizontal’.

\item {} 
\sphinxstyleliteralstrong{text} (\sphinxstyleliteralemphasis{str}) \textendash{} Text to be added to the figure as anchored text. By default, no extra text is shown.

\item {} 
\sphinxstyleliteralstrong{text\_loc} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the location where the text box should be placed. Default is ‘upper right’;
please see \sphinxhref{https://matplotlib.org/2.1.1/api/offsetbox\_api.html\#matplotlib.offsetbox.AnchoredText}{\sphinxcode{matplotlib.offsetbox.AnchoredText}} for all the available options.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{quiver\_xy() (in module tasmania.utils.utils\_plot)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:tasmania.utils.utils_plot.quiver_xy}}\pysiglinewithargsret{\sphinxcode{tasmania.utils.utils\_plot.}\sphinxbfcode{quiver\_xy}}{\emph{x}, \emph{y}, \emph{topography}, \emph{vx}, \emph{vy}, \emph{scalar=None}, \emph{**kwargs}}{}
Generate the quiver plot of a gridded vectorial field at a cross-section parallel to the \(xy\)-plane.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{x} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the underlying \(x\)-grid.

\item {} 
\sphinxstyleliteralstrong{y} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the underlying \(y\)-grid.

\item {} 
\sphinxstyleliteralstrong{topography} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the underlying topography height.

\item {} 
\sphinxstyleliteralstrong{vx} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the \(x\)-component of the field to plot.

\item {} 
\sphinxstyleliteralstrong{vy} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the \(y\)-component of the field to plot.

\item {} 
\sphinxstyleliteralstrong{scalar} (\sphinxtitleref{array\_like}, optional) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing a scalar field associated with the vectorial field.
The arrows will be colored based on the associated scalar value.
If not specified, the arrows will be colored based on their magnitude.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{show} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the plot should be showed, \sphinxcode{False} otherwise. Default is \sphinxcode{True}.

\item {} 
\sphinxstyleliteralstrong{destination} (\sphinxstyleliteralemphasis{str}) \textendash{} String specify the path to the location where the plot will be saved. Default is \sphinxcode{None},
meaning that the plot will not be saved. Note that the plot may be saved only if \sphinxcode{show}
is set to \sphinxcode{False}.

\item {} 
\sphinxstyleliteralstrong{fontsize} (\sphinxstyleliteralemphasis{int}) \textendash{} The fontsize to be used. Default is 12.

\item {} 
\sphinxstyleliteralstrong{figsize} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the figure size. Default is {[}8,8{]}.

\item {} 
\sphinxstyleliteralstrong{title} (\sphinxstyleliteralemphasis{str}) \textendash{} The figure title. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{x\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the \(x\)-axis. Default is ‘x’.

\item {} 
\sphinxstyleliteralstrong{x\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the \(x\)-axis. Default is 1.

\item {} 
\sphinxstyleliteralstrong{x\_lim} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the interval of the \(x\)-axis to visualize.
By default, the entire domain is shown.

\item {} 
\sphinxstyleliteralstrong{x\_step} (\sphinxstyleliteralemphasis{int}) \textendash{} Maximum distance between the \(x\)-index of a drawn point, and the \(x\)-index of any
of its neighbours. Default is 2, i.e., only half of the points will be drawn.

\item {} 
\sphinxstyleliteralstrong{y\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the \(y\)-axis. Default is ‘y’.

\item {} 
\sphinxstyleliteralstrong{y\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the \(y\)-axis. Default is 1.

\item {} 
\sphinxstyleliteralstrong{y\_lim} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the interval of the \(y\)-axis to visualize.
By default, the entire domain is shown.

\item {} 
\sphinxstyleliteralstrong{y\_step} (\sphinxstyleliteralemphasis{int}) \textendash{} Maximum distance between the \(y\)-index of a drawn point, and the :math:{\color{red}\bfseries{}{}`}y-index of any
of its neighbours. Default is 2, i.e., only half of the points will be drawn.

\item {} 
\sphinxstyleliteralstrong{field\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the field. Default is 1.

\item {} 
\sphinxstyleliteralstrong{cmap\_name} (\sphinxstyleliteralemphasis{str}) \textendash{} Name of the Matplotlib’s color map to be used. All the color maps provided by Matplotlib,
as well as the corresponding inverted versions, are available. If not specified, no color map
will be used, and the arrows will draw black.

\item {} 
\sphinxstyleliteralstrong{cbar\_levels} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of levels for the color bar. Default is 14.

\item {} 
\sphinxstyleliteralstrong{cbar\_ticks\_step} (\sphinxstyleliteralemphasis{int}) \textendash{} Distance between two consecutive labelled ticks of the color bar. Default is 1, i.e.,
all ticks are displayed with the corresponding label.

\item {} 
\sphinxstyleliteralstrong{cbar\_center} (\sphinxstyleliteralemphasis{float}) \textendash{} Center of the range covered by the color bar. By default, the color bar covers the spectrum
ranging from the minimum to the maximum assumed by the field.

\item {} 
\sphinxstyleliteralstrong{cbar\_half\_width} (\sphinxstyleliteralemphasis{float}) \textendash{} Half-width of the range covered by the color bar. By default, the color bar covers the spectrum
ranging from the minimum to the maximum assumed by the field.

\item {} 
\sphinxstyleliteralstrong{cbar\_x\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the horizontal axis of the color bar. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{cbar\_y\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the vertical axis of the color bar. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{cbar\_orientation} (\sphinxstyleliteralemphasis{str}) \textendash{} Orientation of the color bar. Either ‘vertical’ (default) or ‘horizontal’.

\item {} 
\sphinxstyleliteralstrong{text} (\sphinxstyleliteralemphasis{str}) \textendash{} Text to be added to the figure as anchored text. By default, no extra text is shown.

\item {} 
\sphinxstyleliteralstrong{text\_loc} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the location where the text box should be placed. Default is ‘upper right’;
please see \sphinxhref{https://matplotlib.org/2.1.1/api/offsetbox\_api.html\#matplotlib.offsetbox.AnchoredText}{\sphinxcode{matplotlib.offsetbox.AnchoredText}} for all the available options.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{quiver\_xz() (in module tasmania.utils.utils\_plot)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:tasmania.utils.utils_plot.quiver_xz}}\pysiglinewithargsret{\sphinxcode{tasmania.utils.utils\_plot.}\sphinxbfcode{quiver\_xz}}{\emph{x}, \emph{z}, \emph{topography}, \emph{vx}, \emph{vz}, \emph{scalar=None}, \emph{**kwargs}}{}
Generate the quiver plot of a gridded vectorial field at a cross-section parallel to the \(xz\)-plane.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{x} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the underlying \(x\)-grid.

\item {} 
\sphinxstyleliteralstrong{z} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the underlying \(z\)-grid.

\item {} 
\sphinxstyleliteralstrong{topography} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} One-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the underlying topography height.

\item {} 
\sphinxstyleliteralstrong{vx} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the \(x\)-component of the field to plot.

\item {} 
\sphinxstyleliteralstrong{vz} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the \(z\)-component of the field to plot.

\item {} 
\sphinxstyleliteralstrong{scalar} (\sphinxtitleref{array\_like}, optional) \textendash{} \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing a scalar field associated with the vectorial field.
The arrows will be colored based on the associated scalar value.
If not specified, the arrows will be colored based on their magnitude.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{show} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the plot should be showed, \sphinxcode{False} otherwise. Default is \sphinxcode{True}.

\item {} 
\sphinxstyleliteralstrong{destination} (\sphinxstyleliteralemphasis{str}) \textendash{} String specify the path to the location where the plot will be saved. Default is \sphinxcode{None},
meaning that the plot will not be saved. Note that the plot may be saved only if \sphinxcode{show}
is set to \sphinxcode{False}.

\item {} 
\sphinxstyleliteralstrong{fontsize} (\sphinxstyleliteralemphasis{int}) \textendash{} The fontsize to be used. Default is 12.

\item {} 
\sphinxstyleliteralstrong{figsize} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the figure size. Default is {[}8,8{]}.

\item {} 
\sphinxstyleliteralstrong{title} (\sphinxstyleliteralemphasis{str}) \textendash{} The figure title. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{x\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the \(x\)-axis. Default is ‘x’.

\item {} 
\sphinxstyleliteralstrong{x\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the \(x\)-axis. Default is 1.

\item {} 
\sphinxstyleliteralstrong{x\_lim} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the interval of the \(x\)-axis to visualize.
By default, the entire domain is shown.

\item {} 
\sphinxstyleliteralstrong{x\_step} (\sphinxstyleliteralemphasis{int}) \textendash{} Maximum distance between the \(x\)-index of a drawn point, and the \(x\)-index of any
of its neighbours. Default is 2, i.e., only half of the points will be drawn.

\item {} 
\sphinxstyleliteralstrong{z\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the \(z\)-axis. Default is ‘z’.

\item {} 
\sphinxstyleliteralstrong{z\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the \(z\)-axis. Default is 1.

\item {} 
\sphinxstyleliteralstrong{z\_lim} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the interval of the \(z\)-axis to visualize.
By default, the entire domain is shown.

\item {} 
\sphinxstyleliteralstrong{z\_step} (\sphinxstyleliteralemphasis{int}) \textendash{} Maximum distance between the \(z\)-index of a drawn point, and the :math:{\color{red}\bfseries{}{}`}z-index of any
of its neighbours. Default is 2, i.e., only half of the points will be drawn.

\item {} 
\sphinxstyleliteralstrong{field\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the field. Default is 1.

\item {} 
\sphinxstyleliteralstrong{cmap\_name} (\sphinxstyleliteralemphasis{str}) \textendash{} Name of the Matplotlib’s color map to be used. All the color maps provided by Matplotlib,
as well as the corresponding inverted versions, are available. If not specified, no color map
will be used, and the arrows will draw black.

\item {} 
\sphinxstyleliteralstrong{cbar\_levels} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of levels for the color bar. Default is 14.

\item {} 
\sphinxstyleliteralstrong{cbar\_ticks\_step} (\sphinxstyleliteralemphasis{int}) \textendash{} Distance between two consecutive labelled ticks of the color bar. Default is 1, i.e.,
all ticks are displayed with the corresponding label.

\item {} 
\sphinxstyleliteralstrong{cbar\_center} (\sphinxstyleliteralemphasis{float}) \textendash{} Center of the range covered by the color bar. By default, the color bar covers the spectrum
ranging from the minimum to the maximum assumed by the field.

\item {} 
\sphinxstyleliteralstrong{cbar\_half\_width} (\sphinxstyleliteralemphasis{float}) \textendash{} Half-width of the range covered by the color bar. By default, the color bar covers the spectrum
ranging from the minimum to the maximum assumed by the field.

\item {} 
\sphinxstyleliteralstrong{cbar\_x\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the horizontal axis of the color bar. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{cbar\_y\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the vertical axis of the color bar. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{cbar\_orientation} (\sphinxstyleliteralemphasis{str}) \textendash{} Orientation of the color bar. Either ‘vertical’ (default) or ‘horizontal’.

\item {} 
\sphinxstyleliteralstrong{text} (\sphinxstyleliteralemphasis{str}) \textendash{} Text to be added to the figure as anchored text. By default, no extra text is shown.

\item {} 
\sphinxstyleliteralstrong{text\_loc} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the location where the text box should be placed. Default is ‘upper right’;
please see \sphinxhref{https://matplotlib.org/2.1.1/api/offsetbox\_api.html\#matplotlib.offsetbox.AnchoredText}{\sphinxcode{matplotlib.offsetbox.AnchoredText}} for all the available options.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{streamplot\_xz() (in module tasmania.utils.utils\_plot)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:tasmania.utils.utils_plot.streamplot_xz}}\pysiglinewithargsret{\sphinxcode{tasmania.utils.utils\_plot.}\sphinxbfcode{streamplot\_xz}}{\emph{x}, \emph{z}, \emph{u}, \emph{w}, \emph{color}, \emph{topography}, \emph{**kwargs}}{}
Generate the streamplot of a gridded vector field at a cross-section parallel to the \(xz\)-plane.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{x} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the underlying \(x\)-grid.

\item {} 
\sphinxstyleliteralstrong{z} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the underlying \(z\)-grid.

\item {} 
\sphinxstyleliteralstrong{u} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the \(x\)-velocity.

\item {} 
\sphinxstyleliteralstrong{w} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the \(z\)-velocity.

\item {} 
\sphinxstyleliteralstrong{color} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} Two-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the streamlines color.

\item {} 
\sphinxstyleliteralstrong{topography} (\sphinxstyleliteralemphasis{array\_like}) \textendash{} One-dimensional \sphinxhref{https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.ndarray.html\#numpy.ndarray}{\sphinxcode{numpy.ndarray}} representing the underlying topography.

\end{itemize}

\item[{Keyword Arguments}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{show} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} if the plot should be showed, \sphinxcode{False} otherwise. Default is \sphinxcode{True}.

\item {} 
\sphinxstyleliteralstrong{destination} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the path to the location where the plot will be saved. Default is \sphinxcode{None},
meaning that the plot will not be saved. Note that the plot may be saved only if \sphinxcode{show}
is set to \sphinxcode{False}.

\item {} 
\sphinxstyleliteralstrong{fontsize} (\sphinxstyleliteralemphasis{int}) \textendash{} The fontsize to be used. Default is 12.

\item {} 
\sphinxstyleliteralstrong{figsize} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the figure size. Default is {[}8,8{]}.

\item {} 
\sphinxstyleliteralstrong{title} (\sphinxstyleliteralemphasis{str}) \textendash{} The figure title. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{x\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the \(x\)-axis. Default is ‘x’.

\item {} 
\sphinxstyleliteralstrong{x\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the \(x\)-axis. Default is 1.

\item {} 
\sphinxstyleliteralstrong{x\_lim} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the interval of the \(x\)-axis to visualize.
By default, the entire domain is shown.

\item {} 
\sphinxstyleliteralstrong{z\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the \(z\)-axis. Default is ‘z’.

\item {} 
\sphinxstyleliteralstrong{z\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the \(z\)-axis. Default is 1.

\item {} 
\sphinxstyleliteralstrong{z\_lim} (\sphinxstyleliteralemphasis{sequence}) \textendash{} Sequence representing the interval of the \(z\)-axis to visualize.
By default, the entire domain is shown.

\item {} 
\sphinxstyleliteralstrong{u\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the \(x\)-velocity. Default is 1.

\item {} 
\sphinxstyleliteralstrong{w\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the \(z\)-velocity. Default is 1.

\item {} 
\sphinxstyleliteralstrong{color\_factor} (\sphinxstyleliteralemphasis{float}) \textendash{} Scaling factor for the color field. Default is 1.

\item {} 
\sphinxstyleliteralstrong{draw\_z\_isolines} (\sphinxstyleliteralemphasis{bool}) \textendash{} \sphinxcode{True} to draw the \(z\)-isolines, \sphinxcode{False} otherwise. Default is \sphinxcode{False}.

\item {} 
\sphinxstyleliteralstrong{cmap\_name} (\sphinxstyleliteralemphasis{str}) \textendash{} Name of the Matplotlib’s color map to be used. All the color maps provided by Matplotlib,
as well as the corresponding inverted versions, are available.

\item {} 
\sphinxstyleliteralstrong{cbar\_levels} (\sphinxstyleliteralemphasis{int}) \textendash{} Number of levels for the color bar. Default is 14.

\item {} 
\sphinxstyleliteralstrong{cbar\_ticks\_step} (\sphinxstyleliteralemphasis{int}) \textendash{} Distance between two consecutive labelled ticks of the color bar. Default is 1, i.e.,
all ticks are displayed with the corresponding label.

\item {} 
\sphinxstyleliteralstrong{cbar\_center} (\sphinxstyleliteralemphasis{float}) \textendash{} Center of the range covered by the color bar. By default, the color bar covers the spectrum
ranging from the minimum to the maximum assumed by the field.

\item {} 
\sphinxstyleliteralstrong{cbar\_half\_width} (\sphinxstyleliteralemphasis{float}) \textendash{} Half-width of the range covered by the color bar. By default, the color bar covers the spectrum
ranging from the minimum to the maximum assumed by the field.

\item {} 
\sphinxstyleliteralstrong{cbar\_x\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the horizontal axis of the color bar. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{cbar\_y\_label} (\sphinxstyleliteralemphasis{str}) \textendash{} Label for the vertical axis of the color bar. Default is an empty string.

\item {} 
\sphinxstyleliteralstrong{cbar\_orientation} (\sphinxstyleliteralemphasis{str}) \textendash{} Orientation of the color bar. Either ‘vertical’ (default) or ‘horizontal’.

\item {} 
\sphinxstyleliteralstrong{text} (\sphinxstyleliteralemphasis{str}) \textendash{} Text to be added to the figure as anchored text. By default, no extra text is shown.

\item {} 
\sphinxstyleliteralstrong{text\_loc} (\sphinxstyleliteralemphasis{str}) \textendash{} String specifying the location where the text box should be placed. Default is ‘upper right’;
please see \sphinxhref{https://matplotlib.org/2.1.1/api/offsetbox\_api.html\#matplotlib.offsetbox.AnchoredText}{\sphinxcode{matplotlib.offsetbox.AnchoredText}} for all the available options.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}



\chapter{Indices and tables}
\label{\detokenize{index:indices-and-tables}}\begin{itemize}
\item {} 
\DUrole{xref,std,std-ref}{genindex}

\item {} 
\DUrole{xref,std,std-ref}{modindex}

\item {} 
\DUrole{xref,std,std-ref}{search}

\end{itemize}


\renewcommand{\indexname}{Python Module Index}
\begin{sphinxtheindex}
\def\bigletter#1{{\Large\sffamily#1}\nopagebreak\vspace{1mm}}
\bigletter{g}
\item {\sphinxstyleindexentry{grids.topography}}\sphinxstyleindexpageref{api:\detokenize{module-grids.topography}}
\indexspace
\bigletter{n}
\item {\sphinxstyleindexentry{namelist}}\sphinxstyleindexpageref{api:\detokenize{module-namelist}}
\indexspace
\bigletter{t}
\item {\sphinxstyleindexentry{tasmania.set\_namelist}}\sphinxstyleindexpageref{api:\detokenize{module-tasmania.set_namelist}}
\item {\sphinxstyleindexentry{tasmania.utils.utils}}\sphinxstyleindexpageref{api:\detokenize{module-tasmania.utils.utils}}
\item {\sphinxstyleindexentry{tasmania.utils.utils\_meteo}}\sphinxstyleindexpageref{api:\detokenize{module-tasmania.utils.utils_meteo}}
\item {\sphinxstyleindexentry{tasmania.utils.utils\_plot}}\sphinxstyleindexpageref{api:\detokenize{module-tasmania.utils.utils_plot}}
\end{sphinxtheindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}